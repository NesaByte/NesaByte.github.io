(self["webpackChunkwbs_creator"]=self["webpackChunkwbs_creator"]||[]).push([[443],{1852:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return _L}});var n={};r.r(n),r.d(n,{AbsPlugin:function(){return Qi},ArrayPlugin:function(){return Ji},BitShiftPlugin:function(){return ro},BitwiseLogicOperationsPlugin:function(){return io},BooleanPlugin:function(){return oo},CharPlugin:function(){return co},CodePlugin:function(){return lo},ComplexPlugin:function(){return kl},ConditionalAggregationPlugin:function(){return Rc},CountBlankPlugin:function(){return uo},CountUniquePlugin:function(){return ho},DateTimePlugin:function(){return fo},DegreesPlugin:function(){return vo},DeltaPlugin:function(){return To},ExpPlugin:function(){return So},FinancialPlugin:function(){return Ao},FormulaTextPlugin:function(){return Co},InformationPlugin:function(){return Oo},IsEvenPlugin:function(){return Io},IsOddPlugin:function(){return Mo},LogarithmPlugin:function(){return Do},LookupPlugin:function(){return Cc},MathConstantsPlugin:function(){return ko},MathPlugin:function(){return Il},MatrixPlugin:function(){return xo},MedianPlugin:function(){return Fo},ModuloPlugin:function(){return Po},NumericAggregationPlugin:function(){return Vo},PowerPlugin:function(){return Ho},RadiansPlugin:function(){return zo},RadixConversionPlugin:function(){return Jo},RandomPlugin:function(){return sc},RomanPlugin:function(){return Oc},RoundingPlugin:function(){return cc},SimpleArithmerticPlugin:function(){return Lc},SqrtPlugin:function(){return lc},StatisticalAggregationPlugin:function(){return $l},StatisticalPlugin:function(){return Ol},SumprodPlugin:function(){return yc},TextPlugin:function(){return Nc},TrigonometryPlugin:function(){return wc}});var a,s,i=function(){var e=this,t=e._self._c;return t("div",{staticClass:"front wbs_table",attrs:{id:"wbs_table"}},[t("div",{staticClass:"hot-center"},[t("div",{staticClass:"btn_WBS",attrs:{"data-app":""}},[t("v-snackbar",{attrs:{"multi-line":""},scopedSlots:e._u([{key:"actions",fn:function(){return[t("v-btn",{attrs:{color:"red",variant:"text"},on:{click:function(t){e.snackbar_finalize=!1}}},[e._v(" Close ")])]},proxy:!0}]),model:{value:e.snackbar_finalize,callback:function(t){e.snackbar_finalize=t},expression:"snackbar_finalize"}},[t("h3",[e._v("FINALIZE RUNNING")]),e._v(" "),t("br")]),t("v-row",{attrs:{justify:"center"}},[t("v-col",{attrs:{cols:"auto"}},[t("v-dialog",{attrs:{persistent:"","max-width":"600px"},scopedSlots:e._u([{key:"activator",fn:function({on:r,attrs:n}){return[t("v-btn",e._g(e._b({attrs:{justify:"center",color:"primary",dark:""}},"v-btn",n,!1),r),[e._v(" Add WBS Element ")])]}}]),model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[t("v-card",[t("v-card-title",[t("span",{staticClass:"text-h5"},[e._v("Add WBS Element")])]),t("v-card-text",[t("v-container",[t("v-row",[t("v-col",{attrs:{cols:"12",sm:"6"}},[t("v-select",{attrs:{items:["Mobilization Support","Internal Work Plan","Eng Design Plan","OPEX Report","Walkdown Plan Report","Design Requirements","Conceptual Eng Report","FMEA Report","DCP","Technical Specification","ID Sor ICS","Replacement Instruction","Model Work Order","MechCivDCN","ElecDCN","Software DCN","Software Patch DCN","Config Intent Change","CSNC Code Classification","SCL Update","Report with Model","HandCalculation","ReportorMemo","IUC","DesignRegistration","Design Reconciliation","IEE or PE Evaluation","Design Manual Update","Third Party Review","OM Doc Updates","Commissioning Specification","Installation Support with FCNs","Commissioning Report","Closeout","Blank Template","BlankTemplate with 5sums"],label:"WBS Element Type",required:""},model:{value:e.WBSElementType,callback:function(t){e.WBSElementType=t},expression:"WBSElementType"}})],1),t("v-col",{attrs:{cols:"12",sm:"6",md:"4"}},[t("v-text-field",{attrs:{label:"WBS Name",required:""},model:{value:e.WBSName,callback:function(t){e.WBSName=t},expression:"WBSName"}})],1)],1),t("v-row",[t("v-col",{attrs:{cols:"12",sm:"6"}},[t("v-select",{attrs:{items:["Use Template Hours","Keep Hours Blank"],label:"WBS Estimate Approach",required:""},model:{value:e.WBSEstimate,callback:function(t){e.WBSEstimate=t},expression:"WBSEstimate"}})],1),t("v-col",{attrs:{cols:"12",sm:"6",md:"4"}},[t("v-text-field",{attrs:{label:"Initialize Department"},model:{value:e.WBSDepartment,callback:function(t){e.WBSDepartment=t},expression:"WBSDepartment"}})],1)],1)],1)],1),t("v-card-actions",[t("v-spacer"),t("v-btn",{attrs:{color:"blue darken-1",text:""},on:{click:function(t){return e.addWBS_element()}}},[e._v(" Add ")]),t("v-btn",{attrs:{color:"blue darken-1",text:""},on:{click:function(t){e.dialog=!1}}},[e._v(" Done ")])],1)],1)],1)],1),t("v-col",{attrs:{cols:"auto"}},[t("v-dialog",{attrs:{persistent:"","max-width":"600px"},scopedSlots:e._u([{key:"activator",fn:function({on:r,attrs:n}){return[t("v-btn",e._g(e._b({attrs:{justify:"center",variant:"text"}},"v-btn",n,!1),r),[e._v(" Clear ")])]}}]),model:{value:e.dialog_clear,callback:function(t){e.dialog_clear=t},expression:"dialog_clear"}},[t("v-card",[t("v-card-title",[t("span",{staticClass:"text-h5"},[e._v("Confirm Clear?")])]),t("v-card-actions",[t("v-spacer"),t("v-btn",{attrs:{color:"blue darken-1",text:""},on:{click:function(t){return e.WBS_clear()}}},[e._v(" YES ")]),t("v-btn",{attrs:{variant:"outlined"},on:{click:function(t){e.dialog_clear=!1}}},[e._v(" NO ")])],1)],1)],1)],1),t("v-col",{attrs:{cols:"auto"}},[t("v-btn",{attrs:{color:"blue darken-1"},on:{click:function(t){return e.finalizeWBS()}}},[e._v(" Finalize ")])],1)],1),t("br"),t("br"),t("v-row",{attrs:{justify:"center"}},[t("v-col",{attrs:{cols:"auto"}},[t("v-btn",{attrs:{color:"primary",dark:""},on:{click:function(t){return e.WBS_submission()}}},[e._v(" Download CSV ")])],1),t("v-col",{attrs:{cols:"auto"}},[t("v-btn",{attrs:{color:"primary",dark:""},on:{click:function(t){return e.WBS_download_XLSX()}}},[e._v(" Download P6")])],1),t("v-col",{attrs:{cols:"auto"}},[t("v-dialog",{attrs:{persistent:"","max-width":"600px"},scopedSlots:e._u([{key:"activator",fn:function({on:r,attrs:n}){return[t("v-btn",e._g(e._b({attrs:{justify:"center",color:"primary",dark:""}},"v-btn",n,!1),r),[e._v(" Download SAP CJ20N ")])]}}]),model:{value:e.dialog_downloadSAP,callback:function(t){e.dialog_downloadSAP=t},expression:"dialog_downloadSAP"}},[t("v-card",[t("v-card-title",[t("span",{staticClass:"text-h5"},[e._v("Please select prefered SAP download version")])]),t("v-card-actions",[t("v-spacer"),t("v-btn",{attrs:{color:"blue darken-1",text:""},on:{click:function(t){return e.WBS_download_SAP_all()}}},[e._v(" Complete WBS ")]),t("v-btn",{attrs:{color:"blue darken-1",text:""},on:{click:function(t){return e.WBS_download_SAP_summary()}}},[e._v(" Summary WBS ")]),t("v-btn",{attrs:{variant:"outlined"},on:{click:function(t){e.dialog_downloadSAP=!1}}},[e._v(" Cancel ")])],1)],1)],1)],1),t("v-col",{attrs:{cols:"auto"}},[t("v-dialog",{attrs:{persistent:"","max-width":"600px"},scopedSlots:e._u([{key:"activator",fn:function({on:r,attrs:n}){return[t("v-btn",e._g(e._b({attrs:{justify:"center",variant:"text"}},"v-btn",n,!1),r),[e._v(" Bruce TOQ ")])]}}]),model:{value:e.dialog_TOQ,callback:function(t){e.dialog_TOQ=t},expression:"dialog_TOQ"}},[t("v-card",[t("v-card-title",[t("span",{staticClass:"text-h5"},[e._v("Functionality to be added in 2024")])]),t("v-card-actions",[t("v-spacer"),t("v-btn",{attrs:{variant:"outlined"},on:{click:function(t){e.dialog_TOQ=!1}}},[e._v(" OK ")])],1)],1)],1)],1)],1)],1)]),t("div",{staticClass:"test"},[t("hot-table",{ref:"hotTableComponent",attrs:{data:e.data,settings:e.hotSettings}})],1),t("div",{staticClass:"wbs_table2",attrs:{id:"wbs_table2"}})])},o=[],c=(r(2801),r(1987)),l=r(6849);r(1703);
/**
 * @license
 * Copyright (c) 2022 Handsoncode. All rights reserved.
 */
class u extends Error{constructor(e){super(`There's no sheet with id = ${e}`)}}class h extends Error{constructor(e){super(`There's no sheet with name '${e}'`)}}class f extends Error{constructor(e){super(`Sheet with name ${e} already exists`)}}class d extends Error{constructor(){super("Sheet size limit exceeded")}}class p extends Error{constructor(){super("This is not a formula")}}class m extends Error{constructor(e){super(`Address (row = ${e.row}, col = ${e.col}) is invalid`)}}class g extends Error{constructor(e){super(`Invalid arguments, expected ${e}`)}}class E extends Error{constructor(e,t){super(`Sheets ${e} and ${t} are not equal.`)}}class v extends Error{constructor(e){super(`Name of Named Expression '${e}' is already present`)}}class T extends Error{constructor(e){super(`Name of Named Expression '${e}' is invalid`)}}class S extends Error{constructor(e){super(`Named Expression '${e}' does not exist`)}}class A extends Error{constructor(){super("There is no operation to undo")}}class R extends Error{constructor(){super("There is no operation to redo")}}class y extends Error{constructor(){super("There is nothing to paste")}}function N(e,t){switch(typeof t){case"function":case"symbol":return t.toString();case"bigint":return"BigInt("+t.toString()+")";default:return t instanceof RegExp?"RegExp("+t.toString()+")":t}}class w extends Error{constructor(e){super(`Unable to parse value: ${JSON.stringify(e,N,4)}`)}}class b extends Error{constructor(e,t){super(`Expected value of type: ${e} for config parameter: ${t}`)}}class C extends Error{constructor(e){super(`Config parameter ${e} cannot be empty.`)}}class O extends Error{constructor(e,t){super(`Config parameter ${e} should be at least ${t}`)}}class I extends Error{constructor(e,t){super(`Config parameter ${e} should be at most ${t}`)}}class M extends Error{constructor(e,t){super(`Expected one of ${e} for config parameter: ${t}`)}}class D extends Error{constructor(){super("Computations are suspended")}}class L extends Error{constructor(e){super(`Translation for ${e} is missing in the translation package you're using.`)}}class k extends Error{constructor(e){super(`Cannot register translation for function with id: ${e}`)}}class _ extends Error{constructor(){super("Language not registered.")}}class U extends Error{constructor(){super("Language already registered.")}}class x extends Error{static functionNotDeclaredInPlugin(e,t){return new x(`Function with id ${e} not declared in plugin ${t}`)}static functionMethodNotFound(e,t){return new x(`Function method ${e} not found in plugin ${t}`)}}class F extends Error{static cannotRegisterFunctionWithId(e){return new F(`Cannot register function with id ${e}`)}static cannotUnregisterFunctionWithId(e){return new F(`Cannot unregister function with id ${e}`)}static cannotUnregisterProtectedPlugin(){return new F("Cannot unregister protected plugin")}}class P extends Error{constructor(){super("Cannot perform this operation, source location has an array inside.")}}class B extends Error{constructor(){super("Cannot perform this operation, target location has an array inside.")}}class Y extends Error{constructor(){super("Relative addresses not allowed in named expressions.")}}class V extends Error{constructor(e,t){super(`Alias id ${e} in plugin ${t} already defined as a function or alias.`)}}(function(e){e["RELATIVE"]="RELATIVE",e["ABSOLUTE"]="ABSOLUTE"})(a||(a={}));class W{constructor(e,t,r){this.type=e,this.col=t,this.sheet=r}static absolute(e,t){return new W(a.ABSOLUTE,e,t)}static relative(e,t){return new W(a.RELATIVE,e,t)}static compareByAbsoluteAddress(e){return(t,r)=>t.toSimpleColumnAddress(e).col-r.toSimpleColumnAddress(e).col}isColumnAbsolute(){return this.type===a.ABSOLUTE}isColumnRelative(){return this.type===a.RELATIVE}isAbsolute(){return this.type===a.ABSOLUTE&&void 0!==this.sheet}moved(e,t,r){const n=void 0===this.sheet?void 0:e;return new W(this.type,this.col+t,n)}shiftedByColumns(e){return new W(this.type,this.col+e,this.sheet)}toSimpleColumnAddress(e){const t=jn(this,e);let r=this.col;return this.isColumnRelative()&&(r=e.col+this.col),Yn(t,r)}shiftRelativeDimensions(e,t){const r=this.isColumnRelative()?this.col+e:this.col;return new W(this.type,r,this.sheet)}shiftAbsoluteDimensions(e,t){const r=this.isColumnAbsolute()?this.col+e:this.col;return new W(this.type,r,this.sheet)}withSheet(e){return new W(this.type,this.col,e)}isInvalid(e){return this.toSimpleColumnAddress(e).col<0}hash(e){const t=e&&void 0!==this.sheet?`#${this.sheet}`:"";switch(this.type){case a.RELATIVE:return`${t}#COLR${this.col}`;case a.ABSOLUTE:return`${t}#COLA${this.col}`}}unparse(e){const t=this.toSimpleColumnAddress(e);if(Vn(t))return;const r=Ve(t.col),n=this.type===a.ABSOLUTE?"$":"";return`${n}${r}`}exceedsSheetSizeLimits(e){return this.col>=e}}
/**
 * @license
 * Copyright (c) 2022 Handsoncode. All rights reserved.
 */
class G{constructor(e,t,r){this.type=e,this.row=t,this.sheet=r}static absolute(e,t){return new G(a.ABSOLUTE,e,t)}static relative(e,t){return new G(a.RELATIVE,e,t)}static compareByAbsoluteAddress(e){return(t,r)=>t.toSimpleRowAddress(e).row-r.toSimpleRowAddress(e).row}isRowAbsolute(){return this.type===a.ABSOLUTE}isRowRelative(){return this.type===a.RELATIVE}isAbsolute(){return this.type===a.ABSOLUTE&&void 0!==this.sheet}moved(e,t,r){const n=void 0===this.sheet?void 0:e;return new G(this.type,this.row+r,n)}shiftedByRows(e){return new G(this.type,this.row+e,this.sheet)}toSimpleRowAddress(e){const t=jn(this,e);let r=this.row;return this.isRowRelative()&&(r=e.row+this.row),Pn(t,r)}shiftRelativeDimensions(e,t){const r=this.isRowRelative()?this.row+t:this.row;return new G(this.type,r,this.sheet)}shiftAbsoluteDimensions(e,t){const r=this.isRowAbsolute()?this.row+t:this.row;return new G(this.type,r,this.sheet)}withSheet(e){return new G(this.type,this.row,e)}isInvalid(e){return this.toSimpleRowAddress(e).row<0}hash(e){const t=e&&void 0!==this.sheet?`#${this.sheet}`:"";switch(this.type){case a.RELATIVE:return`${t}#ROWR${this.row}`;case a.ABSOLUTE:return`${t}#ROWA${this.row}`}}unparse(e){const t=this.toSimpleRowAddress(e);if(Bn(t))return;const r=this.type===a.ABSOLUTE?"$":"";return`${r}${t.row+1}`}exceedsSheetSizeLimits(e){return this.row>=e}}(function(e){e["CELL_REFERENCE_RELATIVE"]="CELL_REFERENCE",e["CELL_REFERENCE_ABSOLUTE"]="CELL_REFERENCE_ABSOLUTE",e["CELL_REFERENCE_ABSOLUTE_COL"]="CELL_REFERENCE_ABSOLUTE_COL",e["CELL_REFERENCE_ABSOLUTE_ROW"]="CELL_REFERENCE_ABSOLUTE_ROW"})(s||(s={}));class H{constructor(e,t,r,n){this.col=e,this.row=t,this.type=r,this.sheet=n}static fromColAndRow(e,t,r){const n=e.isColumnAbsolute()&&t.isRowAbsolute()?H.absolute.bind(this):e.isColumnAbsolute()?H.absoluteCol.bind(this):t.isRowAbsolute()?H.absoluteRow.bind(this):H.relative.bind(this);return n(e.col,t.row,r)}static relative(e,t,r){return new H(e,t,s.CELL_REFERENCE_RELATIVE,r)}static absolute(e,t,r){return new H(e,t,s.CELL_REFERENCE_ABSOLUTE,r)}static absoluteCol(e,t,r){return new H(e,t,s.CELL_REFERENCE_ABSOLUTE_COL,r)}static absoluteRow(e,t,r){return new H(e,t,s.CELL_REFERENCE_ABSOLUTE_ROW,r)}toSimpleCellAddress(e){const t=jn(this,e);return this.type===s.CELL_REFERENCE_ABSOLUTE?Wn(t,this.col,this.row):this.type===s.CELL_REFERENCE_ABSOLUTE_ROW?Wn(t,e.col+this.col,this.row):this.type===s.CELL_REFERENCE_ABSOLUTE_COL?Wn(t,this.col,e.row+this.row):Wn(t,e.col+this.col,e.row+this.row)}toColumnAddress(){const e=this.isColumnRelative()?a.RELATIVE:a.ABSOLUTE;return new W(e,this.col,this.sheet)}toRowAddress(){const e=this.isRowRelative()?a.RELATIVE:a.ABSOLUTE;return new G(e,this.row,this.sheet)}toSimpleColumnAddress(e){const t=jn(this,e);let r=this.col;return this.isColumnRelative()&&(r+=e.col),Yn(t,r)}toSimpleRowAddress(e){const t=jn(this,e);let r=this.row;return this.isRowRelative()&&(r+=e.row),Pn(t,r)}isRowAbsolute(){return this.type===s.CELL_REFERENCE_ABSOLUTE||this.type===s.CELL_REFERENCE_ABSOLUTE_ROW}isColumnAbsolute(){return this.type===s.CELL_REFERENCE_ABSOLUTE||this.type===s.CELL_REFERENCE_ABSOLUTE_COL}isColumnRelative(){return this.type===s.CELL_REFERENCE_RELATIVE||this.type===s.CELL_REFERENCE_ABSOLUTE_ROW}isRowRelative(){return this.type===s.CELL_REFERENCE_RELATIVE||this.type===s.CELL_REFERENCE_ABSOLUTE_COL}isAbsolute(){return this.type===s.CELL_REFERENCE_ABSOLUTE&&void 0!==this.sheet}shiftedByRows(e){return new H(this.col,this.row+e,this.type,this.sheet)}shiftedByColumns(e){return new H(this.col+e,this.row,this.type,this.sheet)}moved(e,t,r){const n=void 0===this.sheet?void 0:e;return new H(this.col+t,this.row+r,this.type,n)}withSheet(e){return new H(this.col,this.row,this.type,e)}isInvalid(e){return Gn(this.toSimpleCellAddress(e))}shiftRelativeDimensions(e,t){const r=this.isColumnAbsolute()?this.col:this.col+e,n=this.isRowAbsolute()?this.row:this.row+t;return new H(r,n,this.type,this.sheet)}shiftAbsoluteDimensions(e,t){const r=this.isColumnRelative()?this.col:this.col+e,n=this.isRowRelative()?this.row:this.row+t;return new H(r,n,this.type,this.sheet)}hash(e){const t=e&&void 0!==this.sheet?`#${this.sheet}`:"";switch(this.type){case s.CELL_REFERENCE_RELATIVE:return`${t}#${this.row}R${this.col}`;case s.CELL_REFERENCE_ABSOLUTE:return`${t}#${this.row}A${this.col}`;case s.CELL_REFERENCE_ABSOLUTE_COL:return`${t}#${this.row}AC${this.col}`;case s.CELL_REFERENCE_ABSOLUTE_ROW:return`${t}#${this.row}AR${this.col}`}}unparse(e){const t=this.toSimpleCellAddress(e);if(Gn(t))return;const r=Ve(t.col),n=this.type===s.CELL_REFERENCE_ABSOLUTE||this.type===s.CELL_REFERENCE_ABSOLUTE_ROW?"$":"",a=this.type===s.CELL_REFERENCE_ABSOLUTE||this.type===s.CELL_REFERENCE_ABSOLUTE_COL?"$":"";return`${a}${r}${n}${t.row+1}`}exceedsSheetSizeLimits(e,t){return this.row>=t||this.col>=e}}var z=r(9193);
/**
 * @license
 * Copyright (c) 2022 Handsoncode. All rights reserved.
 */
const j=":",X="$",K=/\s+/,q=/[ \t\n\r]+/,J=(0,z.createToken)({name:"AdditionOp",pattern:z.Lexer.NA}),Q=(0,z.createToken)({name:"PlusOp",pattern:/\+/,categories:J}),Z=(0,z.createToken)({name:"MinusOp",pattern:/-/,categories:J}),ee=(0,z.createToken)({name:"MultiplicationOp",pattern:z.Lexer.NA}),te=(0,z.createToken)({name:"TimesOp",pattern:/\*/,categories:ee}),re=(0,z.createToken)({name:"DivOp",pattern:/\//,categories:ee}),ne=(0,z.createToken)({name:"PowerOp",pattern:/\^/}),ae=(0,z.createToken)({name:"PercentOp",pattern:/%/}),se=(0,z.createToken)({name:"BooleanOp",pattern:z.Lexer.NA}),ie=(0,z.createToken)({name:"EqualsOp",pattern:/=/,categories:se}),oe=(0,z.createToken)({name:"NotEqualOp",pattern:/<>/,categories:se}),ce=(0,z.createToken)({name:"GreaterThanOp",pattern:/>/,categories:se}),le=(0,z.createToken)({name:"LessThanOp",pattern:/</,categories:se}),ue=(0,z.createToken)({name:"GreaterThanOrEqualOp",pattern:/>=/,categories:se}),he=(0,z.createToken)({name:"LessThanOrEqualOp",pattern:/<=/,categories:se}),fe=(0,z.createToken)({name:"ConcatenateOp",pattern:/&/}),de="[A-Za-z0-9_À-ʯ]+",pe="'(((?!').|'')*)'",me=`(${de}|${pe})!`,ge=(0,z.createToken)({name:"CellReference",pattern:new RegExp(`(${me})?\\${X}?[A-Za-z]+\\${X}?[0-9]+`)}),Ee=(0,z.createToken)({name:"ColumnRange",pattern:new RegExp(`(${me})?\\${X}?[A-Za-z]+${j}(${me})?\\${X}?[A-Za-z]+`)}),ve=(0,z.createToken)({name:"RowRange",pattern:new RegExp(`(${me})?\\${X}?[0-9]+${j}(${me})?\\${X}?[0-9]+`)}),Te=(0,z.createToken)({name:"RangeSeparator",pattern:`${j}`}),Se=(0,z.createToken)({name:"LParen",pattern:/\(/}),Ae=(0,z.createToken)({name:"RParen",pattern:/\)/}),Re=(0,z.createToken)({name:"ArrayLParen",pattern:/{/}),ye=(0,z.createToken)({name:"ArrayRParen",pattern:/}/}),Ne=(0,z.createToken)({name:"ProcedureName",pattern:/([A-Za-z\u00C0-\u02AF][A-Za-z0-9\u00C0-\u02AF._]*)\(/}),we=(0,z.createToken)({name:"NamedExpression",pattern:/[A-Za-z\u00C0-\u02AF_][A-Za-z0-9\u00C0-\u02AF._]*/}),be=(0,z.createToken)({name:"StringLiteral",pattern:/"([^"\\]*(\\.[^"\\]*)*)"/}),Ce=(0,z.createToken)({name:"ErrorLiteral",pattern:/#[A-Za-z0-9\/]+[?!]?/}),Oe=e=>{const t=e.translationPackage.getFunctionTranslation("OFFSET"),r=e.errorMapping,n=e.translationPackage.buildFunctionMapping(),a="standard"===e.ignoreWhiteSpace?q:K,s=(0,z.createToken)({name:"WhiteSpace",pattern:a}),i=(0,z.createToken)({name:"ArrayRowSep",pattern:e.arrayRowSeparator}),o=(0,z.createToken)({name:"ArrayColSep",pattern:e.arrayColumnSeparator});let c,l;e.functionArgSeparator===e.arrayColumnSeparator?(c=o,l=[]):e.functionArgSeparator===e.arrayRowSeparator?(c=i,l=[]):(c=(0,z.createToken)({name:"ArgSeparator",pattern:e.functionArgSeparator}),l=[c]);const u=(0,z.createToken)({name:"NumberLiteral",pattern:new RegExp(`(([${e.decimalSeparator}]\\d+)|(\\d+([${e.decimalSeparator}]\\d*)?))(e[+-]?\\d+)?`)}),h=(0,z.createToken)({name:"OffsetProcedureName",pattern:new RegExp(t,"i")}),f=[s,Q,Z,te,re,ne,ie,oe,ae,ue,he,ce,le,Se,Ae,Re,ye,h,Ne,Te,...l,Ee,ve,u,be,Ce,fe,se,J,ee,ge,we,i,o];return{ArgSeparator:c,NumberLiteral:u,OffsetProcedureName:h,ArrayRowSeparator:i,ArrayColSeparator:o,WhiteSpace:s,allTokens:f,errorMapping:r,functionMapping:n,decimalSeparator:e.decimalSeparator,maxColumns:e.maxColumns,maxRows:e.maxRows}},Ie=new RegExp(`^(${me})?(\\${X}?)([A-Za-z]+)(\\${X}?)([0-9]+)$`),Me=new RegExp(`^(${me})?(\\${X}?)([A-Za-z]+)$`),De=new RegExp(`^(${me})?(\\${X}?)([0-9]+)$`),Le=new RegExp(`^${de}$`),ke=(e,t,r)=>{const n=Ie.exec(t),a=Ye(n[6]);let s=Ge(n,e);if(void 0===s)return;null===s&&(s=void 0);const i=Number(n[8])-1;return n[5]===X&&n[7]===X?H.absolute(a,i,s):n[5]===X?H.absoluteCol(a,i-r.row,s):n[7]===X?H.absoluteRow(a-r.col,i,s):H.relative(a-r.col,i-r.row,s)},_e=(e,t,r)=>{const n=Me.exec(t);let a=Ge(n,e);if(void 0===a)return;null===a&&(a=void 0);const s=Ye(n[6]);return n[5]===X?W.absolute(s,a):W.relative(s-r.col,a)},Ue=(e,t,r)=>{const n=De.exec(t);let a=Ge(n,e);if(void 0===a)return;null===a&&(a=void 0);const s=Number(n[6])-1;return n[5]===X?G.absolute(s,a):G.relative(s-r.row,a)},xe=(e,t,r)=>{const n=Ie.exec(t),a=Ye(n[6]);let s=Ge(n,e);if(void 0===s)return;null===s&&(s=r);const i=Number(n[8])-1;return Wn(s,a,i)},Fe=(e,t,r)=>{const n=t.split(j);if(2!==n.length)return;const[a,s]=n,i=xe(e,a,r);if(void 0===i)return;const o=xe(e,s,i.sheet);return void 0!==o&&i.sheet===o.sheet?$t(i,o):void 0},Pe=(e,t,r)=>{const n=Ve(t.col),a=We(t.sheet,e);if(void 0!==a)return r!==t.sheet?`${a}!${n}${t.row+1}`:`${n}${t.row+1}`},Be=(e,t,r)=>{const n=Pe(e,t.start,r),a=Pe(e,t.end,t.start.sheet);return void 0===n||void 0===a?void 0:`${n}${j}${a}`};function Ye(e){return 1===e.length?e.toUpperCase().charCodeAt(0)-65:e.split("").reduce(((e,t)=>26*e+(t.toUpperCase().charCodeAt(0)-64)),0)-1}function Ve(e){let t="";while(e>=0)t=String.fromCharCode(e%26+97)+t,e=Math.floor(e/26)-1;return t.toUpperCase()}function We(e,t){let r=t(e);if(void 0!==r)return Le.test(r)?r:(r=r.replace(/'/g,"''"),`'${r}'`)}function Ge(e,t){var r;let n=null!==(r=e[3])&&void 0!==r?r:e[2];return n?(n=n.replace(/''/g,"'"),t(n)):null}
/**
 * @license
 * Copyright (c) 2022 Handsoncode. All rights reserved.
 */
const He=(e,t)=>({type:e,message:t});var ze,$e,je;(function(e){e["LexingError"]="LexingError",e["ParserError"]="ParsingError",e["StaticOffsetError"]="StaticOffsetError",e["StaticOffsetOutOfRangeError"]="StaticOffsetOutOfRangeError",e["RangeOffsetNotAllowed"]="RangeOffsetNotAllowed"})(ze||(ze={})),function(e){e["EMPTY"]="EMPTY",e["NUMBER"]="NUMBER",e["STRING"]="STRING",e["MINUS_UNARY_OP"]="MINUS_UNARY_OP",e["PLUS_UNARY_OP"]="PLUS_UNARY_OP",e["PERCENT_OP"]="PERCENT_OP",e["CONCATENATE_OP"]="CONCATENATE_OP",e["EQUALS_OP"]="EQUALS_OP",e["NOT_EQUAL_OP"]="NOT_EQUAL_OP",e["GREATER_THAN_OP"]="GREATER_THAN_OP",e["LESS_THAN_OP"]="LESS_THAN_OP",e["GREATER_THAN_OR_EQUAL_OP"]="GREATER_THAN_OR_EQUAL_OP",e["LESS_THAN_OR_EQUAL_OP"]="LESS_THAN_OR_EQUAL_OP",e["PLUS_OP"]="PLUS_OP",e["MINUS_OP"]="MINUS_OP",e["TIMES_OP"]="TIMES_OP",e["DIV_OP"]="DIV_OP",e["POWER_OP"]="POWER_OP",e["FUNCTION_CALL"]="FUNCTION_CALL",e["NAMED_EXPRESSION"]="NAMED_EXPRESSION",e["PARENTHESIS"]="PARENTHESES",e["CELL_REFERENCE"]="CELL_REFERENCE",e["CELL_RANGE"]="CELL_RANGE",e["COLUMN_RANGE"]="COLUMN_RANGE",e["ROW_RANGE"]="ROW_RANGE",e["ERROR"]="ERROR",e["ERROR_WITH_RAW_INPUT"]="ERROR_WITH_RAW_INPUT",e["ARRAY"]="ARRAY"}($e||($e={})),function(e){e[e["RELATIVE"]=0]="RELATIVE",e[e["START_ABSOLUTE"]=1]="START_ABSOLUTE",e[e["BOTH_ABSOLUTE"]=2]="BOTH_ABSOLUTE"}(je||(je={}));const Xe=e=>({type:$e.EMPTY,leadingWhitespace:null===e||void 0===e?void 0:e.image}),Ke=(e,t)=>({type:$e.NUMBER,value:e,leadingWhitespace:null===t||void 0===t?void 0:t.image}),qe=e=>{var t;return{type:$e.STRING,value:e.image.slice(1,-1),leadingWhitespace:null===(t=e.leadingWhitespace)||void 0===t?void 0:t.image}},Je=(e,t)=>({type:$e.CELL_REFERENCE,reference:e,leadingWhitespace:null===t||void 0===t?void 0:t.image}),Qe=(e,t,r,n)=>(yt(e,t,r),{type:$e.CELL_RANGE,start:e,end:t,sheetReferenceType:r,leadingWhitespace:n}),Ze=(e,t,r,n)=>(yt(e,t,r),{type:$e.COLUMN_RANGE,start:e,end:t,sheetReferenceType:r,leadingWhitespace:null===n||void 0===n?void 0:n.image}),et=(e,t,r,n)=>(yt(e,t,r),{type:$e.ROW_RANGE,start:e,end:t,sheetReferenceType:r,leadingWhitespace:null===n||void 0===n?void 0:n.image}),tt=(e,t,r)=>({type:$e.CONCATENATE_OP,left:e,right:t,leadingWhitespace:null===r||void 0===r?void 0:r.image}),rt=(e,t,r)=>({type:$e.EQUALS_OP,left:e,right:t,leadingWhitespace:null===r||void 0===r?void 0:r.image}),nt=(e,t,r)=>({type:$e.NOT_EQUAL_OP,left:e,right:t,leadingWhitespace:null===r||void 0===r?void 0:r.image}),at=(e,t,r)=>({type:$e.GREATER_THAN_OP,left:e,right:t,leadingWhitespace:null===r||void 0===r?void 0:r.image}),st=(e,t,r)=>({type:$e.LESS_THAN_OP,left:e,right:t,leadingWhitespace:null===r||void 0===r?void 0:r.image}),it=(e,t,r)=>({type:$e.GREATER_THAN_OR_EQUAL_OP,left:e,right:t,leadingWhitespace:null===r||void 0===r?void 0:r.image}),ot=(e,t,r)=>({type:$e.LESS_THAN_OR_EQUAL_OP,left:e,right:t,leadingWhitespace:null===r||void 0===r?void 0:r.image}),ct=(e,t,r)=>({type:$e.PLUS_OP,left:e,right:t,leadingWhitespace:null===r||void 0===r?void 0:r.image}),lt=(e,t,r)=>({type:$e.MINUS_OP,left:e,right:t,leadingWhitespace:null===r||void 0===r?void 0:r.image}),ut=(e,t,r)=>({type:$e.TIMES_OP,left:e,right:t,leadingWhitespace:null===r||void 0===r?void 0:r.image}),ht=(e,t,r)=>({type:$e.DIV_OP,left:e,right:t,leadingWhitespace:null===r||void 0===r?void 0:r.image}),ft=(e,t,r)=>({type:$e.POWER_OP,left:e,right:t,leadingWhitespace:null===r||void 0===r?void 0:r.image}),dt=(e,t)=>({type:$e.MINUS_UNARY_OP,value:e,leadingWhitespace:null===t||void 0===t?void 0:t.image}),pt=(e,t)=>({type:$e.PLUS_UNARY_OP,value:e,leadingWhitespace:null===t||void 0===t?void 0:t.image}),mt=(e,t)=>({type:$e.PERCENT_OP,value:e,leadingWhitespace:null===t||void 0===t?void 0:t.image}),gt=(e,t,r,n)=>({type:$e.FUNCTION_CALL,procedureName:e,args:t,leadingWhitespace:null===r||void 0===r?void 0:r.image,internalWhitespace:null===n||void 0===n?void 0:n.image}),Et=(e,t,r)=>({type:$e.ARRAY,args:e,leadingWhitespace:null===t||void 0===t?void 0:t.image,internalWhitespace:null===r||void 0===r?void 0:r.image}),vt=(e,t)=>({type:$e.NAMED_EXPRESSION,expressionName:e,leadingWhitespace:null===t||void 0===t?void 0:t.image}),Tt=(e,t,r)=>({type:$e.PARENTHESIS,expression:e,leadingWhitespace:null===t||void 0===t?void 0:t.image,internalWhitespace:null===r||void 0===r?void 0:r.image}),St=(e,t)=>({type:$e.ERROR,error:e,leadingWhitespace:null===t||void 0===t?void 0:t.image}),At=(e,t,r)=>({type:$e.ERROR_WITH_RAW_INPUT,error:t,rawInput:e,leadingWhitespace:null===r||void 0===r?void 0:r.image}),Rt=()=>({type:$e.ERROR,error:Fn.parsingError()});function yt(e,t,r){if(void 0!==e.sheet&&void 0===t.sheet||void 0===e.sheet&&void 0!==t.sheet)throw new Error("Start address inconsistent with end address");if(void 0===e.sheet&&r!==je.RELATIVE||void 0!==e.sheet&&r===je.RELATIVE)throw new Error("Sheet address inconsistent with sheet reference type")}function Nt(e,t){return(null!==t&&void 0!==t?t:"")+e}
/**
 * @license
 * Copyright (c) 2022 Handsoncode. All rights reserved.
 */
const wt={[$e.PLUS_OP]:"+",[$e.MINUS_OP]:"-",[$e.TIMES_OP]:"*",[$e.DIV_OP]:"/",[$e.CONCATENATE_OP]:"&",[$e.POWER_OP]:"^",[$e.EQUALS_OP]:"=",[$e.NOT_EQUAL_OP]:"<>",[$e.GREATER_THAN_OP]:">",[$e.GREATER_THAN_OR_EQUAL_OP]:">=",[$e.LESS_THAN_OP]:"<",[$e.LESS_THAN_OR_EQUAL_OP]:"<="},bt=(e,t,r,n)=>({ast:e,relativeDependencies:t,hasVolatileFunction:r,hasStructuralChangeFunction:n});class Ct{constructor(e){this.functionRegistry=e,this.cache=new Map}set(e,t){const r=xt(t,this.functionRegistry),n=bt(t,r,Ot(t,this.functionRegistry.isFunctionVolatile),Ot(t,this.functionRegistry.isFunctionDependentOnSheetStructureChange));return this.cache.set(e,n),n}get(e){return this.cache.get(e)}maybeSetAndThenGet(e,t){const r=this.cache.get(e);return void 0!==r?r.ast:(this.set(e,t),t)}}const Ot=(e,t)=>{switch(e.type){case $e.EMPTY:case $e.NUMBER:case $e.STRING:case $e.ERROR:case $e.ERROR_WITH_RAW_INPUT:case $e.CELL_REFERENCE:case $e.CELL_RANGE:case $e.COLUMN_RANGE:case $e.ROW_RANGE:case $e.NAMED_EXPRESSION:return!1;case $e.PERCENT_OP:case $e.PLUS_UNARY_OP:case $e.MINUS_UNARY_OP:return Ot(e.value,t);case $e.CONCATENATE_OP:case $e.EQUALS_OP:case $e.NOT_EQUAL_OP:case $e.LESS_THAN_OP:case $e.GREATER_THAN_OP:case $e.LESS_THAN_OR_EQUAL_OP:case $e.GREATER_THAN_OR_EQUAL_OP:case $e.MINUS_OP:case $e.PLUS_OP:case $e.TIMES_OP:case $e.DIV_OP:case $e.POWER_OP:return Ot(e.left,t)||Ot(e.right,t);case $e.PARENTHESIS:return Ot(e.expression,t);case $e.FUNCTION_CALL:return!!t(e.procedureName)||e.args.some((e=>Ot(e,t)));case $e.ARRAY:return e.args.some((e=>e.some((e=>Ot(e,t)))))}};
/**
 * @license
 * Copyright (c) 2022 Handsoncode. All rights reserved.
 */
class It{}It.DistinctSigns="Distinct signs.",It.WrongArgNumber="Wrong number of arguments.",It.EmptyArg="Empty function argument.",It.EmptyArray="Empty array not allowed.",It.ArrayDimensions="Array dimensions are not compatible.",It.NoSpaceForArrayResult="No space for array result.",It.ValueSmall="Value too small.",It.ValueLarge="Value too large.",It.BadCriterion="Incorrect criterion.",It.RangeManySheets="Range spans more than one sheet.",It.CellRangeExpected="Cell range expected.",It.WrongDimension="Wrong range dimension.",It.ScalarExpected="Cell range not allowed.",It.NumberCoercion="Value cannot be coerced to number.",It.NumberExpected="Number argument expected.",It.IntegerExpected="Value needs to be an integer.",It.BadMode="Mode not recognized.",It.DateBounds="Date outside of bounds.",It.OutOfSheet="Resulting reference is out of the sheet.",It.WrongType="Wrong type of argument.",It.NaN="NaN or infinite value encountered.",It.EqualLength="Ranges need to be of equal length.",It.Negative="Value cannot be negative.",It.NotBinary="String does not represent a binary number.",It.NotOctal="String does not represent an octal number.",It.NotHex="String does not represent a hexadecimal number.",It.EndStartPeriod="End period needs to be at least start period.",It.CellRefExpected="Cell reference expected.",It.EmptyRange="Empty range not allowed.",It.BadRef="Address is not correct.",It.NumberRange="Number-only range expected.",It.ValueNotFound="Value not found.",It.ValueBaseLarge="Value in base too large.",It.ValueBaseSmall="Value in base too small.",It.ValueBaseLong="Value in base too long.",It.NegativeLength="Length cannot be negative.",It.PatternNotFound="Pattern not found.",It.OneValue="Needs at least one value.",It.TwoValues="Range needs to contain at least two elements.",It.ThreeValues="Range needs to contain at least three elements.",It.IndexBounds="Index out of bounds.",It.IndexLarge="Index too large.",It.Formula="Expected formula.",It.NegativeCount="Count cannot be negative.",It.ParseError="Parsing error.",It.SheetRef="Sheet does not exist.",It.PeriodLong="Period number cannot exceed life length.",It.InvalidDate="Invalid date.",It.BitshiftLong="Result of bitshift is too long.",It.EmptyString="Empty-string argument not allowed.",It.LengthBounds="Length out of bounds.",It.NegativeTime="Time cannot be negative.",It.NoDefault="No default option.",It.Selector="Selector cannot exceed the number of arguments.",It.StartEndDate="Start date needs to be earlier than end date.",It.IncorrectDateTime="String does not represent correct DateTime.",It.CharacterCodeBounds="Character code out of bounds.",It.NonZero="Argument cannot be 0.",It.LessThanOne="Argument cannot be less than 1.",It.WeekendString="Incorrect weekend bitmask string.",It.InvalidRoman="Invalid roman numeral.",It.WrongOrder="Wrong order of values.",It.ComplexNumberExpected="Complex number expected.",It.ShouldBeIorJ="Should be 'i' or 'j'.",It.SizeMismatch="Array dimensions mismatched.",It.FunctionName=e=>`Function name ${e} not recognized.`,It.NamedExpressionName=e=>`Named expression ${e} not recognized.`,It.LicenseKey=e=>`License key is ${e}.`;
/**
 * @license
 * Copyright (c) 2022 Handsoncode. All rights reserved.
 */
class Mt extends z.EmbeddedActionsParser{constructor(e,t){super(e.allTokens,{outputCst:!1,maxLookahead:7}),this.booleanExpressionOrEmpty=this.RULE("booleanExpressionOrEmpty",(()=>this.OR([{ALT:()=>this.SUBRULE(this.booleanExpression)},{ALT:(0,z.EMPTY_ALT)(Xe())}]))),this.procedureExpression=this.RULE("procedureExpression",(()=>{var e;const t=this.CONSUME(Ne),r=t.image.toUpperCase().slice(0,-1),n=null!==(e=this.lexerConfig.functionMapping[r])&&void 0!==e?e:r,a=[];let s=this.SUBRULE(this.booleanExpressionOrEmpty);this.MANY((()=>{var e;const t=this.CONSUME(this.lexerConfig.ArgSeparator);s.type===$e.EMPTY&&(s.leadingWhitespace=null===(e=t.leadingWhitespace)||void 0===e?void 0:e.image),a.push(s),s=this.SUBRULE2(this.booleanExpressionOrEmpty)})),a.push(s),1===a.length&&a[0].type===$e.EMPTY&&(a.length=0);const i=this.CONSUME(Ae);return gt(n,a,t.leadingWhitespace,i.leadingWhitespace)})),this.namedExpressionExpression=this.RULE("namedExpressionExpression",(()=>{const e=this.CONSUME(we);return vt(e.image,e.leadingWhitespace)})),this.offsetProcedureExpression=this.RULE("offsetProcedureExpression",(()=>{const e=[];return this.CONSUME(this.lexerConfig.OffsetProcedureName),this.CONSUME(Se),this.MANY_SEP({SEP:this.lexerConfig.ArgSeparator,DEF:()=>{e.push(this.SUBRULE(this.booleanExpression))}}),this.CONSUME(Ae),this.handleOffsetHeuristic(e)})),this.columnRangeExpression=this.RULE("columnRangeExpression",(()=>{const e=this.CONSUME(Ee),[t,r]=e.image.split(":"),n=this.ACTION((()=>_e(this.sheetMapping,t,this.formulaAddress))),a=this.ACTION((()=>_e(this.sheetMapping,r,this.formulaAddress)));if(void 0===n||void 0===a)return St(new Fn(En.REF));if(n.exceedsSheetSizeLimits(this.lexerConfig.maxColumns)||a.exceedsSheetSizeLimits(this.lexerConfig.maxColumns))return At(e.image,new Fn(En.NAME),e.leadingWhitespace);if(void 0===n.sheet&&void 0!==a.sheet)return this.parsingError(ze.ParserError,"Malformed range expression");const{firstEnd:s,secondEnd:i,sheetRefType:o}=Mt.fixSheetIdsForRangeEnds(n,a),{start:c,end:l}=this.orderColumnRangeEnds(s,i);return Ze(c,l,o,e.leadingWhitespace)})),this.rowRangeExpression=this.RULE("rowRangeExpression",(()=>{const e=this.CONSUME(ve),[t,r]=e.image.split(":"),n=this.ACTION((()=>Ue(this.sheetMapping,t,this.formulaAddress))),a=this.ACTION((()=>Ue(this.sheetMapping,r,this.formulaAddress)));if(void 0===n||void 0===a)return St(new Fn(En.REF));if(n.exceedsSheetSizeLimits(this.lexerConfig.maxRows)||a.exceedsSheetSizeLimits(this.lexerConfig.maxRows))return At(e.image,new Fn(En.NAME),e.leadingWhitespace);if(void 0===n.sheet&&void 0!==a.sheet)return this.parsingError(ze.ParserError,"Malformed range expression");const{firstEnd:s,secondEnd:i,sheetRefType:o}=Mt.fixSheetIdsForRangeEnds(n,a),{start:c,end:l}=this.orderRowRangeEnds(s,i);return et(c,l,o,e.leadingWhitespace)})),this.cellReference=this.RULE("cellReference",(()=>{const e=this.CONSUME(ge),t=this.ACTION((()=>ke(this.sheetMapping,e.image,this.formulaAddress)));return void 0===t?At(e.image,new Fn(En.REF),e.leadingWhitespace):t.exceedsSheetSizeLimits(this.lexerConfig.maxColumns,this.lexerConfig.maxRows)?At(e.image,new Fn(En.NAME),e.leadingWhitespace):Je(t,e.leadingWhitespace)})),this.endRangeReference=this.RULE("endRangeReference",(e=>{var t;const r=this.CONSUME(ge),n=this.ACTION((()=>ke(this.sheetMapping,e.image,this.formulaAddress))),a=this.ACTION((()=>ke(this.sheetMapping,r.image,this.formulaAddress)));return void 0===n||void 0===a?this.ACTION((()=>At(`${e.image}:${r.image}`,new Fn(En.REF),e.leadingWhitespace))):n.exceedsSheetSizeLimits(this.lexerConfig.maxColumns,this.lexerConfig.maxRows)||a.exceedsSheetSizeLimits(this.lexerConfig.maxColumns,this.lexerConfig.maxRows)?this.ACTION((()=>At(`${e.image}:${r.image}`,new Fn(En.NAME),e.leadingWhitespace))):this.buildCellRange(n,a,null===(t=e.leadingWhitespace)||void 0===t?void 0:t.image)})),this.endOfRangeExpression=this.RULE("endOfRangeExpression",(e=>this.OR([{ALT:()=>this.SUBRULE(this.endRangeReference,{ARGS:[e]})},{ALT:()=>{var t;const r=this.SUBRULE(this.offsetProcedureExpression),n=this.ACTION((()=>ke(this.sheetMapping,e.image,this.formulaAddress)));return void 0===n?St(new Fn(En.REF)):r.type===$e.CELL_REFERENCE?this.buildCellRange(n,r.reference,null===(t=e.leadingWhitespace)||void 0===t?void 0:t.image):this.parsingError(ze.RangeOffsetNotAllowed,"Range offset not allowed here")}}]))),this.cellRangeExpression=this.RULE("cellRangeExpression",(()=>{const e=this.CONSUME(ge);return this.CONSUME2(Te),this.SUBRULE(this.endOfRangeExpression,{ARGS:[e]})})),this.endRangeWithOffsetStartReference=this.RULE("endRangeWithOffsetStartReference",(e=>{const t=this.CONSUME(ge),r=this.ACTION((()=>ke(this.sheetMapping,t.image,this.formulaAddress)));return void 0===r?this.ACTION((()=>St(new Fn(En.REF)))):this.buildCellRange(e.reference,r,e.leadingWhitespace)})),this.endOfRangeWithOffsetStartExpression=this.RULE("endOfRangeWithOffsetStartExpression",(e=>this.OR([{ALT:()=>this.SUBRULE(this.endRangeWithOffsetStartReference,{ARGS:[e]})},{ALT:()=>{const t=this.SUBRULE(this.offsetProcedureExpression);return t.type===$e.CELL_REFERENCE?this.buildCellRange(e.reference,t.reference,e.leadingWhitespace):this.parsingError(ze.RangeOffsetNotAllowed,"Range offset not allowed here")}}]))),this.offsetExpression=this.RULE("offsetExpression",(()=>{const e=this.SUBRULE(this.offsetProcedureExpression);let t;return this.OPTION((()=>{this.CONSUME(Te),t=e.type===$e.CELL_RANGE?this.parsingError(ze.RangeOffsetNotAllowed,"Range offset not allowed here"):this.SUBRULE(this.endOfRangeWithOffsetStartExpression,{ARGS:[e]})})),void 0!==t?t:e})),this.insideArrayExpression=this.RULE("insideArrayExpression",(()=>{const e=[[]];return e[e.length-1].push(this.SUBRULE(this.booleanExpression)),this.MANY((()=>{this.OR([{ALT:()=>{this.CONSUME(this.lexerConfig.ArrayColSeparator),e[e.length-1].push(this.SUBRULE2(this.booleanExpression))}},{ALT:()=>{this.CONSUME(this.lexerConfig.ArrayRowSeparator),e.push([]),e[e.length-1].push(this.SUBRULE3(this.booleanExpression))}}])})),Et(e)})),this.parenthesisExpression=this.RULE("parenthesisExpression",(()=>{const e=this.CONSUME(Se),t=this.SUBRULE(this.booleanExpression),r=this.CONSUME(Ae);return Tt(t,e.leadingWhitespace,r.leadingWhitespace)})),this.arrayExpression=this.RULE("arrayExpression",(()=>this.OR([{ALT:()=>{const e=this.CONSUME(Re),t=this.SUBRULE(this.insideArrayExpression),r=this.CONSUME(ye);return Et(t.args,e.leadingWhitespace,r.leadingWhitespace)}},{ALT:()=>this.SUBRULE(this.parenthesisExpression)}]))),this.numericStringToNumber=e=>{const t=e.replace(this.lexerConfig.decimalSeparator,".");return Number(t)},this.positiveAtomicExpression=this.RULE("positiveAtomicExpression",(()=>{var e;return this.OR(null!==(e=this.atomicExpCache)&&void 0!==e?e:this.atomicExpCache=[{ALT:()=>this.SUBRULE(this.arrayExpression)},{ALT:()=>this.SUBRULE(this.cellRangeExpression)},{ALT:()=>this.SUBRULE(this.columnRangeExpression)},{ALT:()=>this.SUBRULE(this.rowRangeExpression)},{ALT:()=>this.SUBRULE(this.offsetExpression)},{ALT:()=>this.SUBRULE(this.cellReference)},{ALT:()=>this.SUBRULE(this.procedureExpression)},{ALT:()=>this.SUBRULE(this.namedExpressionExpression)},{ALT:()=>{const e=this.CONSUME(this.lexerConfig.NumberLiteral);return Ke(this.numericStringToNumber(e.image),e.leadingWhitespace)}},{ALT:()=>{const e=this.CONSUME(be);return qe(e)}},{ALT:()=>{const e=this.CONSUME(Ce),t=e.image.toUpperCase(),r=this.lexerConfig.errorMapping[t];return r?St(new Fn(r),e.leadingWhitespace):this.parsingError(ze.ParserError,"Unknown error literal")}}])})),this.rightUnaryOpAtomicExpression=this.RULE("rightUnaryOpAtomicExpression",(()=>{const e=this.SUBRULE(this.positiveAtomicExpression),t=this.OPTION((()=>this.CONSUME(ae)));return t?mt(e,t.leadingWhitespace):e})),this.atomicExpression=this.RULE("atomicExpression",(()=>this.OR([{ALT:()=>{const e=this.CONSUME(J),t=this.SUBRULE(this.atomicExpression);return(0,z.tokenMatcher)(e,Q)?pt(t,e.leadingWhitespace):(0,z.tokenMatcher)(e,Z)?dt(t,e.leadingWhitespace):(this.customParsingError=He(ze.ParserError,"Mismatched token type"),this.customParsingError)}},{ALT:()=>this.SUBRULE2(this.rightUnaryOpAtomicExpression)}]))),this.powerExpression=this.RULE("powerExpression",(()=>{let e=this.SUBRULE(this.atomicExpression);return this.MANY((()=>{const t=this.CONSUME(ne),r=this.SUBRULE2(this.atomicExpression);(0,z.tokenMatcher)(t,ne)?e=ft(e,r,t.leadingWhitespace):this.ACTION((()=>{throw Error("Operator not supported")}))})),e})),this.multiplicationExpression=this.RULE("multiplicationExpression",(()=>{let e=this.SUBRULE(this.powerExpression);return this.MANY((()=>{const t=this.CONSUME(ee),r=this.SUBRULE2(this.powerExpression);(0,z.tokenMatcher)(t,te)?e=ut(e,r,t.leadingWhitespace):(0,z.tokenMatcher)(t,re)?e=ht(e,r,t.leadingWhitespace):this.ACTION((()=>{throw Error("Operator not supported")}))})),e})),this.additionExpression=this.RULE("additionExpression",(()=>{let e=this.SUBRULE(this.multiplicationExpression);return this.MANY((()=>{const t=this.CONSUME(J),r=this.SUBRULE2(this.multiplicationExpression);(0,z.tokenMatcher)(t,Q)?e=ct(e,r,t.leadingWhitespace):(0,z.tokenMatcher)(t,Z)?e=lt(e,r,t.leadingWhitespace):this.ACTION((()=>{throw Error("Operator not supported")}))})),e})),this.concatenateExpression=this.RULE("concatenateExpression",(()=>{let e=this.SUBRULE(this.additionExpression);return this.MANY((()=>{const t=this.CONSUME(fe),r=this.SUBRULE2(this.additionExpression);e=tt(e,r,t.leadingWhitespace)})),e})),this.booleanExpression=this.RULE("booleanExpression",(()=>{let e=this.SUBRULE(this.concatenateExpression);return this.MANY((()=>{const t=this.CONSUME(se),r=this.SUBRULE2(this.concatenateExpression);(0,z.tokenMatcher)(t,ie)?e=rt(e,r,t.leadingWhitespace):(0,z.tokenMatcher)(t,oe)?e=nt(e,r,t.leadingWhitespace):(0,z.tokenMatcher)(t,ce)?e=at(e,r,t.leadingWhitespace):(0,z.tokenMatcher)(t,le)?e=st(e,r,t.leadingWhitespace):(0,z.tokenMatcher)(t,ue)?e=it(e,r,t.leadingWhitespace):(0,z.tokenMatcher)(t,he)?e=ot(e,r,t.leadingWhitespace):this.ACTION((()=>{throw Error("Operator not supported")}))})),e})),this.formula=this.RULE("formula",(()=>(this.CONSUME(ie),this.SUBRULE(this.booleanExpression)))),this.lexerConfig=e,this.sheetMapping=t,this.formulaAddress=Wn(0,0,0),this.performSelfAnalysis()}parseFromTokens(e,t){this.input=e;let r=this.formulaWithContext(t),n=[];return this.customParsingError&&n.push(this.customParsingError),n=n.concat(this.errors.map((e=>({type:ze.ParserError,message:e.message})))),n.length>0&&(r=Rt()),{ast:r,errors:n}}reset(){super.reset(),this.customParsingError=void 0}formulaWithContext(e){return this.formulaAddress=e,this.formula()}buildCellRange(e,t,r){if(void 0===e.sheet&&void 0!==t.sheet)return this.parsingError(ze.ParserError,"Malformed range expression");const{firstEnd:n,secondEnd:a,sheetRefType:s}=Mt.fixSheetIdsForRangeEnds(e,t),{start:i,end:o}=this.orderCellRangeEnds(n,a);return Qe(i,o,s,r)}static fixSheetIdsForRangeEnds(e,t){const r=Mt.rangeSheetReferenceType(e.sheet,t.sheet),n=void 0!==e.sheet&&void 0===t.sheet?t.withSheet(e.sheet):t;return{firstEnd:e,secondEnd:n,sheetRefType:r}}orderCellRangeEnds(e,t){const r=[e,t],[n,a]=r.map((e=>e.toColumnAddress())).sort(W.compareByAbsoluteAddress(this.formulaAddress)),[s,i]=r.map((e=>e.toRowAddress())).sort(G.compareByAbsoluteAddress(this.formulaAddress)),[o,c]=r.map((e=>e.sheet)).sort(Mt.compareSheetIds.bind(this));return{start:H.fromColAndRow(n,s,o),end:H.fromColAndRow(a,i,c)}}orderColumnRangeEnds(e,t){const r=[e,t],[n,a]=r.sort(W.compareByAbsoluteAddress(this.formulaAddress)),[s,i]=r.map((e=>e.sheet)).sort(Mt.compareSheetIds.bind(this));return{start:new W(n.type,n.col,s),end:new W(a.type,a.col,i)}}orderRowRangeEnds(e,t){const r=[e,t],[n,a]=r.sort(G.compareByAbsoluteAddress(this.formulaAddress)),[s,i]=r.map((e=>e.sheet)).sort(Mt.compareSheetIds.bind(this));return{start:new G(n.type,n.row,s),end:new G(a.type,a.row,i)}}static compareSheetIds(e,t){return e=null!=e?e:1/0,t=null!=t?t:1/0,e-t}handleOffsetHeuristic(e){const t=e[0];if(t.type!==$e.CELL_REFERENCE)return this.parsingError(ze.StaticOffsetError,"First argument to OFFSET is not a reference");const r=e[1];let n;if(r.type===$e.NUMBER&&Number.isInteger(r.value))n=r.value;else if(r.type===$e.PLUS_UNARY_OP&&r.value.type===$e.NUMBER&&Number.isInteger(r.value.value))n=r.value.value;else{if(r.type!==$e.MINUS_UNARY_OP||r.value.type!==$e.NUMBER||!Number.isInteger(r.value.value))return this.parsingError(ze.StaticOffsetError,"Second argument to OFFSET is not a static number");n=-r.value.value}const a=e[2];let i;if(a.type===$e.NUMBER&&Number.isInteger(a.value))i=a.value;else if(a.type===$e.PLUS_UNARY_OP&&a.value.type===$e.NUMBER&&Number.isInteger(a.value.value))i=a.value.value;else{if(a.type!==$e.MINUS_UNARY_OP||a.value.type!==$e.NUMBER||!Number.isInteger(a.value.value))return this.parsingError(ze.StaticOffsetError,"Third argument to OFFSET is not a static number");i=-a.value.value}const o=e[3];let c;if(void 0===o)c=1;else{if(o.type!==$e.NUMBER)return this.parsingError(ze.StaticOffsetError,"Fourth argument to OFFSET is not a static number");if(c=o.value,c<1)return this.parsingError(ze.StaticOffsetError,"Fourth argument to OFFSET is too small number");if(!Number.isInteger(c))return this.parsingError(ze.StaticOffsetError,"Fourth argument to OFFSET is not integer")}const l=e[4];let u;if(void 0===l)u=1;else{if(l.type!==$e.NUMBER)return this.parsingError(ze.StaticOffsetError,"Fifth argument to OFFSET is not a static number");if(u=l.value,u<1)return this.parsingError(ze.StaticOffsetError,"Fifth argument to OFFSET is too small number");if(!Number.isInteger(u))return this.parsingError(ze.StaticOffsetError,"Fifth argument to OFFSET is not integer")}const h=new H(t.reference.col+i,t.reference.row+n,t.reference.type);let f=h.col,d=h.row;if(t.reference.type!==s.CELL_REFERENCE_RELATIVE&&t.reference.type!==s.CELL_REFERENCE_ABSOLUTE_COL||(d+=this.formulaAddress.row),t.reference.type!==s.CELL_REFERENCE_RELATIVE&&t.reference.type!==s.CELL_REFERENCE_ABSOLUTE_ROW||(f+=this.formulaAddress.col),f<0||d<0)return St(new Fn(En.REF,It.OutOfSheet));if(1===u&&1===c)return Je(h);{const e=new H(h.col+u-1,h.row+c-1,h.type);return Qe(h,e,je.RELATIVE)}}parsingError(e,t){return this.customParsingError=He(e,t),Rt()}static rangeSheetReferenceType(e,t){return void 0===e?je.RELATIVE:void 0===t?je.START_ABSOLUTE:je.BOTH_ABSOLUTE}}class Dt{constructor(e){this.lexerConfig=e,this.lexer=new z.Lexer(e.allTokens,{ensureOptimizations:!0})}tokenizeFormula(e){const t=this.lexer.tokenize(e);let r=t.tokens;return r=this.trimTrailingWhitespaces(r),r=this.skipWhitespacesInsideRanges(r),r=this.skipWhitespacesBeforeArgSeparators(r),t.tokens=r,t}skipWhitespacesInsideRanges(e){return Dt.filterTokensByNeighbors(e,((e,t,r)=>((0,z.tokenMatcher)(e,ge)||(0,z.tokenMatcher)(e,Te))&&(0,z.tokenMatcher)(t,this.lexerConfig.WhiteSpace)&&((0,z.tokenMatcher)(r,ge)||(0,z.tokenMatcher)(r,Te))))}skipWhitespacesBeforeArgSeparators(e){return Dt.filterTokensByNeighbors(e,((e,t,r)=>!(0,z.tokenMatcher)(e,this.lexerConfig.ArgSeparator)&&(0,z.tokenMatcher)(t,this.lexerConfig.WhiteSpace)&&(0,z.tokenMatcher)(r,this.lexerConfig.ArgSeparator)))}static filterTokensByNeighbors(e,t){if(e.length<3)return e;let r=0;const n=[e[r++]];while(r<e.length-1)t(e[r-1],e[r],e[r+1])||n.push(e[r]),++r;return n.push(e[r]),n}trimTrailingWhitespaces(e){return e.length>0&&(0,z.tokenMatcher)(e[e.length-1],this.lexerConfig.WhiteSpace)&&e.pop(),e}}
/**
 * @license
 * Copyright (c) 2022 Handsoncode. All rights reserved.
 */
class Lt{constructor(e,t,r,n){this.config=e,this.lexerConfig=t,this.sheetMappingFn=r,this.namedExpressions=n}unparse(e,t){return"="+this.unparseAst(e,t)}unparseAst(e,t){var r,n;switch(e.type){case $e.EMPTY:return Nt("",e.leadingWhitespace);case $e.NUMBER:return Nt(kt(e.value,this.config.decimalSeparator),e.leadingWhitespace);case $e.STRING:return Nt('"'+e.value+'"',e.leadingWhitespace);case $e.FUNCTION_CALL:{const r=e.args.map((e=>void 0!==e?this.unparseAst(e,t):"")).join(this.config.functionArgSeparator),n=this.config.translationPackage.isFunctionTranslated(e.procedureName)?this.config.translationPackage.getFunctionTranslation(e.procedureName):e.procedureName,a=n+"("+r+Nt(")",e.internalWhitespace);return Nt(a,e.leadingWhitespace)}case $e.NAMED_EXPRESSION:{const n=null===(r=this.namedExpressions.nearestNamedExpression(e.expressionName,t.sheet))||void 0===r?void 0:r.displayName;return Nt(n||e.expressionName,e.leadingWhitespace)}case $e.CELL_REFERENCE:{let r;return r=void 0!==e.reference.sheet?this.unparseSheetName(e.reference.sheet)+"!":"",r+=null!==(n=e.reference.unparse(t))&&void 0!==n?n:this.config.translationPackage.getErrorTranslation(En.REF),Nt(r,e.leadingWhitespace)}case $e.COLUMN_RANGE:case $e.ROW_RANGE:case $e.CELL_RANGE:return Nt(this.formatRange(e,t),e.leadingWhitespace);case $e.PLUS_UNARY_OP:{const r=this.unparseAst(e.value,t);return Nt("+",e.leadingWhitespace)+r}case $e.MINUS_UNARY_OP:{const r=this.unparseAst(e.value,t);return Nt("-",e.leadingWhitespace)+r}case $e.PERCENT_OP:return this.unparseAst(e.value,t)+Nt("%",e.leadingWhitespace);case $e.ERROR:{const t=this.config.translationPackage.getErrorTranslation(e.error?e.error.type:En.ERROR);return Nt(t,e.leadingWhitespace)}case $e.ERROR_WITH_RAW_INPUT:return Nt(e.rawInput,e.leadingWhitespace);case $e.PARENTHESIS:{const r=this.unparseAst(e.expression,t),n="("+r+Nt(")",e.internalWhitespace);return Nt(n,e.leadingWhitespace)}case $e.ARRAY:{const r="{"+e.args.map((e=>e.map((e=>this.unparseAst(e,t))).join(this.config.arrayColumnSeparator))).join(this.config.arrayRowSeparator)+Nt("}",e.internalWhitespace);return Nt(r,e.leadingWhitespace)}default:{const r=this.unparseAst(e.left,t),n=this.unparseAst(e.right,t);return r+Nt(wt[e.type],e.leadingWhitespace)+n}}}unparseSheetName(e){const t=We(e,this.sheetMappingFn);if(void 0===t)throw new u(e);return t}formatRange(e,t){let r="",n="";void 0!==e.start.sheet&&e.sheetReferenceType!==je.RELATIVE&&(r=this.unparseSheetName(e.start.sheet)+"!"),void 0!==e.end.sheet&&e.sheetReferenceType===je.BOTH_ABSOLUTE&&(n=this.unparseSheetName(e.end.sheet)+"!");const a=e.start.unparse(t),s=e.end.unparse(t);return void 0===a||void 0===s?this.config.translationPackage.getErrorTranslation(En.REF):`${r}${a}:${n}${s}`}}function kt(e,t){const r=e.toString();return r.replace(".",t)}
/**
 * @license
 * Copyright (c) 2022 Handsoncode. All rights reserved.
 */
class _t{constructor(e,t,r){this.config=e,this.functionRegistry=t,this.sheetMapping=r,this.statsCacheUsed=0,this.lexerConfig=Oe(e),this.lexer=new Dt(this.lexerConfig),this.formulaParser=new Mt(this.lexerConfig,this.sheetMapping),this.cache=new Ct(this.functionRegistry)}parse(e,t){const r=this.tokenizeFormula(e);if(r.errors.length>0){const e=r.errors.map((e=>({type:ze.LexingError,message:e.message})));return{ast:Rt(),errors:e,hasVolatileFunction:!1,hasStructuralChangeFunction:!1,dependencies:[]}}const n=this.computeHashFromTokens(r.tokens,t);let a=this.cache.get(n);if(void 0!==a)++this.statsCacheUsed;else{const e=this.bindWhitespacesToTokens(r.tokens),s=this.formulaParser.parseFromTokens(e,t);if(s.errors.length>0)return Object.assign(Object.assign({},s),{hasVolatileFunction:!1,hasStructuralChangeFunction:!1,dependencies:[]});a=this.cache.set(n,s.ast)}const{ast:s,hasVolatileFunction:i,hasStructuralChangeFunction:o,relativeDependencies:c}=a;return{ast:s,errors:[],hasVolatileFunction:i,hasStructuralChangeFunction:o,dependencies:c}}fetchCachedResultForAst(e){const t=this.computeHashFromAst(e);return this.fetchCachedResult(t)}fetchCachedResult(e){const t=this.cache.get(e);if(void 0===t)throw new Error("There is no AST with such key in the cache");{const{ast:e,hasVolatileFunction:r,hasStructuralChangeFunction:n,relativeDependencies:a}=t;return{ast:e,errors:[],hasVolatileFunction:r,hasStructuralChangeFunction:n,dependencies:a}}}computeHashFromTokens(e,t){var r;let n="",a=0;while(a<e.length){const s=e[a];if((0,z.tokenMatcher)(s,ge)){const e=ke(this.sheetMapping,s.image,t);n=void 0===e?n.concat(s.image):n.concat(e.hash(!0))}else if((0,z.tokenMatcher)(s,Ne)){const e=s.image.toUpperCase().slice(0,-1),t=null!==(r=this.lexerConfig.functionMapping[e])&&void 0!==r?r:e;n=n.concat(t,"(")}else if((0,z.tokenMatcher)(s,Ee)){const[e,r]=s.image.split(":"),a=_e(this.sheetMapping,e,t),i=_e(this.sheetMapping,r,t);n=void 0===a||void 0===i?n.concat("!REF"):n.concat(a.hash(!0),":",i.hash(!0))}else if((0,z.tokenMatcher)(s,ve)){const[e,r]=s.image.split(":"),a=Ue(this.sheetMapping,e,t),i=Ue(this.sheetMapping,r,t);n=void 0===a||void 0===i?n.concat("!REF"):n.concat(a.hash(!0),":",i.hash(!0))}else n=n.concat(s.image);a++}return n}rememberNewAst(e){const t=this.computeHashFromAst(e);return this.cache.maybeSetAndThenGet(t,e)}computeHashFromAst(e){return"="+this.computeHashOfAstNode(e)}computeHashOfAstNode(e){switch(e.type){case $e.EMPTY:return e.leadingWhitespace||"";case $e.NUMBER:return Nt(kt(e.value,this.config.decimalSeparator),e.leadingWhitespace);case $e.STRING:return Nt('"'+e.value+'"',e.leadingWhitespace);case $e.NAMED_EXPRESSION:return Nt(e.expressionName,e.leadingWhitespace);case $e.FUNCTION_CALL:{const t=e.args.map((e=>this.computeHashOfAstNode(e))).join(this.config.functionArgSeparator),r=e.procedureName+"("+t+Nt(")",e.internalWhitespace);return Nt(r,e.leadingWhitespace)}case $e.CELL_REFERENCE:return Nt(e.reference.hash(!0),e.leadingWhitespace);case $e.COLUMN_RANGE:case $e.ROW_RANGE:case $e.CELL_RANGE:{const t=e.start.hash(e.sheetReferenceType!==je.RELATIVE),r=e.end.hash(e.sheetReferenceType===je.BOTH_ABSOLUTE);return Nt(t+":"+r,e.leadingWhitespace)}case $e.MINUS_UNARY_OP:return Nt("-"+this.computeHashOfAstNode(e.value),e.leadingWhitespace);case $e.PLUS_UNARY_OP:return Nt("+"+this.computeHashOfAstNode(e.value),e.leadingWhitespace);case $e.PERCENT_OP:return this.computeHashOfAstNode(e.value)+Nt("%",e.leadingWhitespace);case $e.ERROR:{const t=this.config.translationPackage.getErrorTranslation(e.error?e.error.type:En.ERROR);return Nt(t,e.leadingWhitespace)}case $e.ERROR_WITH_RAW_INPUT:return Nt(e.rawInput,e.leadingWhitespace);case $e.ARRAY:{const t=e.args.map((e=>e.map((e=>this.computeHashOfAstNode(e))).join(","))).join(";");return Nt("{"+t+Nt("}",e.internalWhitespace),e.leadingWhitespace)}case $e.PARENTHESIS:{const t=this.computeHashOfAstNode(e.expression),r="("+t+Nt(")",e.internalWhitespace);return Nt(r,e.leadingWhitespace)}default:return this.computeHashOfAstNode(e.left)+Nt(wt[e.type],e.leadingWhitespace)+this.computeHashOfAstNode(e.right)}}bindWhitespacesToTokens(e){const t=[],r=e[0];(0,z.tokenMatcher)(r,this.lexerConfig.WhiteSpace)||t.push(r);for(let n=1;n<e.length;++n){const r=e[n];if((0,z.tokenMatcher)(r,this.lexerConfig.WhiteSpace))continue;const a=e[n-1];(0,z.tokenMatcher)(a,this.lexerConfig.WhiteSpace)&&(r.leadingWhitespace=a),t.push(r)}return t}tokenizeFormula(e){return this.lexer.tokenizeFormula(e)}}
/**
 * @license
 * Copyright (c) 2022 Handsoncode. All rights reserved.
 */
const Ut=(e,t,r,n)=>{switch(e.type){case $e.EMPTY:case $e.NUMBER:case $e.STRING:case $e.ERROR:return;case $e.NAMED_EXPRESSION:return void(n&&r.push(new Vt(e.expressionName)));case $e.CELL_REFERENCE:return void(n&&r.push(new Ft(e.reference)));case $e.CELL_RANGE:return void(n&&e.start.sheet===e.end.sheet&&r.push(new Pt(e.start,e.end)));case $e.COLUMN_RANGE:return void(n&&e.start.sheet===e.end.sheet&&r.push(new Bt(e.start,e.end)));case $e.ROW_RANGE:return void(n&&e.start.sheet===e.end.sheet&&r.push(new Yt(e.start,e.end)));case $e.PERCENT_OP:case $e.PLUS_UNARY_OP:case $e.MINUS_UNARY_OP:return void Ut(e.value,t,r,!0);case $e.CONCATENATE_OP:case $e.EQUALS_OP:case $e.NOT_EQUAL_OP:case $e.LESS_THAN_OP:case $e.GREATER_THAN_OP:case $e.LESS_THAN_OR_EQUAL_OP:case $e.GREATER_THAN_OR_EQUAL_OP:case $e.MINUS_OP:case $e.PLUS_OP:case $e.TIMES_OP:case $e.DIV_OP:case $e.POWER_OP:return Ut(e.left,t,r,!0),void Ut(e.right,t,r,!0);case $e.PARENTHESIS:return void Ut(e.expression,t,r,n);case $e.FUNCTION_CALL:{const n=!t.doesFunctionNeedArgumentToBeComputed(e.procedureName);return void e.args.forEach((e=>Ut(e,t,r,n)))}}},xt=(e,t)=>{const r=new Array;return Ut(e,t,r,!0),r};
/**
 * @license
 * Copyright (c) 2022 Handsoncode. All rights reserved.
 */
class Ft{constructor(e){this.dependency=e}absolutize(e){return this.dependency.toSimpleCellAddress(e)}}class Pt{constructor(e,t){this.start=e,this.end=t}absolutize(e){return new jt(this.start.toSimpleCellAddress(e),this.end.toSimpleCellAddress(e))}}class Bt{constructor(e,t){this.start=e,this.end=t}absolutize(e){const t=this.start.toSimpleColumnAddress(e),r=this.end.toSimpleColumnAddress(e);return new Xt(t.sheet,t.col,r.col)}}class Yt{constructor(e,t){this.start=e,this.end=t}absolutize(e){const t=this.start.toSimpleRowAddress(e),r=this.end.toSimpleRowAddress(e);return new Kt(t.sheet,t.row,r.row)}}class Vt{constructor(e){this.name=e}absolutize(e){return this}}
/**
 * @license
 * Copyright (c) 2022 Handsoncode. All rights reserved.
 */
class Wt{constructor(e,t,r){if(this.sheet=e,this.rowStart=t,this.rowEnd=r,t<0)throw Error("Starting row cant be less than 0");if(r<t)throw Error("Row span cant end before start")}get numberOfRows(){return this.rowEnd-this.rowStart+1}get start(){return this.rowStart}get end(){return this.rowEnd}static fromNumberOfRows(e,t,r){return new Wt(e,t,t+r-1)}static fromRowStartAndEnd(e,t,r){return new Wt(e,t,r)}*rows(){for(let e=this.rowStart;e<=this.rowEnd;++e)yield e}intersect(e){if(this.sheet!==e.sheet)throw Error("Can't intersect spans from different sheets");const t=Math.max(this.rowStart,e.rowStart),r=Math.min(this.rowEnd,e.rowEnd);return t>r?null:new Wt(this.sheet,t,r)}firstRow(){return new Wt(this.sheet,this.rowStart,this.rowStart)}}class Gt{constructor(e,t,r){if(this.sheet=e,this.columnStart=t,this.columnEnd=r,t<0)throw Error("Starting column cant be less than 0");if(r<t)throw Error("Column span cant end before start")}get numberOfColumns(){return this.columnEnd-this.columnStart+1}get start(){return this.columnStart}get end(){return this.columnEnd}static fromNumberOfColumns(e,t,r){return new Gt(e,t,t+r-1)}static fromColumnStartAndEnd(e,t,r){return new Gt(e,t,r)}*columns(){for(let e=this.columnStart;e<=this.columnEnd;++e)yield e}intersect(e){if(this.sheet!==e.sheet)throw Error("Can't intersect spans from different sheets");const t=Math.max(this.columnStart,e.columnStart),r=Math.min(this.columnEnd,e.columnEnd);return t>r?null:new Gt(this.sheet,t,r)}firstColumn(){return new Gt(this.sheet,this.columnStart,this.columnStart)}}
/**
 * @license
 * Copyright (c) 2022 Handsoncode. All rights reserved.
 */
const Ht="AbsoluteCellRange: Wrong range size";function zt(e){return!(!e||"object"!==typeof e&&"function"!==typeof e)&&("start"in e&&$n(e.start)&&"end"in e&&$n(e.end))}const $t=(e,t)=>({start:e,end:t});class jt{constructor(e,t){if(e.sheet!==t.sheet)throw new E(e.sheet,t.sheet);this.start=Wn(e.sheet,e.col,e.row),this.end=Wn(t.sheet,t.col,t.row)}get sheet(){return this.start.sheet}static fromAst(e,t){return e.type===$e.CELL_RANGE?jt.fromCellRange(e,t):e.type===$e.COLUMN_RANGE?Xt.fromColumnRange(e,t):Kt.fromRowRangeAst(e,t)}static fromAstOrUndef(e,t){try{return jt.fromAst(e,t)}catch(r){return}}static fromCellRange(e,t){return new jt(e.start.toSimpleCellAddress(t),e.end.toSimpleCellAddress(t))}static spanFrom(e,t,r){const n=jt.spanFromOrUndef(e,t,r);if(void 0===n)throw new Error(Ht);return n}static spanFromOrUndef(e,t,r){if(!Number.isFinite(t)&&Number.isFinite(r)){if(0!==e.col)return;return new Kt(e.sheet,e.row,e.row+r-1)}if(!Number.isFinite(r)&&Number.isFinite(t)){if(0!==e.row)return;return new Xt(e.sheet,e.col,e.col+t-1)}if(Number.isFinite(r)&&Number.isFinite(t))return new jt(e,Wn(e.sheet,e.col+t-1,e.row+r-1))}static fromCoordinates(e,t,r,n,a){return new jt(Wn(e,t,r),Wn(e,n,a))}isFinite(){return Number.isFinite(this.size())}doesOverlap(e){return this.start.sheet==e.start.sheet&&(!(this.end.row<e.start.row||this.start.row>e.end.row)&&!(this.end.col<e.start.col||this.start.col>e.end.col))}addressInRange(e){return this.sheet===e.sheet&&(this.start.row<=e.row&&this.end.row>=e.row&&this.start.col<=e.col&&this.end.col>=e.col)}columnInRange(e){return this.sheet===e.sheet&&(this.start.col<=e.col&&this.end.col>=e.col)}rowInRange(e){return this.sheet===e.sheet&&(this.start.row<=e.row&&this.end.row>=e.row)}containsRange(e){return this.addressInRange(e.start)&&this.addressInRange(e.end)}intersectionWith(e){if(this.sheet!==e.start.sheet)return;const t=Math.max(this.start.row,e.start.row),r=Math.min(this.end.row,e.end.row),n=Math.max(this.start.col,e.start.col),a=Math.min(this.end.col,e.end.col);return t>r||n>a?void 0:new jt(Wn(this.sheet,n,t),Wn(this.sheet,a,r))}includesRow(e){return this.start.row<e&&this.end.row>=e}includesColumn(e){return this.start.col<e&&this.end.col>=e}shiftByRows(e){this.start.row+=e,this.end.row+=e}expandByRows(e){this.end.row+=e}shiftByColumns(e){this.start.col+=e,this.end.col+=e}shifted(e,t){return jt.spanFrom(Wn(this.sheet,this.start.col+e,this.start.row+t),this.width(),this.height())}expandByColumns(e){this.end.col+=e}moveToSheet(e){this.start.sheet=e,this.end.sheet=e}removeSpan(e){e instanceof Wt?this.removeRows(e.start,e.end):this.removeColumns(e.start,e.end)}shouldBeRemoved(){return this.width()<=0||this.height()<=0}rangeWithSameWidth(e,t){return jt.spanFrom(Wn(this.sheet,this.start.col,e),this.width(),t)}rangeWithSameHeight(e,t){return jt.spanFrom(Wn(this.sheet,e,this.start.row),t,this.height())}toString(){return`${this.start.sheet},${this.start.col},${this.start.row},${this.end.col},${this.end.row}`}width(){return this.end.col-this.start.col+1}height(){return this.end.row-this.start.row+1}size(){return this.height()*this.width()}arrayOfAddressesInRange(){const e=[];for(let t=0;t<this.height();++t){e[t]=[];for(let r=0;r<this.width();++r){const n=Wn(this.sheet,this.start.col+r,this.start.row+t);e[t].push(n)}}return e}withStart(e){return new jt(e,this.end)}sameDimensionsAs(e){return this.width()===e.width()&&this.height()===e.height()}sameAs(e){return Xn(this.start,e.start)&&Xn(this.end,e.end)}addressesArrayMap(e,t){const r=[];let n=this.start.row;while(n<=this.effectiveEndRow(e)){let a=this.start.col;const s=[];while(a<=this.effectiveEndColumn(e))s.push(t(Wn(this.start.sheet,a,n))),a++;r.push(s),n++}return r}addresses(e){const t=[];let r=this.start.row;const n=this.effectiveEndRow(e),a=this.effectiveEndColumn(e);while(r<=n){let e=this.start.col;while(e<=a)t.push(Wn(this.start.sheet,e,r)),e++;r++}return t}*addressesWithDirection(e,t,r){if(e>0)if(t>0){let e=this.effectiveEndRow(r);while(e>=this.start.row){let t=this.effectiveEndColumn(r);while(t>=this.start.col)yield Wn(this.start.sheet,t,e),t-=1;e-=1}}else{let e=this.start.row;while(e<=this.effectiveEndRow(r)){let t=this.effectiveEndColumn(r);while(t>=this.start.col)yield Wn(this.start.sheet,t,e),t-=1;e+=1}}else if(t>0){let e=this.effectiveEndRow(r);while(e>=this.start.row){let t=this.start.col;while(t<=this.effectiveEndColumn(r))yield Wn(this.start.sheet,t,e),t+=1;e-=1}}else{let e=this.start.row;while(e<=this.effectiveEndRow(r)){let t=this.start.col;while(t<=this.effectiveEndColumn(r))yield Wn(this.start.sheet,t,e),t+=1;e+=1}}}getAddress(e,t){if(e<0||t<0||t>this.height()-1||e>this.width()-1)throw Error("Index out of bound");return Wn(this.start.sheet,this.start.col+e,this.start.row+t)}exceedsSheetSizeLimits(e,t){return this.end.col>=e||this.end.row>=t}effectiveEndColumn(e){return this.end.col}effectiveEndRow(e){return this.end.row}effectiveWidth(e){return this.width()}effectiveHeight(e){return this.height()}removeRows(e,t){if(!(e>this.end.row)){if(t<this.start.row){const r=t-e+1;return this.shiftByRows(-r)}e<=this.start.row&&(this.start.row=e),this.end.row-=Math.min(t,this.end.row)-e+1}}removeColumns(e,t){if(!(e>this.end.col)){if(t<this.start.col){const r=t-e+1;return this.shiftByColumns(-r)}e<=this.start.col&&(this.start.col=e),this.end.col-=Math.min(t,this.end.col)-e+1}}}class Xt extends jt{constructor(e,t,r){super(Wn(e,t,0),Wn(e,r,Number.POSITIVE_INFINITY))}static fromColumnRange(e,t){const r=e.start.toSimpleColumnAddress(t),n=e.end.toSimpleColumnAddress(t);if(r.sheet!==n.sheet)throw new E(r.sheet,n.sheet);return new Xt(r.sheet,r.col,n.col)}shouldBeRemoved(){return this.width()<=0}shiftByRows(e){}expandByRows(e){}shifted(e,t){return new Xt(this.sheet,this.start.col+e,this.end.col+e)}rangeWithSameHeight(e,t){return new Xt(this.sheet,e,e+t-1)}exceedsSheetSizeLimits(e,t){return this.end.col>=e}effectiveEndRow(e){return this.effectiveHeight(e)-1}effectiveHeight(e){return e.getSheetHeight(this.sheet)}removeRows(e,t){}}class Kt extends jt{constructor(e,t,r){super(Wn(e,0,t),Wn(e,Number.POSITIVE_INFINITY,r))}static fromRowRangeAst(e,t){const r=e.start.toSimpleRowAddress(t),n=e.end.toSimpleRowAddress(t);if(r.sheet!==n.sheet)throw new E(r.sheet,n.sheet);return new Kt(r.sheet,r.row,n.row)}shouldBeRemoved(){return this.height()<=0}shiftByColumns(e){}expandByColumns(e){}shifted(e,t){return new Kt(this.sheet,this.start.row+t,this.end.row+t)}rangeWithSameWidth(e,t){return new Kt(this.sheet,e,e+t-1)}exceedsSheetSizeLimits(e,t){return this.end.row>=t}effectiveEndColumn(e){return this.effectiveWidth(e)-1}effectiveWidth(e){return e.getSheetWidth(this.sheet)}removeColumns(e,t){}}
/**
 * @license
 * Copyright (c) 2022 Handsoncode. All rights reserved.
 */
const qt=(e,t)=>e.map((e=>e.absolutize(t))),Jt=e=>e.filter((e=>e instanceof Vt||(e instanceof jt?!(Gn(e.start)||Gn(e.end)):!Gn(e))));
/**
 * @license
 * Copyright (c) 2022 Handsoncode. All rights reserved.
 */
class Qt{constructor(e,t,r){this.formulaAddress=e,this.arraysFlag=t,this.formulaVertex=r}}var Zt=r(1784),er=r.n(Zt);
/**
 * @license
 * Copyright (c) 2022 Handsoncode. All rights reserved.
 */
function tr(e){const t=e.caseSensitive?e.accentSensitive?"variant":"case":e.accentSensitive?"accent":"base",r=e.caseFirst,n=e.ignorePunctuation;return new Intl.Collator(e.localeLang,{sensitivity:t,caseFirst:r,ignorePunctuation:n})}
/**
 * @license
 * Copyright (c) 2022 Handsoncode. All rights reserved.
 */
const rr=Symbol("Empty value");function nr(e){return e instanceof ar?e.val:e}class ar{constructor(e,t){this.val=e,this.format=t}fromNumber(e){return new this.constructor(e)}}function sr(e,t){if("number"===typeof e)return t;{const r=e.fromNumber(t);return r.format=e.format,r}}class ir extends ar{getDetailedType(){return fr.NUMBER_DATE}}class or extends ar{getDetailedType(){return fr.NUMBER_CURRENCY}}class cr extends ar{getDetailedType(){return fr.NUMBER_TIME}}class lr extends ar{getDetailedType(){return fr.NUMBER_DATETIME}}class ur extends ar{getDetailedType(){return fr.NUMBER_PERCENT}}function hr(e){return"number"===typeof e||e instanceof ar}var fr;function dr(e){return e instanceof ar?e.getDetailedType():fr.NUMBER_RAW}function pr(e){return e instanceof ar?e.format:void 0}function mr(e){return e instanceof ar?{type:e.getDetailedType(),format:e.format}:{type:fr.NUMBER_RAW}}(function(e){e["NUMBER_RAW"]="NUMBER_RAW",e["NUMBER_DATE"]="NUMBER_DATE",e["NUMBER_TIME"]="NUMBER_TIME",e["NUMBER_DATETIME"]="NUMBER_DATETIME",e["NUMBER_CURRENCY"]="NUMBER_CURRENCY",e["NUMBER_PERCENT"]="NUMBER_PERCENT"})(fr||(fr={}));
/**
 * @license
 * Copyright (c) 2022 Handsoncode. All rights reserved.
 */
const gr="i",Er=/^\s*([+-]?)\s*(([\d\.,]+(e[+-]?\d+)?)\s*([ij]?)|([ij]))\s*(([+-])\s*([+-]?)\s*(([\d\.,]+(e[+-]?\d+)?)\s*([ij]?)|([ij])))?$/;class vr{constructor(e,t,r){this.config=e,this.dateTimeHelper=t,this.numberLiteralsHelper=r,this.lt=(e,t)=>this.compare(e,t)<0,this.leq=(e,t)=>this.compare(e,t)<=0,this.gt=(e,t)=>this.compare(e,t)>0,this.geq=(e,t)=>this.compare(e,t)>=0,this.eq=(e,t)=>0===this.compare(e,t),this.neq=(e,t)=>0!==this.compare(e,t),this.pow=(e,t)=>Math.pow(nr(e),nr(t)),this.addWithEpsilonRaw=(e,t)=>{const r=e+t;return Math.abs(r)<this.actualEps*Math.abs(e)?0:r},this.addWithEpsilon=(e,t)=>{const r=Ur(e,t);return this.ExtendedNumberFactory(this.addWithEpsilonRaw(nr(e),nr(t)),r)},this.unaryMinus=e=>sr(e,-nr(e)),this.unaryPlus=e=>e,this.unaryPercent=e=>new ur(nr(e)/100),this.concat=(e,t)=>e.concat(t),this.nonstrictadd=(e,t)=>e instanceof Fn?e:t instanceof Fn?t:"number"===typeof e?"number"===typeof t?this.addWithEpsilonRaw(e,t):e:"number"===typeof t?t:0,this.subtract=(e,t)=>{const r=Ur(e,t),n=nr(e),a=nr(t);let s=n-a;return Math.abs(s)<this.actualEps*Math.abs(n)&&(s=0),this.ExtendedNumberFactory(s,r)},this.divide=(e,t)=>{const r=nr(e),n=nr(t);if(0===n)return new Fn(En.DIV_BY_ZERO);{const a=xr(e,t);return this.ExtendedNumberFactory(r/n,a)}},this.multiply=(e,t)=>{const r=xr(e,t);return this.ExtendedNumberFactory(nr(e)*nr(t),r)},this.manyToExactComplex=e=>{const t=[];for(const r of e){if(r instanceof Fn)return r;if(hr(r)||"string"===typeof r){const e=this.coerceScalarToComplex(r);e instanceof Fn||t.push(e)}}return t},this.coerceNumbersExactRanges=e=>this.manyToNumbers(e,this.manyToExactNumbers),this.coerceNumbersCoerceRangesDropNulls=e=>this.manyToNumbers(e,this.manyToCoercedNumbersDropNulls),this.manyToExactNumbers=e=>{const t=[];for(const r of e){if(r instanceof Fn)return r;hr(r)&&t.push(nr(r))}return t},this.manyToOnlyNumbersDropNulls=e=>{const t=[];for(const r of e){if(r instanceof Fn)return r;if(hr(r))t.push(nr(r));else if(r!==rr)return new Fn(En.VALUE,It.NumberExpected)}return t},this.manyToCoercedNumbersDropNulls=e=>{const t=[];for(const r of e){if(r instanceof Fn)return r;if(r===rr)continue;const e=this.coerceScalarToNumberOrError(r);hr(e)&&t.push(nr(e))}return t},this.collator=tr(e),this.actualEps=e.smartRounding?e.precisionEpsilon:0}eqMatcherFunction(e){const t=this.buildRegex(e);return e=>"string"===typeof e&&t.test(this.normalizeString(e))}neqMatcherFunction(e){const t=this.buildRegex(e);return e=>!("string"===typeof e)||!t.test(this.normalizeString(e))}searchString(e,t){var r;const n=this.buildRegex(e,!1),a=n.exec(t);return null!==(r=null===a||void 0===a?void 0:a.index)&&void 0!==r?r:-1}requiresRegex(e){if(!this.config.useRegularExpressions&&!this.config.useWildcards)return!this.config.matchWholeCell;for(let t=0;t<e.length;t++){const r=e.charAt(t);if(Ir(r)||this.config.useRegularExpressions&&Dr(r))return!0}return!1}floatCmp(e,t){const r=nr(e),n=nr(t),a=1+this.actualEps;return n>=0&&r*a>=n&&r<=n*a||n<=0&&r*a<=n&&r>=n*a?0:r>n?1:-1}coerceScalarToNumberOrError(e){var t;return e instanceof Fn?e:null!==(t=this.coerceToMaybeNumber(e))&&void 0!==t?t:new Fn(En.VALUE,It.NumberCoercion)}coerceToMaybeNumber(e){var t;return null!==(t=this.coerceNonDateScalarToMaybeNumber(e))&&void 0!==t?t:"string"===typeof e?this.dateTimeHelper.dateStringToDateNumber(e):void 0}coerceNonDateScalarToMaybeNumber(e){if(e===rr)return 0;if("string"===typeof e){if(""===e)return 0;const t=this.coerceStringToMaybePercentNumber(e);if(void 0!==t)return t;const r=this.coerceStringToMaybeCurrencyNumber(e);return void 0!==r?r:this.numberLiteralsHelper.numericStringToMaybeNumber(e.trim())}return hr(e)?e:"boolean"===typeof e?Number(e):void 0}coerceStringToMaybePercentNumber(e){const t=e.trim();if(t.endsWith("%")){const e=t.slice(0,t.length-1).trim(),r=this.numberLiteralsHelper.numericStringToMaybeNumber(e);if(void 0!==r)return new ur(r/100)}}coerceStringToMaybeCurrencyNumber(e){const t=this.currencyMatcher(e.trim());if(void 0!==t){const[e,r]=t,n=this.numberLiteralsHelper.numericStringToMaybeNumber(r);if(void 0!==n)return new or(n,e)}}currencyMatcher(e){for(const t of this.config.currencySymbol){if(e.startsWith(t))return[t,e.slice(t.length).trim()];if(e.endsWith(t))return[t,e.slice(0,e.length-t.length).trim()]}}coerceComplexExactRanges(e){const t=[];for(const n of e)if(n instanceof jr)t.push(n);else if(n!==rr){const e=this.coerceScalarToComplex(n);if(e instanceof Fn)return e;t.push(e)}const r=[];for(const n of t)if(n instanceof jr){const e=this.manyToExactComplex(n.valuesFromTopLeftCorner());if(e instanceof Fn)return e;r.push(...e)}else r.push(n);return r}coerceScalarToComplex(e){return e instanceof Fn?e:e===rr?[0,0]:hr(e)?[nr(e),0]:"string"===typeof e?this.coerceStringToComplex(e):new Fn(En.NUM,It.ComplexNumberExpected)}ExtendedNumberFactory(e,t){const{type:r,format:n}=t;switch(r){case fr.NUMBER_RAW:return e;case fr.NUMBER_CURRENCY:return new or(e,null!==n&&void 0!==n?n:this.config.currencySymbol[0]);case fr.NUMBER_DATE:return new ir(e,n);case fr.NUMBER_DATETIME:return new lr(e,n);case fr.NUMBER_TIME:return new cr(e,n);case fr.NUMBER_PERCENT:return new ur(e,n)}}buildRegex(e,t=!0){let r;e=this.normalizeString(e);let n=this.config.useWildcards,a=this.config.useRegularExpressions;if(a)try{RegExp(e)}catch(s){a=!1,n=!1}return r=a?_r(e,this.config.caseSensitive):n?Lr(e,this.config.caseSensitive):kr(e,this.config.caseSensitive),this.config.matchWholeCell&&t?RegExp("^("+r+")$"):RegExp(r)}normalizeString(e){return this.config.caseSensitive||(e=e.toLowerCase()),this.config.accentSensitive||(e=Br(e,"nfd").replace(/[\u0300-\u036f]/g,"")),e}compare(e,t){if("string"===typeof e||"string"===typeof t){const r="string"===typeof e?this.dateTimeHelper.dateStringToDateNumber(e):e,n="string"===typeof t?this.dateTimeHelper.dateStringToDateNumber(t):t;if(hr(r)&&hr(n))return this.floatCmp(r,n)}return e===rr?e=Rr(t):t===rr&&(t=Rr(e)),"string"===typeof e&&"string"===typeof t?this.stringCmp(e,t):"boolean"===typeof e&&"boolean"===typeof t?br(Ar(e),Ar(t)):hr(e)&&hr(t)?this.floatCmp(e,t):e===rr&&t===rr?0:br(kn(_n(e)),kn(_n(t)))}stringCmp(e,t){return this.collator.compare(e,t)}manyToNumbers(e,t){const r=[];for(const a of e)if(a instanceof jr)r.push(a);else{const e=nr(this.coerceScalarToNumberOrError(a));if(e instanceof Fn)return e;r.push(e)}const n=[];for(const a of r)if(a instanceof jr){const e=t(a.valuesFromTopLeftCorner());if(e instanceof Fn)return e;n.push(...e)}else n.push(a);return n}coerceStringToComplex(e){const t=Er.exec(e);if(null===t)return new Fn(En.NUM,It.ComplexNumberExpected);let r,n;return r=void 0!==t[6]?"-"===t[1]?[0,-1]:[0,1]:this.parseComplexToken(t[1]+t[3],t[5]),r instanceof Fn||void 0===t[8]?r:(n=void 0!==t[14]?"-"===t[9]?[0,-1]:[0,1]:this.parseComplexToken(t[9]+t[11],t[13]),n instanceof Fn?n:""!==t[5]||""===t[13]?new Fn(En.NUM,It.ComplexNumberExpected):"+"===t[8]?[r[0]+n[0],r[1]+n[1]]:[r[0]-n[0],r[1]-n[1]])}parseComplexToken(e,t){const r=nr(this.coerceNonDateScalarToMaybeNumber(e));return void 0===r?new Fn(En.NUM,It.ComplexNumberExpected):""===t?[r,0]:[0,r]}}function Tr([e,t],r){if(!isFinite(e)||!isFinite(t))return new Fn(En.NUM,It[NaN]);if(r=null!==r&&void 0!==r?r:gr,0===t)return`${e}`;const n=`${-1===t||1===t?"":Math.abs(t)}${r}`;return 0===e?`${t<0?"-":""}${n}`:`${e}${t<0?"-":"+"}${n}`}function Sr(e){return e instanceof jr?e:jr.fromScalar(e)}function Ar(e){return Number(e)}function Rr(e){return"string"===typeof e?"":hr(e)?0:"boolean"!==typeof e&&rr}function yr(e){if(e instanceof Fn||"boolean"===typeof e)return e;if(e===rr)return!1;if(hr(e))return 0!==nr(e);{const t=e.toUpperCase();return"TRUE"===t||"FALSE"!==t&&(""!==t&&void 0)}}function Nr(e){return e instanceof Fn||"string"===typeof e?e:e===rr?"":hr(e)?nr(e).toString():e?"TRUE":"FALSE"}function wr(e){return e===rr?0:e}function br(e,t){const r=nr(e),n=nr(t);return r>n?1:r<n?-1:0}function Cr(e){return isNaN(e)||e===1/0||e===-1/0}function Or(e){return 0===e?0:e}function Ir(e){return["*","?"].includes(e)}const Mr=["{","}","[","]","(",")","<",">","=",".","+","-",",","\\","$","^","!"];function Dr(e){return Mr.includes(e)}function Lr(e,t){let r="";for(let n=0;n<e.length;n++){const a=e.charAt(n);if("~"===a){if(n==e.length-1){r+="~";continue}const t=e.charAt(n+1);Ir(t)||Dr(t)?(r+="\\"+t,n++):(r+=t,n++)}else Ir(a)?r+="."+a:Dr(a)?r+="\\"+a:r+=t?a:a.toLowerCase()}return r}function kr(e,t){let r="";for(let n=0;n<e.length;n++){const a=e.charAt(n);Ir(a)||Dr(a)?r+="\\"+a:r+=t?a:a.toLowerCase()}return r}function _r(e,t){let r="";for(let n=0;n<e.length;n++){const a=e.charAt(n);Ir(a)||Dr(a)?r+=a:r+=t?a:a.toLowerCase()}return r}function Ur(e,t){const{type:r,format:n}=mr(e),{type:a,format:s}=mr(t);if(r===fr.NUMBER_RAW)return{type:a,format:s};if(a===fr.NUMBER_RAW)return{type:r,format:n};if((r===fr.NUMBER_DATETIME||r===fr.NUMBER_DATE)&&(a===fr.NUMBER_DATETIME||a===fr.NUMBER_DATE))return{type:fr.NUMBER_RAW};if(r===fr.NUMBER_TIME){if(a===fr.NUMBER_DATE)return{type:fr.NUMBER_DATETIME,format:s+" "+n};if(a===fr.NUMBER_DATETIME)return{type:fr.NUMBER_DATETIME,format:s}}if(a===fr.NUMBER_TIME){if(r===fr.NUMBER_DATE)return{type:fr.NUMBER_DATETIME,format:n+" "+s};if(r===fr.NUMBER_DATETIME)return{type:fr.NUMBER_DATETIME,format:n}}return{type:r,format:n}}function xr(e,t){let{type:r,format:n}=mr(e),{type:a,format:s}=mr(t);return r===fr.NUMBER_PERCENT&&(r=fr.NUMBER_RAW,n=void 0),a===fr.NUMBER_PERCENT&&(a=fr.NUMBER_RAW,s=void 0),r===fr.NUMBER_RAW?{type:a,format:s}:a===fr.NUMBER_RAW?{type:r,format:n}:{type:fr.NUMBER_RAW}}function Fr(e){return Br(e.toLowerCase(),"nfd").replace(/[\u0300-\u036f]/g,"")}function Pr(e,t){var r;if(e.isAdHoc())return null===(r=e.data[0])||void 0===r?void 0:r[0];const n=e.range;if(t.formulaAddress.sheet===n.sheet)if(1===n.width()){const r=t.formulaAddress.row-n.start.row;if(r>=0&&r<n.height())return e.data[r][0]}else if(1===n.height()){const r=t.formulaAddress.col-n.start.col;if(r>=0&&r<n.width())return e.data[0][r]}}function Br(e,t){return"function"===typeof e.normalize?e.normalize(t.toUpperCase()):er()[t](e)}
/**
 * @license
 * Copyright (c) 2022 Handsoncode. All rights reserved.
 */
var Yr,Vr;(function(e){e["STRING"]="STRING",e["NUMBER"]="NUMBER",e["BOOLEAN"]="BOOLEAN",e["SCALAR"]="SCALAR",e["NOERROR"]="NOERROR",e["RANGE"]="RANGE",e["INTEGER"]="INTEGER",e["COMPLEX"]="COMPLEX",e["ANY"]="ANY"})(Yr||(Yr={}));class Wr{constructor(e){this.coerceScalarToNumberOrError=e=>this.arithmeticHelper.coerceScalarToNumberOrError(e),this.runFunction=(e,t,r,n)=>{var a,s,i,o,c;let l,u=r.parameters||[];if(l=r.expandRanges?this.listOfScalarValues(e,t):e.map((e=>[this.evaluateAst(e,t),!1])),void 0===r.repeatLastArgs&&u.length<l.length)return new Fn(En.NA,It.WrongArgNumber);if(void 0!==r.repeatLastArgs&&u.length<l.length&&(l.length-u.length)%r.repeatLastArgs!==0)return new Fn(En.NA,It.WrongArgNumber);u=[...u];while(u.length<l.length)u.push(...u.slice(u.length-r.repeatLastArgs));let h=1,f=1;if(!r.vectorizationForbidden&&t.arraysFlag)for(let p=0;p<l.length;p++){const[e]=l[p];e instanceof jr&&u[p].argumentType!==Yr.RANGE&&u[p].argumentType!==Yr.ANY&&(f=Math.max(f,e.height()),h=Math.max(h,e.width()))}for(let p=l.length;p<u.length;p++)if(void 0===(null===(a=u[p])||void 0===a?void 0:a.defaultValue)&&!(null===(s=u[p])||void 0===s?void 0:s.optionalArg))return new Fn(En.NA,It.WrongArgNumber);const d=[];for(let p=0;p<f;p++){const e=[];for(let a=0;a<h;a++){let s;const d=[];for(let e=0;e<u.length;e++){let[n,h]=null!==(i=l[e])&&void 0!==i?i:[void 0,void 0];n instanceof jr&&u[e].argumentType!==Yr.RANGE&&u[e].argumentType!==Yr.ANY&&!r.vectorizationForbidden&&t.arraysFlag&&(n=null===(o=n.data[1!==n.height()?p:0])||void 0===o?void 0:o[1!==n.width()?a:0]);const f=null!==n&&void 0!==n?n:null===(c=u[e])||void 0===c?void 0:c.defaultValue;if(void 0===f)d.push(void 0);else{const r=void 0!==n?this.coerceToType(f,u[e],t):f;void 0!==r?(r instanceof Fn&&u[e].argumentType!==Yr.SCALAR&&(s=null!==s&&void 0!==s?s:r),d.push(r)):h||(s=null!==s&&void 0!==s?s:new Fn(En.VALUE,It.WrongType))}}const m=null!==s&&void 0!==s?s:this.returnNumberWrapper(n(...d),r.returnNumberType);if(1===f&&1===h)return m;if(m instanceof jr)throw"Function returning array cannot be vectorized.";e.push(m)}d.push(e)}return jr.onlyValues(d)},this.runFunctionWithReferenceArgument=(e,t,r,n,a,s=(()=>new Fn(En.NA,It.CellRefExpected)))=>{if(0===e.length)return this.returnNumberWrapper(n(),r.returnNumberType);if(e.length>1)return new Fn(En.NA,It.WrongArgNumber);let i,o=e[0];while(o.type===$e.PARENTHESIS)o=o.expression;if(o.type===$e.CELL_REFERENCE)i=o.reference.toSimpleCellAddress(t.formulaAddress);else if(o.type===$e.CELL_RANGE||o.type===$e.COLUMN_RANGE||o.type===$e.ROW_RANGE)try{i=jt.fromAst(o,t.formulaAddress).start}catch(c){return new Fn(En.REF,It.CellRefExpected)}return void 0!==i?this.returnNumberWrapper(a(i),r.returnNumberType):this.runFunction(e,t,r,s)},this.interpreter=e,this.dependencyGraph=e.dependencyGraph,this.columnSearch=e.columnSearch,this.config=e.config,this.serialization=e.serialization,this.arraySizePredictor=e.arraySizePredictor,this.dateTimeHelper=e.dateTimeHelper,this.arithmeticHelper=e.arithmeticHelper}evaluateAst(e,t){return this.interpreter.evaluateAst(e,t)}arraySizeForAst(e,t){return this.arraySizePredictor.checkArraySizeForAst(e,t)}listOfScalarValues(e,t){const r=[];for(const n of e){const e=this.evaluateAst(n,t);if(e instanceof jr)for(const t of e.valuesFromTopLeftCorner())r.push([t,!0]);else r.push([e,!1])}return r}coerceToType(e,t,r){let n;if(e instanceof jr)switch(t.argumentType){case Yr.RANGE:case Yr.ANY:n=e;break;default:{const t=Pr(e,r);if(void 0===t)return;e=t}}if(!(e instanceof jr))switch(t.argumentType){case Yr.INTEGER:case Yr.NUMBER:const r=this.coerceScalarToNumberOrError(e);if(!hr(r)){n=r;break}const a=nr(r);if(void 0!==t.maxValue&&a>t.maxValue)return new Fn(En.NUM,It.ValueLarge);if(void 0!==t.minValue&&a<t.minValue)return new Fn(En.NUM,It.ValueSmall);if(void 0!==t.lessThan&&a>=t.lessThan)return new Fn(En.NUM,It.ValueLarge);if(void 0!==t.greaterThan&&a<=t.greaterThan)return new Fn(En.NUM,It.ValueSmall);if(t.argumentType===Yr.INTEGER&&!Number.isInteger(a))return new Fn(En.NUM,It.IntegerExpected);n=r;break;case Yr.STRING:n=Nr(e);break;case Yr.BOOLEAN:n=yr(e);break;case Yr.SCALAR:case Yr.NOERROR:case Yr.ANY:n=e;break;case Yr.RANGE:if(e instanceof Fn)return e;n=Sr(e);break;case Yr.COMPLEX:return this.arithmeticHelper.coerceScalarToComplex(nr(e))}return t.passSubtype||void 0===n?n:nr(n)}metadata(e){const t=this.constructor.implementedFunctions[e];if(void 0!==t)return t;throw new Error(`No metadata for function ${e}.`)}returnNumberWrapper(e,t,r){return void 0!==t&&hr(e)?this.arithmeticHelper.ExtendedNumberFactory(nr(e),{type:t,format:r}):e}}
/**
 * @license
 * Copyright (c) 2022 Handsoncode. All rights reserved.
 */
class Gr{constructor(e,t,r=!1){if(this.width=e,this.height=t,this.isRef=r,e<=0||t<=0)throw Error("Incorrect array size")}static fromArray(e){return new Gr(e.length>0?e[0].length:0,e.length)}static error(){return new Gr(1,1,!0)}static scalar(){return new Gr(1,1,!1)}isScalar(){return this.width<=1&&this.height<=1||this.isRef}}function Hr(e,t){return new Gr(Math.max(e.width,t.width),Math.max(e.height,t.height))}function zr(e){return new Gr(e.width,e.height)}class $r{constructor(e,t){this.config=e,this.functionRegistry=t}checkArraySize(e,t){return this.checkArraySizeForAst(e,{formulaAddress:t,arraysFlag:this.config.useArrayArithmetic})}checkArraySizeForAst(e,t){switch(e.type){case $e.FUNCTION_CALL:return this.checkArraySizeForFunction(e,t);case $e.COLUMN_RANGE:case $e.ROW_RANGE:case $e.CELL_RANGE:{const r=jt.fromAstOrUndef(e,t.formulaAddress);return void 0===r?Gr.error():new Gr(r.width(),r.height(),!0)}case $e.ARRAY:{const r=[],n=[];for(const i of e.args){const e=i.map((e=>this.checkArraySizeForAst(e,t))),a=Math.min(...e.map((e=>e.height))),s=e.reduce(((e,t)=>e+t.width),0);r.push(a),n.push(s)}const a=r.reduce(((e,t)=>e+t),0),s=Math.min(...n);return new Gr(s,a)}case $e.STRING:case $e.NUMBER:return Gr.scalar();case $e.CELL_REFERENCE:return new Gr(1,1,!0);case $e.DIV_OP:case $e.CONCATENATE_OP:case $e.EQUALS_OP:case $e.GREATER_THAN_OP:case $e.GREATER_THAN_OR_EQUAL_OP:case $e.LESS_THAN_OP:case $e.LESS_THAN_OR_EQUAL_OP:case $e.MINUS_OP:case $e.NOT_EQUAL_OP:case $e.PLUS_OP:case $e.POWER_OP:case $e.TIMES_OP:{const r=this.checkArraySizeForAst(e.left,t),n=this.checkArraySizeForAst(e.right,t);return!t.arraysFlag&&(r.height>1||r.width>1||n.height>1||n.width>1)?Gr.error():Hr(r,n)}case $e.MINUS_UNARY_OP:case $e.PLUS_UNARY_OP:case $e.PERCENT_OP:{const r=this.checkArraySizeForAst(e.value,t);return!t.arraysFlag&&(r.height>1||r.width>1)?Gr.error():zr(r)}case $e.PARENTHESIS:return this.checkArraySizeForAst(e.expression,t);case $e.EMPTY:return Gr.error();default:return Gr.error()}}checkArraySizeForFunction(e,t){const r=this.functionRegistry.getMetadata(e.procedureName),n=this.functionRegistry.getArraySizeFunction(e.procedureName);if(void 0!==n)return n(e,t);const a=e.args.map((e=>{var n;return this.checkArraySizeForAst(e,new Qt(t.formulaAddress,t.arraysFlag||null!==(n=null===r||void 0===r?void 0:r.arrayFunction)&&void 0!==n&&n))}));if(void 0===r||r.expandRanges||!t.arraysFlag||r.vectorizationForbidden||void 0===r.parameters)return new Gr(1,1);const s=[...r.parameters];if(void 0===r.repeatLastArgs&&s.length<a.length)return Gr.error();if(void 0!==r.repeatLastArgs&&s.length<a.length&&(a.length-s.length)%r.repeatLastArgs!==0)return Gr.error();while(s.length<a.length)s.push(...s.slice(s.length-r.repeatLastArgs));let i=1,o=1;for(let c=0;c<a.length;c++)s[c].argumentType!==Yr.RANGE&&s[c].argumentType!==Yr.ANY&&(o=Math.max(o,a[c].height),i=Math.max(i,a[c].width));return new Gr(i,o)}}
/**
 * @license
 * Copyright (c) 2022 Handsoncode. All rights reserved.
 */
class jr{constructor(e,t,r,n){this._data=e,this.range=t,this.dependencyGraph=r,this._hasOnlyNumbers=n,this.size=void 0===e?new Gr(t.effectiveWidth(r),t.effectiveHeight(r)):new Gr(e[0].length,e.length)}get data(){return this.ensureThatComputed(),this._data}static fromRange(e,t,r){return new jr(e,t,r,!0)}static onlyNumbers(e){return new jr(e,void 0,void 0,!0)}static onlyValues(e){return new jr(e,void 0,void 0,void 0)}static onlyRange(e,t){return new jr(void 0,e,t,void 0)}static fromScalar(e){return new jr([[e]],void 0,void 0,void 0)}isAdHoc(){return void 0===this.range}width(){return this.size.width}height(){return this.size.height}valuesFromTopLeftCorner(){this.ensureThatComputed();const e=[];for(let t=0;t<this._data.length;t++)for(let r=0;r<this._data[0].length;r++)e.push(this._data[t][r]);return e}*effectiveAddressesFromData(e){for(let t=0;t<this.data.length;++t){const r=this.data[t];for(let n=0;n<r.length;++n)yield Wn(e.sheet,e.col+n,e.row+t)}}*entriesFromTopLeftCorner(e){this.ensureThatComputed();for(let t=0;t<this.size.height;++t)for(let r=0;r<this.size.width;++r)yield[this._data[t][r],Wn(e.sheet,e.col+r,e.row+t)]}*iterateValuesFromTopLeftCorner(){yield*this.valuesFromTopLeftCorner()}numberOfElements(){return this.size.width*this.size.height}hasOnlyNumbers(){if(void 0===this._hasOnlyNumbers){this._hasOnlyNumbers=!0;for(const e of this.data)for(const t of e)if("number"!==typeof t)return this._hasOnlyNumbers=!1,!1}return this._hasOnlyNumbers}rawNumbers(){return this._data}rawData(){var e;return this.ensureThatComputed(),null!==(e=this._data)&&void 0!==e?e:[]}sameDimensionsAs(e){return this.width()===e.width()&&this.height()===e.height()}ensureThatComputed(){void 0===this._data&&(this._hasOnlyNumbers=!0,this._data=this.range.addressesArrayMap(this.dependencyGraph,(e=>{const t=this.dependencyGraph.getCellValue(e);return t instanceof jr?(this._hasOnlyNumbers=!1,new Fn(En.VALUE,It.ScalarExpected)):(hr(t)||(this._hasOnlyNumbers=!1),t)})))}}
/**
 * @license
 * Copyright (c) 2022 Handsoncode. All rights reserved.
 */
class Xr{constructor(){this.changes=new Map}static empty(){return new Xr}addAll(e){for(const t of e.changes.values())this.add(t.address,t);return this}addChange(e,t,r){this.addInterpreterValue(e,t,r)}exportChanges(e){let t=[];return this.changes.forEach((r=>{const n=e.exportChange(r);Array.isArray(n)?t=t.concat(n):t.push(n)})),t}getChanges(){return Array.from(this.changes.values())}isEmpty(){return 0===this.changes.size}add(e,t){const r=t.value;if(r instanceof jr)for(const n of r.effectiveAddressesFromData(e))this.changes.delete(`${n.sheet},${n.col},${n.row}`);this.changes.set(zn(e),t)}addInterpreterValue(e,t,r){this.add(t,{address:t,value:e,oldValue:r})}}(function(e){e["BUILD_ENGINE_TOTAL"]="BUILD_ENGINE_TOTAL",e["PARSER"]="PARSER",e["GRAPH_BUILD"]="GRAPH_BUILD",e["COLLECT_DEPENDENCIES"]="COLLECT_DEPENDENCIES",e["PROCESS_DEPENDENCIES"]="PROCESS_DEPENDENCIES",e["TOP_SORT"]="TOP_SORT",e["BUILD_COLUMN_INDEX"]="BUILD_COLUMN_INDEX",e["EVALUATION"]="EVALUATION",e["VLOOKUP"]="VLOOKUP",e["TRANSFORM_ASTS"]="TRANSFORM_ASTS",e["TRANSFORM_ASTS_POSTPONED"]="TRANSFORM_ASTS_POSTPONED",e["ADJUSTING_ADDRESS_MAPPING"]="ADJUSTING_ADDRESS_MAPPING",e["ADJUSTING_ARRAY_MAPPING"]="ADJUSTING_ARRAY_MAPPING",e["ADJUSTING_RANGES"]="ADJUSTING_RANGES",e["ADJUSTING_GRAPH"]="ADJUSTING_GRAPH",e["CRITERION_FUNCTION_FULL_CACHE_USED"]="CRITERION_FUNCTION_FULL_CACHE_USED",e["CRITERION_FUNCTION_PARTIAL_CACHE_USED"]="CRITERION_FUNCTION_PARTIAL_CACHE_USED"})(Vr||(Vr={}));
/**
 * @license
 * Copyright (c) 2022 Handsoncode. All rights reserved.
 */
class Kr{constructor(){this.stats=new Map([[Vr.CRITERION_FUNCTION_FULL_CACHE_USED,0],[Vr.CRITERION_FUNCTION_PARTIAL_CACHE_USED,0]]),this.startTimes=new Map}incrementCriterionFunctionFullCacheUsed(){var e;const t=(null!==(e=this.stats.get(Vr.CRITERION_FUNCTION_FULL_CACHE_USED))&&void 0!==e?e:0)+1;this.stats.set(Vr.CRITERION_FUNCTION_FULL_CACHE_USED,t)}incrementCriterionFunctionPartialCacheUsed(){var e;const t=(null!==(e=this.stats.get(Vr.CRITERION_FUNCTION_PARTIAL_CACHE_USED))&&void 0!==e?e:0)+1;this.stats.set(Vr.CRITERION_FUNCTION_PARTIAL_CACHE_USED,t)}reset(){this.stats.clear(),this.startTimes.clear(),this.stats.set(Vr.CRITERION_FUNCTION_FULL_CACHE_USED,0),this.stats.set(Vr.CRITERION_FUNCTION_PARTIAL_CACHE_USED,0)}start(e){if(this.startTimes.get(e))throw Error(`Statistics ${e} already started`);this.startTimes.set(e,Date.now())}end(e){var t;const r=Date.now(),n=this.startTimes.get(e);if(!n)throw Error(`Statistics ${e} not started`);{let a=null!==(t=this.stats.get(e))&&void 0!==t?t:0;a+=r-n,this.stats.set(e,a),this.startTimes.delete(e)}}measure(e,t){this.start(e);const r=t();return this.end(e),r}snapshot(){return new Map(this.stats)}}
/**
 * @license
 * Copyright (c) 2022 Handsoncode. All rights reserved.
 */
class qr extends Kr{incrementCriterionFunctionFullCacheUsed(){}incrementCriterionFunctionPartialCacheUsed(){}start(e){}end(e){}}
/**
 * @license
 * Copyright (c) 2022 Handsoncode. All rights reserved.
 */
class Jr{constructor(e){this.policy=e,this.mapping=new Map}getCell(e){const t=this.mapping.get(e.sheet);if(void 0===t)throw new u(e.sheet);return t.getCell(e)}fetchCell(e){const t=this.mapping.get(e.sheet);if(void 0===t)throw new u(e.sheet);const r=t.getCell(e);if(!r)throw Error("Vertex for address missing in AddressMapping");return r}strategyFor(e){const t=this.mapping.get(e);if(void 0===t)throw new u(e);return t}addSheet(e,t){if(this.mapping.has(e))throw Error("Sheet already added");this.mapping.set(e,t)}autoAddSheet(e,t,r){const{height:n,width:a,fill:s}=r,i=this.policy.call(s);this.addSheet(e,new i(a,n))}getCellValue(e){const t=this.getCell(e);return void 0===t?rr:t instanceof nn?t.getArrayCellValue(e):t.getCellValue()}getRawValue(e){const t=this.getCell(e);return t instanceof Nn?t.getValues().rawValue:t instanceof nn?t.getArrayCellRawValue(e):null}setCell(e,t){const r=this.mapping.get(e.sheet);if(!r)throw Error("Sheet not initialized");r.setCell(e,t)}moveCell(e,t){const r=this.mapping.get(e.sheet);if(!r)throw Error("Sheet not initialized.");if(e.sheet!==t.sheet)throw Error("Cannot move cells between sheets.");if(r.has(t))throw new Error("Cannot move cell. Destination already occupied.");const n=r.getCell(e);if(void 0===n)throw new Error("Cannot move cell. No cell with such address.");this.setCell(t,n),this.removeCell(e)}removeCell(e){const t=this.mapping.get(e.sheet);if(!t)throw Error("Sheet not initialized");t.removeCell(e)}has(e){const t=this.mapping.get(e.sheet);return void 0!==t&&t.has(e)}getHeight(e){const t=this.mapping.get(e);if(void 0===t)throw new u(e);return t.getHeight()}getWidth(e){const t=this.mapping.get(e);if(!t)throw new u(e);return t.getWidth()}addRows(e,t,r){const n=this.mapping.get(e);if(void 0===n)throw new u(e);n.addRows(t,r)}removeRows(e){const t=this.mapping.get(e.sheet);if(void 0===t)throw new u(e.sheet);t.removeRows(e)}removeSheet(e){this.mapping.delete(e)}addColumns(e,t,r){const n=this.mapping.get(e);if(void 0===n)throw new u(e);n.addColumns(t,r)}removeColumns(e){const t=this.mapping.get(e.sheet);if(void 0===t)throw new u(e.sheet);t.removeColumns(e)}*verticesFromRowsSpan(e){yield*this.mapping.get(e.sheet).verticesFromRowsSpan(e)}*verticesFromColumnsSpan(e){yield*this.mapping.get(e.sheet).verticesFromColumnsSpan(e)}*entriesFromRowsSpan(e){yield*this.mapping.get(e.sheet).entriesFromRowsSpan(e)}*entriesFromColumnsSpan(e){yield*this.mapping.get(e.sheet).entriesFromColumnsSpan(e)}*entries(){for(const[e,t]of this.mapping.entries())yield*t.getEntries(e)}*sheetEntries(e){const t=this.mapping.get(e);if(void 0===t)throw new u(e);yield*t.getEntries(e)}}
/**
 * @license
 * Copyright (c) 2022 Handsoncode. All rights reserved.
 */
class Qr{constructor(){this.arrayMapping=new Map}getArray(e){const t=this.getArrayByCorner(e.start);if(null===t||void 0===t?void 0:t.getRange().sameAs(e))return t}getArrayByCorner(e){return this.arrayMapping.get(zn(e))}setArray(e,t){this.arrayMapping.set(zn(e.start),t)}removeArray(e){"string"===typeof e?this.arrayMapping.delete(e):this.arrayMapping.delete(zn(e.start))}count(){return this.arrayMapping.size}*arraysInRows(e){for(const[t,r]of this.arrayMapping.entries())r.spansThroughSheetRows(e.sheet,e.rowStart,e.rowEnd)&&(yield[t,r])}*arraysInCols(e){for(const[t,r]of this.arrayMapping.entries())r.spansThroughSheetColumn(e.sheet,e.columnStart,e.columnEnd)&&(yield[t,r])}isFormulaArrayInRow(e,t){for(const r of this.arrayMapping.values())if(r.spansThroughSheetRows(e,t))return!0;return!1}isFormulaArrayInAllRows(e){let t=!0;for(const r of e.rows())this.isFormulaArrayInRow(e.sheet,r)||(t=!1);return t}isFormulaArrayInColumn(e,t){for(const r of this.arrayMapping.values())if(r.spansThroughSheetColumn(e,t))return!0;return!1}isFormulaArrayInAllColumns(e){let t=!0;for(const r of e.columns())this.isFormulaArrayInColumn(e.sheet,r)||(t=!1);return t}isFormulaArrayInRange(e){for(const t of this.arrayMapping.values())if(t.getRange().doesOverlap(e))return!0;return!1}isFormulaArrayAtAddress(e){for(const t of this.arrayMapping.values())if(t.getRange().addressInRange(e))return!0;return!1}moveArrayVerticesAfterRowByRows(e,t,r){this.updateArrayVerticesInSheet(e,((e,n)=>{const a=n.getRange();return t<=a.start.row?[a.shifted(0,r),n]:void 0}))}moveArrayVerticesAfterColumnByColumns(e,t,r){this.updateArrayVerticesInSheet(e,((e,n)=>{const a=n.getRange();return t<=a.start.col?[a.shifted(r,0),n]:void 0}))}updateArrayVerticesInSheet(e,t){const r=Array();for(const[n,a]of this.arrayMapping.entries()){if(a.sheet!==e)continue;const s=t(n,a);void 0!==s&&(this.removeArray(n),r.push(s))}r.forEach((([e,t])=>{this.setArray(e,t)}))}}
/**
 * @license
 * Copyright (c) 2022 Handsoncode. All rights reserved.
 */
class Zr{constructor(e){this.size=e}width(){return this.size.width}height(){return this.size.height}get(e,t){throw Error("Array not computed yet.")}simpleRangeValue(){throw Error("Array not computed yet.")}}class en{constructor(e){this.size=new Gr(e.length>0?e[0].length:0,e.length),this.array=e}static fromInterpreterValue(e){return new en(e instanceof jr?e.data:[[e]])}simpleRangeValue(){return jr.onlyValues(this.array)}addRows(e,t){this.array.splice(e,0,...this.nullArrays(t,this.width())),this.size.height+=t}addColumns(e,t){for(let r=0;r<this.height();r++)this.array[r].splice(e,0,...new Array(t).fill(rr));this.size.width+=t}removeRows(e,t){if(this.outOfBound(0,e)||this.outOfBound(0,t))throw Error("Array index out of bound");const r=t-e+1;this.array.splice(e,r),this.size.height-=r}removeColumns(e,t){if(this.outOfBound(e,0)||this.outOfBound(t,0))throw Error("Array index out of bound");const r=t-e+1;for(const n of this.array)n.splice(e,r);this.size.width-=r}nullArrays(e,t){const r=[];for(let n=0;n<e;++n)r.push(new Array(t).fill(rr));return r}get(e,t){if(this.outOfBound(e,t))throw Error("Array index out of bound");return this.array[t][e]}set(e,t,r){if(this.outOfBound(e,t))throw Error("Array index out of bound");this.array[t][e]=r}width(){return this.size.width}height(){return this.size.height}raw(){return this.array}resize(e){if(this.height()<e.height&&isFinite(e.height)&&this.addRows(this.height(),e.height-this.height()),this.height()>e.height)throw"Resizing to smaller array";if(this.width()<e.width&&isFinite(e.width)&&this.addColumns(this.width(),e.width-this.width()),this.width()>e.width)throw"Resizing to smaller array"}outOfBound(e,t){return e<0||t<0||t>this.size.height-1||e>this.size.width-1}}class tn{constructor(e,t){this.error=e,this.size=t}get(e,t){return this.error}width(){return this.size.width}height(){return this.size.height}simpleRangeValue(){return this.error}}
/**
 * @license
 * Copyright (c) 2022 Handsoncode. All rights reserved.
 */
class rn{constructor(e,t,r){this.formula=e,this.cellAddress=t,this.version=r}get width(){return 1}get height(){return 1}static fromAst(e,t,r,n){return r.isScalar()?new an(e,t,n):new nn(e,t,r,n)}getFormula(e){return this.ensureRecentData(e),this.formula}ensureRecentData(e){if(this.version!=e.version()){const[t,r,n]=e.applyTransformations(this.formula,this.cellAddress,this.version);this.formula=t,this.cellAddress=r,this.version=n}}getAddress(e){return this.ensureRecentData(e),this.cellAddress}}class nn extends rn{constructor(e,t,r,n=0){super(e,t,n),r.isRef?this.array=new tn(new Fn(En.REF,It.NoSpaceForArrayResult),Gr.error()):this.array=new Zr(r)}get width(){return this.array.width()}get height(){return this.array.height()}get sheet(){return this.cellAddress.sheet}get leftCorner(){return this.cellAddress}setCellValue(e){if(e instanceof Fn)return this.setErrorValue(e),e;const t=en.fromInterpreterValue(e);return t.resize(this.array.size),this.array=t,e}getCellValue(){if(this.array instanceof Zr)throw Error("Array not computed yet.");return this.array.simpleRangeValue()}valueOrUndef(){if(!(this.array instanceof Zr))return this.array.simpleRangeValue()}getArrayCellValue(e){const t=e.col-this.cellAddress.col,r=e.row-this.cellAddress.row;try{return this.array.get(t,r)}catch(n){return new Fn(En.REF)}}getArrayCellRawValue(e){const t=this.getArrayCellValue(e);return t instanceof Fn||t===rr?void 0:nr(t)}setArrayCellValue(e,t){const r=e.col-this.cellAddress.col,n=e.row-this.cellAddress.row;this.array instanceof en&&this.array.set(r,n,t)}setNoSpace(){return this.array=new tn(new Fn(En.SPILL,It.NoSpaceForArrayResult),Gr.error()),this.getCellValue()}getRange(){return jt.spanFrom(this.cellAddress,this.width,this.height)}getRangeOrUndef(){return jt.spanFromOrUndef(this.cellAddress,this.width,this.height)}setAddress(e){this.cellAddress=e}setFormula(e){this.formula=e}spansThroughSheetRows(e,t,r=t){return this.cellAddress.sheet===e&&this.cellAddress.row<=r&&t<this.cellAddress.row+this.height}spansThroughSheetColumn(e,t,r=t){return this.cellAddress.sheet===e&&this.cellAddress.col<=r&&t<this.cellAddress.col+this.width}isComputed(){return!(this.array instanceof Zr)}columnsFromArray(){return Gt.fromNumberOfColumns(this.cellAddress.sheet,this.cellAddress.col,this.width)}rowsFromArray(){return Wt.fromNumberOfRows(this.cellAddress.sheet,this.cellAddress.row,this.height)}ensureRecentData(e){}isLeftCorner(e){return Xn(this.cellAddress,e)}setErrorValue(e){this.array=new tn(e,this.array.size)}}class an extends rn{constructor(e,t,r){super(e,t,r)}valueOrUndef(){return this.cachedCellValue}setCellValue(e){return this.cachedCellValue=e,this.cachedCellValue}getCellValue(){if(void 0!==this.cachedCellValue)return this.cachedCellValue;throw Error("Value of the formula cell is not computed.")}isComputed(){return void 0!==this.cachedCellValue}}
/**
 * @license
 * Copyright (c) 2022 Handsoncode. All rights reserved.
 */
class sn{constructor(e){this.range=e,this.functionCache=new Map,this.criterionFunctionCache=new Map,this.dependentCacheRanges=new Set,this.bruteForce=!1}get start(){return this.range.start}get end(){return this.range.end}get sheet(){return this.range.start.sheet}getFunctionValue(e){return this.functionCache.get(e)}setFunctionValue(e,t){this.functionCache.set(e,t)}getCriterionFunctionValue(e,t){var r;return null===(r=this.getCriterionFunctionValues(e).get(t))||void 0===r?void 0:r[0]}getCriterionFunctionValues(e){var t;return null!==(t=this.criterionFunctionCache.get(e))&&void 0!==t?t:new Map}setCriterionFunctionValues(e,t){this.criterionFunctionCache.set(e,t)}addDependentCacheRange(e){e!==this&&this.dependentCacheRanges.add(e)}clearCache(){this.functionCache.clear(),this.criterionFunctionCache.clear(),this.dependentCacheRanges.forEach((e=>e.criterionFunctionCache.clear())),this.dependentCacheRanges.clear()}getStart(){return this.start}getEnd(){return this.end}}
/**
 * @license
 * Copyright (c) 2022 Handsoncode. All rights reserved.
 */
const on=(e,t,r,n,a)=>{if(t instanceof sn){const e=t.range.intersectionWith(r);return void 0!==e?Array.from(e.addresses(a)):[]}let s,i;return t instanceof rn?(s=t.getFormula(n),i=t.getAddress(n),xt(s,e).filter((e=>e instanceof Ft)).map((e=>e.dependency.toSimpleCellAddress(i))).filter((e=>r.addressInRange(e)))):[]};
/**
 * @license
 * Copyright (c) 2022 Handsoncode. All rights reserved.
 */
var cn;(function(e){e[e["ON_STACK"]=0]="ON_STACK",e[e["PROCESSED"]=1]="PROCESSED",e[e["POPPED"]=2]="POPPED"})(cn||(cn={}));class ln{constructor(e){this.dependencyQuery=e,this.nodes=new Set,this.specialNodes=new Set,this.specialNodesStructuralChanges=new Set,this.specialNodesRecentlyChanged=new Set,this.infiniteRanges=new Set,this.edges=new Map}addNode(e){this.nodes.add(e),this.edges.has(e)||this.edges.set(e,new Set)}addEdge(e,t){if(!this.nodes.has(e))throw new Error(`Unknown node ${e}`);if(!this.nodes.has(t))throw new Error(`Unknown node ${t}`);this.edges.get(e).add(t)}removeEdge(e,t){if(!this.existsEdge(e,t))throw new Error("Edge does not exist");this.edges.get(e).delete(t)}softRemoveEdge(e,t){var r;null===(r=this.edges.get(e))||void 0===r||r.delete(t)}removeIncomingEdges(e){this.edges.forEach((t=>{t.delete(e)}))}adjacentNodes(e){return this.edges.get(e)}adjacentNodesCount(e){return this.adjacentNodes(e).size}hasNode(e){return this.nodes.has(e)}nodesCount(){return this.nodes.size}edgesCount(){let e=0;return this.edges.forEach((t=>e+=t.size)),e}removeNode(e){for(const t of this.adjacentNodes(e).values())this.markNodeAsSpecialRecentlyChanged(t);return this.edges.delete(e),this.nodes.delete(e),this.specialNodes.delete(e),this.specialNodesRecentlyChanged.delete(e),this.specialNodesStructuralChanges.delete(e),this.infiniteRanges.delete(e),this.removeDependencies(e)}markNodeAsSpecial(e){this.specialNodes.add(e)}markNodeAsSpecialRecentlyChanged(e){this.nodes.has(e)&&this.specialNodesRecentlyChanged.add(e)}markNodeAsChangingWithStructure(e){this.specialNodesStructuralChanges.add(e)}clearSpecialNodesRecentlyChanged(){this.specialNodesRecentlyChanged.clear()}markNodeAsInfiniteRange(e){this.infiniteRanges.add(e)}existsEdge(e,t){var r,n;return null!==(n=null===(r=this.edges.get(e))||void 0===r?void 0:r.has(t))&&void 0!==n&&n}topSortWithScc(){return this.getTopSortedWithSccSubgraphFrom(Array.from(this.nodes),(()=>!0),(()=>{}))}getTopSortedWithSccSubgraphFrom(e,t,r){const n=new Map,a=new Map,s=new Map,i=new Set,o=new Map,c=[];let l=0;const u=new Set;e.reverse(),e.forEach((e=>{if(void 0!==o.get(e))return;const t=[e],r=[];o.set(e,cn.ON_STACK);while(t.length>0){const e=t[t.length-1];switch(o.get(e)){case cn.ON_STACK:n.set(e,l),a.set(e,l),r.push(e),l++,this.adjacentNodes(e).forEach((r=>{void 0===n.get(r)&&(t.push(r),s.set(r,e),o.set(r,cn.ON_STACK))})),o.set(e,cn.PROCESSED);break;case cn.PROCESSED:{let l;if(l=n.get(e),this.adjacentNodes(e).forEach((t=>{i.has(t)||(l=s.get(t)===e?Math.min(l,a.get(t)):Math.min(l,n.get(t)))})),a.set(e,l),l===n.get(e)){const t=[];do{t.push(r[r.length-1]),r.pop()}while(t[t.length-1]!==e);t.forEach((e=>{i.add(e)})),c.push(...t),t.length>1&&t.forEach((e=>{u.add(e)}))}t.pop(),o.set(e,cn.POPPED);break}case cn.POPPED:t.pop();break}}}));const h=new Set(e),f=[],d=[];return c.reverse(),c.forEach((e=>{u.has(e)||this.adjacentNodes(e).has(e)?(d.push(e),r(e),this.adjacentNodes(e).forEach((e=>h.add(e)))):(f.push(e),h.has(e)&&t(e)&&this.adjacentNodes(e).forEach((e=>h.add(e))))})),{sorted:f,cycled:d}}getDependencies(e){const t=[];return this.edges.forEach(((r,n)=>{r.has(e)&&t.push(n)})),t}removeDependencies(e){const t=this.dependencyQuery(e);for(const r of t)this.softRemoveEdge(r,e);return t}}
/**
 * @license
 * Copyright (c) 2022 Handsoncode. All rights reserved.
 */
class un{constructor(){this.rangeMapping=new Map}getMappingSize(e){var t,r;return null!==(r=null===(t=this.rangeMapping.get(e))||void 0===t?void 0:t.size)&&void 0!==r?r:0}setRange(e){let t=this.rangeMapping.get(e.getStart().sheet);void 0===t&&(t=new Map,this.rangeMapping.set(e.getStart().sheet,t));const r=hn(e.getStart(),e.getEnd());t.set(r,e)}removeRange(e){const t=e.getStart().sheet,r=this.rangeMapping.get(t);if(void 0===r)return;const n=hn(e.getStart(),e.getEnd());r.delete(n),0===r.size&&this.rangeMapping.delete(t)}getRange(e,t){const r=this.rangeMapping.get(e.sheet),n=hn(e,t);return null===r||void 0===r?void 0:r.get(n)}fetchRange(e,t){const r=this.getRange(e,t);if(!r)throw Error("Range does not exist");return r}truncateRanges(e,t){const r=Array(),n=Array(),a=Array(),s=e.sheet;for(const[o,c]of this.entriesFromSheet(e.sheet)){const i=c.range;e.start<=t(c.range.end)&&(i.removeSpan(e),i.shouldBeRemoved()?(this.removeByKey(s,o),r.push(c)):n.push([o,c]),a.push(c))}const i=[];n.sort(((e,r)=>dn(e[1],r[1],t)));for(const[o,c]of n){const e=fn(c.range);if(e===o)continue;const t=this.getByKey(s,e);this.removeByKey(s,o),void 0!==t&&c!=t?i.push([t,c]):this.setRange(c)}return{verticesToRemove:r,verticesToMerge:i,verticesWithChangedSize:a}}moveAllRangesInSheetAfterRowByRows(e,t,r){return this.updateVerticesFromSheet(e,((e,n)=>t<=n.start.row?(n.range.shiftByRows(r),{changedSize:!1,vertex:n}):t>n.start.row&&t<=n.end.row?(n.range.expandByRows(r),{changedSize:!0,vertex:n}):void 0))}moveAllRangesInSheetAfterColumnByColumns(e,t,r){return this.updateVerticesFromSheet(e,((e,n)=>t<=n.start.col?(n.range.shiftByColumns(r),{changedSize:!1,vertex:n}):t>n.start.col&&t<=n.end.col?(n.range.expandByColumns(r),{changedSize:!0,vertex:n}):void 0))}moveRangesInsideSourceRange(e,t,r,n){this.updateVerticesFromSheet(e.sheet,((a,s)=>e.containsRange(s.range)?(s.range.shiftByColumns(t),s.range.shiftByRows(r),s.range.moveToSheet(n),{changedSize:!1,vertex:s}):void 0))}removeRangesInSheet(e){if(this.rangeMapping.has(e)){const t=this.rangeMapping.get(e).values();return this.rangeMapping.delete(e),t}return[][Symbol.iterator]()}*rangesInSheet(e){const t=this.rangeMapping.get(e);t&&(yield*t.values())}*rangeVerticesContainedInRange(e){for(const t of this.rangesInSheet(e.sheet))e.containsRange(t.range)&&(yield t)}findSmallerRange(e){if(e.height()>1&&Number.isFinite(e.height())){const t=Wn(e.end.sheet,e.end.col,e.end.row-1),r=this.getRange(e.start,t);if(void 0!==r){const t=new jt(Wn(e.start.sheet,e.start.col,e.end.row),e.end);return{smallerRangeVertex:r,restRange:t}}}return{restRange:e}}*entriesFromSheet(e){const t=this.rangeMapping.get(e);t&&(yield*t.entries())}removeByKey(e,t){this.rangeMapping.get(e).delete(t)}getByKey(e,t){var r;return null===(r=this.rangeMapping.get(e))||void 0===r?void 0:r.get(t)}updateVerticesFromSheet(e,t){const r=Array();for(const[n,a]of this.entriesFromSheet(e)){const s=t(n,a);void 0!==s&&(this.removeByKey(e,n),r.push(s))}return r.forEach((e=>{this.setRange(e.vertex)})),{verticesWithChangedSize:r.filter((e=>e.changedSize)).map((e=>e.vertex))}}}function hn(e,t){return`${e.col},${e.row},${t.col},${t.row}`}function fn(e){return hn(e.start,e.end)}const dn=(e,t,r)=>{const n=r(e.range.start),a=r(e.range.start);if(n===a){const n=r(e.range.end),a=r(t.range.end);return n-a}return n-a};
/**
 * @license
 * Copyright (c) 2022 Handsoncode. All rights reserved.
 */
class pn{constructor(e,t,r){this.functions=e,this.errors=t,this.ui=r,this._protectedTranslations={VERSION:"VERSION"},this.checkUI(),this.checkErrors(),this.checkFunctionTranslations(this.functions),Object.assign(this.functions,this._protectedTranslations)}extendFunctions(e){this.checkFunctionTranslations(e),Object.assign(this.functions,e)}buildFunctionMapping(){return Object.keys(this.functions).reduce(((e,t)=>(e[this.functions[t]]=t,e)),{})}buildErrorMapping(){return Object.keys(this.errors).reduce(((e,t)=>(e[this.errors[t]]=t,e)),{})}isFunctionTranslated(e){return void 0!==this.functions[e]}getFunctionTranslations(e){const t=[];for(const r of e)this.isFunctionTranslated(r)&&t.push(this.functions[r]);return t}getFunctionTranslation(e){const t=this.functions[e];if(void 0===t)throw new L(`functions.${e}`);return t}getMaybeFunctionTranslation(e){return this.functions[e]}getErrorTranslation(e){if(e===En.LIC)return`#${En.LIC}!`;const t=this.errors[e];if(void 0===t)throw new L(`errors.${e}`);return t}getUITranslation(e){const t=this.ui[e];if(void 0===t)throw new L(`ui.${e}`);return t}checkUI(){for(const e of Object.values(gn))if(!(e in this.ui))throw new L(`ui.${e}`)}checkErrors(){for(const e of Object.values(En))if(!(e in this.errors)&&e!==En.LIC)throw new L(`errors.${e}`)}checkFunctionTranslations(e){const t=new Set(Object.getOwnPropertyNames(e));for(const r of Object.getOwnPropertyNames(this._protectedTranslations))if(t.has(r))throw new k(r)}}function mn(e){return new pn(Object.assign({},e.functions),Object.assign({},e.errors),Object.assign({},e.ui))}
/**
 * @license
 * Copyright (c) 2022 Handsoncode. All rights reserved.
 */
var gn,En,vn;
/**
 * @license
 * Copyright (c) 2022 Handsoncode. All rights reserved.
 */
function Tn(e){return e.toLowerCase()}(function(e){e["NEW_SHEET_PREFIX"]="NEW_SHEET_PREFIX"})(gn||(gn={}));class Sn{constructor(e,t){this.id=e,this.displayName=t}get canonicalName(){return Tn(this.displayName)}}class An{constructor(e){this.languages=e,this.mappingFromCanonicalName=new Map,this.mappingFromId=new Map,this.lastSheetId=-1,this.fetch=e=>{const t=this.mappingFromCanonicalName.get(Tn(e));if(void 0===t)throw new h(e);return t.id},this.get=e=>{var t;return null===(t=this.mappingFromCanonicalName.get(Tn(e)))||void 0===t?void 0:t.id},this.fetchDisplayName=e=>this.fetchSheetById(e).displayName,this.sheetNamePrefix=e.getUITranslation(gn.NEW_SHEET_PREFIX)}addSheet(e=`${this.sheetNamePrefix}${this.lastSheetId+2}`){const t=Tn(e);if(this.mappingFromCanonicalName.has(t))throw new f(e);this.lastSheetId++;const r=new Sn(this.lastSheetId,e);return this.store(r),r.id}removeSheet(e){const t=this.fetchSheetById(e);e==this.lastSheetId&&--this.lastSheetId,this.mappingFromCanonicalName.delete(t.canonicalName),this.mappingFromId.delete(t.id)}getDisplayName(e){var t;return null===(t=this.mappingFromId.get(e))||void 0===t?void 0:t.displayName}*displayNames(){for(const e of this.mappingFromCanonicalName.values())yield e.displayName}numberOfSheets(){return this.mappingFromCanonicalName.size}hasSheetWithId(e){return this.mappingFromId.has(e)}hasSheetWithName(e){return this.mappingFromCanonicalName.has(Tn(e))}renameSheet(e,t){const r=this.fetchSheetById(e),n=r.displayName;if(n===t)return;const a=this.mappingFromCanonicalName.get(Tn(t));if(void 0!==a&&a.id!==r.id)throw new f(t);const s=r.canonicalName;return this.mappingFromCanonicalName.delete(s),r.displayName=t,this.store(r),n}sheetNames(){return Array.from(this.mappingFromId.values()).map((e=>e.displayName))}store(e){this.mappingFromId.set(e.id,e),this.mappingFromCanonicalName.set(e.canonicalName,e)}fetchSheetById(e){const t=this.mappingFromId.get(e);if(void 0===t)throw new u(e);return t}}
/**
 * @license
 * Copyright (c) 2022 Handsoncode. All rights reserved.
 */
class Rn{constructor(e,t,r,n,a,s,i,o){this.addressMapping=e,this.rangeMapping=t,this.sheetMapping=r,this.arrayMapping=n,this.stats=a,this.lazilyTransformingAstService=s,this.functionRegistry=i,this.namedExpressions=o,this.changes=Xr.empty(),this.dependencyQueryAddresses=e=>{if(e instanceof sn)return this.rangeDependencyQuery(e).map((([e,t])=>e));{const t=this.formulaDependencyQuery(e);if(void 0!==t){const[e,r]=t;return r.map((t=>t instanceof Vt?this.namedExpressions.namedExpressionOrPlaceholder(t.name,e.sheet).address:$n(t)?t:$t(t.start,t.end)))}return[]}},this.dependencyQueryVertices=e=>{if(e instanceof sn)return this.rangeDependencyQuery(e).map((([e,t])=>t));{const t=this.formulaDependencyQuery(e);if(void 0!==t){const[e,r]=t;return r.map((t=>{if(t instanceof jt)return this.rangeMapping.fetchRange(t.start,t.end);if(t instanceof Vt){const r=this.namedExpressions.namedExpressionOrPlaceholder(t.name,e.sheet);return this.addressMapping.fetchCell(r.address)}return this.addressMapping.fetchCell(t)}))}return[]}},this.rangeDependencyQuery=e=>{const t=[],{smallerRangeVertex:r,restRange:n}=this.rangeMapping.findSmallerRange(e.range);let a;void 0!==r&&this.graph.adjacentNodes(r).has(e)?(a=n,t.push([new jt(r.start,r.end),r])):a=e.range;for(const s of a.addresses(this)){const e=this.addressMapping.getCell(s);e instanceof yn&&(e.address=s),void 0!==e&&t.push([s,e])}return t},this.formulaDependencyQuery=e=>{let t,r;if(!(e instanceof rn))return;r=e.getAddress(this.lazilyTransformingAstService),t=e.getFormula(this.lazilyTransformingAstService);const n=xt(t,this.functionRegistry);return[r,qt(n,r)]},this.graph=new ln(this.dependencyQueryVertices)}static buildEmpty(e,t,r,n,a){return new Rn(new Jr(t.chooseAddressMappingPolicy),new un,new An(t.translationPackage),new Qr,a,e,r,n)}setFormulaToCell(e,t,r,n,a,s){const i=rn.fromAst(t,e,n,this.lazilyTransformingAstService.version());return this.exchangeOrAddFormulaVertex(i),this.processCellDependencies(r,i),this.graph.markNodeAsSpecialRecentlyChanged(i),a&&this.markAsVolatile(i),s&&this.markAsDependentOnStructureChange(i),this.correctInfiniteRangesDependency(e),this.getAndClearContentChanges()}setParsingErrorToCell(e,t){const r=this.shrinkPossibleArrayAndGetCell(e);return this.exchangeOrAddGraphNode(r,t),this.addressMapping.setCell(e,t),this.graph.markNodeAsSpecialRecentlyChanged(t),this.correctInfiniteRangesDependency(e),this.getAndClearContentChanges()}setValueToCell(e,t){const r=this.shrinkPossibleArrayAndGetCell(e);if(r instanceof nn&&this.arrayMapping.removeArray(r.getRange()),r instanceof Nn){const e=r.getValues();e.rawValue!==t.rawValue&&(r.setValues(t),this.graph.markNodeAsSpecialRecentlyChanged(r))}else{const n=new Nn(t.parsedValue,t.rawValue);this.exchangeOrAddGraphNode(r,n),this.addressMapping.setCell(e,n),this.graph.markNodeAsSpecialRecentlyChanged(n)}return this.correctInfiniteRangesDependency(e),this.getAndClearContentChanges()}setCellEmpty(e){const t=this.shrinkPossibleArrayAndGetCell(e);if(void 0===t)return Xr.empty();if(this.graph.adjacentNodes(t).size>0){const r=new yn(e);this.exchangeGraphNode(t,r),0===this.graph.adjacentNodesCount(r)?(this.removeVertex(r),this.addressMapping.removeCell(e)):(this.graph.markNodeAsSpecialRecentlyChanged(r),this.addressMapping.setCell(e,r))}else this.removeVertex(t),this.addressMapping.removeCell(e);return this.getAndClearContentChanges()}ensureThatVertexIsNonArrayCellVertex(e){if(e instanceof nn)throw new Error("Illegal operation")}clearRecentlyChangedVertices(){this.graph.clearSpecialNodesRecentlyChanged()}verticesToRecompute(){return new Set([...this.graph.specialNodesRecentlyChanged,...this.volatileVertices()])}processCellDependencies(e,t){e.forEach((e=>{if(e instanceof jt){const r=e;let n=this.getRange(r.start,r.end);void 0===n&&(n=new sn(r),this.rangeMapping.setRange(n)),this.graph.addNode(n),r.isFinite()||this.graph.markNodeAsInfiniteRange(n);const{smallerRangeVertex:a,restRange:s}=this.rangeMapping.findSmallerRange(r);if(void 0!==a){if(this.graph.addEdge(a,n),n.bruteForce){n.bruteForce=!1;for(const e of r.addresses(this))this.graph.removeEdge(this.fetchCell(e),n)}}else n.bruteForce=!0;const i=this.arrayMapping.getArray(s);if(void 0!==i)this.graph.addEdge(i,n);else for(const e of s.addresses(this))this.graph.addEdge(this.fetchCellOrCreateEmpty(e),n);this.graph.addEdge(n,t),r.isFinite()&&this.correctInfiniteRangesDependenciesByRangeVertex(n)}else if(e instanceof Vt){const r=t.getAddress(this.lazilyTransformingAstService).sheet,n=this.fetchNamedExpressionVertex(e.name,r);this.graph.addEdge(n,t)}else this.graph.addEdge(this.fetchCellOrCreateEmpty(e),t)}))}fetchNamedExpressionVertex(e,t){const r=this.namedExpressions.namedExpressionOrPlaceholder(e,t);return this.fetchCellOrCreateEmpty(r.address)}exchangeNode(e,t){const r=this.fetchCellOrCreateEmpty(e),n=this.fetchCellOrCreateEmpty(t);this.addressMapping.removeCell(e),this.exchangeGraphNode(r,n)}correctInfiniteRangesDependency(e){let t;for(const r of this.graph.infiniteRanges){const n=r;n.range.addressInRange(e)&&(t=null!==t&&void 0!==t?t:this.fetchCellOrCreateEmpty(e),this.graph.addEdge(t,n))}}fetchCellOrCreateEmpty(e){let t=this.addressMapping.getCell(e);return void 0===t&&(t=new yn(e),this.graph.addNode(t),this.addressMapping.setCell(e,t)),t}removeRows(e){this.stats.measure(Vr.ADJUSTING_GRAPH,(()=>{for(const[t,r]of this.addressMapping.entriesFromRowsSpan(e)){for(const e of this.graph.adjacentNodes(r))this.graph.markNodeAsSpecialRecentlyChanged(e);if(r instanceof nn){if(!r.isLeftCorner(t))continue;this.shrinkArrayToCorner(r),this.arrayMapping.removeArray(r.getRange())}this.removeVertex(r)}})),this.stats.measure(Vr.ADJUSTING_ADDRESS_MAPPING,(()=>{this.addressMapping.removeRows(e)}));const t=this.stats.measure(Vr.ADJUSTING_RANGES,(()=>{const t=this.truncateRanges(e,(e=>e.row));return this.getArrayVerticesRelatedToRanges(t)}));return this.stats.measure(Vr.ADJUSTING_ARRAY_MAPPING,(()=>{this.fixArraysAfterRemovingRows(e.sheet,e.rowStart,e.numberOfRows)})),this.addStructuralNodesToChangeSet(),{affectedArrays:t,contentChanges:this.getAndClearContentChanges()}}removeSheet(e){const t=new Set;for(const[r,n]of this.addressMapping.sheetEntries(e)){if(n instanceof nn){if(t.has(n))continue;t.add(n)}for(const e of this.graph.adjacentNodes(n))this.graph.markNodeAsSpecialRecentlyChanged(e);this.removeVertex(n),this.addressMapping.removeCell(r)}this.stats.measure(Vr.ADJUSTING_ARRAY_MAPPING,(()=>{for(const e of t.values())this.arrayMapping.removeArray(e.getRange())})),this.stats.measure(Vr.ADJUSTING_RANGES,(()=>{const t=this.rangeMapping.removeRangesInSheet(e);for(const e of t)this.removeVertex(e);this.stats.measure(Vr.ADJUSTING_ADDRESS_MAPPING,(()=>{this.addressMapping.removeSheet(e)}))})),this.addStructuralNodesToChangeSet()}clearSheet(e){const t=new Set;for(const[r,n]of this.addressMapping.sheetEntries(e))n instanceof nn?t.add(n):this.setCellEmpty(r);for(const r of t.values())this.setArrayEmpty(r);this.addStructuralNodesToChangeSet()}removeColumns(e){this.stats.measure(Vr.ADJUSTING_GRAPH,(()=>{for(const[t,r]of this.addressMapping.entriesFromColumnsSpan(e)){for(const e of this.graph.adjacentNodes(r))this.graph.markNodeAsSpecialRecentlyChanged(e);if(r instanceof nn){if(!r.isLeftCorner(t))continue;this.shrinkArrayToCorner(r),this.arrayMapping.removeArray(r.getRange())}this.removeVertex(r)}})),this.stats.measure(Vr.ADJUSTING_ADDRESS_MAPPING,(()=>{this.addressMapping.removeColumns(e)}));const t=this.stats.measure(Vr.ADJUSTING_RANGES,(()=>{const t=this.truncateRanges(e,(e=>e.col));return this.getArrayVerticesRelatedToRanges(t)}));return this.stats.measure(Vr.ADJUSTING_ARRAY_MAPPING,(()=>this.fixArraysAfterRemovingColumns(e.sheet,e.columnStart,e.numberOfColumns))),this.addStructuralNodesToChangeSet(),{affectedArrays:t,contentChanges:this.getAndClearContentChanges()}}addRows(e){this.stats.measure(Vr.ADJUSTING_ADDRESS_MAPPING,(()=>{this.addressMapping.addRows(e.sheet,e.rowStart,e.numberOfRows)}));const t=this.stats.measure(Vr.ADJUSTING_RANGES,(()=>{const t=this.rangeMapping.moveAllRangesInSheetAfterRowByRows(e.sheet,e.rowStart,e.numberOfRows);return this.fixRangesWhenAddingRows(e.sheet,e.rowStart,e.numberOfRows),this.getArrayVerticesRelatedToRanges(t.verticesWithChangedSize)}));this.stats.measure(Vr.ADJUSTING_ARRAY_MAPPING,(()=>{this.fixArraysAfterAddingRow(e.sheet,e.rowStart,e.numberOfRows)}));for(const r of this.addressMapping.verticesFromRowsSpan(e))this.graph.markNodeAsSpecialRecentlyChanged(r);return this.addStructuralNodesToChangeSet(),{affectedArrays:t}}addColumns(e){this.stats.measure(Vr.ADJUSTING_ADDRESS_MAPPING,(()=>{this.addressMapping.addColumns(e.sheet,e.columnStart,e.numberOfColumns)}));const t=this.stats.measure(Vr.ADJUSTING_RANGES,(()=>{const t=this.rangeMapping.moveAllRangesInSheetAfterColumnByColumns(e.sheet,e.columnStart,e.numberOfColumns);return this.fixRangesWhenAddingColumns(e.sheet,e.columnStart,e.numberOfColumns),this.getArrayVerticesRelatedToRanges(t.verticesWithChangedSize)}));this.stats.measure(Vr.ADJUSTING_ARRAY_MAPPING,(()=>this.fixArraysAfterAddingColumn(e.sheet,e.columnStart,e.numberOfColumns)));for(const r of this.addressMapping.verticesFromColumnsSpan(e))this.graph.markNodeAsSpecialRecentlyChanged(r);return this.addStructuralNodesToChangeSet(),{affectedArrays:t,contentChanges:this.getAndClearContentChanges()}}ensureNoArrayInRange(e){if(this.arrayMapping.isFormulaArrayInRange(e))throw Error("It is not possible to move / replace cells with array")}isThereSpaceForArray(e){const t=e.getRangeOrUndef();if(void 0===t)return!1;for(const r of t.addresses(this)){const t=this.addressMapping.getCell(r);if(void 0!==t&&!(t instanceof yn)&&t!==e)return!1}return!0}moveCells(e,t,r,n){for(const a of e.addressesWithDirection(t,r,this)){const s=Wn(n,a.col+t,a.row+r);let i=this.addressMapping.getCell(a);const o=this.addressMapping.getCell(s);if(this.addressMapping.removeCell(a),void 0!==i){let t;this.graph.markNodeAsSpecialRecentlyChanged(i),this.addressMapping.setCell(s,i);for(const r of this.graph.adjacentNodes(i))r instanceof sn&&!e.containsRange(r.range)&&(t=null!==t&&void 0!==t?t:this.fetchCellOrCreateEmpty(a),this.graph.addEdge(t,r),this.graph.removeEdge(i,r));t&&(this.graph.markNodeAsSpecialRecentlyChanged(t),this.addressMapping.setCell(a,t))}if(void 0!==o){void 0===i&&this.addressMapping.removeCell(s);for(const e of this.graph.adjacentNodes(o))i=null!==i&&void 0!==i?i:this.fetchCellOrCreateEmpty(s),this.graph.addEdge(i,e),this.graph.markNodeAsSpecialRecentlyChanged(i);this.removeVertex(o)}}for(const a of this.rangeMapping.rangeVerticesContainedInRange(e))for(const t of this.graph.adjacentNodes(a))if(t instanceof sn&&!e.containsRange(t.range)){this.graph.removeEdge(a,t);for(const e of a.range.addresses(this)){const r=this.fetchCellOrCreateEmpty(e);this.graph.addEdge(r,t),this.addressMapping.setCell(e,r),this.graph.markNodeAsSpecialRecentlyChanged(r)}}this.rangeMapping.moveRangesInsideSourceRange(e,t,r,n)}setArrayEmpty(e){const t=jt.spanFrom(e.getAddress(this.lazilyTransformingAstService),e.width,e.height),r=this.graph.adjacentNodes(e);for(const n of t.addresses(this))this.addressMapping.removeCell(n);for(const n of r.values()){const t=on(this.functionRegistry,n,e.getRange(),this.lazilyTransformingAstService,this);for(const e of t){const t=this.fetchCellOrCreateEmpty(e);this.graph.addEdge(t,n)}t.length>0&&this.graph.markNodeAsSpecialRecentlyChanged(n)}this.removeVertex(e),this.arrayMapping.removeArray(e.getRange())}addVertex(e,t){this.graph.addNode(t),this.addressMapping.setCell(e,t)}addArrayVertex(e,t){this.graph.addNode(t),this.setAddressMappingForArrayVertex(t,e)}*arrayFormulaNodes(){for(const e of this.graph.nodes)e instanceof nn&&(yield e)}*entriesFromRowsSpan(e){yield*this.addressMapping.entriesFromRowsSpan(e)}*entriesFromColumnsSpan(e){yield*this.addressMapping.entriesFromColumnsSpan(e)}existsVertex(e){return this.addressMapping.has(e)}fetchCell(e){return this.addressMapping.fetchCell(e)}getCell(e){return this.addressMapping.getCell(e)}getCellValue(e){return this.addressMapping.getCellValue(e)}getRawValue(e){return this.addressMapping.getRawValue(e)}getScalarValue(e){const t=this.addressMapping.getCellValue(e);return t instanceof jr?new Fn(En.VALUE,It.ScalarExpected):t}existsEdge(e,t){return this.graph.existsEdge(e,t)}getSheetId(e){return this.sheetMapping.fetch(e)}getSheetHeight(e){return this.addressMapping.getHeight(e)}getSheetWidth(e){return this.addressMapping.getWidth(e)}getArray(e){return this.arrayMapping.getArray(e)}setArray(e,t){this.arrayMapping.setArray(e,t)}getRange(e,t){return this.rangeMapping.getRange(e,t)}topSortWithScc(){return this.graph.topSortWithScc()}markAsVolatile(e){this.graph.markNodeAsSpecial(e)}markAsDependentOnStructureChange(e){this.graph.markNodeAsChangingWithStructure(e)}forceApplyPostponedTransformations(){for(const e of this.graph.nodes.values())e instanceof an&&e.ensureRecentData(this.lazilyTransformingAstService)}volatileVertices(){return this.graph.specialNodes}getArrayVerticesRelatedToRanges(e){const t=e.map((e=>this.graph.hasNode(e)?Array.from(this.graph.adjacentNodes(e)).filter((e=>e instanceof nn)):[]));return new Set(...t)}*rawValuesFromRange(e){for(const t of e.addresses(this)){const e=this.getScalarValue(t);e!==rr&&(yield[nr(e),t])}}*entriesFromRange(e){for(const t of e.addresses(this))yield[t,this.getCell(t)]}exchangeGraphNode(e,t){this.graph.addNode(t);const r=this.graph.adjacentNodes(e);this.removeVertex(e),r.forEach((e=>{this.graph.hasNode(e)&&this.graph.addEdge(t,e)}))}exchangeOrAddGraphNode(e,t){e?this.exchangeGraphNode(e,t):this.graph.addNode(t)}computeListOfValuesInRange(e){const t=[];for(const r of e.addresses(this)){const e=this.getScalarValue(r);t.push(e)}return t}shrinkArrayToCorner(e){this.cleanAddressMappingUnderArray(e);for(const t of this.adjacentArrayVertices(e)){let r;r=t instanceof rn?this.formulaDirectDependenciesToArray(t,e):this.rangeDirectDependenciesToArray(t,e);let n=!1;for(const[a,s]of r)e.isLeftCorner(a)&&(n=!0),this.graph.addEdge(s,t),this.graph.markNodeAsSpecialRecentlyChanged(s);n||this.graph.removeEdge(e,t)}this.graph.markNodeAsSpecialRecentlyChanged(e)}isArrayInternalCell(e){const t=this.getCell(e);return t instanceof nn&&!t.isLeftCorner(e)}getAndClearContentChanges(){const e=this.changes;return this.changes=Xr.empty(),e}getAdjacentNodesAddresses(e){const t=this.graph.adjacentNodes(e),r=[];return t.forEach((e=>{const t=e;t instanceof sn?r.push($t(t.start,t.end)):r.push(t.getAddress(this.lazilyTransformingAstService))})),r}correctInfiniteRangesDependenciesByRangeVertex(e){for(const t of this.graph.infiniteRanges){const r=t,n=e.range.intersectionWith(r.range);if(void 0!==n)for(const e of n.addresses(this))this.graph.addEdge(this.fetchCellOrCreateEmpty(e),t)}}cleanAddressMappingUnderArray(e){const t=e.getRange();for(const r of t.addresses(this)){const t=e.getArrayCellValue(r);this.getCell(r)===e?e.isLeftCorner(r)?this.changes.addChange(new Fn(En.REF),r,t):(this.addressMapping.removeCell(r),this.changes.addChange(rr,r,t)):this.changes.addChange(rr,r,t)}}*formulaDirectDependenciesToArray(e,t){var r;const[,n]=null!==(r=this.formulaDependencyQuery(e))&&void 0!==r?r:[];if(void 0!==n)for(const a of n)if(!(a instanceof Vt||a instanceof jt)&&t.getRange().addressInRange(a)){const e=this.fetchCellOrCreateEmpty(a);yield[a,e]}}*rangeDirectDependenciesToArray(e,t){const{restRange:r}=this.rangeMapping.findSmallerRange(e.range);for(const n of r.addresses(this))if(t.getRange().addressInRange(n)){const e=this.fetchCellOrCreateEmpty(n);yield[n,e]}}*adjacentArrayVertices(e){const t=this.graph.adjacentNodes(e);for(const r of t)(r instanceof rn||r instanceof sn)&&(yield r)}addStructuralNodesToChangeSet(){for(const e of this.graph.specialNodesStructuralChanges)this.graph.markNodeAsSpecialRecentlyChanged(e)}fixRangesWhenAddingRows(e,t,r){const n=Array.from(this.rangeMapping.rangesInSheet(e));for(const a of n)if(a.range.includesRow(t+r))if(a.bruteForce){const e=a.range.rangeWithSameWidth(t,r);for(const t of e.addresses(this))this.graph.addEdge(this.fetchCellOrCreateEmpty(t),a)}else{let e=a,t=this.rangeMapping.findSmallerRange(e.range);if(void 0!==t.smallerRangeVertex)continue;while(void 0===t.smallerRangeVertex){const r=new sn(jt.spanFrom(e.range.start,e.range.width(),e.range.height()-1));this.rangeMapping.setRange(r),this.graph.addNode(r);const n=new jt(Wn(e.range.start.sheet,e.range.start.col,e.range.end.row),e.range.end);this.addAllFromRange(n,e),this.graph.addEdge(r,e),e=r,t=this.rangeMapping.findSmallerRange(e.range)}this.graph.addEdge(t.smallerRangeVertex,e),this.addAllFromRange(t.restRange,e),this.graph.removeEdge(t.smallerRangeVertex,a)}}addAllFromRange(e,t){for(const r of e.addresses(this))this.graph.addEdge(this.fetchCellOrCreateEmpty(r),t)}fixRangesWhenAddingColumns(e,t,r){for(const n of this.rangeMapping.rangesInSheet(e))if(n.range.includesColumn(t+r)){let a;a=n.bruteForce?n.range.rangeWithSameHeight(t,r):jt.spanFrom(Wn(e,t,n.range.end.row),r,1);for(const e of a.addresses(this))this.graph.addEdge(this.fetchCellOrCreateEmpty(e),n)}}exchangeOrAddFormulaVertex(e){const t=e.getAddress(this.lazilyTransformingAstService),r=jt.spanFrom(t,e.width,e.height),n=this.shrinkPossibleArrayAndGetCell(t);if(e instanceof nn&&this.setArray(r,e),this.exchangeOrAddGraphNode(n,e),this.addressMapping.setCell(t,e),e instanceof nn){if(!this.isThereSpaceForArray(e))return;for(const t of r.addresses(this)){if(e.isLeftCorner(t))continue;const r=this.getCell(t);this.exchangeOrAddGraphNode(r,e)}}for(const a of r.addresses(this))this.addressMapping.setCell(a,e)}setAddressMappingForArrayVertex(e,t){if(this.addressMapping.setCell(t,e),!(e instanceof nn))return;const r=jt.spanFromOrUndef(t,e.width,e.height);if(void 0!==r&&(this.setArray(r,e),this.isThereSpaceForArray(e)))for(const n of r.addresses(this))this.addressMapping.setCell(n,e)}truncateRanges(e,t){const{verticesToRemove:r,verticesToMerge:n,verticesWithChangedSize:a}=this.rangeMapping.truncateRanges(e,t);for(const[s,i]of n)this.mergeRangeVertices(s,i);for(const s of r)this.removeVertexAndCleanupDependencies(s);return a}fixArraysAfterAddingRow(e,t,r){if(this.arrayMapping.moveArrayVerticesAfterRowByRows(e,t,r),!(t<=0))for(const[,n]of this.arrayMapping.arraysInRows(Wt.fromRowStartAndEnd(e,t-1,t-1))){const a=n.getRange();for(let s=a.start.col;s<=a.end.col;++s)for(let i=t;i<=a.end.row;++i){const t=Wn(e,s,i),a=Wn(e,s,i+r),o=n.getArrayCellValue(t);this.addressMapping.moveCell(a,t),this.changes.addChange(rr,a,o)}}}fixArraysAfterRemovingRows(e,t,r){if(this.arrayMapping.moveArrayVerticesAfterRowByRows(e,t,-r),!(t<=0))for(const[,n]of this.arrayMapping.arraysInRows(Wt.fromRowStartAndEnd(e,t-1,t-1)))if(this.isThereSpaceForArray(n))for(const e of n.getRange().addresses(this))this.addressMapping.setCell(e,n);else this.setNoSpaceIfArray(n)}fixArraysAfterAddingColumn(e,t,r){if(this.arrayMapping.moveArrayVerticesAfterColumnByColumns(e,t,r),!(t<=0))for(const[,n]of this.arrayMapping.arraysInCols(Gt.fromColumnStartAndEnd(e,t-1,t-1))){const a=n.getRange();for(let s=a.start.row;s<=a.end.row;++s)for(let i=t;i<=a.end.col;++i){const t=Wn(e,i,s),a=Wn(e,i+r,s),o=n.getArrayCellValue(t);this.addressMapping.moveCell(a,t),this.changes.addChange(rr,a,o)}}}fixArraysAfterRemovingColumns(e,t,r){if(this.arrayMapping.moveArrayVerticesAfterColumnByColumns(e,t,-r),!(t<=0))for(const[,n]of this.arrayMapping.arraysInCols(Gt.fromColumnStartAndEnd(e,t-1,t-1)))if(this.isThereSpaceForArray(n))for(const e of n.getRange().addresses(this))this.addressMapping.setCell(e,n);else this.setNoSpaceIfArray(n)}shrinkPossibleArrayAndGetCell(e){const t=this.getCell(e);return t instanceof nn?(this.setNoSpaceIfArray(t),this.getCell(e)):t}setNoSpaceIfArray(e){e instanceof nn&&(this.shrinkArrayToCorner(e),e.setNoSpace())}removeVertex(e){this.removeVertexAndCleanupDependencies(e),e instanceof sn&&this.rangeMapping.removeRange(e)}mergeRangeVertices(e,t){const r=this.graph.adjacentNodes(t);this.removeVertexAndCleanupDependencies(t),this.graph.softRemoveEdge(e,t),r.forEach((t=>{this.graph.hasNode(t)&&this.graph.addEdge(e,t)}))}removeVertexAndCleanupDependencies(e){const t=new Set(this.graph.removeNode(e));while(t.size>0){const e=t.values().next().value;t.delete(e),this.graph.hasNode(e)&&0===this.graph.adjacentNodesCount(e)&&((e instanceof sn||e instanceof yn)&&this.graph.removeNode(e).forEach((e=>t.add(e))),e instanceof sn?this.rangeMapping.removeRange(e):e instanceof yn&&this.addressMapping.removeCell(e.address))}}}
/**
 * @license
 * Copyright (c) 2022 Handsoncode. All rights reserved.
 */
class yn{constructor(e){this.address=e}getCellValue(){return rr}}
/**
 * @license
 * Copyright (c) 2022 Handsoncode. All rights reserved.
 */
class Nn{constructor(e,t){this.parsedValue=e,this.rawValue=t}getValues(){return{parsedValue:this.parsedValue,rawValue:this.rawValue}}setValues(e){this.parsedValue=e.parsedValue,this.rawValue=e.rawValue}getCellValue(){return this.parsedValue}setCellValue(e){throw"SetCellValue is deprecated for ValueCellVertex"}}
/**
 * @license
 * Copyright (c) 2022 Handsoncode. All rights reserved.
 */
class wn{constructor(e,t){this.errors=e,this.rawInput=t}getCellValue(){return Fn.parsingError()}getFormula(){return this.rawInput}}
/**
 * @license
 * Copyright (c) 2022 Handsoncode. All rights reserved.
 */
class bn{constructor(e,t){this.width=e,this.height=t,this.mapping=new Map}getCell(e){var t;return null===(t=this.mapping.get(e.col))||void 0===t?void 0:t.get(e.row)}setCell(e,t){this.width=Math.max(this.width,e.col+1),this.height=Math.max(this.height,e.row+1);let r=this.mapping.get(e.col);r||(r=new Map,this.mapping.set(e.col,r)),r.set(e.row,t)}has(e){var t;return!!(null===(t=this.mapping.get(e.col))||void 0===t?void 0:t.get(e.row))}getHeight(){return this.height}getWidth(){return this.width}removeCell(e){var t;null===(t=this.mapping.get(e.col))||void 0===t||t.delete(e.row)}addRows(e,t){this.mapping.forEach((r=>{const n=new Map;r.forEach(((a,s)=>{s>=e&&(n.set(s+t,a),r.delete(s))})),n.forEach(((e,t)=>{r.set(t,e)}))})),this.height+=t}addColumns(e,t){const r=new Map;this.mapping.forEach(((n,a)=>{a>=e&&(r.set(a+t,n),this.mapping.delete(a))})),r.forEach(((e,t)=>{this.mapping.set(t,e)})),this.width+=t}removeRows(e){this.mapping.forEach((t=>{const r=new Map;t.forEach(((n,a)=>{a>=e.rowStart&&(t.delete(a),a>e.rowEnd&&r.set(a-e.numberOfRows,n))})),r.forEach(((e,r)=>{t.set(r,e)}))}));const t=Math.min(this.height-1,e.rowEnd),r=Math.max(0,t-e.rowStart+1);this.height=Math.max(0,this.height-r)}removeColumns(e){const t=new Map;this.mapping.forEach(((r,n)=>{n>=e.columnStart&&(this.mapping.delete(n),n>e.columnEnd&&t.set(n-e.numberOfColumns,r))})),t.forEach(((e,t)=>{this.mapping.set(t,e)}));const r=Math.min(this.width-1,e.columnEnd),n=Math.max(0,r-e.columnStart+1);this.width=Math.max(0,this.width-n)}*getEntries(e){for(const[t,r]of this.mapping)for(const[n,a]of r)yield[Wn(e,t,n),a]}*verticesFromColumn(e){const t=this.mapping.get(e);if(void 0!==t)for(const[r,n]of t)yield n}*verticesFromRow(e){for(const t of this.mapping.values()){const r=t.get(e);void 0!==r&&(yield r)}}*verticesFromColumnsSpan(e){for(const t of e.columns()){const e=this.mapping.get(t);if(void 0!==e)for(const[t,r]of e)yield r}}*verticesFromRowsSpan(e){for(const t of this.mapping.values())for(const r of e.rows()){const e=t.get(r);void 0!==e&&(yield e)}}*entriesFromRowsSpan(e){for(const[t,r]of this.mapping.entries())for(const n of e.rows()){const a=r.get(n);void 0!==a&&(yield[Wn(e.sheet,t,n),a])}}*entriesFromColumnsSpan(e){for(const t of e.columns()){const r=this.mapping.get(t);if(void 0!==r)for(const[n,a]of r.entries())yield[Wn(e.sheet,t,n),a]}}*vertices(){for(const[e,t]of this.mapping)for(const[r,n]of t)void 0!==n&&(yield n)}}
/**
 * @license
 * Copyright (c) 2022 Handsoncode. All rights reserved.
 */
class Cn{constructor(e,t){this.width=e,this.height=t,this.mapping=new Array(t);for(let r=0;r<t;r++)this.mapping[r]=new Array(e)}getCell(e){return this.getCellVertex(e.col,e.row)}setCell(e,t){this.width=Math.max(this.width,e.col+1),this.height=Math.max(this.height,e.row+1);const r=this.mapping[e.row];r||(this.mapping[e.row]=new Array(this.width)),this.mapping[e.row][e.col]=t}has(e){const t=this.mapping[e.row];return!!t&&!!t[e.col]}getHeight(){return this.height}getWidth(){return this.width}removeCell(e){void 0!==this.mapping[e.row]&&delete this.mapping[e.row][e.col]}addRows(e,t){const r=[];for(let n=0;n<t;n++)r.push(new Array(this.width));this.mapping.splice(e,0,...r),this.height+=t}addColumns(e,t){for(let r=0;r<this.height;r++)this.mapping[r].splice(e,0,...new Array(t));this.width+=t}removeRows(e){this.mapping.splice(e.rowStart,e.numberOfRows);const t=Math.min(this.height-1,e.rowEnd),r=Math.max(0,t-e.rowStart+1);this.height=Math.max(0,this.height-r)}removeColumns(e){for(let n=0;n<this.height;n++)this.mapping[n].splice(e.columnStart,e.numberOfColumns);const t=Math.min(this.width-1,e.columnEnd),r=Math.max(0,t-e.columnStart+1);this.width=Math.max(0,this.width-r)}*getEntries(e){for(let t=0;t<this.height;++t)for(let r=0;r<this.width;++r){const n=this.getCellVertex(r,t);n&&(yield[Wn(e,r,t),n])}}*verticesFromColumn(e){for(let t=0;t<this.height;++t){const r=this.getCellVertex(e,t);r&&(yield r)}}*verticesFromRow(e){for(let t=0;t<this.width;++t){const r=this.getCellVertex(t,e);r&&(yield r)}}*verticesFromColumnsSpan(e){for(let t=e.columnStart;t<=e.columnEnd;++t)for(let e=0;e<this.height;++e){const r=this.getCellVertex(t,e);r&&(yield r)}}*verticesFromRowsSpan(e){for(let t=0;t<this.width;++t)for(let r=e.rowStart;r<=e.rowEnd;++r){const e=this.getCellVertex(t,r);e&&(yield e)}}*entriesFromRowsSpan(e){for(let t=0;t<this.width;++t)for(let r=e.rowStart;r<=e.rowEnd;++r){const n=this.getCellVertex(t,r);n&&(yield[Wn(e.sheet,t,r),n])}}*entriesFromColumnsSpan(e){for(let t=0;t<this.height;++t)for(let r=e.columnStart;r<=e.columnEnd;++r){const n=this.getCellVertex(r,t);n&&(yield[Wn(e.sheet,r,t),n])}}*vertices(){for(let e=0;e<this.height;++e)for(let t=0;t<this.width;++t){const r=this.getCellVertex(t,e);r&&(yield r)}}getCellVertex(e,t){var r;return null===(r=this.mapping[t])||void 0===r?void 0:r[e]}}(function(e){e["DIV_BY_ZERO"]="DIV_BY_ZERO",e["NAME"]="NAME",e["VALUE"]="VALUE",e["NUM"]="NUM",e["NA"]="NA",e["CYCLE"]="CYCLE",e["REF"]="REF",e["SPILL"]="SPILL",e["LIC"]="LIC",e["ERROR"]="ERROR"})(En||(En={})),function(e){e["FORMULA"]="FORMULA",e["VALUE"]="VALUE",e["ARRAY"]="ARRAY",e["EMPTY"]="EMPTY",e["ARRAYFORMULA"]="ARRAYFORMULA"}(vn||(vn={}));const On=(e,t)=>e instanceof nn?e.isLeftCorner(t)?vn.ARRAYFORMULA:vn.ARRAY:e instanceof an||e instanceof wn?vn.FORMULA:e instanceof Nn?vn.VALUE:vn.EMPTY;var In,Mn;(function(e){e["EMPTY"]="EMPTY",e["NUMBER"]="NUMBER",e["STRING"]="STRING",e["BOOLEAN"]="BOOLEAN",e["ERROR"]="ERROR"})(In||(In={})),function(e){e["NUMBER"]="NUMBER"}(Mn||(Mn={}));const Dn=Object.assign(Object.assign({},In),Mn),Ln=Object.assign(Object.assign({},In),fr),kn=e=>{switch(e){case Dn.EMPTY:return 0;case Dn.NUMBER:return 1;case Dn.STRING:return 2;case Dn.BOOLEAN:return 3;case Dn.ERROR:return 4}throw new Error("Cell value not computed")},_n=e=>{if(e===rr)return Dn.EMPTY;if(e instanceof Fn||e instanceof jr)return Dn.ERROR;if("string"===typeof e)return Dn.STRING;if(hr(e))return Dn.NUMBER;if("boolean"===typeof e)return Dn.BOOLEAN;throw new Error("Cell value not computed")},Un=e=>hr(e)?dr(e):_n(e),xn=e=>hr(e)?pr(e):void 0;class Fn{constructor(e,t,r){this.type=e,this.message=t,this.root=r}static parsingError(){return new Fn(En.ERROR,It.ParseError)}attachRootVertex(e){return void 0===this.root?new Fn(this.type,this.message,e):this}}const Pn=(e,t)=>({sheet:e,row:t}),Bn=e=>e.row<0,Yn=(e,t)=>({sheet:e,col:t}),Vn=e=>e.col<0,Wn=(e,t,r)=>({sheet:e,col:t,row:r}),Gn=e=>e.col<0||e.row<0,Hn=(e,t,r,n)=>Wn(t,e.col+r,e.row+n),zn=e=>`${e.sheet},${e.row},${e.col}`;function $n(e){return!(!e||"object"!==typeof e&&"function"!==typeof e)&&("col"in e&&"number"===typeof e.col&&"row"in e&&"number"===typeof e.row&&"sheet"in e&&"number"===typeof e.sheet)}const jn=(e,t)=>{var r;return null!==(r=e.sheet)&&void 0!==r?r:t.sheet},Xn=(e,t)=>e.sheet===t.sheet&&e.col===t.col&&e.row===t.row;
/**
 * @license
 * Copyright (c) 2022 Handsoncode. All rights reserved.
 */
class Kn{constructor(e,t,r){var n;this.value=t,this.address=r,this.type=e.type,this.message=null!==(n=e.message)&&void 0!==n?n:""}toString(){return this.value}valueOf(){return this.value}}
/**
 * @license
 * Copyright (c) 2022 Handsoncode. All rights reserved.
 */
function qn(e,t,r){if("undefined"===typeof e)return $i.defaultConfig[r];if("string"===typeof t){if(typeof e===t)return e;throw new b(t,r)}if(t.includes(e))return e;throw new M(t.map((e=>`'${e}'`)).join(" "),r)}function Jn(e,t,r){if(e<r)throw new O(t,r)}function Qn(e,t,r){if(e>r)throw new I(t,r)}function Zn(e,t,r,n){if(t(e))return e;if("undefined"===typeof e)return $i.defaultConfig[n];throw new b(r,n)}function ea(...e){const t=new Map;e.forEach((e=>{const r=t.get(e.value)||[];r.push(e.name),t.set(e.value,r)}));const r=[];for(const n of t.values())n.length>1&&r.push(n);if(r.length>0){r.forEach((e=>e.sort()));const e=r.map((e=>`[${e}]`)).join("; ");throw new Error(`Config initialization failed. Parameters in conflict: ${e}`)}}function ta(e,t,r){if(typeof e!==t)throw new b(t,r)}
/**
 * @license
 * Copyright (c) 2022 Handsoncode. All rights reserved.
 */
function ra(e,t,r){e=e.replace(/\s\s+/g," ").trim().toLowerCase();let n=e.substring(e.length-2);"am"===n||"pm"===n?e=e.substring(0,e.length-2).trim():(n=e.substring(e.length-1),"a"===n||"p"===n?e=e.substring(0,e.length-1).trim():n=void 0);const a=e.split(/[ /.-]/g);a.length>=2&&a[a.length-2].includes(":")&&(a[a.length-2]=a[a.length-2]+"."+a[a.length-1],a.pop());const s=a[a.length-1].split(":");if(void 0!==n&&s.push(n),1===a.length)return aa(s,r);if(1===s.length)return sa(a,t);const i=sa(a.slice(0,a.length-1),t),o=aa(s,r);return void 0===i||void 0===o?void 0:Object.assign(Object.assign({},i),o)}const na=/^ss(\.(s+|0+))?$/;function aa(e,t){const r=1e3;if(void 0===t)return;t=t.toLowerCase(),t.endsWith("am/pm")?t=t.substring(0,t.length-5).trim():t.endsWith("a/p")&&(t=t.substring(0,t.length-3).trim());const n=t.split(":");let a;if("am"===e[e.length-1]||"a"===e[e.length-1]?(a=!1,e.pop()):"pm"!==e[e.length-1]&&"p"!==e[e.length-1]||(a=!0,e.pop()),e.length!==n.length)return;const s=n.indexOf("hh"),i=n.indexOf("mm"),o=n.findIndex((e=>na.test(e))),c=-1!==s?e[s]:"0";if(!/^\d+$/.test(c))return;let l=Number(c);if(void 0!==a){if(l<0||l>12)return;l%=12,a&&(l+=12)}const u=-1!==i?e[i]:"0";if(!/^\d+$/.test(u))return;const h=Number(u),f=-1!==o?e[o]:"0";if(!/^\d+(\.\d+)?$/.test(f))return;const d=Math.round(Number(f)*r)/r;return{hours:l,minutes:h,seconds:d}}function sa(e,t){if(void 0===t)return;const r=t.toLowerCase().split(/[ /.-]/g);if(e.length!==r.length)return;const n=r.indexOf("mm"),a=r.indexOf("dd"),s=r.indexOf("yyyy"),i=r.indexOf("yy");if(!(n in e)||!(a in e)||!(s in e)&&!(i in e))return;if(s in e&&i in e)return;let o;if(s in e){const t=e[s];if(!/^\d+$/.test(t))return;if(o=Number(t),o<1e3||o>9999)return}else{const t=e[i];if(!/^\d+$/.test(t))return;if(o=Number(t),o<0||o>99)return}const c=e[n];if(!/^\d+$/.test(c))return;const l=Number(c),u=e[a];if(!/^\d+$/.test(u))return;const h=Number(u);return{year:o,month:l,day:h}}
/**
 * @license
 * Copyright (c) 2022 Handsoncode. All rights reserved.
 */
const ia=[31,28,31,30,31,30,31,31,30,31,30,31],oa=[0,31,59,90,120,151,181,212,243,273,304,334],ca=60,la=60,ua=24;function ha(e){return!(!e||"object"!==typeof e&&"function"!==typeof e)&&("year"in e&&"number"===typeof e.year&&"month"in e&&"number"===typeof e.month&&"day"in e&&"number"===typeof e.day)}function fa(e){return!(!e||"object"!==typeof e&&"function"!==typeof e)&&("hours"in e&&"number"===typeof e.hours&&"minutes"in e&&"number"===typeof e.minutes&&"seconds"in e&&"number"===typeof e.seconds)}const da={year:9999,month:12,day:31};class pa{constructor(e){this.config=e,this.minDateAbsoluteValue=this.dateToNumberFromZero(e.nullDate),this.maxDateValue=this.dateToNumber(da),this.leapYear1900=e.leapYear1900,!this.leapYear1900&&0<=this.dateToNumber({year:1900,month:2,day:28})?this.epochYearZero=this.numberToSimpleDate(2).year:this.epochYearZero=this.numberToSimpleDate(1).year,this.parseDateTime=e.parseDateTime}getWithinBounds(e){return e<=this.maxDateValue&&e>=0?e:void 0}dateStringToDateNumber(e){const{dateTime:t,dateFormat:r="",timeFormat:n=""}=this.parseDateTimeFromConfigFormats(e);if(void 0!==t)return fa(t)?ha(t)?new lr(Aa(t)+this.dateToNumber(t),r+" "+n):new cr(Aa(t),n):ha(t)?new ir(this.dateToNumber(t),r):0}parseDateTimeFromConfigFormats(e){return this.parseDateTimeFromFormats(e,this.config.dateFormats,this.config.timeFormats)}getNullYear(){return this.config.nullYear}getEpochYearZero(){return this.epochYearZero}isValidDate(e){return!(isNaN(e.year)||isNaN(e.month)||isNaN(e.day))&&(e.day===Math.round(e.day)&&e.month===Math.round(e.month)&&e.year===Math.round(e.year)&&(!(e.year<1582)&&(!(e.month<1||e.month>12)&&(!(e.day<1)&&(this.isLeapYear(e.year)&&2===e.month?e.day<=29:e.day<=ia[e.month-1])))))}dateToNumber(e){return this.dateToNumberFromZero(e)-this.minDateAbsoluteValue}relativeNumberToAbsoluteNumber(e){return e+this.minDateAbsoluteValue-(this.leapYear1900?1:0)}numberToSimpleDate(e){const t=Math.floor(e)+this.minDateAbsoluteValue;let r=Math.floor(t/365.2425);this.dateToNumberFromZero({year:r+1,month:1,day:1})<=t?r++:this.dateToNumberFromZero({year:r-1,month:1,day:1})>t&&r--;const n=t-this.dateToNumberFromZero({year:r,month:1,day:1}),a=ma(n-(this.isLeapYear(r)&&n>=59?1:0)),s=n-oa[a]-(this.isLeapYear(r)&&a>1?1:0);return{year:r,month:a+1,day:s+1}}numberToSimpleDateTime(e){const t=Sa(e%1),r=Math.floor(t.hours/ua);t.hours=t.hours%ua;const n=this.numberToSimpleDate(Math.floor(e)+r);return Object.assign(Object.assign({},n),t)}leapYearsCount(e){return Math.floor(e/4)-Math.floor(e/100)+Math.floor(e/400)+(this.config.leapYear1900&&e>=1900?1:0)}daysInMonth(e,t){return this.isLeapYear(e)&&2===t?29:ia[t-1]}endOfMonth(e){return{year:e.year,month:e.month,day:this.daysInMonth(e.year,e.month)}}toBasisUS(e,t){return 31===e.day&&(e.day=30),30===e.day&&31===t.day&&(t.day=30),2===e.month&&e.day===this.daysInMonth(e.year,e.month)&&(e.day=30,2===t.month&&t.day===this.daysInMonth(t.year,t.month)&&(t.day=30)),[e,t]}yearLengthForBasis(e,t){return e.year!==t.year?e.year+1!==t.year||e.month<t.month||e.month===t.month&&e.day<t.day?(this.leapYearsCount(t.year)-this.leapYearsCount(e.year-1))/(t.year-e.year+1)+365:this.countLeapDays(t)!==this.countLeapDays({year:e.year,month:e.month,day:e.day-1})?366:365:this.isLeapYear(e.year)?366:365}parseSingleFormat(e,t,r){const n=this.parseDateTime(e,t,r);if(!ha(n)||(n.year>=0&&n.year<100&&(n.year<this.getNullYear()?n.year+=2e3:n.year+=1900),this.isValidDate(n)))return n}parseDateTimeFromFormats(e,t,r){const n=0===t.length?[void 0]:t,a=0===r.length?[void 0]:r;for(const s of n)for(const t of a){const r=this.parseSingleFormat(e,s,t);if(void 0!==r)return{dateTime:r,timeFormat:t,dateFormat:s}}return{}}countLeapDays(e){return e.month>2||2===e.month&&e.day>=29?this.leapYearsCount(e.year):this.leapYearsCount(e.year-1)}dateToNumberFromZero(e){return 365*e.year+oa[e.month-1]+e.day-1+(e.month<=2?this.leapYearsCount(e.year-1):this.leapYearsCount(e.year))}isLeapYear(e){return!(e%4)&&(!!(e%100)||(!(e%400)||1900===e&&this.config.leapYear1900))}}function ma(e){let t=0;return oa[t+6]<=e&&(t+=6),oa[t+3]<=e&&(t+=3),oa[t+2]<=e?t+=2:oa[t+1]<=e&&(t+=1),t}function ga(e,t){const r=12*e.year+e.month-1+t;return{year:Math.floor(r/12),month:r%12+1,day:e.day}}function Ea(e){return{year:e.year,month:e.month,day:Math.min(e.day,ia[e.month-1])}}function va(e){return Math.round(3600*e*24)/86400}function Ta(e,t=1){return Math.round(e*t)/t}function Sa(e){const t=e*ua*la*ca,r=Ta(t%ca,1e5)%ca,n=(t-r)/ca,a=Math.round(n%la)%la,s=(n-a)/la,i=Math.round(s);return{hours:i,minutes:a,seconds:r}}function Aa(e){return((e.seconds/60+e.minutes)/60+e.hours)/24}function Ra(e){return{year:e.year,month:e.month,day:Math.min(30,e.day)}}class ya{call(){return Cn}}
/**
 * @license
 * Copyright (c) 2022 Handsoncode. All rights reserved.
 */
const Na=/(\\.|dd|DD|d|D|mm|MM|m|M|YYYY|YY|yyyy|yy|HH|hh|H|h|ss(\.(0+|s+))?|s|AM\/PM|am\/pm|A\/P|a\/p|\[mm]|\[MM]|\[hh]|\[HH])/g,wa=/(\\.|[#0]+(\.[#0]*)?)/g;var ba,Ca;function Oa(e,t){return{type:e,value:t}}function Ia(e){Na.lastIndex=0;const t=[];let r;do{r=Na.exec(e),null!==r&&t.push(r)}while(r);return t}function Ma(e){wa.lastIndex=0;const t=wa.exec(e);return null!==t?[t]:[]}function Da(e,t){const r=[];let n=0;for(let s=0;s<e.length;++s){const a=e[s];if(a.index!==n){const e=t.substr(n,a.index-n);r.push(Oa(ba.FREE_TEXT,e))}a[0].startsWith("\\")?r.push(Oa(ba.FREE_TEXT,a[0])):r.push(Oa(ba.FORMAT,a[0])),n=a.index+a[0].length}const a=e[e.length-1];if(a.index+a[0].length<t.length){const e=t.substr(a.index+a[0].length,t.length);r.push(Oa(ba.FREE_TEXT,e))}return r}function La(e){const t=Ia(e);return t.every((e=>_a(e)))?void 0:{type:Ca.DATE,tokens:Da(t,e)}}function ka(e){const t=Ma(e);return t.every((e=>_a(e)))?void 0:{type:Ca.NUMBER,tokens:Da(t,e)}}function _a(e){return e[0].startsWith("\\")}
/**
 * @license
 * Copyright (c) 2022 Handsoncode. All rights reserved.
 */
function Ua(e,t,r,n){const a=r.stringifyDateTime(n.numberToSimpleDateTime(e),t);if(void 0!==a)return a;const s=r.stringifyDuration(Sa(e),t);if(void 0!==s)return s;const i=ka(t);return void 0!==i?Ba(i.tokens,e):t}function xa(e,t){let r=e+"";while(r.length<t)r="0"+r;return r}function Fa(e,t){let r=e+"";while(r.length<t)r+="0";return r}function Pa(e,t){return e.split(t).length-1}function Ba(e,t){let r="";for(let n=0;n<e.length;++n){const a=e[n];if(a.type===ba.FREE_TEXT){r+=a.value;continue}const s=a.value.split("."),i=s[0],o=s[1]||"",c=s[1]?".":"",l=Number(t.toFixed(o.length)).toString().split(".");let u=l[0]||"",h=l[1]||"";if(i.length>u.length){const e=Pa(i.substr(0,i.length-u.length),"0");u=xa(u,e+u.length)}const f=Pa(o.substr(h.length,o.length-h.length),"0");h=Fa(h,f+h.length),r+=u+c+h}return r}function Ya(e,t){const r=La(t);if(void 0===r)return;const n=r.tokens;let a="";for(const s of n)if(s.type!==ba.FREE_TEXT)switch(s.value.toLowerCase()){case"h":case"hh":a+=xa(e.hours,s.value.length),e.hours=0;break;case"[hh]":a+=xa(e.hours,s.value.length-2),e.hours=0;break;case"m":case"mm":a+=xa(e.minutes,s.value.length),e.minutes=0;break;case"[mm]":a+=xa(e.minutes+60*e.hours,s.value.length-2),e.minutes=0,e.hours=0;break;case"s":case"ss":a+=xa(Math.floor(e.seconds),s.value.length);break;default:if(na.test(s.value)){const t=Math.max(s.value.length-3,0);a+=(e.seconds<10?"0":"")+Math.floor(e.seconds*Math.pow(10,t))/Math.pow(10,t);continue}return}else a+=s.value;return a}function Va(e,t){const r=La(t);if(void 0===r)return;const n=r.tokens;let a="",s=!1;const i=n.some((e=>e.type===ba.FORMAT&&("a/p"===e.value||"A/P"===e.value||"am/pm"===e.value||"AM/PM"===e.value)));for(let o=0;o<n.length;o++){const t=n[o];if(t.type!==ba.FREE_TEXT)switch(t.value.toLowerCase()){case"h":case"hh":s=!0,a+=xa(i?(e.hours+11)%12+1:e.hours,t.value.length);break;case"d":case"dd":a+=xa(e.day,t.value.length);break;case"s":case"ss":a+=xa(Math.floor(e.seconds),t.value.length);break;case"m":case"mm":o+1<n.length&&n[o+1].value.startsWith(":")&&(s=!0),a+=xa(s?e.minutes:e.month,t.value.length),s=!0;break;case"yy":a+=xa(e.year%100,t.value.length);break;case"yyyy":a+=e.year;break;case"am/pm":case"a/p":{const[r,n]=t.value.split("/");a+=e.hours<12?r:n;break}default:if(na.test(t.value)){const r=t.value.length-3;a+=(e.seconds<10?"0":"")+Math.floor(e.seconds*Math.pow(10,r))/Math.pow(10,r);continue}return}else a+=t.value}return a}(function(e){e["FORMAT"]="FORMAT",e["FREE_TEXT"]="FREE_TEXT"})(ba||(ba={})),function(e){e["DATE"]="DATE",e["NUMBER"]="NUMBER",e["STRING"]="STRING"}(Ca||(Ca={}));
/**
 * @license
 * Copyright (c) 2022 Handsoncode. All rights reserved.
 */
const Wa="length",Ga=e=>parseInt(e,16),Ha=e=>parseInt(e,10),za=e=>(e+"").replace(/\-/g,""),$a=(e,t,r)=>e["substr"](t,r),ja=e=>e["codePointAt"](0)-65;function Xa(e){return 25===za(e)[Wa]?Ga($a(za(e),Ga("12"),ja("F")))/(Ga($a(za(e),ja("C"),ja("Y")>>4))||1+(~~![][Wa]<<3)):0}function Ka(e){if(e=(e+"").replace(/\-/g,""),e[Wa]!==ja("Z"))return!1;let t=0;return[[0,ja("G")+1],[ja("H"),ja("H")-1],[ja("G")+ja("H"),ja("G")]].reduce(((r,[n,a],s)=>(r|=(Ha(`${Ha(Ga($a(e,t+n-(0===s?0:2),a+(s?2:0)))+(Ga($a(e,t+n+a,2))+[]).padStart(2,"0"))}`)%97||2)>>1,t+=2,r)),ja("A"))===[]+1>>1}
/**
 * @license
 * Copyright (c) 2022 Handsoncode. All rights reserved.
 */
const qa={invalid:()=>"The license key for HyperFormula is invalid.",expired:({keyValidityDate:e})=>`The license key for HyperFormula expired on ${e}, and is not valid for the installed version.`,missing:()=>"The license key for HyperFormula is missing."};let Ja=!1;function Qa(e){const t={template:"missing",vars:{}};if("gpl-v3"===e||"internal-use-in-handsontable"===e)t.template="valid";else if("string"===typeof e&&Ka(e)){const[r,n,a]="17/11/2022".split("/"),s=Math.floor(new Date(`${n}/${r}/${a}`).getTime()/864e5),i=Xa(e);t.vars.keyValidityDate=Za(new Date(864e5*(i+1))),t.template=s>i?"expired":"valid"}else""!==e&&(t.template="invalid");return Ja||"valid"===t.template||(console.warn(qa[t.template](t.vars)),Ja=!0),t.template}function Za(e){const t=["January","February","March","April","May","June","July","August","September","October","November","December"],r=t[e.getMonth()],n=e.getDate(),a=e.getFullYear();return`${r} ${n}, ${a}`}
/**
 * @license
 * Copyright (c) 2022 Handsoncode. All rights reserved.
 */
var es,ts,rs;function ns(e){return e.startsWith("=")}function as(e){const t=e.toLowerCase();return"true"===t||"false"===t}function ss(e,t){const r=e.toUpperCase(),n=/#[A-Za-z0-9\/]+[?!]?/;return n.test(r)&&Object.prototype.hasOwnProperty.call(t,r)}(function(e){class t{constructor(e){this.value=e,this.value=sr(this.value,Or(nr(this.value)))}}e.Number=t;class r{constructor(e){this.value=e}}e.String=r;class n{constructor(e){this.value=e}}e.Boolean=n;class a{static getSingletonInstance(){return a.instance||(a.instance=new a),a.instance}}e.Empty=a;class s{constructor(e){this.formula=e}}e.Formula=s;class i{constructor(e,t){this.value=new Fn(e,t)}}e.Error=i})(es||(es={}));class is{constructor(e,t,r){this.config=e,this.dateHelper=t,this.numberLiteralsHelper=r}parse(e){if(void 0===e||null===e)return es.Empty.getSingletonInstance();if("number"===typeof e)return Cr(e)?new es.Error(En.NUM,It.ValueLarge):new es.Number(e);if("boolean"===typeof e)return new es.Boolean(e);if(e instanceof Date){const t=this.dateHelper.dateToNumber({day:e.getDate(),month:e.getMonth()+1,year:e.getFullYear()}),r=Aa({hours:e.getHours(),minutes:e.getMinutes(),seconds:e.getSeconds()+e.getMilliseconds()/1e3}),n=t+r;return n<0?new es.Error(En.NUM,It.DateBounds):n%1===0?new es.Number(new ir(n,"Date()")):n<1?new es.Number(new cr(n,"Date()")):new es.Number(new lr(n,"Date()"))}if("string"===typeof e){if(as(e))return new es.Boolean("true"===e.toLowerCase());if(ns(e))return new es.Formula(e);if(ss(e,this.config.errorMapping))return new es.Error(this.config.errorMapping[e.toUpperCase()]);{let t,r=e.trim(),n=0;if(r.endsWith("%"))n=1,r=r.slice(0,r.length-1);else{const e=this.currencyMatcher(r);void 0!==e&&(n=2,[t,r]=e)}const a=this.numberLiteralsHelper.numericStringToMaybeNumber(r);if(void 0!==a){let e;return e=1===n?new ur(a/100):2===n?new or(a,t):a,new es.Number(e)}const s=this.dateHelper.dateStringToDateNumber(r);return void 0!==s?new es.Number(s):new es.String(e.startsWith("'")?e.slice(1):e)}}throw new w(e)}currencyMatcher(e){for(const t of this.config.currencySymbol){if(e.startsWith(t))return[t,e.slice(t.length)];if(e.endsWith(t))return[t,e.slice(0,e.length-t.length)]}}}(function(e){e[e["COPY"]=0]="COPY",e[e["CUT"]=1]="CUT"})(ts||(ts={})),function(e){e[e["VALUE"]=0]="VALUE",e[e["EMPTY"]=1]="EMPTY",e[e["FORMULA"]=2]="FORMULA",e[e["PARSING_ERROR"]=3]="PARSING_ERROR"}(rs||(rs={}));class os{constructor(e,t,r,n,a){this.sourceLeftCorner=e,this.width=t,this.height=r,this.type=n,this.content=a}*getContent(e){if(void 0!==this.content)for(let t=0;t<this.height;++t)for(let r=0;r<this.width;++r)yield[Wn(e.sheet,e.col+r,e.row+t),this.content[t][r]]}}class cs{constructor(e,t,r){this.dependencyGraph=t,this.operations=r,this.maxRows=e.maxRows,this.maxColumns=e.maxColumns}cut(e,t,r){this.clipboard=new os(e,t,r,ts.CUT)}copy(e,t,r){const n=[];for(let a=0;a<r;++a){n[a]=[];for(let r=0;r<t;++r){const t=this.operations.getClipboardCell(Wn(e.sheet,e.col+r,e.row+a));n[a].push(t)}}this.clipboard=new os(e,t,r,ts.COPY,n)}abortCut(){this.clipboard&&this.clipboard.type===ts.CUT&&this.clear()}clear(){this.clipboard=void 0}ensureItIsPossibleToCopyPaste(e){if(void 0===this.clipboard)return;if(Gn(e)||!this.dependencyGraph.sheetMapping.hasSheetWithId(e.sheet))throw new g("a valid target address.");const t=jt.spanFrom(e,this.clipboard.width,this.clipboard.height);if(t.exceedsSheetSizeLimits(this.maxColumns,this.maxRows))throw new d;if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(t))throw new Error("It is not possible to paste onto an array")}isCutClipboard(){return void 0!==this.clipboard&&this.clipboard.type===ts.CUT}isCopyClipboard(){return void 0!==this.clipboard&&this.clipboard.type===ts.COPY}}
/**
 * @license
 * Copyright (c) 2022 Handsoncode. All rights reserved.
 */
class ls{constructor(e,t,r,n){this.displayName=e,this.address=t,this.added=r,this.options=n}normalizeExpressionName(){return this.displayName.toLowerCase()}copy(){return new ls(this.displayName,this.address,this.added,this.options)}}class us{constructor(){this.mapping=new Map}has(e){return this.mapping.has(this.normalizeExpressionName(e))}isNameAvailable(e){const t=this.normalizeExpressionName(e),r=this.mapping.get(t);return!(r&&r.added)}add(e){this.mapping.set(e.normalizeExpressionName(),e)}get(e){return this.mapping.get(this.normalizeExpressionName(e))}getExisting(e){const t=this.mapping.get(this.normalizeExpressionName(e));return t&&t.added?t:void 0}remove(e){const t=this.normalizeExpressionName(e),r=this.mapping.get(t);r&&(r.added=!1)}getAllNamedExpressions(){return Array.from(this.mapping.values()).filter((e=>e.added))}normalizeExpressionName(e){return e.toLowerCase()}}class hs{constructor(){this.mapping=new Map}add(e){this.mapping.set(this.normalizeExpressionName(e.displayName),e)}get(e){return this.mapping.get(this.normalizeExpressionName(e))}has(e){return this.mapping.has(this.normalizeExpressionName(e))}getAllNamedExpressions(){return Array.from(this.mapping.values()).filter((e=>e.added))}isNameAvailable(e){const t=this.normalizeExpressionName(e);return!this.mapping.has(t)}remove(e){const t=this.normalizeExpressionName(e),r=this.mapping.get(t);r&&this.mapping.delete(t)}normalizeExpressionName(e){return e.toLowerCase()}}class fs{constructor(){this.nextNamedExpressionRow=0,this.workbookStore=new us,this.worksheetStores=new Map,this.addressCache=new Map}isNameAvailable(e,t){var r,n;return void 0===t?this.workbookStore.isNameAvailable(e):null===(n=null===(r=this.worksheetStore(t))||void 0===r?void 0:r.isNameAvailable(e))||void 0===n||n}namedExpressionInAddress(e){const t=this.addressCache.get(e);return t&&t.added?t:void 0}namedExpressionForScope(e,t){var r;return void 0===t?this.workbookStore.getExisting(e):null===(r=this.worksheetStore(t))||void 0===r?void 0:r.get(e)}nearestNamedExpression(e,t){var r,n;return null!==(n=null===(r=this.worksheetStore(t))||void 0===r?void 0:r.get(e))&&void 0!==n?n:this.workbookStore.getExisting(e)}isExpressionInScope(e,t){var r,n;return null!==(n=null===(r=this.worksheetStore(t))||void 0===r?void 0:r.has(e))&&void 0!==n&&n}isNameValid(e){return!/^[A-Za-z]+[0-9]+$/.test(e)&&/^[A-Za-z\u00C0-\u02AF_][A-Za-z0-9\u00C0-\u02AF._]*$/.test(e)}addNamedExpression(e,t,r){const n=void 0===t?this.workbookStore:this.worksheetStoreOrCreate(t);let a=n.get(e);return void 0!==a?(a.added=!0,a.displayName=e,a.options=r):(a=new ls(e,this.nextAddress(),!0,r),n.add(a)),this.addressCache.set(a.address.row,a),a}restoreNamedExpression(e,t){const r=void 0===t?this.workbookStore:this.worksheetStoreOrCreate(t);return e.added=!0,r.add(e),this.addressCache.set(e.address.row,e),e}namedExpressionOrPlaceholder(e,t){var r;return null!==(r=this.worksheetStoreOrCreate(t).get(e))&&void 0!==r?r:this.workbookNamedExpressionOrPlaceholder(e)}workbookNamedExpressionOrPlaceholder(e){let t=this.workbookStore.get(e);return void 0===t&&(t=new ls(e,this.nextAddress(),!1),this.workbookStore.add(t)),t}remove(e,t){let r;r=void 0===t?this.workbookStore:this.worksheetStore(t);const n=null===r||void 0===r?void 0:r.get(e);if(void 0===r||void 0===n||!n.added)throw"Named expression does not exist";r.remove(e),r instanceof hs&&0===r.mapping.size&&this.worksheetStores.delete(t),this.addressCache.delete(n.address.row)}getAllNamedExpressionsNamesInScope(e){return this.getAllNamedExpressions().filter((({scope:t})=>t===e)).map((e=>e.expression.displayName))}getAllNamedExpressionsNames(){return this.getAllNamedExpressions().map((e=>e.expression.displayName))}getAllNamedExpressions(){const e=[];return this.workbookStore.getAllNamedExpressions().forEach((t=>{e.push({expression:t,scope:void 0})})),this.worksheetStores.forEach(((t,r)=>{t.getAllNamedExpressions().forEach((t=>{e.push({expression:t,scope:r})}))})),e}getAllNamedExpressionsForScope(e){var t,r;return void 0===e?this.workbookStore.getAllNamedExpressions():null!==(r=null===(t=this.worksheetStores.get(e))||void 0===t?void 0:t.getAllNamedExpressions())&&void 0!==r?r:[]}worksheetStoreOrCreate(e){let t=this.worksheetStores.get(e);return t||(t=new hs,this.worksheetStores.set(e,t)),t}worksheetStore(e){return this.worksheetStores.get(e)}nextAddress(){return Wn(fs.SHEET_FOR_WORKBOOK_EXPRESSIONS,0,this.nextNamedExpressionRow++)}}fs.SHEET_FOR_WORKBOOK_EXPRESSIONS=-1;const ds=e=>{switch(e.type){case $e.EMPTY:case $e.NUMBER:case $e.STRING:case $e.ERROR:case $e.ERROR_WITH_RAW_INPUT:return!1;case $e.CELL_REFERENCE:return!e.reference.isAbsolute();case $e.CELL_RANGE:case $e.COLUMN_RANGE:case $e.ROW_RANGE:return!e.start.isAbsolute();case $e.NAMED_EXPRESSION:return!1;case $e.PERCENT_OP:case $e.PLUS_UNARY_OP:case $e.MINUS_UNARY_OP:return ds(e.value);case $e.CONCATENATE_OP:case $e.EQUALS_OP:case $e.NOT_EQUAL_OP:case $e.LESS_THAN_OP:case $e.GREATER_THAN_OP:case $e.LESS_THAN_OR_EQUAL_OP:case $e.GREATER_THAN_OR_EQUAL_OP:case $e.MINUS_OP:case $e.PLUS_OP:case $e.TIMES_OP:case $e.DIV_OP:case $e.POWER_OP:return ds(e.left)||ds(e.right);case $e.PARENTHESIS:return ds(e.expression);case $e.FUNCTION_CALL:return e.args.some((e=>ds(e)));case $e.ARRAY:return e.args.some((e=>e.some((e=>ds(e)))))}};
/**
 * @license
 * Copyright (c) 2022 Handsoncode. All rights reserved.
 */
class ps{performEagerTransformations(e,t){for(const r of e.arrayFormulaNodes()){const[n,a]=this.transformSingleAst(r.getFormula(e.lazilyTransformingAstService),r.getAddress(e.lazilyTransformingAstService)),s=t.rememberNewAst(n);r.setFormula(s),r.setAddress(a)}}transformSingleAst(e,t){const r=this.transformAst(e,t),n=this.fixNodeAddress(t);return[r,n]}transformAst(e,t){switch(e.type){case $e.CELL_REFERENCE:return this.transformCellReferenceAst(e,t);case $e.CELL_RANGE:return this.transformCellRangeAst(e,t);case $e.COLUMN_RANGE:return this.transformColumnRangeAst(e,t);case $e.ROW_RANGE:return this.transformRowRangeAst(e,t);case $e.EMPTY:case $e.ERROR:case $e.NUMBER:case $e.NAMED_EXPRESSION:case $e.ERROR_WITH_RAW_INPUT:case $e.STRING:return e;case $e.PERCENT_OP:case $e.MINUS_UNARY_OP:case $e.PLUS_UNARY_OP:return Object.assign(Object.assign({},e),{value:this.transformAst(e.value,t)});case $e.FUNCTION_CALL:return Object.assign(Object.assign({},e),{procedureName:e.procedureName,args:e.args.map((e=>this.transformAst(e,t)))});case $e.PARENTHESIS:return Object.assign(Object.assign({},e),{expression:this.transformAst(e.expression,t)});case $e.ARRAY:return Object.assign(Object.assign({},e),{args:e.args.map((e=>e.map((e=>this.transformAst(e,t)))))});default:return Object.assign(Object.assign({},e),{left:this.transformAst(e.left,t),right:this.transformAst(e.right,t)})}}transformCellReferenceAst(e,t){const r=this.transformCellAddress(e.reference,t);return r instanceof H?Object.assign(Object.assign({},e),{reference:r}):r===En.REF?St(new Fn(En.REF)):e}transformCellRangeAst(e,t){const r=this.transformCellRange(e.start,e.end,t);return Array.isArray(r)?Object.assign(Object.assign({},e),{start:r[0],end:r[1]}):r===En.REF?St(new Fn(En.REF)):e}transformColumnRangeAst(e,t){const r=this.transformColumnRange(e.start,e.end,t);return Array.isArray(r)?Object.assign(Object.assign({},e),{start:r[0],end:r[1]}):r===En.REF?St(new Fn(En.REF)):e}transformRowRangeAst(e,t){const r=this.transformRowRange(e.start,e.end,t);return Array.isArray(r)?Object.assign(Object.assign({},e),{start:r[0],end:r[1]}):r===En.REF?St(new Fn(En.REF)):e}}
/**
 * @license
 * Copyright (c) 2022 Handsoncode. All rights reserved.
 */
class ms extends ps{constructor(e){super(),this.columnsSpan=e}get sheet(){return this.columnsSpan.sheet}isIrreversible(){return!1}transformRowRangeAst(e,t){return e}transformCellRange(e,t,r){return this.transformRange(e,t,r)}transformRowRange(e,t,r){throw Error("Not implemented")}transformColumnRange(e,t,r){return this.transformRange(e,t,r)}transformCellAddress(e,t){const r=jn(e,t);if(r!==this.columnsSpan.sheet&&t.sheet!==this.columnsSpan.sheet)return!1;const n=e.toSimpleColumnAddress(t);if(r===this.columnsSpan.sheet&&t.sheet!==this.columnsSpan.sheet)return this.columnsSpan.columnStart<=n.col&&e.shiftedByColumns(this.columnsSpan.numberOfColumns);if(t.sheet===this.columnsSpan.sheet&&r!==this.columnsSpan.sheet)return!e.isColumnAbsolute()&&(!(t.col<this.columnsSpan.columnStart)&&e.shiftedByColumns(-this.columnsSpan.numberOfColumns));if(e.isColumnAbsolute())return!(e.col<this.columnsSpan.columnStart)&&e.shiftedByColumns(this.columnsSpan.numberOfColumns);{const r=e.toSimpleColumnAddress(t);return r.col<this.columnsSpan.columnStart?!(t.col<this.columnsSpan.columnStart)&&e.shiftedByColumns(-this.columnsSpan.numberOfColumns):t.col<this.columnsSpan.columnStart&&e.shiftedByColumns(this.columnsSpan.numberOfColumns)}}fixNodeAddress(e){return this.columnsSpan.sheet===e.sheet&&this.columnsSpan.columnStart<=e.col?Object.assign(Object.assign({},e),{col:e.col+this.columnsSpan.numberOfColumns}):e}transformRange(e,t,r){const n=this.transformCellAddress(e,r),a=this.transformCellAddress(t,r);return n===En.REF||a===En.REF?En.REF:!(!n&&!a)&&[n||e,a||t]}}
/**
 * @license
 * Copyright (c) 2022 Handsoncode. All rights reserved.
 */
class gs extends ps{constructor(e){super(),this.rowsSpan=e}get sheet(){return this.rowsSpan.sheet}isIrreversible(){return!1}transformColumnRangeAst(e,t){return e}transformCellRange(e,t,r){return this.transformRange(e,t,r)}transformRowRange(e,t,r){return this.transformRange(e,t,r)}transformColumnRange(e,t,r){throw Error("Not implemented")}transformCellAddress(e,t){const r=jn(e,t);if(r!==this.rowsSpan.sheet&&t.sheet!==this.rowsSpan.sheet)return!1;const n=e.toSimpleRowAddress(t);return r===this.rowsSpan.sheet&&t.sheet!==this.rowsSpan.sheet?this.rowsSpan.rowStart<=n.row&&e.shiftedByRows(this.rowsSpan.numberOfRows):t.sheet===this.rowsSpan.sheet&&r!==this.rowsSpan.sheet?!e.isRowAbsolute()&&(!(t.row<this.rowsSpan.rowStart)&&e.shiftedByRows(-this.rowsSpan.numberOfRows)):e.isRowAbsolute()?!(e.row<this.rowsSpan.rowStart)&&e.shiftedByRows(this.rowsSpan.numberOfRows):n.row<this.rowsSpan.rowStart?!(t.row<this.rowsSpan.rowStart)&&e.shiftedByRows(-this.rowsSpan.numberOfRows):t.row<this.rowsSpan.rowStart&&e.shiftedByRows(this.rowsSpan.numberOfRows)}fixNodeAddress(e){return this.rowsSpan.sheet===e.sheet&&this.rowsSpan.rowStart<=e.row?Object.assign(Object.assign({},e),{row:e.row+this.rowsSpan.numberOfRows}):e}transformRange(e,t,r){const n=this.transformCellAddress(e,r),a=this.transformCellAddress(t,r);return n===En.REF||a===En.REF?En.REF:!(!n&&!a)&&[n||e,a||t]}}
/**
 * @license
 * Copyright (c) 2022 Handsoncode. All rights reserved.
 */
class Es extends ps{constructor(e){super(),this.sheet=e}isIrreversible(){return!0}fixNodeAddress(e){return e}transformCellAddress(e,t){return!!e.isInvalid(t)&&En.REF}transformCellRange(e,t,r){return!(!e.isInvalid(r)&&!t.isInvalid(r))&&En.REF}transformColumnRange(e,t,r){return!(!e.isInvalid(r)&&!t.isInvalid(r))&&En.REF}transformRowRange(e,t,r){return!(!e.isInvalid(r)&&!t.isInvalid(r))&&En.REF}}
/**
 * @license
 * Copyright (c) 2022 Handsoncode. All rights reserved.
 */
class vs extends ps{constructor(e,t,r,n){super(),this.sourceRange=e,this.toRight=t,this.toBottom=r,this.toSheet=n,this.dependentFormulaTransformer=new Ts(e,t,r,n)}get sheet(){return this.sourceRange.sheet}isIrreversible(){return!0}transformSingleAst(e,t){if(this.sourceRange.addressInRange(t)){const r=this.transformAst(e,t);return[r,this.fixNodeAddress(t)]}return this.dependentFormulaTransformer.transformSingleAst(e,t)}fixNodeAddress(e){return Wn(this.toSheet,e.col+this.toRight,e.row+this.toBottom)}transformCellAddress(e,t){return this.transformAddress(e,t)}transformCellRange(e,t,r){return this.transformRange(e,t,r)}transformColumnRange(e,t,r){return this.transformRange(e,t,r)}transformRowRange(e,t,r){return this.transformRange(e,t,r)}transformAddress(e,t){const r=this.sourceRange;if(e instanceof H){const n=e.toSimpleCellAddress(t);if(r.addressInRange(n))return e.shiftAbsoluteDimensions(this.toRight,this.toBottom)}return e.shiftRelativeDimensions(-this.toRight,-this.toBottom)}transformRange(e,t,r){const n=this.sourceRange;if(e instanceof H&&t instanceof H){const a=e.toSimpleCellAddress(r),s=t.toSimpleCellAddress(r);if(n.addressInRange(a)&&n.addressInRange(s))return[e.shiftAbsoluteDimensions(this.toRight,this.toBottom),t.shiftAbsoluteDimensions(this.toRight,this.toBottom)]}return[e.shiftRelativeDimensions(-this.toRight,-this.toBottom),t.shiftRelativeDimensions(-this.toRight,-this.toBottom)]}}class Ts extends ps{constructor(e,t,r,n){super(),this.sourceRange=e,this.toRight=t,this.toBottom=r,this.toSheet=n}get sheet(){return this.sourceRange.sheet}isIrreversible(){return!0}fixNodeAddress(e){return e}transformCellAddress(e,t){return!!this.shouldMove(e,t)&&e.moved(this.toSheet,this.toRight,this.toBottom)}transformCellRange(e,t,r){return this.transformRange(e,t,r)}transformColumnRange(e,t,r){return this.transformRange(e,t,r)}transformRowRange(e,t,r){return this.transformRange(e,t,r)}shouldMove(e,t){return e instanceof H?this.sourceRange.addressInRange(e.toSimpleCellAddress(t)):e instanceof G?this.sourceRange.rowInRange(e.toSimpleRowAddress(t))&&!this.sourceRange.isFinite():this.sourceRange.columnInRange(e.toSimpleColumnAddress(t))&&!this.sourceRange.isFinite()}transformRange(e,t,r){const n=this.transformCellAddress(e,r),a=this.transformCellAddress(t,r);return!(!n||!a)&&[n,a]}}
/**
 * @license
 * Copyright (c) 2022 Handsoncode. All rights reserved.
 */
class Ss extends ps{constructor(e){super(),this.columnsSpan=e}get sheet(){return this.columnsSpan.sheet}isIrreversible(){return!0}transformRowRangeAst(e,t){return e}transformCellRange(e,t,r){return this.transformRange(e,t,r)}transformRowRange(e,t,r){throw Error("Not implemented")}transformColumnRange(e,t,r){return this.transformRange(e,t,r)}transformCellAddress(e,t){const r=jn(e,t);if(this.columnsSpan.sheet!==t.sheet&&this.columnsSpan.sheet!==r)return!1;if(this.columnsSpan.sheet!==t.sheet&&this.columnsSpan.sheet===r){const r=e.toSimpleColumnAddress(t);if(r.col<this.columnsSpan.columnStart)return!1;if(r.col>this.columnsSpan.columnEnd)return e.shiftedByColumns(-this.columnsSpan.numberOfColumns)}if(this.columnsSpan.sheet===t.sheet&&this.columnsSpan.sheet!==r){if(e.isColumnAbsolute())return!1;if(t.col<this.columnsSpan.columnStart)return!1;if(t.col>this.columnsSpan.columnEnd)return e.shiftedByColumns(this.columnsSpan.numberOfColumns)}if(this.columnsSpan.sheet===t.sheet&&this.columnsSpan.sheet===r)if(e.isColumnAbsolute()){if(e.col<this.columnsSpan.columnStart)return!1;if(e.col>this.columnsSpan.columnEnd)return e.shiftedByColumns(-this.columnsSpan.numberOfColumns)}else{const r=e.toSimpleColumnAddress(t);if(r.col<this.columnsSpan.columnStart){if(t.col<this.columnsSpan.columnStart)return!1;if(t.col>this.columnsSpan.columnEnd)return e.shiftedByColumns(this.columnsSpan.numberOfColumns)}else if(r.col>this.columnsSpan.columnEnd){if(t.col<this.columnsSpan.columnStart)return e.shiftedByColumns(-this.columnsSpan.numberOfColumns);if(t.col>this.columnsSpan.columnEnd)return!1}}return En.REF}fixNodeAddress(e){return this.columnsSpan.sheet===e.sheet&&this.columnsSpan.columnStart<=e.col?Object.assign(Object.assign({},e),{col:e.col-this.columnsSpan.numberOfColumns}):e}transformRange(e,t,r){const n=jn(e,r);let a=e,s=t;if(this.columnsSpan.sheet===n){const n=e.toSimpleColumnAddress(r),i=t.toSimpleColumnAddress(r);if(this.columnsSpan.columnStart<=n.col&&this.columnsSpan.columnEnd>=i.col)return En.REF;n.col>=this.columnsSpan.columnStart&&n.col<=this.columnsSpan.columnEnd&&(a=e.shiftedByColumns(this.columnsSpan.columnEnd-n.col+1)),i.col>=this.columnsSpan.columnStart&&i.col<=this.columnsSpan.columnEnd&&(s=t.shiftedByColumns(-(i.col-this.columnsSpan.columnStart+1)))}const i=this.transformCellAddress(a,r),o=this.transformCellAddress(s,r);if(!1===i&&!1===o)return[a,s];if(i===En.REF||o===En.REF)throw Error("Cannot happen");return[i||a,o||s]}}
/**
 * @license
 * Copyright (c) 2022 Handsoncode. All rights reserved.
 */
class As extends ps{constructor(e){super(),this.rowsSpan=e}get sheet(){return this.rowsSpan.sheet}isIrreversible(){return!0}transformColumnRangeAst(e,t){return e}transformCellAddress(e,t){const r=jn(e,t);if(this.rowsSpan.sheet!==t.sheet&&this.rowsSpan.sheet!==r)return!1;if(this.rowsSpan.sheet!==t.sheet&&this.rowsSpan.sheet===r){const r=e.toSimpleRowAddress(t);if(r.row<this.rowsSpan.rowStart)return!1;if(r.row>this.rowsSpan.rowEnd)return e.shiftedByRows(-this.rowsSpan.numberOfRows)}if(this.rowsSpan.sheet===t.sheet&&this.rowsSpan.sheet!==r){if(e.isRowAbsolute())return!1;if(t.row<this.rowsSpan.rowStart)return!1;if(t.row>this.rowsSpan.rowEnd)return e.shiftedByRows(this.rowsSpan.numberOfRows)}if(this.rowsSpan.sheet===t.sheet&&this.rowsSpan.sheet===r)if(e.isRowAbsolute()){if(e.row<this.rowsSpan.rowStart)return!1;if(e.row>this.rowsSpan.rowEnd)return e.shiftedByRows(-this.rowsSpan.numberOfRows)}else{const r=e.toSimpleRowAddress(t);if(r.row<this.rowsSpan.rowStart){if(t.row<this.rowsSpan.rowStart)return!1;if(t.row>this.rowsSpan.rowEnd)return e.shiftedByRows(this.rowsSpan.numberOfRows)}else if(r.row>this.rowsSpan.rowEnd){if(t.row<this.rowsSpan.rowStart)return e.shiftedByRows(-this.rowsSpan.numberOfRows);if(t.row>this.rowsSpan.rowEnd)return!1}}return En.REF}transformCellRange(e,t,r){return this.transformRange(e,t,r)}transformRowRange(e,t,r){return this.transformRange(e,t,r)}transformColumnRange(e,t,r){throw Error("Not implemented")}fixNodeAddress(e){return this.rowsSpan.sheet===e.sheet&&this.rowsSpan.rowStart<=e.row?Object.assign(Object.assign({},e),{row:e.row-this.rowsSpan.numberOfRows}):e}transformRange(e,t,r){const n=jn(e,r);let a=e,s=t;if(this.rowsSpan.sheet===n){const n=e.toSimpleRowAddress(r),i=t.toSimpleRowAddress(r);if(this.rowsSpan.rowStart<=n.row&&this.rowsSpan.rowEnd>=i.row)return En.REF;n.row>=this.rowsSpan.rowStart&&n.row<=this.rowsSpan.rowEnd&&(a=e.shiftedByRows(this.rowsSpan.rowEnd-n.row+1)),i.row>=this.rowsSpan.rowStart&&i.row<=this.rowsSpan.rowEnd&&(s=t.shiftedByRows(-(i.row-this.rowsSpan.rowStart+1)))}const i=this.transformCellAddress(a,r),o=this.transformCellAddress(s,r);return!1===i&&!1===o?[a,s]:i===En.REF||o===En.REF?En.REF:[i||a,o||s]}}
/**
 * @license
 * Copyright (c) 2022 Handsoncode. All rights reserved.
 */
class Rs extends ps{constructor(e){super(),this.sheet=e}isIrreversible(){return!0}performEagerTransformations(e,t){for(const r of e.arrayFormulaNodes()){const[t]=this.transformSingleAst(r.getFormula(e.lazilyTransformingAstService),r.getAddress(e.lazilyTransformingAstService));r.setFormula(t)}}fixNodeAddress(e){return e}transformCellAddress(e,t){return this.transformAddress(e)}transformCellRange(e,t,r){return this.transformAddress(e)}transformColumnRange(e,t,r){return this.transformAddress(e)}transformRowRange(e,t,r){return this.transformAddress(e)}transformAddress(e){return e.sheet===this.sheet&&En.REF}}
/**
 * @license
 * Copyright (c) 2022 Handsoncode. All rights reserved.
 */
function ys(e){if(!Array.isArray(e))throw new g("an array of arrays.");for(let t=0;t<e.length;t++)if(!Array.isArray(e[t]))throw new g("an array of arrays.")}function Ns(e){let t=0,r=0,n=0;for(let s=0;s<e.length;s++){let a=0;for(let t=0;t<e[s].length;t++){const r=e[s][t];void 0!==r&&null!==r&&(a=t+1,++n)}t=Math.max(t,a),a>0&&(r=s+1)}const a=t*r;return{height:r,width:t,fill:0===a?0:n/a}}
/**
 * @license
 * Copyright (c) 2022 Handsoncode. All rights reserved.
 */
class ws{constructor(e,t){this.sheet=e,this.indexes=t}normalizedIndexes(){return Ms(this.indexes)}rowsSpans(){return this.normalizedIndexes().map((e=>Wt.fromNumberOfRows(this.sheet,e[0],e[1])))}}class bs{constructor(e,t){this.sheet=e,this.indexes=t}normalizedIndexes(){return Ds(this.indexes)}rowsSpans(){return this.normalizedIndexes().map((e=>Wt.fromNumberOfRows(this.sheet,e[0],e[1])))}}class Cs{constructor(e,t){this.sheet=e,this.indexes=t}normalizedIndexes(){return Ds(this.indexes)}columnsSpans(){return this.normalizedIndexes().map((e=>Gt.fromNumberOfColumns(this.sheet,e[0],e[1])))}}class Os{constructor(e,t){this.sheet=e,this.indexes=t}normalizedIndexes(){return Ms(this.indexes)}columnsSpans(){return this.normalizedIndexes().map((e=>Gt.fromNumberOfColumns(this.sheet,e[0],e[1])))}}class Is{constructor(e,t,r,n,a,s,i,o,c){this.dependencyGraph=t,this.columnSearch=r,this.cellContentParser=n,this.parser=a,this.stats=s,this.lazilyTransformingAstService=i,this.namedExpressions=o,this.arraySizePredictor=c,this.changes=Xr.empty(),this.allocateNamedExpressionAddressSpace(),this.maxColumns=e.maxColumns,this.maxRows=e.maxRows}get sheetMapping(){return this.dependencyGraph.sheetMapping}get addressMapping(){return this.dependencyGraph.addressMapping}removeRows(e){const t=[];for(const r of e.rowsSpans()){const e=this.doRemoveRows(r);e&&t.push(e)}return t}addRows(e){for(const t of e.rowsSpans())this.doAddRows(t)}addColumns(e){for(const t of e.columnsSpans())this.doAddColumns(t)}removeColumns(e){const t=[];for(const r of e.columnsSpans()){const e=this.doRemoveColumns(r);e&&t.push(e)}return t}removeSheet(e){let t;this.dependencyGraph.removeSheet(e),this.stats.measure(Vr.TRANSFORM_ASTS,(()=>{const r=new Rs(e);r.performEagerTransformations(this.dependencyGraph,this.parser),t=this.lazilyTransformingAstService.addTransformation(r)})),this.sheetMapping.removeSheet(e),this.columnSearch.removeSheet(e);const r=this.namedExpressions.getAllNamedExpressionsForScope(e).map((t=>this.removeNamedExpression(t.normalizeExpressionName(),e)));return{version:t,scopedNamedExpressions:r}}removeSheetByName(e){const t=this.sheetMapping.fetch(e);return this.removeSheet(t)}clearSheet(e){this.dependencyGraph.clearSheet(e),this.columnSearch.removeSheet(e)}addSheet(e){const t=this.sheetMapping.addSheet(e),r=[];return this.dependencyGraph.addressMapping.autoAddSheet(t,r,Ns(r)),this.sheetMapping.fetchDisplayName(t)}renameSheet(e,t){return this.sheetMapping.renameSheet(e,t)}moveRows(e,t,r,n){const a=Wt.fromNumberOfRows(e,n,r);this.lazilyTransformingAstService.beginCombinedMode(e),this.doAddRows(a),n<t&&(t+=r);const s=Wn(e,0,t),i=Wn(e,0,n);this.moveCells(s,Number.POSITIVE_INFINITY,r,i);const o=Wt.fromNumberOfRows(e,t,r);return this.doRemoveRows(o),this.lazilyTransformingAstService.commitCombinedMode()}moveColumns(e,t,r,n){const a=Gt.fromNumberOfColumns(e,n,r);this.lazilyTransformingAstService.beginCombinedMode(e),this.doAddColumns(a),n<t&&(t+=r);const s=Wn(e,t,0),i=Wn(e,n,0);this.moveCells(s,r,Number.POSITIVE_INFINITY,i);const o=Gt.fromNumberOfColumns(e,t,r);return this.doRemoveColumns(o),this.lazilyTransformingAstService.commitCombinedMode()}moveCells(e,t,r,n){this.ensureItIsPossibleToMoveCells(e,t,r,n);const a=jt.spanFrom(e,t,r),s=jt.spanFrom(n,t,r),i=n.col-e.col,o=n.row-e.row,c=n.sheet,l=this.getRangeClipboardCells(s),u=this.dependencyGraph.rawValuesFromRange(s);this.columnSearch.removeValues(u);const h=this.dependencyGraph.rawValuesFromRange(a);let f;this.columnSearch.moveValues(h,i,o,c),this.stats.measure(Vr.TRANSFORM_ASTS,(()=>{const e=new vs(a,i,o,c);e.performEagerTransformations(this.dependencyGraph,this.parser),f=this.lazilyTransformingAstService.addTransformation(e)})),this.dependencyGraph.moveCells(a,i,o,c);const d=this.updateNamedExpressionsForMovedCells(e,t,r,n);return{version:f,overwrittenCellsData:l,addedGlobalNamedExpressions:d}}setRowOrder(e,t){const r=[];let n=[];for(const[a,s]of t)if(a!==s){const t=jt.spanFrom({sheet:e,col:0,row:a},1/0,1),i=this.getRangeClipboardCells(t);n=n.concat(i),r.push(i.map((([{sheet:e,col:t},r])=>[{sheet:e,col:t,row:s},r])))}return r.forEach((t=>this.restoreClipboardCells(e,t.values()))),n}setColumnOrder(e,t){const r=[];let n=[];for(const[a,s]of t)if(a!==s){const t=jt.spanFrom({sheet:e,col:a,row:0},1,1/0),i=this.getRangeClipboardCells(t);n=n.concat(i),r.push(i.map((([{sheet:e,col:t,row:r},n])=>[{sheet:e,col:s,row:r},n])))}return r.forEach((t=>this.restoreClipboardCells(e,t.values()))),n}addNamedExpression(e,t,r,n){const a=this.namedExpressions.addNamedExpression(e,r,n);this.storeNamedExpressionInCell(a.address,t),this.adjustNamedExpressionEdges(a,e,r)}restoreNamedExpression(e,t,r){const n=e.displayName;this.restoreCell(e.address,t);const a=this.namedExpressions.restoreNamedExpression(e,r);this.adjustNamedExpressionEdges(a,n,r)}changeNamedExpressionExpression(e,t,r,n){const a=this.namedExpressions.namedExpressionForScope(e,r);if(!a)throw new S(e);const s=a.copy();a.options=n;const i=this.getClipboardCell(a.address);return this.storeNamedExpressionInCell(a.address,t),[s,i]}removeNamedExpression(e,t){const r=this.namedExpressions.namedExpressionForScope(e,t);if(!r)throw new S(e);this.namedExpressions.remove(r.displayName,t);const n=this.getClipboardCell(r.address);if(void 0!==t){const t=this.namedExpressions.workbookNamedExpressionOrPlaceholder(e);this.dependencyGraph.exchangeNode(r.address,t.address)}else this.dependencyGraph.setCellEmpty(r.address);return[r,n]}ensureItIsPossibleToMoveCells(e,t,r,n){if(Gn(e)||!(Ls(t)&&Ls(r)||ks(e,t,r))||Gn(n)||!this.sheetMapping.hasSheetWithId(e.sheet)||!this.sheetMapping.hasSheetWithId(n.sheet))throw new g("a valid range of cells to move.");const a=jt.spanFrom(e,t,r),s=jt.spanFrom(n,t,r);if(s.exceedsSheetSizeLimits(this.maxColumns,this.maxRows))throw new d;if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(a))throw new P;if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(s))throw new B}restoreClipboardCells(e,t){const r=[];for(const[n,a]of t)if(this.restoreCell(n,a),a.type===rs.FORMULA){const{dependencies:t}=this.parser.fetchCachedResult(a.hash);r.push(...this.updateNamedExpressionsForTargetAddress(e,n,t))}return r}restoreCell(e,t){switch(t.type){case rs.VALUE:this.setValueToCell(t,e);break;case rs.FORMULA:this.setFormulaToCellFromCache(t.hash,e);break;case rs.EMPTY:this.setCellEmpty(e);break;case rs.PARSING_ERROR:this.setParsingErrorToCell(t.rawInput,t.errors,e);break}}getOldContent(e){const t=this.dependencyGraph.getCell(e);if(void 0===t||t instanceof yn)return[e,{type:rs.EMPTY}];if(t instanceof Nn)return[e,Object.assign({type:rs.VALUE},t.getValues())];if(t instanceof rn)return[t.getAddress(this.lazilyTransformingAstService),{type:rs.FORMULA,hash:this.parser.computeHashFromAst(t.getFormula(this.lazilyTransformingAstService))}];if(t instanceof wn)return[e,{type:rs.PARSING_ERROR,rawInput:t.rawInput,errors:t.errors}];throw Error("Trying to copy unsupported type")}getClipboardCell(e){const t=this.dependencyGraph.getCell(e);if(void 0===t||t instanceof yn)return{type:rs.EMPTY};if(t instanceof Nn)return Object.assign({type:rs.VALUE},t.getValues());if(t instanceof nn){const r=t.getArrayCellValue(e);return r===rr?{type:rs.EMPTY}:{type:rs.VALUE,parsedValue:r,rawValue:t.getArrayCellRawValue(e)}}if(t instanceof an)return{type:rs.FORMULA,hash:this.parser.computeHashFromAst(t.getFormula(this.lazilyTransformingAstService))};if(t instanceof wn)return{type:rs.PARSING_ERROR,rawInput:t.rawInput,errors:t.errors};throw Error("Trying to copy unsupported type")}getSheetClipboardCells(e){const t=this.dependencyGraph.getSheetHeight(e),r=this.dependencyGraph.getSheetWidth(e),n=new Array(t);for(let a=0;a<t;a++){n[a]=new Array(r);for(let t=0;t<r;t++){const r=Wn(e,t,a);n[a][t]=this.getClipboardCell(r)}}return n}getRangeClipboardCells(e){const t=[];for(const r of e.addresses(this.dependencyGraph))t.push([r,this.getClipboardCell(r)]);return t}setCellContent(e,t){const r=this.cellContentParser.parse(t),n=this.getOldContent(e);if(r instanceof es.Formula){const t=this.parser.parse(r.formula,e),{ast:n,errors:a}=t;if(a.length>0)this.setParsingErrorToCell(r.formula,a,e);else{const r=this.arraySizePredictor.checkArraySize(n,e);this.setFormulaToCell(e,r,t)}}else r instanceof es.Empty?this.setCellEmpty(e):this.setValueToCell({parsedValue:r.value,rawValue:t},e);return n}setSheetContent(e,t){this.clearSheet(e);for(let r=0;r<t.length;r++)for(let n=0;n<t[r].length;n++){const a=Wn(e,n,r);this.setCellContent(a,t[r][n])}}setParsingErrorToCell(e,t,r){const n=this.dependencyGraph.getCellValue(r),a=new wn(t,e),s=this.dependencyGraph.setParsingErrorToCell(r,a);this.columnSearch.remove(nr(n),r),this.columnSearch.applyChanges(s.getChanges()),this.changes.addAll(s),this.changes.addChange(a.getCellValue(),r)}setFormulaToCell(e,t,{ast:r,hasVolatileFunction:n,hasStructuralChangeFunction:a,dependencies:s}){const i=this.dependencyGraph.getCellValue(e),o=this.dependencyGraph.setFormulaToCell(e,r,qt(s,e),t,n,a);this.columnSearch.remove(nr(i),e),this.columnSearch.applyChanges(o.getChanges()),this.changes.addAll(o)}setValueToCell(e,t){const r=this.dependencyGraph.getCellValue(t),n=this.dependencyGraph.setValueToCell(t,e);this.columnSearch.change(nr(r),nr(e.parsedValue),t),this.columnSearch.applyChanges(n.getChanges().filter((e=>!Xn(e.address,t)))),this.changes.addAll(n),this.changes.addChange(e.parsedValue,t)}setCellEmpty(e){if(this.dependencyGraph.isArrayInternalCell(e))return;const t=this.dependencyGraph.getCellValue(e),r=this.dependencyGraph.setCellEmpty(e);this.columnSearch.remove(nr(t),e),this.columnSearch.applyChanges(r.getChanges()),this.changes.addAll(r),this.changes.addChange(rr,e)}setFormulaToCellFromCache(e,t){const{ast:r,hasVolatileFunction:n,hasStructuralChangeFunction:a,dependencies:s}=this.parser.fetchCachedResult(e),i=qt(s,t),[o]=new Es(t.sheet).transformSingleAst(r,t);this.parser.rememberNewAst(o);const c=Jt(i),l=this.arraySizePredictor.checkArraySize(r,t);this.dependencyGraph.setFormulaToCell(t,o,c,l,n,a)}rowEffectivelyNotInSheet(e,t){const r=this.dependencyGraph.addressMapping.getHeight(t);return e>=r}getAndClearContentChanges(){const e=this.changes;return this.changes=Xr.empty(),e}forceApplyPostponedTransformations(){this.dependencyGraph.forceApplyPostponedTransformations()}doRemoveRows(e){if(this.rowEffectivelyNotInSheet(e.rowStart,e.sheet))return;const t=[];for(const[s]of this.dependencyGraph.entriesFromRowsSpan(e))t.push({address:s,cellType:this.getClipboardCell(s)});const{affectedArrays:r,contentChanges:n}=this.dependencyGraph.removeRows(e);let a;return this.columnSearch.applyChanges(n.getChanges()),this.stats.measure(Vr.TRANSFORM_ASTS,(()=>{const t=new As(e);t.performEagerTransformations(this.dependencyGraph,this.parser),a=this.lazilyTransformingAstService.addTransformation(t)})),this.rewriteAffectedArrays(r),{version:a,removedCells:t,rowFrom:e.rowStart,rowCount:e.numberOfRows}}doRemoveColumns(e){if(this.columnEffectivelyNotInSheet(e.columnStart,e.sheet))return;const t=[];for(const[s]of this.dependencyGraph.entriesFromColumnsSpan(e))t.push({address:s,cellType:this.getClipboardCell(s)});const{affectedArrays:r,contentChanges:n}=this.dependencyGraph.removeColumns(e);let a;return this.columnSearch.applyChanges(n.getChanges()),this.columnSearch.removeColumns(e),this.stats.measure(Vr.TRANSFORM_ASTS,(()=>{const t=new Ss(e);t.performEagerTransformations(this.dependencyGraph,this.parser),a=this.lazilyTransformingAstService.addTransformation(t)})),this.rewriteAffectedArrays(r),{version:a,removedCells:t,columnFrom:e.columnStart,columnCount:e.numberOfColumns}}doAddRows(e){if(this.rowEffectivelyNotInSheet(e.rowStart,e.sheet))return;const{affectedArrays:t}=this.dependencyGraph.addRows(e);this.stats.measure(Vr.TRANSFORM_ASTS,(()=>{const t=new gs(e);t.performEagerTransformations(this.dependencyGraph,this.parser),this.lazilyTransformingAstService.addTransformation(t)})),this.rewriteAffectedArrays(t)}rewriteAffectedArrays(e){for(const t of e.values()){if(t.array.size.isRef)continue;const e=t.getFormula(this.lazilyTransformingAstService),r=t.getAddress(this.lazilyTransformingAstService),n=this.parser.computeHashFromAst(e);this.setFormulaToCellFromCache(n,r)}}doAddColumns(e){if(this.columnEffectivelyNotInSheet(e.columnStart,e.sheet))return;const{affectedArrays:t,contentChanges:r}=this.dependencyGraph.addColumns(e);this.columnSearch.addColumns(e),this.columnSearch.applyChanges(r.getChanges()),this.stats.measure(Vr.TRANSFORM_ASTS,(()=>{const t=new ms(e);t.performEagerTransformations(this.dependencyGraph,this.parser),this.lazilyTransformingAstService.addTransformation(t)})),this.rewriteAffectedArrays(t)}columnEffectivelyNotInSheet(e,t){const r=this.dependencyGraph.addressMapping.getWidth(t);return e>=r}adjustNamedExpressionEdges(e,t,r){if(void 0===r)return;const n=this.dependencyGraph.fetchCellOrCreateEmpty(e.address),a=this.namedExpressions.workbookNamedExpressionOrPlaceholder(t),s=this.dependencyGraph.fetchCellOrCreateEmpty(a.address);for(const i of this.dependencyGraph.graph.adjacentNodes(s))if(i instanceof an&&i.getAddress(this.lazilyTransformingAstService).sheet===r){const t=i.getFormula(this.lazilyTransformingAstService),r=i.getAddress(this.lazilyTransformingAstService),{dependencies:a}=this.parser.fetchCachedResultForAst(t);for(const o of qt(a,r))o instanceof Vt&&o.name.toLowerCase()===e.displayName.toLowerCase()&&(this.dependencyGraph.graph.removeEdge(s,i),this.dependencyGraph.graph.addEdge(n,i))}}storeNamedExpressionInCell(e,t){const r=this.cellContentParser.parse(t);if(r instanceof es.Formula){const t=this.parser.parse(r.formula,Wn(-1,0,0));if(ds(t.ast))throw new Y;const{ast:n,hasVolatileFunction:a,hasStructuralChangeFunction:s,dependencies:i}=t;this.dependencyGraph.setFormulaToCell(e,n,qt(i,e),Gr.scalar(),a,s)}else r instanceof es.Empty?this.setCellEmpty(e):this.setValueToCell({parsedValue:r.value,rawValue:t},e)}updateNamedExpressionsForMovedCells(e,t,r,n){if(e.sheet===n.sheet)return[];const a=[],s=jt.spanFrom(n,t,r);for(const i of s.addresses(this.dependencyGraph)){const t=this.addressMapping.fetchCell(i);if(t instanceof an&&i.sheet!==e.sheet){const r=t.getFormula(this.lazilyTransformingAstService),{dependencies:n}=this.parser.fetchCachedResultForAst(r);a.push(...this.updateNamedExpressionsForTargetAddress(e.sheet,i,n))}}return a}updateNamedExpressionsForTargetAddress(e,t,r){if(e===t.sheet)return[];const n=[],a=this.addressMapping.fetchCell(t);for(const s of qt(r,t)){if(!(s instanceof Vt))continue;const r=s.name,i=this.dependencyGraph.fetchNamedExpressionVertex(r,e),o=this.namedExpressions.isExpressionInScope(r,t.sheet),c=o?this.dependencyGraph.fetchNamedExpressionVertex(r,t.sheet):this.copyOrFetchGlobalNamedExpressionVertex(r,i,n);c!==i&&(this.dependencyGraph.graph.softRemoveEdge(i,a),this.dependencyGraph.graph.addEdge(c,a))}return n}allocateNamedExpressionAddressSpace(){this.dependencyGraph.addressMapping.addSheet(fs.SHEET_FOR_WORKBOOK_EXPRESSIONS,new bn(0,0))}copyOrFetchGlobalNamedExpressionVertex(e,t,r){let n=this.namedExpressions.namedExpressionForScope(e);if(void 0===n)if(n=this.namedExpressions.addNamedExpression(e),r.push(n.normalizeExpressionName()),t instanceof an){const e=this.parser.fetchCachedResultForAst(t.getFormula(this.lazilyTransformingAstService)),{ast:r,hasVolatileFunction:a,hasStructuralChangeFunction:s,dependencies:i}=e;this.dependencyGraph.setFormulaToCell(n.address,r,qt(i,n.address),Gr.scalar(),a,s)}else t instanceof yn?this.setCellEmpty(n.address):t instanceof Nn&&this.setValueToCell(t.getValues(),n.address);return this.dependencyGraph.fetchCellOrCreateEmpty(n.address)}}function Ms(e){if(e.length<=1)return e;const t=[...e].sort((([e],[t])=>e-t)),r=t.reduce(((e,[t,r])=>{const n=e[e.length-1],a=n[0]+n[1];return t<=a?n[1]+=Math.max(0,r-(a-t)):e.push([t,r]),e}),[t[0]]);let n=0;for(let a=0;a<r.length;++a)r[a][0]-=n,n+=r[a][1];return r}function Ds(e){if(e.length<=1)return e;const t=[...e].sort((([e],[t])=>e-t)),r=t.reduce(((e,[t,r])=>{const n=e[e.length-1];return t===n[0]?n[1]=Math.max(n[1],r):e.push([t,r]),e}),[t[0]]);let n=0;for(let a=0;a<r.length;++a)r[a][0]+=n,n+=r[a][1];return r}function Ls(e){return Number.isInteger(e)&&e>0}function ks(e,t,r){return 0===e.row&&Ls(t)&&r===Number.POSITIVE_INFINITY||0===e.col&&Ls(r)&&t===Number.POSITIVE_INFINITY}
/**
 * @license
 * Copyright (c) 2022 Handsoncode. All rights reserved.
 */
class _s{}class Us extends _s{constructor(e,t){super(),this.command=e,this.rowsRemovals=t}doUndo(e){e.undoRemoveRows(this)}doRedo(e){e.redoRemoveRows(this)}}class xs extends _s{constructor(e,t,r,n,a,s,i){super(),this.sourceLeftCorner=e,this.width=t,this.height=r,this.destinationLeftCorner=n,this.overwrittenCellsData=a,this.addedGlobalNamedExpressions=s,this.version=i}doUndo(e){e.undoMoveCells(this)}doRedo(e){e.redoMoveCells(this)}}class Fs extends _s{constructor(e){super(),this.command=e}doUndo(e){e.undoAddRows(this)}doRedo(e){e.redoAddRows(this)}}class Ps extends _s{constructor(e,t,r){super(),this.sheetId=e,this.rowMapping=t,this.oldContent=r}doUndo(e){e.undoSetRowOrder(this)}doRedo(e){e.redoSetRowOrder(this)}}class Bs extends _s{constructor(e,t,r){super(),this.sheetId=e,this.columnMapping=t,this.oldContent=r}doUndo(e){e.undoSetColumnOrder(this)}doRedo(e){e.redoSetColumnOrder(this)}}class Ys extends _s{constructor(e,t,r){super(),this.sheetId=e,this.oldSheetContent=t,this.newSheetContent=r}doUndo(e){e.undoSetSheetContent(this)}doRedo(e){e.redoSetSheetContent(this)}}class Vs extends _s{constructor(e,t,r,n,a){super(),this.sheet=e,this.startRow=t,this.numberOfRows=r,this.targetRow=n,this.version=a,this.undoStart=this.startRow<this.targetRow?this.targetRow-this.numberOfRows:this.targetRow,this.undoEnd=this.startRow>this.targetRow?this.startRow+this.numberOfRows:this.startRow}doUndo(e){e.undoMoveRows(this)}doRedo(e){e.redoMoveRows(this)}}class Ws extends _s{constructor(e,t,r,n,a){super(),this.sheet=e,this.startColumn=t,this.numberOfColumns=r,this.targetColumn=n,this.version=a,this.undoStart=this.startColumn<this.targetColumn?this.targetColumn-this.numberOfColumns:this.targetColumn,this.undoEnd=this.startColumn>this.targetColumn?this.startColumn+this.numberOfColumns:this.startColumn}doUndo(e){e.undoMoveColumns(this)}doRedo(e){e.redoMoveColumns(this)}}class Gs extends _s{constructor(e){super(),this.command=e}doUndo(e){e.undoAddColumns(this)}doRedo(e){e.redoAddColumns(this)}}class Hs extends _s{constructor(e,t){super(),this.command=e,this.columnsRemovals=t}doUndo(e){e.undoRemoveColumns(this)}doRedo(e){e.redoRemoveColumns(this)}}class zs extends _s{constructor(e){super(),this.sheetName=e}doUndo(e){e.undoAddSheet(this)}doRedo(e){e.redoAddSheet(this)}}class $s extends _s{constructor(e,t,r,n,a){super(),this.sheetName=e,this.sheetId=t,this.oldSheetContent=r,this.scopedNamedExpressions=n,this.version=a}doUndo(e){e.undoRemoveSheet(this)}doRedo(e){e.redoRemoveSheet(this)}}class js extends _s{constructor(e,t,r){super(),this.sheetId=e,this.oldName=t,this.newName=r}doUndo(e){e.undoRenameSheet(this)}doRedo(e){e.redoRenameSheet(this)}}class Xs extends _s{constructor(e,t){super(),this.sheetId=e,this.oldSheetContent=t}doUndo(e){e.undoClearSheet(this)}doRedo(e){e.redoClearSheet(this)}}class Ks extends _s{constructor(e){super(),this.cellContents=e}doUndo(e){e.undoSetCellContents(this)}doRedo(e){e.redoSetCellContents(this)}}class qs extends _s{constructor(e,t,r,n){super(),this.targetLeftCorner=e,this.oldContent=t,this.newContent=r,this.addedGlobalNamedExpressions=n}doUndo(e){e.undoPaste(this)}doRedo(e){e.redoPaste(this)}}class Js extends _s{constructor(e,t,r,n){super(),this.name=e,this.newContent=t,this.scope=r,this.options=n}doUndo(e){e.undoAddNamedExpression(this)}doRedo(e){e.redoAddNamedExpression(this)}}class Qs extends _s{constructor(e,t,r){super(),this.namedExpression=e,this.content=t,this.scope=r}doUndo(e){e.undoRemoveNamedExpression(this)}doRedo(e){e.redoRemoveNamedExpression(this)}}class Zs extends _s{constructor(e,t,r,n,a){super(),this.namedExpression=e,this.newContent=t,this.oldContent=r,this.scope=n,this.options=a}doUndo(e){e.undoChangeNamedExpression(this)}doRedo(e){e.redoChangeNamedExpression(this)}}class ei extends _s{constructor(){super(...arguments),this.operations=[]}add(e){this.operations.push(e)}*reversedOperations(){for(let e=this.operations.length-1;e>=0;e--)yield this.operations[e]}doUndo(e){e.undoBatch(this)}doRedo(e){e.redoBatch(this)}}class ti{constructor(e,t){this.operations=t,this.oldData=new Map,this.undoStack=[],this.redoStack=[],this.undoLimit=e.undoLimit}saveOperation(e){void 0!==this.batchUndoEntry?this.batchUndoEntry.add(e):this.addUndoEntry(e)}beginBatchMode(){this.batchUndoEntry=new ei}commitBatchMode(){if(void 0===this.batchUndoEntry)throw"Batch mode wasn't started";this.addUndoEntry(this.batchUndoEntry),this.batchUndoEntry=void 0}storeDataForVersion(e,t,r){this.oldData.has(e)||this.oldData.set(e,[]);const n=this.oldData.get(e);n.push([t,r])}clearRedoStack(){this.redoStack=[]}clearUndoStack(){this.undoStack=[]}isUndoStackEmpty(){return 0===this.undoStack.length}isRedoStackEmpty(){return 0===this.redoStack.length}undo(){const e=this.undoStack.pop();if(!e)throw"Attempted to undo without operation on stack";this.undoEntry(e),this.redoStack.push(e)}undoBatch(e){for(const t of e.reversedOperations())this.undoEntry(t)}undoRemoveRows(e){this.operations.forceApplyPostponedTransformations();const{command:{sheet:t},rowsRemovals:r}=e;for(let n=r.length-1;n>=0;--n){const e=r[n];this.operations.addRows(new bs(t,[[e.rowFrom,e.rowCount]]));for(const{address:t,cellType:r}of e.removedCells)this.operations.restoreCell(t,r);this.restoreOldDataFromVersion(e.version-1)}}undoRemoveColumns(e){this.operations.forceApplyPostponedTransformations();const{command:{sheet:t},columnsRemovals:r}=e;for(let n=r.length-1;n>=0;--n){const e=r[n];this.operations.addColumns(new Cs(t,[[e.columnFrom,e.columnCount]]));for(const{address:t,cellType:r}of e.removedCells)this.operations.restoreCell(t,r);this.restoreOldDataFromVersion(e.version-1)}}undoAddRows(e){const t=e.command.rowsSpans();for(let r=t.length-1;r>=0;--r){const n=t[r];this.operations.removeRows(new ws(e.command.sheet,[[n.rowStart,n.numberOfRows]]))}}undoAddColumns(e){const t=e.command.columnsSpans();for(let r=t.length-1;r>=0;--r){const n=t[r];this.operations.removeColumns(new Os(e.command.sheet,[[n.columnStart,n.numberOfColumns]]))}}undoSetCellContents(e){for(const t of e.cellContents){const e=t.address,[r,n]=t.oldContent;Xn(e,r)||this.operations.setCellEmpty(e),this.operations.restoreCell(r,n)}}undoPaste(e){this.restoreOperationOldContent(e.oldContent);for(const t of e.addedGlobalNamedExpressions)this.operations.removeNamedExpression(t)}undoMoveRows(e){const{sheet:t}=e;this.operations.moveRows(t,e.undoStart,e.numberOfRows,e.undoEnd),this.restoreOldDataFromVersion(e.version-1)}undoMoveColumns(e){const{sheet:t}=e;this.operations.moveColumns(t,e.undoStart,e.numberOfColumns,e.undoEnd),this.restoreOldDataFromVersion(e.version-1)}undoMoveCells(e){this.operations.forceApplyPostponedTransformations(),this.operations.moveCells(e.destinationLeftCorner,e.width,e.height,e.sourceLeftCorner),this.restoreOperationOldContent(e.overwrittenCellsData),this.restoreOldDataFromVersion(e.version-1);for(const t of e.addedGlobalNamedExpressions)this.operations.removeNamedExpression(t)}undoAddSheet(e){const{sheetName:t}=e;this.operations.removeSheetByName(t)}undoRemoveSheet(e){this.operations.forceApplyPostponedTransformations();const{oldSheetContent:t,sheetId:r}=e;this.operations.addSheet(e.sheetName);for(let n=0;n<t.length;n++){const e=t[n];for(let t=0;t<e.length;t++){const a=e[t],s=Wn(r,t,n);this.operations.restoreCell(s,a)}}for(const[n,a]of e.scopedNamedExpressions)this.operations.restoreNamedExpression(n,a,r);this.restoreOldDataFromVersion(e.version-1)}undoRenameSheet(e){this.operations.renameSheet(e.sheetId,e.oldName)}undoClearSheet(e){const{oldSheetContent:t,sheetId:r}=e;for(let n=0;n<t.length;n++){const e=t[n];for(let t=0;t<e.length;t++){const a=e[t],s=Wn(r,t,n);this.operations.restoreCell(s,a)}}}undoSetSheetContent(e){const{oldSheetContent:t,sheetId:r}=e;this.operations.clearSheet(r);for(let n=0;n<t.length;n++){const e=t[n];for(let t=0;t<e.length;t++){const a=e[t],s=Wn(r,t,n);this.operations.restoreCell(s,a)}}}undoAddNamedExpression(e){this.operations.removeNamedExpression(e.name,e.scope)}undoRemoveNamedExpression(e){this.operations.restoreNamedExpression(e.namedExpression,e.content,e.scope)}undoChangeNamedExpression(e){this.operations.restoreNamedExpression(e.namedExpression,e.oldContent,e.scope)}undoSetRowOrder(e){this.restoreOperationOldContent(e.oldContent)}undoSetColumnOrder(e){this.restoreOperationOldContent(e.oldContent)}redo(){const e=this.redoStack.pop();if(!e)throw"Attempted to redo without operation on stack";this.redoEntry(e),this.undoStack.push(e)}redoBatch(e){for(const t of e.operations)this.redoEntry(t)}redoRemoveRows(e){this.operations.removeRows(e.command)}redoMoveCells(e){this.operations.moveCells(e.sourceLeftCorner,e.width,e.height,e.destinationLeftCorner)}redoRemoveColumns(e){this.operations.removeColumns(e.command)}redoPaste(e){const{targetLeftCorner:t,newContent:r}=e,n=r.length,a=r[0].length;for(let s=0;s<n;++s)for(let e=0;e<a;++e){const n=Wn(t.sheet,t.col+e,t.row+s);this.operations.restoreCell(n,r[s][e])}}redoSetCellContents(e){for(const t of e.cellContents)this.operations.setCellContent(t.address,t.newContent)}redoAddRows(e){this.operations.addRows(e.command)}redoAddColumns(e){this.operations.addColumns(e.command)}redoRemoveSheet(e){this.operations.removeSheetByName(e.sheetName)}redoAddSheet(e){this.operations.addSheet(e.sheetName)}redoRenameSheet(e){this.operations.renameSheet(e.sheetId,e.newName)}redoMoveRows(e){this.operations.moveRows(e.sheet,e.startRow,e.numberOfRows,e.targetRow)}redoMoveColumns(e){this.operations.moveColumns(e.sheet,e.startColumn,e.numberOfColumns,e.targetColumn)}redoClearSheet(e){this.operations.clearSheet(e.sheetId)}redoSetSheetContent(e){const{sheetId:t,newSheetContent:r}=e;this.operations.setSheetContent(t,r)}redoAddNamedExpression(e){this.operations.addNamedExpression(e.name,e.newContent,e.scope,e.options)}redoRemoveNamedExpression(e){this.operations.removeNamedExpression(e.namedExpression.displayName,e.scope)}redoChangeNamedExpression(e){this.operations.changeNamedExpressionExpression(e.namedExpression.displayName,e.newContent,e.scope,e.options)}redoSetRowOrder(e){this.operations.setRowOrder(e.sheetId,e.rowMapping)}redoSetColumnOrder(e){this.operations.setColumnOrder(e.sheetId,e.columnMapping)}addUndoEntry(e){this.undoStack.push(e),this.undoStack.splice(0,Math.max(0,this.undoStack.length-this.undoLimit))}undoEntry(e){e.doUndo(this)}restoreOperationOldContent(e){for(const[t,r]of e)this.operations.restoreCell(t,r)}redoEntry(e){e.doRedo(this)}restoreOldDataFromVersion(e){const t=this.oldData.get(e)||[];for(const r of t){const[e,t]=r;this.operations.setFormulaToCellFromCache(t,e)}}}
/**
 * @license
 * Copyright (c) 2022 Handsoncode. All rights reserved.
 */
class ri{constructor(e,t,r,n,a,s,i,o,c,l){this.operations=t,this.undoRedo=r,this.clipboardOperations=n,this.dependencyGraph=a,this.columnSearch=s,this.parser=i,this.cellContentParser=o,this.lazilyTransformingAstService=c,this.namedExpressions=l,this.maxRows=e.maxRows,this.maxColumns=e.maxColumns}get sheetMapping(){return this.dependencyGraph.sheetMapping}addRows(e,...t){const r=new bs(e,t);this.ensureItIsPossibleToAddRows(e,...t),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut(),this.operations.addRows(r),this.undoRedo.saveOperation(new Fs(r))}removeRows(e,...t){const r=new ws(e,t);this.ensureItIsPossibleToRemoveRows(e,...t),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const n=this.operations.removeRows(r);this.undoRedo.saveOperation(new Us(r,n))}addColumns(e,...t){const r=new Cs(e,t);this.ensureItIsPossibleToAddColumns(e,...t),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut(),this.operations.addColumns(r),this.undoRedo.saveOperation(new Gs(r))}removeColumns(e,...t){const r=new Os(e,t);this.ensureItIsPossibleToRemoveColumns(e,...t),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const n=this.operations.removeColumns(r);this.undoRedo.saveOperation(new Hs(r,n))}moveCells(e,t,r,n){this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const{version:a,overwrittenCellsData:s,addedGlobalNamedExpressions:i}=this.operations.moveCells(e,t,r,n);this.undoRedo.saveOperation(new xs(e,t,r,n,s,i,a))}moveRows(e,t,r,n){this.ensureItIsPossibleToMoveRows(e,t,r,n),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const a=this.operations.moveRows(e,t,r,n);this.undoRedo.saveOperation(new Vs(e,t,r,n,a))}moveColumns(e,t,r,n){this.ensureItIsPossibleToMoveColumns(e,t,r,n),this.undoRedo.clearRedoStack();const a=this.operations.moveColumns(e,t,r,n);this.undoRedo.saveOperation(new Ws(e,t,r,n,a))}cut(e,t,r){this.clipboardOperations.cut(e,t,r)}ensureItIsPossibleToCopy(e,t,r){if(!ni(t))throw new g("width to be positive integer.");if(!ni(r))throw new g("height to be positive integer.")}copy(e,t,r){this.ensureItIsPossibleToCopy(e,t,r),this.clipboardOperations.copy(e,t,r)}paste(e){const t=this.clipboardOperations.clipboard;if(void 0===t)throw new y;if(this.clipboardOperations.isCutClipboard())this.moveCells(t.sourceLeftCorner,t.width,t.height,e);else if(this.clipboardOperations.isCopyClipboard()){this.clipboardOperations.ensureItIsPossibleToCopyPaste(e);const r=jt.spanFrom(e,t.width,t.height),n=this.operations.getRangeClipboardCells(r);this.undoRedo.clearRedoStack();const a=this.operations.restoreClipboardCells(t.sourceLeftCorner.sheet,t.getContent(e));this.undoRedo.saveOperation(new qs(e,n,t.content,a))}}beginUndoRedoBatchMode(){this.undoRedo.beginBatchMode()}commitUndoRedoBatchMode(){this.undoRedo.commitBatchMode()}isClipboardEmpty(){return void 0===this.clipboardOperations.clipboard}clearClipboard(){this.clipboardOperations.clear()}addSheet(e){void 0!==e&&this.ensureItIsPossibleToAddSheet(e),this.undoRedo.clearRedoStack();const t=this.operations.addSheet(e);return this.undoRedo.saveOperation(new zs(t)),t}removeSheet(e){this.ensureScopeIdIsValid(e),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const t=this.sheetMapping.fetchDisplayName(e),r=this.operations.getSheetClipboardCells(e),{version:n,scopedNamedExpressions:a}=this.operations.removeSheet(e);this.undoRedo.saveOperation(new $s(t,e,r,a,n))}renameSheet(e,t){this.ensureItIsPossibleToRenameSheet(e,t);const r=this.operations.renameSheet(e,t);return void 0!==r&&(this.undoRedo.clearRedoStack(),this.undoRedo.saveOperation(new js(e,r,t))),r}clearSheet(e){this.ensureScopeIdIsValid(e),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const t=this.operations.getSheetClipboardCells(e);this.operations.clearSheet(e),this.undoRedo.saveOperation(new Xs(e,t))}setCellContents(e,t){if(t instanceof Array){for(let n=0;n<t.length;n++)if(!(t[n]instanceof Array))throw new g("an array of arrays or a raw cell value.")}else t=[[t]];this.ensureItIsPossibleToChangeCellContents(e,t),this.undoRedo.clearRedoStack();const r=[];for(let n=0;n<t.length;n++)for(let a=0;a<t[n].length;a++){const s={sheet:e.sheet,row:e.row+n,col:e.col+a},i=t[n][a];this.clipboardOperations.abortCut();const o=this.operations.setCellContent(s,i);r.push({address:s,newContent:i,oldContent:o})}this.undoRedo.saveOperation(new Ks(r))}setSheetContent(e,t){this.ensureScopeIdIsValid(e),this.ensureItIsPossibleToChangeSheetContents(e,t),ys(t),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const r=this.operations.getSheetClipboardCells(e);this.operations.setSheetContent(e,t),this.undoRedo.saveOperation(new Ys(e,r,t))}setRowOrder(e,t){this.validateSwapRowIndexes(e,t),this.testRowOrderForArrays(e,t),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const r=this.operations.setRowOrder(e,t);this.undoRedo.saveOperation(new Ps(e,t,r))}validateSwapRowIndexes(e,t){if(!this.sheetMapping.hasSheetWithId(e))throw new u(e);this.validateRowOrColumnMapping(e,t,"row")}testColumnOrderForArrays(e,t){for(const[r,n]of t)if(r!==n){const t=jt.spanFrom({sheet:e,col:r,row:0},1,1/0);if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(t))throw new P}}setColumnOrder(e,t){this.validateSwapColumnIndexes(e,t),this.testColumnOrderForArrays(e,t),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const r=this.operations.setColumnOrder(e,t);this.undoRedo.saveOperation(new Bs(e,t,r))}validateSwapColumnIndexes(e,t){if(!this.sheetMapping.hasSheetWithId(e))throw new u(e);this.validateRowOrColumnMapping(e,t,"column")}testRowOrderForArrays(e,t){for(const[r,n]of t)if(r!==n){const t=jt.spanFrom({sheet:e,col:0,row:r},1/0,1);if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(t))throw new P}}mappingFromOrder(e,t,r){if(!this.sheetMapping.hasSheetWithId(e))throw new u(e);const n="row"===r?this.dependencyGraph.getSheetHeight(e):this.dependencyGraph.getSheetWidth(e);if(t.length!==n)throw new g(`number of ${r}s provided to be sheet ${"row"===r?"height":"width"}.`);const a=[];for(let s=0;s<n;s++)t[s]!==s&&a.push([s,t[s]]);return a}undo(){if(this.undoRedo.isUndoStackEmpty())throw new A;this.clipboardOperations.abortCut(),this.undoRedo.undo()}redo(){if(this.undoRedo.isRedoStackEmpty())throw new R;this.clipboardOperations.abortCut(),this.undoRedo.redo()}addNamedExpression(e,t,r,n){this.ensureItIsPossibleToAddNamedExpression(e,t,r),this.operations.addNamedExpression(e,t,r,n),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut(),this.undoRedo.saveOperation(new Js(e,t,r,n))}changeNamedExpressionExpression(e,t,r,n){this.ensureItIsPossibleToChangeNamedExpression(e,r,t);const[a,s]=this.operations.changeNamedExpressionExpression(e,r,t,n);this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut(),this.undoRedo.saveOperation(new Zs(a,r,s,t,n))}removeNamedExpression(e,t){this.ensureScopeIdIsValid(t);const[r,n]=this.operations.removeNamedExpression(e,t);return this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut(),this.undoRedo.saveOperation(new Qs(r,n,t)),r}ensureItIsPossibleToAddNamedExpression(e,t,r){this.ensureScopeIdIsValid(r),this.ensureNamedExpressionNameIsValid(e,r),this.ensureNamedExpressionIsValid(t)}ensureItIsPossibleToChangeNamedExpression(e,t,r){if(this.ensureScopeIdIsValid(r),void 0===this.namedExpressions.namedExpressionForScope(e,r))throw new S(e);this.ensureNamedExpressionIsValid(t)}isItPossibleToRemoveNamedExpression(e,t){if(this.ensureScopeIdIsValid(t),void 0===this.namedExpressions.namedExpressionForScope(e,t))throw new S(e)}ensureItIsPossibleToAddRows(e,...t){if(!this.sheetMapping.hasSheetWithId(e))throw new u(e);const r=this.dependencyGraph.getSheetHeight(e),n=t.map((e=>e[1])).reduce(((e,t)=>e+t),0);if(r+n>this.maxRows)throw new d;for(const[a,s]of t)if(!ai(a)||!ni(s))throw new g("row number to be nonnegative and number of rows to add to be positive.")}ensureItIsPossibleToRemoveRows(e,...t){for(const[r,n]of t){const t=r+n-1;if(!ai(r)||!ai(t))throw new g("starting and ending row to be nonnegative.");if(t<r)throw new g("starting row to be smaller than the ending row.");if(!this.sheetMapping.hasSheetWithId(e))throw new u(e)}}ensureItIsPossibleToAddColumns(e,...t){if(!this.sheetMapping.hasSheetWithId(e))throw new u(e);const r=this.dependencyGraph.getSheetWidth(e),n=t.map((e=>e[1])).reduce(((e,t)=>e+t),0);if(r+n>this.maxColumns)throw new d;for(const[a,s]of t)if(!ai(a)||!ni(s))throw new g("column number to be nonnegative and number of columns to add to be positive.")}ensureItIsPossibleToRemoveColumns(e,...t){for(const[r,n]of t){const t=r+n-1;if(!ai(r)||!ai(t))throw new g("starting and ending column to be nonnegative.");if(t<r)throw new g("starting column to be smaller than the ending column.");if(!this.sheetMapping.hasSheetWithId(e))throw new u(e)}}ensureItIsPossibleToMoveRows(e,t,r,n){this.ensureItIsPossibleToAddRows(e,[n,r]);const a=Wn(e,0,t),s=Wn(e,0,n);if(!this.sheetMapping.hasSheetWithId(e)||Gn(a)||Gn(s)||!ni(r)||n<=t+r&&n>=t)throw new g("a valid range of rows to move.");const i=this.dependencyGraph.getSheetWidth(e),o=jt.spanFrom(a,i,r);if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(o))throw new P;if(n>0&&this.dependencyGraph.arrayMapping.isFormulaArrayInAllRows(Wt.fromNumberOfRows(e,n-1,2)))throw new B}ensureItIsPossibleToMoveColumns(e,t,r,n){this.ensureItIsPossibleToAddColumns(e,[n,r]);const a=Wn(e,t,0),s=Wn(e,n,0);if(!this.sheetMapping.hasSheetWithId(e)||Gn(a)||Gn(s)||!ni(r)||n<=t+r&&n>=t)throw new g("a valid range of columns to move.");const i=this.dependencyGraph.getSheetHeight(e),o=jt.spanFrom(a,r,i);if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(o))throw new P;if(n>0&&this.dependencyGraph.arrayMapping.isFormulaArrayInAllColumns(Gt.fromNumberOfColumns(e,n-1,2)))throw new B}ensureItIsPossibleToAddSheet(e){if(this.sheetMapping.hasSheetWithName(e))throw new f(e)}ensureItIsPossibleToRenameSheet(e,t){if(!this.sheetMapping.hasSheetWithId(e))throw new u(e);const r=this.sheetMapping.get(t);if(void 0!==r&&r!==e)throw new f(t)}ensureItIsPossibleToChangeContent(e){if(Gn(e))throw new m(e);if(!this.sheetMapping.hasSheetWithId(e.sheet))throw new u(e.sheet)}ensureItIsPossibleToChangeCellContents(e,t){const r=Ns(t),n=jt.spanFrom(e,r.width,r.height);this.ensureRangeInSizeLimits(n);for(const a of n.addresses(this.dependencyGraph))this.ensureItIsPossibleToChangeContent(a)}ensureItIsPossibleToChangeSheetContents(e,t){const r=Ns(t),n=jt.spanFrom(Wn(e,0,0),r.width,r.height);this.ensureRangeInSizeLimits(n)}ensureRangeInSizeLimits(e){if(e.exceedsSheetSizeLimits(this.maxColumns,this.maxRows))throw new d}isThereSomethingToUndo(){return!this.undoRedo.isUndoStackEmpty()}isThereSomethingToRedo(){return!this.undoRedo.isRedoStackEmpty()}getAndClearContentChanges(){return this.operations.getAndClearContentChanges()}ensureScopeIdIsValid(e){if(void 0!==e&&!this.sheetMapping.hasSheetWithId(e))throw new u(e)}validateRowOrColumnMapping(e,t,r){const n="row"===r?this.dependencyGraph.getSheetHeight(e):this.dependencyGraph.getSheetWidth(e),a=t.map((([e,t])=>e)).sort(((e,t)=>e-t)),s=t.map((([e,t])=>t)).sort(((e,t)=>e-t));for(let i=0;i<a.length;i++){if(!ai(a[i])||a[i]>=n)throw new g(`${r} numbers to be nonnegative integers and less than sheet ${"row"===r?"height":"width"}.`);if(a[i]===a[i+1])throw new g(`source ${r} numbers to be unique.`);if(a[i]!==s[i])throw new g(`target ${r} numbers to be permutation of source ${r} numbers.`)}}ensureNamedExpressionNameIsValid(e,t){if(!this.namedExpressions.isNameValid(e))throw new T(e);if(!this.namedExpressions.isNameAvailable(e,t))throw new v(e)}ensureNamedExpressionIsValid(e){const t=this.cellContentParser.parse(e);if(t instanceof es.Formula){const e=this.parser.parse(t.formula,Wn(-1,0,0));if(ds(e.ast))throw new Y}}}function ni(e){return Number.isInteger(e)&&e>0}function ai(e){return Number.isInteger(e)&&e>=0}
/**
 * @license
 * Copyright (c) 2022 Handsoncode. All rights reserved.
 */
class si{constructor(e,t,r,n,a,s){this.config=e,this.stats=t,this.interpreter=r,this.lazilyTransformingAstService=n,this.dependencyGraph=a,this.columnSearch=s}run(){this.stats.start(Vr.TOP_SORT);const{sorted:e,cycled:t}=this.dependencyGraph.topSortWithScc();this.stats.end(Vr.TOP_SORT),this.stats.measure(Vr.EVALUATION,(()=>{this.recomputeFormulas(t,e)}))}partialRun(e){const t=Xr.empty();return this.stats.measure(Vr.EVALUATION,(()=>{this.dependencyGraph.graph.getTopSortedWithSccSubgraphFrom(e,(e=>{if(e instanceof rn){const r=e.isComputed()?e.getCellValue():void 0,n=this.recomputeFormulaVertexValue(e);if(n!==r){const a=e.getAddress(this.lazilyTransformingAstService);return t.addChange(n,a),this.columnSearch.change(nr(r),nr(n),a),!0}return!1}return!(e instanceof sn)||(e.clearCache(),!0)}),(e=>{if(e instanceof sn)e.clearCache();else if(e instanceof rn){const r=e.getAddress(this.lazilyTransformingAstService);this.columnSearch.remove(nr(e.valueOrUndef()),r);const n=new Fn(En.CYCLE,void 0,e);e.setCellValue(n),t.addChange(n,r)}}))})),t}runAndForget(e,t,r){const n=[];for(const s of qt(r,t))if(s instanceof jt){const e=s;if(void 0===this.dependencyGraph.getRange(e.start,e.end)){const t=new sn(e);this.dependencyGraph.rangeMapping.setRange(t),n.push(t)}}const a=this.evaluateAstToCellValue(e,new Qt(t,this.config.useArrayArithmetic));return n.forEach((e=>{this.dependencyGraph.rangeMapping.removeRange(e)})),a}recomputeFormulas(e,t){e.forEach((e=>{e instanceof rn&&e.setCellValue(new Fn(En.CYCLE,void 0,e))})),t.forEach((e=>{if(e instanceof rn){const t=this.recomputeFormulaVertexValue(e),r=e.getAddress(this.lazilyTransformingAstService);this.columnSearch.add(nr(t),r)}else e instanceof sn&&e.clearCache()}))}recomputeFormulaVertexValue(e){const t=e.getAddress(this.lazilyTransformingAstService);if(e instanceof nn&&(e.array.size.isRef||!this.dependencyGraph.isThereSpaceForArray(e)))return e.setNoSpace();{const r=e.getFormula(this.lazilyTransformingAstService),n=this.evaluateAstToCellValue(r,new Qt(t,this.config.useArrayArithmetic,e));return e.setCellValue(n)}}evaluateAstToCellValue(e,t){const r=this.interpreter.evaluateAst(e,t);return r instanceof jr?r:r===rr&&this.config.evaluateNullToZero?0:r}}
/**
 * @license
 * Copyright (c) 2022 Handsoncode. All rights reserved.
 */
class ii{constructor(e,t){this.address=e,this.newValue=t}get col(){return this.address.col}get row(){return this.address.row}get sheet(){return this.address.sheet}get value(){return this.newValue}}class oi{constructor(e,t){this.name=e,this.newValue=t}}class ci{constructor(e,t,r,n){this.config=e,this.namedExpressions=t,this.sheetIndexMapping=r,this.lazilyTransformingService=n}exportChange(e){const t=e.value,r=e.address;if(r.sheet===fs.SHEET_FOR_WORKBOOK_EXPRESSIONS){const e=this.namedExpressions.namedExpressionInAddress(r.row);if(!e)throw new Error("Missing named expression");return new oi(e.displayName,this.exportScalarOrRange(t))}if(t instanceof jr){const e=[];for(const[n,a]of t.entriesFromTopLeftCorner(r))e.push(new ii(a,this.exportValue(n)));return e}return new ii(r,this.exportValue(t))}exportValue(e){return e instanceof jr?this.detailedError(new Fn(En.VALUE,It.ScalarExpected)):this.config.smartRounding&&hr(e)?this.cellValueRounding(nr(e)):e instanceof Fn?this.detailedError(e):e===rr?null:nr(e)}exportScalarOrRange(e){return e instanceof jr?e.rawData().map((e=>e.map((e=>this.exportValue(e))))):this.exportValue(e)}detailedError(e){var t,r;let n;const a=null===(t=e.root)||void 0===t?void 0:t.getAddress(this.lazilyTransformingService);return void 0!==a&&(n=a.sheet===fs.SHEET_FOR_WORKBOOK_EXPRESSIONS?null===(r=this.namedExpressions.namedExpressionInAddress(a.row))||void 0===r?void 0:r.displayName:Pe(this.sheetIndexMapping,a,-1)),new Kn(e,this.config.translationPackage.getErrorTranslation(e.type),n)}cellValueRounding(e){if(0===e)return e;const t=Math.floor(Math.log10(Math.abs(e))),r=Math.pow(10,this.config.precisionRounding-t);return e<0?-Math.round(-e*r)/r:Math.round(e*r)/r}}
/**
 * @license
 * Copyright (c) 2022 Handsoncode. All rights reserved.
 */
class li{constructor(e,t,r,n,a,s){this.dependencyGraph=e,this.columnSearch=t,this.parser=r,this.cellContentParser=n,this.stats=a,this.arraySizePredictor=s,this.buildStrategy=new ui(e,t,r,a,n,s)}buildGraph(e,t){const r=t.measure(Vr.COLLECT_DEPENDENCIES,(()=>this.buildStrategy.run(e)));this.dependencyGraph.getAndClearContentChanges(),t.measure(Vr.PROCESS_DEPENDENCIES,(()=>this.processDependencies(r)))}processDependencies(e){e.forEach(((e,t)=>{this.dependencyGraph.processCellDependencies(e,t)}))}}class ui{constructor(e,t,r,n,a,s){this.dependencyGraph=e,this.columnIndex=t,this.parser=r,this.stats=n,this.cellContentParser=a,this.arraySizePredictor=s}run(e){const t=new Map;for(const r in e){const n=this.dependencyGraph.getSheetId(r),a=e[r];for(let e=0;e<a.length;++e){const r=a[e];for(let a=0;a<r.length;++a){const s=r[a],i=Wn(n,a,e),o=this.cellContentParser.parse(s);if(o instanceof es.Formula){const e=this.stats.measure(Vr.PARSER,(()=>this.parser.parse(o.formula,i)));if(e.errors.length>0){this.shrinkArrayIfNeeded(i);const t=new wn(e.errors,o.formula);this.dependencyGraph.addVertex(i,t)}else{this.shrinkArrayIfNeeded(i);const r=this.arraySizePredictor.checkArraySize(e.ast,i);if(r.isScalar()){const r=new an(e.ast,i,0);t.set(r,qt(e.dependencies,i)),this.dependencyGraph.addVertex(i,r),e.hasVolatileFunction&&this.dependencyGraph.markAsVolatile(r),e.hasStructuralChangeFunction&&this.dependencyGraph.markAsDependentOnStructureChange(r)}else{const n=new nn(e.ast,i,new Gr(r.width,r.height));t.set(n,qt(e.dependencies,i)),this.dependencyGraph.addArrayVertex(i,n)}}}else if(o instanceof es.Empty);else{this.shrinkArrayIfNeeded(i);const e=new Nn(o.value,s);this.columnIndex.add(nr(o.value),i),this.dependencyGraph.addVertex(i,e)}}}}return t}shrinkArrayIfNeeded(e){const t=this.dependencyGraph.getCell(e);t instanceof nn&&this.dependencyGraph.shrinkArrayToCorner(t)}}
/**
 * @license
 * Copyright (c) 2022 Handsoncode. All rights reserved.
 */
const hi=new Map([["gpl-v3",1],["missing",2],["invalid",3],["expired",4]]);class fi extends Wr{version(e,t){return this.runFunction(e.args,t,this.metadata("VERSION"),(()=>{const{licenseKeyValidityState:e,licenseKey:t}=this.config;let r;return hi.has(t)?r=hi.get(t):hi.has(e)?r=hi.get(e):"valid"===e&&(r=t.slice(-5)),`HyperFormula v${Hi.version}, ${r}`}))}}
/**
 * @license
 * Copyright (c) 2022 Handsoncode. All rights reserved.
 */
function di(e,t){var r;let n=t.implementedFunctions[e];const a=null===(r=t.aliases)||void 0===r?void 0:r[e];if(void 0!==a){if(void 0!==n)throw new V(e,t.name);n=t.implementedFunctions[a]}if(void 0===n)throw x.functionNotDeclaredInPlugin(e,t.name);return n}fi.implementedFunctions={VERSION:{method:"version",parameters:[]}};class pi{constructor(e){if(this.config=e,this.functions=new Map,this.arraySizeFunctions=new Map,this.volatileFunctions=new Set,this.arrayFunctions=new Set,this.structuralChangeFunctions=new Set,this.functionsWhichDoesNotNeedArgumentsToBeComputed=new Set,this.functionsMetadata=new Map,this.doesFunctionNeedArgumentToBeComputed=e=>this.functionsWhichDoesNotNeedArgumentsToBeComputed.has(e),this.isFunctionVolatile=e=>this.volatileFunctions.has(e),this.isArrayFunction=e=>this.arrayFunctions.has(e),this.isFunctionDependentOnSheetStructureChange=e=>this.structuralChangeFunctions.has(e),e.functionPlugins.length>0){this.instancePlugins=new Map;for(const t of e.functionPlugins)pi.loadPluginFunctions(t,this.instancePlugins)}else this.instancePlugins=new Map(pi.plugins);for(const[t,r]of pi.protectedFunctions())pi.loadFunctionUnprotected(r,t,this.instancePlugins);for(const[t,r]of this.instancePlugins.entries())this.categorizeFunction(t,di(t,r))}static registerFunctionPlugin(e,t){this.loadPluginFunctions(e,this.plugins),void 0!==t&&this.loadTranslations(t)}static registerFunction(e,t,r){this.loadPluginFunction(t,e,this.plugins),void 0!==r&&this.loadTranslations(r)}static unregisterFunction(e){if(this.functionIsProtected(e))throw F.cannotUnregisterFunctionWithId(e);this.plugins.delete(e)}static unregisterFunctionPlugin(e){for(const t of this.protectedPlugins())if(t===e)throw F.cannotUnregisterProtectedPlugin();for(const[t,r]of this.plugins.entries())r===e&&this.plugins.delete(t)}static unregisterAll(){this.plugins.clear()}static getRegisteredFunctionIds(){return[...Array.from(this.plugins.keys()),...Array.from(this._protectedPlugins.keys())]}static getPlugins(){return Array.from(new Set(this.plugins.values()).values())}static getFunctionPlugin(e){return this.functionIsProtected(e)?void 0:this.plugins.get(e)}static functionIsProtected(e){return this._protectedPlugins.has(e)}static loadTranslations(e){const t=new Set(Hi.getRegisteredLanguagesCodes());Object.keys(e).forEach((r=>{t.has(r)&&Hi.getLanguage(r).extendFunctions(e[r])}))}static loadPluginFunctions(e,t){Object.keys(e.implementedFunctions).forEach((r=>{this.loadPluginFunction(e,r,t)})),void 0!==e.aliases&&Object.keys(e.aliases).forEach((r=>{this.loadPluginFunction(e,r,t)}))}static loadPluginFunction(e,t,r){if(this.functionIsProtected(t))throw F.cannotRegisterFunctionWithId(t);this.loadFunctionUnprotected(e,t,r)}static loadFunctionUnprotected(e,t,r){const n=di(t,e).method;if(!Object.prototype.hasOwnProperty.call(e.prototype,n))throw x.functionMethodNotFound(n,e.name);r.set(t,e)}static*protectedFunctions(){for(const[e,t]of this._protectedPlugins)void 0!==t&&(yield[e,t])}static*protectedPlugins(){for(const[,e]of this._protectedPlugins)void 0!==e&&(yield e)}initializePlugins(e){const t=[];for(const[r,n]of this.instancePlugins.entries()){let a=t.find((e=>e instanceof n));void 0===a&&(a=new n(e),t.push(a));const s=di(r,n),i=s.method;this.functions.set(r,[i,a]);const o=s.arraySizeMethod;void 0!==o&&this.arraySizeFunctions.set(r,[o,a])}}getFunctionPlugin(e){if(!pi.functionIsProtected(e))return this.instancePlugins.get(e)}getFunction(e){const t=this.functions.get(e);if(void 0!==t&&this.config.translationPackage.isFunctionTranslated(e)){const[e,r]=t;return(t,n)=>r[e](t,n)}}getArraySizeFunction(e){const t=this.arraySizeFunctions.get(e);if(void 0!==t&&this.config.translationPackage.isFunctionTranslated(e)){const[e,r]=t;return(t,n)=>r[e](t,n)}}getMetadata(e){return this.functionsMetadata.get(e)}getPlugins(){const e=new Set;for(const[t,r]of this.instancePlugins)pi.functionIsProtected(t)||e.add(r);return Array.from(e)}getRegisteredFunctionIds(){return Array.from(this.functions.keys())}categorizeFunction(e,t){t.isVolatile&&this.volatileFunctions.add(e),t.arrayFunction&&this.arrayFunctions.add(e),t.doesNotNeedArgumentsToBeComputed&&this.functionsWhichDoesNotNeedArgumentsToBeComputed.add(e),t.isDependentOnSheetStructureChange&&this.structuralChangeFunctions.add(e),this.functionsMetadata.set(e,t)}}
/**
 * @license
 * Copyright (c) 2022 Handsoncode. All rights reserved.
 */
var mi;pi.plugins=new Map,pi._protectedPlugins=new Map([["VERSION",fi],["OFFSET",void 0]]),function(e){e["GREATER_THAN"]="GREATER_THAN",e["GREATER_THAN_OR_EQUAL"]="GREATER_THAN_OR_EQUAL",e["LESS_THAN"]="LESS_THAN",e["LESS_THAN_OR_EQUAL"]="LESS_THAN_OR_EQUAL",e["NOT_EQUAL"]="NOT_EQUAL",e["EQUAL"]="EQUAL"}(mi||(mi={}));const gi=(e,t)=>({operator:e,value:t});class Ei{constructor(e){var t,r,n,a;this.trueString=null!==(r=null===(t=e.translationPackage.getMaybeFunctionTranslation("TRUE"))||void 0===t?void 0:t.toLowerCase())&&void 0!==r?r:"true",this.falseString=null!==(a=null===(n=e.translationPackage.getMaybeFunctionTranslation("FALSE"))||void 0===n?void 0:n.toLowerCase())&&void 0!==a?a:"false"}fromCellValue(e,t){if("string"!==typeof e&&"boolean"!==typeof e&&"number"!==typeof e)return;const r=this.parseCriterion(e,t);return void 0!==r?{raw:e,lambda:Si(r,t)}:void 0}parseCriterion(e,t){if("number"===typeof e||"boolean"===typeof e)return gi(mi.EQUAL,e);if("string"===typeof e){const r=vi.exec(e);let n,a;r?(a=Ti(r[1]),n=r[2]):(a=mi.EQUAL,n=e);const s=t.coerceToMaybeNumber(n),i=n.toLowerCase()===this.trueString||n.toLowerCase()!==this.falseString&&void 0;if(void 0===a)return;if(""===n)return gi(a,null);if(void 0!==s)return gi(a,nr(s));if(a===mi.EQUAL||a===mi.NOT_EQUAL)return gi(a,null!==i&&void 0!==i?i:n)}}}const vi=/([<>=]+)(.*)/;function Ti(e){switch(e){case">":return mi.GREATER_THAN;case">=":return mi.GREATER_THAN_OR_EQUAL;case"<":return mi.LESS_THAN;case"<=":return mi.LESS_THAN_OR_EQUAL;case"<>":return mi.NOT_EQUAL;case"=":return mi.EQUAL;default:return}}const Si=(e,t)=>{switch(e.operator){case mi.GREATER_THAN:return"number"===typeof e.value?r=>"number"===typeof r&&t.floatCmp(r,e.value)>0:e=>!1;case mi.GREATER_THAN_OR_EQUAL:return"number"===typeof e.value?r=>"number"===typeof r&&t.floatCmp(r,e.value)>=0:e=>!1;case mi.LESS_THAN:return"number"===typeof e.value?r=>"number"===typeof r&&t.floatCmp(r,e.value)<0:e=>!1;case mi.LESS_THAN_OR_EQUAL:return"number"===typeof e.value?r=>"number"===typeof r&&t.floatCmp(r,e.value)<=0:e=>!1;case mi.EQUAL:return"number"===typeof e.value?r=>{if("number"===typeof r)return 0===t.floatCmp(r,e.value);if("string"===typeof r){if(""===r)return!1;const n=t.coerceToMaybeNumber(r);return void 0!==n&&0===t.floatCmp(n,e.value)}return!1}:"string"===typeof e.value?t.eqMatcherFunction(e.value):"boolean"===typeof e.value?t=>"boolean"===typeof t&&t===e.value:e=>e===rr;case mi.NOT_EQUAL:return"number"===typeof e.value?r=>{if("number"===typeof r)return 0!==t.floatCmp(r,e.value);if("string"===typeof r){if(""===r)return!0;const n=t.coerceToMaybeNumber(r);return void 0===n||0!==t.floatCmp(n,e.value)}return!0}:"string"===typeof e.value?t.neqMatcherFunction(e.value):"boolean"===typeof e.value?t=>"boolean"!==typeof t||t!==e.value:e=>e!==rr}};
/**
 * @license
 * Copyright (c) 2022 Handsoncode. All rights reserved.
 */
class Ai{constructor(e,t,r,n,a,s,i,o,c,l){this.config=e,this.dependencyGraph=t,this.columnSearch=r,this.stats=n,this.arithmeticHelper=a,this.functionRegistry=s,this.namedExpressions=i,this.serialization=o,this.arraySizePredictor=c,this.dateTimeHelper=l,this.equalOp=(e,t)=>yi(this.arithmeticHelper.eq,e,t),this.notEqualOp=(e,t)=>yi(this.arithmeticHelper.neq,e,t),this.greaterThanOp=(e,t)=>yi(this.arithmeticHelper.gt,e,t),this.lessThanOp=(e,t)=>yi(this.arithmeticHelper.lt,e,t),this.greaterThanOrEqualOp=(e,t)=>yi(this.arithmeticHelper.geq,e,t),this.lessThanOrEqualOp=(e,t)=>yi(this.arithmeticHelper.leq,e,t),this.concatOp=(e,t)=>yi(this.arithmeticHelper.concat,Nr(e),Nr(t)),this.plusOp=(e,t)=>yi(this.arithmeticHelper.addWithEpsilon,this.arithmeticHelper.coerceScalarToNumberOrError(e),this.arithmeticHelper.coerceScalarToNumberOrError(t)),this.minusOp=(e,t)=>yi(this.arithmeticHelper.subtract,this.arithmeticHelper.coerceScalarToNumberOrError(e),this.arithmeticHelper.coerceScalarToNumberOrError(t)),this.timesOp=(e,t)=>yi(this.arithmeticHelper.multiply,this.arithmeticHelper.coerceScalarToNumberOrError(e),this.arithmeticHelper.coerceScalarToNumberOrError(t)),this.powerOp=(e,t)=>yi(this.arithmeticHelper.pow,this.arithmeticHelper.coerceScalarToNumberOrError(e),this.arithmeticHelper.coerceScalarToNumberOrError(t)),this.divOp=(e,t)=>yi(this.arithmeticHelper.divide,this.arithmeticHelper.coerceScalarToNumberOrError(e),this.arithmeticHelper.coerceScalarToNumberOrError(t)),this.unaryMinusOp=e=>Ri(this.arithmeticHelper.unaryMinus,this.arithmeticHelper.coerceScalarToNumberOrError(e)),this.percentOp=e=>Ri(this.arithmeticHelper.unaryPercent,this.arithmeticHelper.coerceScalarToNumberOrError(e)),this.unaryPlusOp=e=>this.arithmeticHelper.unaryPlus(e),this.functionRegistry.initializePlugins(this),this.criterionBuilder=new Ei(e)}evaluateAst(e,t){let r=this.evaluateAstWithoutPostprocessing(e,t);if(hr(r)){if(Cr(nr(r)))return new Fn(En.NUM,It[NaN]);r=sr(r,Or(nr(r)))}return r instanceof jr&&1===r.height()&&1===r.width()&&([[r]]=r.data),Ni(r,t.formulaVertex)}evaluateAstWithoutPostprocessing(e,t){switch(e.type){case $e.EMPTY:return rr;case $e.CELL_REFERENCE:{const r=e.reference.toSimpleCellAddress(t.formulaAddress);return Gn(r)?new Fn(En.REF,It.BadRef):this.dependencyGraph.getCellValue(r)}case $e.NUMBER:case $e.STRING:return e.value;case $e.CONCATENATE_OP:{const r=this.evaluateAst(e.left,t),n=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.concatOp,r,n,t)}case $e.EQUALS_OP:{const r=this.evaluateAst(e.left,t),n=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.equalOp,r,n,t)}case $e.NOT_EQUAL_OP:{const r=this.evaluateAst(e.left,t),n=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.notEqualOp,r,n,t)}case $e.GREATER_THAN_OP:{const r=this.evaluateAst(e.left,t),n=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.greaterThanOp,r,n,t)}case $e.LESS_THAN_OP:{const r=this.evaluateAst(e.left,t),n=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.lessThanOp,r,n,t)}case $e.GREATER_THAN_OR_EQUAL_OP:{const r=this.evaluateAst(e.left,t),n=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.greaterThanOrEqualOp,r,n,t)}case $e.LESS_THAN_OR_EQUAL_OP:{const r=this.evaluateAst(e.left,t),n=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.lessThanOrEqualOp,r,n,t)}case $e.PLUS_OP:{const r=this.evaluateAst(e.left,t),n=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.plusOp,r,n,t)}case $e.MINUS_OP:{const r=this.evaluateAst(e.left,t),n=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.minusOp,r,n,t)}case $e.TIMES_OP:{const r=this.evaluateAst(e.left,t),n=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.timesOp,r,n,t)}case $e.POWER_OP:{const r=this.evaluateAst(e.left,t),n=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.powerOp,r,n,t)}case $e.DIV_OP:{const r=this.evaluateAst(e.left,t),n=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.divOp,r,n,t)}case $e.PLUS_UNARY_OP:{const r=this.evaluateAst(e.value,t);return this.unaryRangeWrapper(this.unaryPlusOp,r,t)}case $e.MINUS_UNARY_OP:{const r=this.evaluateAst(e.value,t);return this.unaryRangeWrapper(this.unaryMinusOp,r,t)}case $e.PERCENT_OP:{const r=this.evaluateAst(e.value,t);return this.unaryRangeWrapper(this.percentOp,r,t)}case $e.FUNCTION_CALL:{if("valid"!==this.config.licenseKeyValidityState&&!pi.functionIsProtected(e.procedureName))return new Fn(En.LIC,It.LicenseKey(this.config.licenseKeyValidityState));const r=this.functionRegistry.getFunction(e.procedureName);return void 0!==r?r(e,new Qt(t.formulaAddress,t.arraysFlag||this.functionRegistry.isArrayFunction(e.procedureName),t.formulaVertex)):new Fn(En.NAME,It.FunctionName(e.procedureName))}case $e.NAMED_EXPRESSION:{const r=this.namedExpressions.nearestNamedExpression(e.expressionName,t.formulaAddress.sheet);return r?this.dependencyGraph.getCellValue(r.address):new Fn(En.NAME,It.NamedExpressionName(e.expressionName))}case $e.CELL_RANGE:{if(!this.rangeSpansOneSheet(e))return new Fn(En.REF,It.RangeManySheets);const r=jt.fromCellRange(e,t.formulaAddress),n=this.dependencyGraph.getArray(r);if(n){const e=n.array;if(e instanceof Zr)throw new Error("Array should be already computed");if(e instanceof Fn)return e;if(e instanceof en)return jr.fromRange(e.raw(),r,this.dependencyGraph);throw new Error("Unknown array")}return jr.onlyRange(r,this.dependencyGraph)}case $e.COLUMN_RANGE:{if(!this.rangeSpansOneSheet(e))return new Fn(En.REF,It.RangeManySheets);const r=Xt.fromColumnRange(e,t.formulaAddress);return jr.onlyRange(r,this.dependencyGraph)}case $e.ROW_RANGE:{if(!this.rangeSpansOneSheet(e))return new Fn(En.REF,It.RangeManySheets);const r=Kt.fromRowRangeAst(e,t.formulaAddress);return jr.onlyRange(r,this.dependencyGraph)}case $e.PARENTHESIS:return this.evaluateAst(e.expression,t);case $e.ARRAY:{let r;const n=[];for(const a of e.args){let e;const s=[];for(const r of a){const n=Sr(this.evaluateAst(r,t)),a=n.height();if(void 0===e)e=a,s.push(...n.data);else{if(e!==a)return new Fn(En.REF,It.SizeMismatch);for(let e=0;e<a;e++)s[e].push(...n.data[e])}}const i=s[0].length;if(void 0===r)r=i,n.push(...s);else{if(r!==i)return new Fn(En.REF,It.SizeMismatch);n.push(...s)}}return jr.onlyValues(n)}case $e.ERROR_WITH_RAW_INPUT:case $e.ERROR:return e.error}}rangeSpansOneSheet(e){return e.start.sheet===e.end.sheet}unaryRangeWrapper(e,t,r){var n;if(t instanceof jr&&!r.arraysFlag&&(t=null!==(n=Pr(t,r))&&void 0!==n?n:new Fn(En.VALUE,It.ScalarExpected)),t instanceof Fn)return t;if(t instanceof jr){const r=t.data.map((t=>t.map(e)));return jr.onlyValues(r)}return e(t)}binaryRangeWrapper(e,t,r,n){var a,s;if(t instanceof jr&&!n.arraysFlag&&(t=null!==(a=Pr(t,n))&&void 0!==a?a:new Fn(En.VALUE,It.ScalarExpected)),t instanceof Fn)return t;if(r instanceof jr&&!n.arraysFlag&&(r=null!==(s=Pr(r,n))&&void 0!==s?s:new Fn(En.VALUE,It.ScalarExpected)),r instanceof Fn)return r;if(t instanceof jr||r instanceof jr){if(!(t instanceof jr)){if(r.isAdHoc()){const n=r.data;for(let r=0;r<n.length;r++)for(let a=0;a<n[0].length;a++)n[r][a]=e(t,n[r][a]);return jr.onlyValues(n)}t=jr.fromScalar(t)}if(!(r instanceof jr)){if(t.isAdHoc()){const n=t.data;for(let t=0;t<n.length;t++)for(let a=0;a<n[0].length;a++)n[t][a]=e(n[t][a],r);return jr.onlyValues(n)}r=jr.fromScalar(r)}if(t.width()===r.width()&&t.height()===r.height()){if(t.isAdHoc()){const n=t.data,a=r.data;for(let t=0;t<n.length;t++)for(let r=0;r<n[0].length;r++)n[t][r]=e(n[t][r],a[t][r]);return jr.onlyValues(n)}if(r.isAdHoc()){const n=t.data,a=r.data;for(let t=0;t<n.length;t++)for(let r=0;r<n[0].length;r++)a[t][r]=e(n[t][r],a[t][r]);return jr.onlyValues(a)}}const n=Math.max(t.width(),r.width()),a=Math.max(t.height(),r.height()),s=Array(a);for(let e=0;e<a;e++)s[e]=Array(n);for(let i=0;i<a;i++){const a=1!==t.height()?i:0,o=1!==r.height()?i:0;for(let c=0;c<n;c++){const n=1!==t.width()?c:0,l=1!==r.width()?c:0;a<t.height()&&o<r.height()&&n<t.width()&&l<r.width()?s[i][c]=e(t.data[a][n],r.data[o][l]):s[i][c]=new Fn(En.NA)}}return jr.onlyValues(s)}return e(t,r)}}function Ri(e,t){return t instanceof Fn?t:e(t)}function yi(e,t,r){return t instanceof Fn?t:r instanceof Fn?r:e(t,r)}function Ni(e,t){return e instanceof Fn&&void 0!==t?e.attachRootVertex(t):e}
/**
 * @license
 * Copyright (c) 2022 Handsoncode. All rights reserved.
 */
class wi{constructor(e){this.sheet=e,this.transformations=[]}add(e){this.transformations.push(e)}performEagerTransformations(e,t){this.transformations.forEach((r=>r.performEagerTransformations(e,t)))}transformSingleAst(e,t){let[r,n]=[e,t];return this.transformations.forEach((e=>{[r,n]=e.transformSingleAst(r,n)})),[r,n]}isIrreversible(){return!0}}
/**
 * @license
 * Copyright (c) 2022 Handsoncode. All rights reserved.
 */
class bi{constructor(e){this.stats=e,this.transformations=[]}version(){return this.transformations.length}addTransformation(e){return void 0!==this.combinedTransformer?this.combinedTransformer.add(e):this.transformations.push(e),this.version()}beginCombinedMode(e){this.combinedTransformer=new wi(e)}commitCombinedMode(){if(void 0===this.combinedTransformer)throw"Combined mode wasn't started";return this.transformations.push(this.combinedTransformer),this.combinedTransformer=void 0,this.version()}applyTransformations(e,t,r){this.stats.start(Vr.TRANSFORM_ASTS_POSTPONED);for(let a=r;a<this.transformations.length;a++){const r=this.transformations[a];r.isIrreversible()&&(this.undoRedo.storeDataForVersion(a,t,this.parser.computeHashFromAst(e)),this.parser.rememberNewAst(e));const[n,s]=r.transformSingleAst(e,t);e=n,t=s}const n=this.parser.rememberNewAst(e);return this.stats.end(Vr.TRANSFORM_ASTS_POSTPONED),[n,t,this.transformations.length]}*getTransformationsFrom(e,t){for(let r=e;r<this.transformations.length;r++){const e=this.transformations[r];t&&!t(e)||(yield e)}}}
/**
 * @license
 * Copyright (c) 2022 Handsoncode. All rights reserved.
 */
const Ci=-1;function Oi(e,t,{searchCoordinate:r,orderingDirection:n,matchExactly:a},s){const i=t.start[r],o="col"===r?t.effectiveEndColumn(s):t.effectiveEndRow(s),c="col"===r?e=>nr(s.getCellValue(Wn(t.sheet,e,t.start.row))):e=>nr(s.getCellValue(Wn(t.sheet,t.start.col,e))),l="asc"===n?(e,t)=>Mi(e,t):(e,t)=>-Mi(e,t),u=Ii((t=>l(e,c(t))>=0),i,o),h=c(u);return u===Ci||typeof h!==typeof e||a&&h!==e?Ci:u-i}function Ii(e,t,r){let n=t,a=r;while(n<a){const t=Math.ceil((n+a)/2);e(t)?n=t:a=t-1}return n===a&&e(n)?n:Ci}function Mi(e,t){return typeof e===typeof t?e===rr?0:e<t?-1:e>t?1:0:e===rr?-1:t===rr?1:t instanceof Fn||"number"===typeof e&&"string"===typeof t||"number"===typeof e&&"boolean"===typeof t?-1:"string"===typeof e&&"number"===typeof t?1:"string"===typeof e&&"boolean"===typeof t?-1:1}
/**
 * @license
 * Copyright (c) 2022 Handsoncode. All rights reserved.
 */
class Di{constructor(e){this.dependencyGraph=e}advancedFind(e,t){let r;const n=t.range;r=void 0===n?t.valuesFromTopLeftCorner():this.dependencyGraph.computeListOfValuesInRange(n);for(let a=0;a<r.length;a++)if(e(nr(r[a])))return a;return-1}basicFind(e,t,r,{ordering:n,matchExactly:a}){const s="string"===typeof e?Fr(e):e,i=t.range;return void 0===i?this.findNormalizedValue(s,t.valuesFromTopLeftCorner()):"none"===n?this.findNormalizedValue(s,this.dependencyGraph.computeListOfValuesInRange(i)):Oi(s,i,{searchCoordinate:r,orderingDirection:n,matchExactly:a},this.dependencyGraph)}findNormalizedValue(e,t){return t.map(nr).map((e=>"string"===typeof e?Fr(e):e)).indexOf(e)}}
/**
 * @license
 * Copyright (c) 2022 Handsoncode. All rights reserved.
 */
class Li extends Di{constructor(e){super(e),this.dependencyGraph=e}add(e,t){}remove(e,t){}change(e,t,r){}applyChanges(e){}addColumns(e){}removeColumns(e){}removeSheet(e){}moveValues(e,t,r,n){}removeValues(e){}find(e,t,r){return this.basicFind(e,t,"row",r)}}
/**
 * @license
 * Copyright (c) 2022 Handsoncode. All rights reserved.
 */
class ki{constructor(e,t,r){this.dependencyGraph=e,this.config=t,this.stats=r,this.index=new Map,this.transformingService=this.dependencyGraph.lazilyTransformingAstService,this.binarySearchStrategy=new Li(e)}add(e,t){if(!(e===rr||e instanceof Fn))if(e instanceof jr)for(const[r,n]of e.entriesFromTopLeftCorner(t))this.addSingleCellValue(nr(r),n);else this.addSingleCellValue(e,t)}remove(e,t){if(void 0!==e)if(e instanceof jr)for(const[r,n]of e.entriesFromTopLeftCorner(t))this.removeSingleValue(nr(r),n);else this.removeSingleValue(e,t)}change(e,t,r){e!==t&&(this.remove(e,r),this.add(t,r))}applyChanges(e){for(const t of e)void 0!==t.oldValue&&this.change(nr(t.oldValue),nr(t.value),t.address)}moveValues(e,t,r,n){for(const[a,s]of e){const e=Hn(s,n,t,r);this.remove(a,s),this.add(a,e)}}removeValues(e){for(const[t,r]of e)this.remove(t,r)}find(e,t,{ordering:r,matchExactly:n}){const a=!0===n?"findFirst":"findLast",s=this.findUsingColumnIndex(e,t,a);return void 0!==s?s:this.binarySearchStrategy.find(e,t,{ordering:r,matchExactly:n})}findUsingColumnIndex(e,t,r){const n=t.range;if(void 0===n)return;this.ensureRecentData(n.sheet,n.start.col,e);const a=this.getColumnMap(n.sheet,n.start.col);if(!a)return-1;const s="string"===typeof e?Fr(e):e,i=a.get(s);if(!i||!i.index||0===i.index.length)return;const o=ki.findRowBelongingToRange(i,n,r);return void 0!==o?o-n.start.row:void 0}static findRowBelongingToRange(e,t,r){const n=t.start.row,a=t.end.row,s="findFirst"===r?_i(n,e.index,"upperBound"):_i(a,e.index,"lowerBound");if(-1===s)return;const i=e.index[s],o=i>=n&&i<=a;return o?i:void 0}advancedFind(e,t){return this.binarySearchStrategy.advancedFind(e,t)}addColumns(e){const t=this.index.get(e.sheet);t&&t.splice(e.columnStart,0,...Array(e.numberOfColumns))}removeColumns(e){const t=this.index.get(e.sheet);t&&t.splice(e.columnStart,e.numberOfColumns)}removeSheet(e){this.index.delete(e)}getColumnMap(e,t){this.index.has(e)||this.index.set(e,[]);const r=this.index.get(e);let n=r[t];return n||(n=new Map,r[t]=n),n}getValueIndex(e,t,r){const n=this.getColumnMap(e,t);let a=this.getColumnMap(e,t).get(r);return a||(a={version:this.transformingService.version(),index:[]},n.set(r,a)),a}ensureRecentData(e,t,r){const n=this.getValueIndex(e,t,r),a=this.transformingService.version();if(n.version===a)return;const s=this.transformingService.getTransformationsFrom(n.version,(t=>t.sheet===e&&(t instanceof gs||t instanceof As)));for(const i of s)i instanceof gs?this.addRows(t,i.rowsSpan,r):i instanceof As&&this.removeRows(t,i.rowsSpan,r);n.version=a}addSingleCellValue(e,t){this.stats.measure(Vr.BUILD_COLUMN_INDEX,(()=>{this.ensureRecentData(t.sheet,t.col,e),"string"===typeof e&&(e=Fr(e));const r=this.getValueIndex(t.sheet,t.col,e);ki.addValue(r,t.row)}))}removeSingleValue(e,t){this.stats.measure(Vr.BUILD_COLUMN_INDEX,(()=>{this.ensureRecentData(t.sheet,t.col,e);const r=this.getColumnMap(t.sheet,t.col);"string"===typeof e&&(e=Fr(e));const n=r.get(e);if(!n)return;const a=_i(t.row,n.index);a>-1&&n.index.splice(a,1),0===n.index.length&&r.delete(e),0===r.size&&delete this.index.get(t.sheet)[t.col]}))}addRows(e,t,r){const n=this.getValueIndex(t.sheet,e,r);ki.shiftRows(n,t.rowStart,t.numberOfRows)}removeRows(e,t,r){const n=this.getValueIndex(t.sheet,e,r);ki.removeRowsFromValues(n,t),ki.shiftRows(n,t.rowEnd+1,-t.numberOfRows)}static addValue(e,t){const r=_i(t,e.index,"lowerBound"),n=e.index[r]===t;n||e.index.splice(r+1,0,t)}static removeRowsFromValues(e,t){const r=_i(t.rowStart,e.index,"upperBound"),n=_i(t.rowEnd,e.index,"lowerBound"),a=r>-1&&n>-1&&r<=n&&e.index[r]<=t.rowEnd;a&&e.index.splice(r,n-r+1)}static shiftRows(e,t,r){const n=_i(t,e.index,"upperBound");if(-1!==n)for(let a=n;a<e.index.length;++a)e.index[a]+=r}}function _i(e,t,r="upperBound"){let n=0,a=t.length-1;while(n<=a){const r=Math.floor((n+a)/2);if(e>t[r])n=r+1;else{if(!(e<t[r]))return r;a=r-1}}const s="lowerBound"===r?a:n,i=s>=0&&s<=t.length;return i?s:-1}
/**
 * @license
 * Copyright (c) 2022 Handsoncode. All rights reserved.
 */
function Ui(e,t,r){return t.useColumnIndex?new ki(e,t,r):new Li(e)}
/**
 * @license
 * Copyright (c) 2022 Handsoncode. All rights reserved.
 */
class xi{constructor(e){this.config=e;const t="."===this.config.thousandSeparator?`\\${this.config.thousandSeparator}`:this.config.thousandSeparator,r="."===this.config.decimalSeparator?`\\${this.config.decimalSeparator}`:this.config.decimalSeparator;this.numberPattern=new RegExp(`^([+-]?((${r}\\d+)|(\\d+(${t}\\d{3,})*(${r}\\d*)?)))(e[+-]?\\d+)?$`),this.allThousandSeparatorsRegex=new RegExp(`${t}`,"g")}numericStringToMaybeNumber(e){if(this.numberPattern.test(e)){const t=this.numericStringToNumber(e);if(isNaN(t))return;return t}}numericStringToNumber(e){const t=e.replace(this.allThousandSeparatorsRegex,"").replace(this.config.decimalSeparator,".");return Number(t)}}
/**
 * @license
 * Copyright (c) 2022 Handsoncode. All rights reserved.
 */
class Fi{constructor(e,t,r){this.dependencyGraph=e,this.unparser=t,this.exporter=r}getCellFormula(e,t){const r=this.dependencyGraph.getCell(e);if(r instanceof an){const n=r.getFormula(this.dependencyGraph.lazilyTransformingAstService);return t=null!==t&&void 0!==t?t:e,this.unparser.unparse(n,t)}if(r instanceof nn){const n=r.getAddress(this.dependencyGraph.lazilyTransformingAstService);if(n.row!==e.row||n.col!==e.col||n.sheet!==e.sheet)return;t=null!==t&&void 0!==t?t:e;const a=r.getFormula(this.dependencyGraph.lazilyTransformingAstService);if(void 0!==a)return this.unparser.unparse(a,t)}else if(r instanceof wn)return r.getFormula()}getCellSerialized(e,t){var r;return null!==(r=this.getCellFormula(e,t))&&void 0!==r?r:this.getRawValue(e)}getCellValue(e){return this.exporter.exportValue(this.dependencyGraph.getScalarValue(e))}getRawValue(e){return this.dependencyGraph.getRawValue(e)}getSheetValues(e){return this.genericSheetGetter(e,(e=>this.getCellValue(e)))}getSheetFormulas(e){return this.genericSheetGetter(e,(e=>this.getCellFormula(e)))}genericSheetGetter(e,t){const r=this.dependencyGraph.getSheetHeight(e),n=this.dependencyGraph.getSheetWidth(e),a=new Array(r);for(let s=0;s<r;s++){a[s]=new Array(n);for(let r=0;r<n;r++){const n=Wn(e,r,s);a[s][r]=t(n)}for(let e=n-1;e>=0;e--){if(null!==a[s][e]&&void 0!==a[s][e])break;a[s].pop()}}for(let s=r-1;s>=0;s--){if(0!==a[s].length)break;a.pop()}return a}genericAllSheetsGetter(e){const t={};for(const r of this.dependencyGraph.sheetMapping.displayNames()){const n=this.dependencyGraph.sheetMapping.fetch(r);t[r]=e(n)}return t}getSheetSerialized(e){return this.genericSheetGetter(e,(e=>this.getCellSerialized(e)))}getAllSheetsValues(){return this.genericAllSheetsGetter((e=>this.getSheetValues(e)))}getAllSheetsFormulas(){return this.genericAllSheetsGetter((e=>this.getSheetFormulas(e)))}getAllSheetsSerialized(){return this.genericAllSheetsGetter((e=>this.getSheetSerialized(e)))}getAllNamedExpressionsSerialized(){const e=[];let t=0;for(const r of this.dependencyGraph.sheetMapping.displayNames()){const n=this.dependencyGraph.sheetMapping.fetch(r);e[n]=t,t++}return this.dependencyGraph.namedExpressions.getAllNamedExpressions().map((t=>({name:t.expression.displayName,expression:this.getCellSerialized(t.expression.address),scope:void 0!==t.scope?e[t.scope]:void 0,options:t.expression.options})))}withNewConfig(e,t){const r=new Lt(e,Oe(e),this.dependencyGraph.sheetMapping.fetchDisplayName,t);return new Fi(this.dependencyGraph,r,this.exporter)}}
/**
 * @license
 * Copyright (c) 2022 Handsoncode. All rights reserved.
 */
class Pi{static buildFromSheets(e,t={},r=[]){const n=new $i(t);return this.buildEngine(n,e,r)}static buildFromSheet(e,t={},r=[]){const n=new $i(t),a=n.translationPackage.getUITranslation(gn.NEW_SHEET_PREFIX)+"1";return this.buildEngine(n,{[a]:e},r)}static buildEmpty(e={},t=[]){return this.buildEngine(new $i(e),{},t)}static rebuildWithConfig(e,t,r,n){return this.buildEngine(e,t,r,n)}static buildEngine(e,t={},r=[],n=(e.useStats?new Kr:new qr)){n.start(Vr.BUILD_ENGINE_TOTAL);const a=new fs,s=new pi(e),i=new bi(n),o=Rn.buildEmpty(i,e,s,a,n),c=Ui(o,e,n),l=o.sheetMapping,u=o.addressMapping;for(const C in t)if(Object.prototype.hasOwnProperty.call(t,C)){const r=t[C];ys(r);const n=Ns(r);if(n.height>e.maxRows||n.width>e.maxColumns)throw new d;const a=l.addSheet(C);u.autoAddSheet(a,r,n)}const h=new _t(e,s,l.get);i.parser=h;const f=new Lt(e,Oe(e),l.fetchDisplayName,a),p=new pa(e),m=new xi(e),g=new vr(e,p,m),E=new is(e,p,m),v=new $r(e,s),T=new Is(e,o,c,E,h,n,i,a,v),S=new ti(e,T);i.undoRedo=S;const A=new cs(e,o,T),R=new ri(e,T,S,A,o,c,h,E,i,a);r.forEach((e=>{R.ensureItIsPossibleToAddNamedExpression(e.name,e.expression,e.scope),R.operations.addNamedExpression(e.name,e.expression,e.scope,e.options)}));const y=new ci(e,a,l.fetchDisplayName,i),N=new Fi(o,f,y),w=new Ai(e,o,c,n,g,s,a,N,v,p);n.measure(Vr.GRAPH_BUILD,(()=>{const e=new li(o,c,h,E,n,v);e.buildGraph(t,n)}));const b=new si(e,n,w,i,o,c);return b.run(),n.end(Vr.BUILD_ENGINE_TOTAL),{config:e,stats:n,dependencyGraph:o,columnSearch:c,parser:h,unparser:f,cellContentParser:E,evaluator:b,lazilyTransformingAstService:i,crudOperations:R,exporter:y,namedExpressions:a,serialization:N,functionRegistry:s}}}
/**
 * @license
 * Copyright (c) 2022 Handsoncode. All rights reserved.
 */
function Bi(e){for(const[t,r]of Object.entries(e))r instanceof Function?e[t]=Yi(r):delete e[t]}function Yi(e){return()=>{throw new Error(`The "${e}" method cannot be called because this HyperFormula instance has been destroyed`)}}var Vi,Wi=r(6433);(function(e){e["SheetAdded"]="sheetAdded",e["SheetRemoved"]="sheetRemoved",e["SheetRenamed"]="sheetRenamed",e["NamedExpressionAdded"]="namedExpressionAdded",e["NamedExpressionRemoved"]="namedExpressionRemoved",e["ValuesUpdated"]="valuesUpdated",e["EvaluationSuspended"]="evaluationSuspended",e["EvaluationResumed"]="evaluationResumed"})(Vi||(Vi={}));class Gi extends Wi.TinyEmitter{emit(e,...t){return super.emit(e,...t),this}}
/**
 * @license
 * Copyright (c) 2022 Handsoncode. All rights reserved.
 */
class Hi{constructor(e,t,r,n,a,s,i,o,c,l,u,h,f,d){this._config=e,this._stats=t,this._dependencyGraph=r,this._columnSearch=n,this._parser=a,this._unparser=s,this._cellContentParser=i,this._evaluator=o,this._lazilyTransformingAstService=c,this._crudOperations=l,this._exporter=u,this._namedExpressions=h,this._serialization=f,this._functionRegistry=d,this._emitter=new Gi,this._evaluationSuspended=!1}static get defaultConfig(){return Xi()}get graph(){return this.dependencyGraph.graph}get rangeMapping(){return this.dependencyGraph.rangeMapping}get arrayMapping(){return this.dependencyGraph.arrayMapping}get sheetMapping(){return this.dependencyGraph.sheetMapping}get addressMapping(){return this.dependencyGraph.addressMapping}get dependencyGraph(){return this._dependencyGraph}get evaluator(){return this._evaluator}get columnSearch(){return this._columnSearch}get lazilyTransformingAstService(){return this._lazilyTransformingAstService}get licenseKeyValidityState(){return this._config.licenseKeyValidityState}static buildFromArray(e,t={},r=[]){return this.buildFromEngineState(Pi.buildFromSheet(e,t,r))}static buildFromSheets(e,t={},r=[]){return this.buildFromEngineState(Pi.buildFromSheets(e,t,r))}static buildEmpty(e={},t=[]){return this.buildFromEngineState(Pi.buildEmpty(e,t))}static getLanguage(e){ta(e,"string","languageCode");const t=this.registeredLanguages.get(e);if(void 0===t)throw new _;return t}static registerLanguage(e,t){if(ta(e,"string","languageCode"),this.registeredLanguages.has(e))throw new U;this.registeredLanguages.set(e,mn(t))}static unregisterLanguage(e){if(ta(e,"string","languageCode"),!this.registeredLanguages.has(e))throw new _;this.registeredLanguages.delete(e)}static getRegisteredLanguagesCodes(){return Array.from(this.registeredLanguages.keys())}static registerFunctionPlugin(e,t){pi.registerFunctionPlugin(e,t)}static unregisterFunctionPlugin(e){pi.unregisterFunctionPlugin(e)}static registerFunction(e,t,r){ta(e,"string","functionId"),pi.registerFunction(e,t,r)}static unregisterFunction(e){ta(e,"string","functionId"),pi.unregisterFunction(e)}static unregisterAllFunctions(){pi.unregisterAll()}static getRegisteredFunctionNames(e){ta(e,"string","code");const t=pi.getRegisteredFunctionIds(),r=this.getLanguage(e);return r.getFunctionTranslations(t)}static getFunctionPlugin(e){return ta(e,"string","functionId"),pi.getFunctionPlugin(e)}static getAllFunctionPlugins(){return pi.getPlugins()}static buildFromEngineState(e){return new Hi(e.config,e.stats,e.dependencyGraph,e.columnSearch,e.parser,e.unparser,e.cellContentParser,e.evaluator,e.lazilyTransformingAstService,e.crudOperations,e.exporter,e.namedExpressions,e.serialization,e.functionRegistry)}getCellValue(e){if(!$n(e))throw new b("SimpleCellAddress","cellAddress");return this.ensureEvaluationIsNotSuspended(),this._serialization.getCellValue(e)}getCellFormula(e){if(!$n(e))throw new b("SimpleCellAddress","cellAddress");return this._serialization.getCellFormula(e)}getCellSerialized(e){if(!$n(e))throw new b("SimpleCellAddress","cellAddress");return this.ensureEvaluationIsNotSuspended(),this._serialization.getCellSerialized(e)}getSheetValues(e){return ta(e,"number","sheetId"),this.ensureEvaluationIsNotSuspended(),this._serialization.getSheetValues(e)}getSheetFormulas(e){return ta(e,"number","sheetId"),this._serialization.getSheetFormulas(e)}getSheetSerialized(e){return ta(e,"number","sheetId"),this.ensureEvaluationIsNotSuspended(),this._serialization.getSheetSerialized(e)}getAllSheetsDimensions(){return this._serialization.genericAllSheetsGetter((e=>this.getSheetDimensions(e)))}getSheetDimensions(e){return ta(e,"number","sheetId"),{width:this.dependencyGraph.getSheetWidth(e),height:this.dependencyGraph.getSheetHeight(e)}}getAllSheetsValues(){return this.ensureEvaluationIsNotSuspended(),this._serialization.getAllSheetsValues()}getAllSheetsFormulas(){return this._serialization.getAllSheetsFormulas()}getAllSheetsSerialized(){return this.ensureEvaluationIsNotSuspended(),this._serialization.getAllSheetsSerialized()}updateConfig(e){const t=this._config.mergeConfig(e),r=this._config.mergeConfig({language:e.language}),n=this._serialization.withNewConfig(r,this._namedExpressions).getAllSheetsSerialized(),a=this._serialization.getAllNamedExpressionsSerialized(),s=Pi.rebuildWithConfig(t,n,a,this._stats);this._config=s.config,this._stats=s.stats,this._dependencyGraph=s.dependencyGraph,this._columnSearch=s.columnSearch,this._parser=s.parser,this._unparser=s.unparser,this._cellContentParser=s.cellContentParser,this._evaluator=s.evaluator,this._lazilyTransformingAstService=s.lazilyTransformingAstService,this._crudOperations=s.crudOperations,this._exporter=s.exporter,this._namedExpressions=s.namedExpressions,this._serialization=s.serialization,this._functionRegistry=s.functionRegistry}getConfig(){return this._config.getConfig()}rebuildAndRecalculate(){this.updateConfig({})}getStats(){return this._stats.snapshot()}undo(){return this._crudOperations.undo(),this.recomputeIfDependencyGraphNeedsIt()}redo(){return this._crudOperations.redo(),this.recomputeIfDependencyGraphNeedsIt()}isThereSomethingToUndo(){return this._crudOperations.isThereSomethingToUndo()}isThereSomethingToRedo(){return this._crudOperations.isThereSomethingToRedo()}isItPossibleToSetCellContents(e){let t;if($n(e))t=new jt(e,e);else{if(!zt(e))throw new b("SimpleCellAddress | SimpleCellRange","address");t=new jt(e.start,e.end)}try{this._crudOperations.ensureRangeInSizeLimits(t);for(const e of t.addresses(this._dependencyGraph))this._crudOperations.ensureItIsPossibleToChangeContent(e)}catch(r){return!1}return!0}setCellContents(e,t){return this._crudOperations.setCellContents(e,t),this.recomputeIfDependencyGraphNeedsIt()}swapRowIndexes(e,t){return ta(e,"number","sheetId"),this._crudOperations.setRowOrder(e,t),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToSwapRowIndexes(e,t){ta(e,"number","sheetId");try{return this._crudOperations.validateSwapRowIndexes(e,t),this._crudOperations.testRowOrderForArrays(e,t),!0}catch(r){return!1}}setRowOrder(e,t){ta(e,"number","sheetId");const r=this._crudOperations.mappingFromOrder(e,t,"row");return this.swapRowIndexes(e,r)}isItPossibleToSetRowOrder(e,t){ta(e,"number","sheetId");try{const r=this._crudOperations.mappingFromOrder(e,t,"row");return this._crudOperations.validateSwapRowIndexes(e,r),this._crudOperations.testRowOrderForArrays(e,r),!0}catch(r){return!1}}swapColumnIndexes(e,t){return ta(e,"number","sheetId"),this._crudOperations.setColumnOrder(e,t),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToSwapColumnIndexes(e,t){ta(e,"number","sheetId");try{return this._crudOperations.validateSwapColumnIndexes(e,t),this._crudOperations.testColumnOrderForArrays(e,t),!0}catch(r){return!1}}setColumnOrder(e,t){ta(e,"number","sheetId");const r=this._crudOperations.mappingFromOrder(e,t,"column");return this.swapColumnIndexes(e,r)}isItPossibleToSetColumnOrder(e,t){ta(e,"number","sheetId");try{const r=this._crudOperations.mappingFromOrder(e,t,"column");return this._crudOperations.validateSwapColumnIndexes(e,r),this._crudOperations.testColumnOrderForArrays(e,r),!0}catch(r){return!1}}isItPossibleToAddRows(e,...t){ta(e,"number","sheetId");const r=Ds(t);try{return this._crudOperations.ensureItIsPossibleToAddRows(e,...r),!0}catch(n){return!1}}addRows(e,...t){return ta(e,"number","sheetId"),this._crudOperations.addRows(e,...t),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToRemoveRows(e,...t){ta(e,"number","sheetId");const r=Ms(t);try{return this._crudOperations.ensureItIsPossibleToRemoveRows(e,...r),!0}catch(n){return!1}}removeRows(e,...t){return ta(e,"number","sheetId"),this._crudOperations.removeRows(e,...t),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToAddColumns(e,...t){ta(e,"number","sheetId");const r=Ds(t);try{return this._crudOperations.ensureItIsPossibleToAddColumns(e,...r),!0}catch(n){return!1}}addColumns(e,...t){return ta(e,"number","sheetId"),this._crudOperations.addColumns(e,...t),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToRemoveColumns(e,...t){ta(e,"number","sheetId");const r=Ms(t);try{return this._crudOperations.ensureItIsPossibleToRemoveColumns(e,...r),!0}catch(n){return!1}}removeColumns(e,...t){return ta(e,"number","sheetId"),this._crudOperations.removeColumns(e,...t),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToMoveCells(e,t){if(!$n(t))throw new b("SimpleCellAddress","destinationLeftCorner");if(!zt(e))throw new b("SimpleCellRange","source");try{const r=new jt(e.start,e.end);return this._crudOperations.operations.ensureItIsPossibleToMoveCells(r.start,r.width(),r.height(),t),!0}catch(r){return!1}}moveCells(e,t){if(!$n(t))throw new b("SimpleCellAddress","destinationLeftCorner");if(!zt(e))throw new b("SimpleCellRange","source");const r=new jt(e.start,e.end);return this._crudOperations.moveCells(r.start,r.width(),r.height(),t),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToMoveRows(e,t,r,n){ta(e,"number","sheetId"),ta(t,"number","startRow"),ta(r,"number","numberOfRows"),ta(n,"number","targetRow");try{return this._crudOperations.ensureItIsPossibleToMoveRows(e,t,r,n),!0}catch(a){return!1}}moveRows(e,t,r,n){return ta(e,"number","sheetId"),ta(t,"number","startRow"),ta(r,"number","numberOfRows"),ta(n,"number","targetRow"),this._crudOperations.moveRows(e,t,r,n),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToMoveColumns(e,t,r,n){ta(e,"number","sheetId"),ta(t,"number","startColumn"),ta(r,"number","numberOfColumns"),ta(n,"number","targetColumn");try{return this._crudOperations.ensureItIsPossibleToMoveColumns(e,t,r,n),!0}catch(a){return!1}}moveColumns(e,t,r,n){return ta(e,"number","sheetId"),ta(t,"number","startColumn"),ta(r,"number","numberOfColumns"),ta(n,"number","targetColumn"),this._crudOperations.moveColumns(e,t,r,n),this.recomputeIfDependencyGraphNeedsIt()}copy(e){if(!zt(e))throw new b("SimpleCellRange","source");const t=new jt(e.start,e.end);return this._crudOperations.copy(t.start,t.width(),t.height()),this.getRangeValues(e)}cut(e){if(!zt(e))throw new b("SimpleCellRange","source");const t=new jt(e.start,e.end);return this._crudOperations.cut(t.start,t.width(),t.height()),this.getRangeValues(e)}paste(e){if(!$n(e))throw new b("SimpleCellAddress","targetLeftCorner");return this.ensureEvaluationIsNotSuspended(),this._crudOperations.paste(e),this.recomputeIfDependencyGraphNeedsIt()}isClipboardEmpty(){return this._crudOperations.isClipboardEmpty()}clearClipboard(){this._crudOperations.clearClipboard()}clearRedoStack(){this._crudOperations.undoRedo.clearRedoStack()}clearUndoStack(){this._crudOperations.undoRedo.clearUndoStack()}getRangeValues(e){if(!zt(e))throw new b("SimpleCellRange","source");const t=new jt(e.start,e.end);return t.arrayOfAddressesInRange().map((e=>e.map((e=>this.getCellValue(e)))))}getRangeFormulas(e){if(!zt(e))throw new b("SimpleCellRange","source");const t=new jt(e.start,e.end);return t.arrayOfAddressesInRange().map((e=>e.map((e=>this.getCellFormula(e)))))}getRangeSerialized(e){if(!zt(e))throw new b("SimpleCellRange","source");const t=new jt(e.start,e.end);return t.arrayOfAddressesInRange().map((e=>e.map((e=>this.getCellSerialized(e)))))}getFillRangeData(e,t,r=!1){if(!zt(e))throw new b("SimpleCellRange","source");if(!zt(t))throw new b("SimpleCellRange","target");const n=new jt(e.start,e.end),a=new jt(t.start,t.end);return this.ensureEvaluationIsNotSuspended(),a.arrayOfAddressesInRange().map((a=>a.map((a=>{const s=((a.row-(r?t:e).start.row)%n.height()+n.height())%n.height()+e.start.row,i=((a.col-(r?t:e).start.col)%n.width()+n.width())%n.width()+e.start.col;return this._serialization.getCellSerialized({row:s,col:i,sheet:n.sheet},a)}))))}isItPossibleToAddSheet(e){ta(e,"string","sheetName");try{return this._crudOperations.ensureItIsPossibleToAddSheet(e),!0}catch(t){return!1}}addSheet(e){void 0!==e&&ta(e,"string","sheetName");const t=this._crudOperations.addSheet(e);return this._emitter.emit(Vi.SheetAdded,t),t}isItPossibleToRemoveSheet(e){ta(e,"number","sheetId");try{return this._crudOperations.ensureScopeIdIsValid(e),!0}catch(t){return!1}}removeSheet(e){ta(e,"number","sheetId");const t=this.sheetMapping.getDisplayName(e);this._crudOperations.removeSheet(e);const r=this.recomputeIfDependencyGraphNeedsIt();return this._emitter.emit(Vi.SheetRemoved,t,r),r}isItPossibleToClearSheet(e){ta(e,"number","sheetId");try{return this._crudOperations.ensureScopeIdIsValid(e),!0}catch(t){return!1}}clearSheet(e){return ta(e,"number","sheetId"),this._crudOperations.clearSheet(e),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToReplaceSheetContent(e,t){ta(e,"number","sheetId");try{return this._crudOperations.ensureScopeIdIsValid(e),this._crudOperations.ensureItIsPossibleToChangeSheetContents(e,t),!0}catch(r){return!1}}setSheetContent(e,t){return ta(e,"number","sheetId"),this._crudOperations.setSheetContent(e,t),this.recomputeIfDependencyGraphNeedsIt()}simpleCellAddressFromString(e,t){return ta(e,"string","cellAddress"),ta(t,"number","sheetId"),xe(this.sheetMapping.get,e,t)}simpleCellRangeFromString(e,t){return ta(e,"string","cellRange"),ta(t,"number","sheetId"),Fe(this.sheetMapping.get,e,t)}simpleCellAddressToString(e,t){if(!$n(e))throw new b("SimpleCellAddress","cellAddress");return ta(t,"number","sheetId"),Pe(this.sheetMapping.fetchDisplayName,e,t)}simpleCellRangeToString(e,t){if(!zt(e))throw new b("SimpleCellRange","cellRange");return ta(t,"number","sheetId"),Be(this.sheetMapping.fetchDisplayName,e,t)}getCellDependents(e){let t;if($n(e))t=this._dependencyGraph.addressMapping.getCell(e);else{if(!zt(e))throw new b("SimpleCellAddress | SimpleCellRange",e);t=this._dependencyGraph.rangeMapping.getRange(e.start,e.end)}return void 0===t?[]:this._dependencyGraph.getAdjacentNodesAddresses(t)}getCellPrecedents(e){let t;if($n(e))t=this._dependencyGraph.addressMapping.getCell(e);else{if(!zt(e))throw new b("SimpleCellAddress | SimpleCellRange",e);t=this._dependencyGraph.rangeMapping.getRange(e.start,e.end)}return void 0===t?[]:this._dependencyGraph.dependencyQueryAddresses(t)}getSheetName(e){return ta(e,"number","sheetId"),this.sheetMapping.getDisplayName(e)}getSheetNames(){return this.sheetMapping.sheetNames()}getSheetId(e){return ta(e,"string","sheetName"),this.sheetMapping.get(e)}doesSheetExist(e){return ta(e,"string","sheetName"),this.sheetMapping.hasSheetWithName(e)}getCellType(e){if(!$n(e))throw new b("SimpleCellAddress","cellAddress");const t=this.dependencyGraph.getCell(e);return On(t,e)}doesCellHaveSimpleValue(e){if(!$n(e))throw new b("SimpleCellAddress","cellAddress");return this.getCellType(e)===vn.VALUE}doesCellHaveFormula(e){if(!$n(e))throw new b("SimpleCellAddress","cellAddress");const t=this.getCellType(e);return t===vn.FORMULA||t===vn.ARRAYFORMULA}isCellEmpty(e){if(!$n(e))throw new b("SimpleCellAddress","cellAddress");return this.getCellType(e)===vn.EMPTY}isCellPartOfArray(e){if(!$n(e))throw new b("SimpleCellAddress","cellAddress");const t=this.getCellType(e);return t===vn.ARRAY||t===vn.ARRAYFORMULA}getCellValueType(e){if(!$n(e))throw new b("SimpleCellAddress","cellAddress");this.ensureEvaluationIsNotSuspended();const t=this.dependencyGraph.getCellValue(e);return _n(t)}getCellValueDetailedType(e){if(!$n(e))throw new b("SimpleCellAddress","cellAddress");this.ensureEvaluationIsNotSuspended();const t=this.dependencyGraph.getCellValue(e);return Un(t)}getCellValueFormat(e){if(!$n(e))throw new b("SimpleCellAddress","cellAddress");this.ensureEvaluationIsNotSuspended();const t=this.dependencyGraph.getCellValue(e);return xn(t)}countSheets(){return this.sheetMapping.numberOfSheets()}isItPossibleToRenameSheet(e,t){ta(e,"number","sheetId"),ta(t,"string","newName");try{return this._crudOperations.ensureItIsPossibleToRenameSheet(e,t),!0}catch(r){return!1}}renameSheet(e,t){ta(e,"number","sheetId"),ta(t,"string","newName");const r=this._crudOperations.renameSheet(e,t);void 0!==r&&this._emitter.emit(Vi.SheetRenamed,r,t)}batch(e){this.suspendEvaluation(),this._crudOperations.beginUndoRedoBatchMode();try{e()}catch(t){throw this._crudOperations.commitUndoRedoBatchMode(),this.resumeEvaluation(),t}return this._crudOperations.commitUndoRedoBatchMode(),this.resumeEvaluation()}suspendEvaluation(){this._evaluationSuspended=!0,this._emitter.emit(Vi.EvaluationSuspended)}resumeEvaluation(){this._evaluationSuspended=!1;const e=this.recomputeIfDependencyGraphNeedsIt();return this._emitter.emit(Vi.EvaluationResumed,e),e}isEvaluationSuspended(){return this._evaluationSuspended}isItPossibleToAddNamedExpression(e,t,r){ta(e,"string","expressionName"),void 0!==r&&ta(r,"number","scope");try{return this._crudOperations.ensureItIsPossibleToAddNamedExpression(e,t,r),!0}catch(n){return!1}}addNamedExpression(e,t,r,n){ta(e,"string","expressionName"),void 0!==r&&ta(r,"number","scope"),this._crudOperations.addNamedExpression(e,t,r,n);const a=this.recomputeIfDependencyGraphNeedsIt();return this._emitter.emit(Vi.NamedExpressionAdded,e,a),a}getNamedExpressionValue(e,t){ta(e,"string","expressionName"),void 0!==t&&ta(t,"number","scope"),this.ensureEvaluationIsNotSuspended(),this._crudOperations.ensureScopeIdIsValid(t);const r=this._namedExpressions.namedExpressionForScope(e,t);return r?this._serialization.getCellValue(r.address):void 0}getNamedExpressionFormula(e,t){ta(e,"string","expressionName"),void 0!==t&&ta(t,"number","scope"),this._crudOperations.ensureScopeIdIsValid(t);const r=this._namedExpressions.namedExpressionForScope(e,t);return void 0===r?void 0:this._serialization.getCellFormula(r.address)}getNamedExpression(e,t){ta(e,"string","expressionName"),void 0!==t&&ta(t,"number","scope");const r=this._namedExpressions.namedExpressionForScope(e,t);if(void 0===r)return;const n=this._serialization.getCellFormula(r.address);return{name:e,scope:t,expression:n,options:r.options}}isItPossibleToChangeNamedExpression(e,t,r){ta(e,"string","expressionName"),void 0!==r&&ta(r,"number","scope");try{return this._crudOperations.ensureItIsPossibleToChangeNamedExpression(e,t,r),!0}catch(n){return!1}}changeNamedExpression(e,t,r,n){return ta(e,"string","expressionName"),void 0!==r&&ta(r,"number","scope"),this._crudOperations.changeNamedExpressionExpression(e,r,t,n),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToRemoveNamedExpression(e,t){ta(e,"string","expressionName"),void 0!==t&&ta(t,"number","scope");try{return this._crudOperations.isItPossibleToRemoveNamedExpression(e,t),!0}catch(r){return!1}}removeNamedExpression(e,t){ta(e,"string","expressionName"),void 0!==t&&ta(t,"number","scope");const r=this._crudOperations.removeNamedExpression(e,t);if(r){const e=this.recomputeIfDependencyGraphNeedsIt();return this._emitter.emit(Vi.NamedExpressionRemoved,r.displayName,e),e}return[]}listNamedExpressions(e){return void 0!==e&&ta(e,"number","scope"),this._crudOperations.ensureScopeIdIsValid(e),this._namedExpressions.getAllNamedExpressionsNamesInScope(e)}getAllNamedExpressionsSerialized(){return this._serialization.getAllNamedExpressionsSerialized()}normalizeFormula(e){ta(e,"string","formulaString");const{ast:t,address:r}=this.extractTemporaryFormula(e);if(void 0===t)throw new p;return this._unparser.unparse(t,r)}calculateFormula(e,t){ta(e,"string","formulaString"),ta(t,"number","sheetId"),this._crudOperations.ensureScopeIdIsValid(t);const{ast:r,address:n,dependencies:a}=this.extractTemporaryFormula(e,t);if(void 0===r)throw new p;const s=this.evaluator.runAndForget(r,n,a);return this._exporter.exportScalarOrRange(s)}validateFormula(e){ta(e,"string","formulaString");const{ast:t}=this.extractTemporaryFormula(e);return void 0!==t&&!(t.type===$e.ERROR&&!t.error)}getRegisteredFunctionNames(){const e=Hi.getLanguage(this._config.language);return e.getFunctionTranslations(this._functionRegistry.getRegisteredFunctionIds())}getFunctionPlugin(e){return ta(e,"string","functionId"),this._functionRegistry.getFunctionPlugin(e)}getAllFunctionPlugins(){return this._functionRegistry.getPlugins()}numberToDateTime(e){return ta(e,"number","val"),this._evaluator.interpreter.dateTimeHelper.numberToSimpleDateTime(e)}numberToDate(e){return ta(e,"number","val"),this._evaluator.interpreter.dateTimeHelper.numberToSimpleDate(e)}numberToTime(e){return ta(e,"number","val"),Sa(e)}on(e,t){this._emitter.on(e,t)}once(e,t){this._emitter.once(e,t)}off(e,t){this._emitter.off(e,t)}destroy(){Bi(this)}ensureEvaluationIsNotSuspended(){if(this._evaluationSuspended)throw new D}extractTemporaryFormula(e,t=1){const r=this._cellContentParser.parse(e),n={sheet:t,col:0,row:0};if(!(r instanceof es.Formula))return{address:n,dependencies:[]};const{ast:a,errors:s,dependencies:i}=this._parser.parse(r.formula,n);return s.length>0?{address:n,dependencies:[]}:{ast:a,address:n,dependencies:i}}recomputeIfDependencyGraphNeedsIt(){if(this._evaluationSuspended)return[];{const e=this._crudOperations.getAndClearContentChanges(),t=Array.from(this.dependencyGraph.verticesToRecompute());this.dependencyGraph.clearRecentlyChangedVertices(),t.length>0&&e.addAll(this.evaluator.partialRun(t));const r=e.exportChanges(this._exporter);return e.isEmpty()||this._emitter.emit(Vi.ValuesUpdated,r),r}}}Hi.version="2.2.0",Hi.buildDate="17/11/2022 13:13:30",Hi.releaseDate="17/11/2022",Hi.languages={},Hi.registeredLanguages=new Map;
/**
 * @license
 * Copyright (c) 2022 Handsoncode. All rights reserved.
 */
const zi=new WeakMap;class $i{constructor(e={},t=!0){const{accentSensitive:r,binarySearchThreshold:n,caseSensitive:a,caseFirst:s,chooseAddressMappingPolicy:i,currencySymbol:o,dateFormats:c,decimalSeparator:l,evaluateNullToZero:u,functionArgSeparator:h,functionPlugins:f,ignorePunctuation:d,leapYear1900:p,localeLang:m,language:g,ignoreWhiteSpace:E,licenseKey:v,matchWholeCell:T,arrayColumnSeparator:S,arrayRowSeparator:A,maxRows:R,maxColumns:y,nullYear:N,nullDate:w,parseDateTime:b,precisionEpsilon:C,precisionRounding:O,stringifyDateTime:I,stringifyDuration:M,smartRounding:D,timeFormats:L,thousandSeparator:k,useArrayArithmetic:_,useStats:U,undoLimit:x,useColumnIndex:F,useRegularExpressions:P,useWildcards:B}=e;t&&$i.warnDeprecatedOptions(e),this.useArrayArithmetic=qn(_,"boolean","useArrayArithmetic"),this.accentSensitive=qn(r,"boolean","accentSensitive"),this.caseSensitive=qn(a,"boolean","caseSensitive"),this.caseFirst=qn(s,["upper","lower","false"],"caseFirst"),this.ignorePunctuation=qn(d,"boolean","ignorePunctuation"),this.chooseAddressMappingPolicy=null!==i&&void 0!==i?i:$i.defaultConfig.chooseAddressMappingPolicy,this.dateFormats=[...Zn(c,Array.isArray,"array","dateFormats")],this.timeFormats=[...Zn(L,Array.isArray,"array","timeFormats")],this.functionArgSeparator=qn(h,"string","functionArgSeparator"),this.decimalSeparator=qn(l,[".",","],"decimalSeparator"),this.language=qn(g,"string","language"),this.ignoreWhiteSpace=qn(E,["standard","any"],"ignoreWhiteSpace"),this.licenseKey=qn(v,"string","licenseKey"),this.thousandSeparator=qn(k,["",","," ","."],"thousandSeparator"),this.arrayColumnSeparator=qn(S,[",",";"],"arrayColumnSeparator"),this.arrayRowSeparator=qn(A,[";","|"],"arrayRowSeparator"),this.localeLang=qn(m,"string","localeLang"),this.functionPlugins=[...null!==f&&void 0!==f?f:$i.defaultConfig.functionPlugins],this.smartRounding=qn(D,"boolean","smartRounding"),this.evaluateNullToZero=qn(u,"boolean","evaluateNullToZero"),this.nullYear=qn(N,"number","nullYear"),Jn(this.nullYear,"nullYear",0),Qn(this.nullYear,"nullYear",100),this.precisionRounding=qn(O,"number","precisionRounding"),Jn(this.precisionRounding,"precisionRounding",0),this.precisionEpsilon=qn(C,"number","precisionEpsilon"),Jn(this.precisionEpsilon,"precisionEpsilon",0),this.useColumnIndex=qn(F,"boolean","useColumnIndex"),this.useStats=qn(U,"boolean","useStats"),this.binarySearchThreshold=null!==n&&void 0!==n?n:$i.defaultConfig.binarySearchThreshold,this.parseDateTime=qn(b,"function","parseDateTime"),this.stringifyDateTime=qn(I,"function","stringifyDateTime"),this.stringifyDuration=qn(M,"function","stringifyDuration"),this.translationPackage=Hi.getLanguage(this.language),this.errorMapping=this.translationPackage.buildErrorMapping(),this.nullDate=Zn(w,ha,"IDate","nullDate"),this.leapYear1900=qn(p,"boolean","leapYear1900"),this.undoLimit=qn(x,"number","undoLimit"),this.useRegularExpressions=qn(P,"boolean","useRegularExpressions"),this.useWildcards=qn(B,"boolean","useWildcards"),this.matchWholeCell=qn(T,"boolean","matchWholeCell"),Jn(this.undoLimit,"undoLimit",0),this.maxRows=qn(R,"number","maxRows"),Jn(this.maxRows,"maxRows",1),this.maxColumns=qn(y,"number","maxColumns"),this.currencySymbol=this.setupCurrencySymbol(o),Jn(this.maxColumns,"maxColumns",1),zi.set(this,{licenseKeyValidityState:Qa(this.licenseKey)}),ea({value:this.decimalSeparator,name:"decimalSeparator"},{value:this.functionArgSeparator,name:"functionArgSeparator"},{value:this.thousandSeparator,name:"thousandSeparator"}),ea({value:this.arrayRowSeparator,name:"arrayRowSeparator"},{value:this.arrayColumnSeparator,name:"arrayColumnSeparator"})}setupCurrencySymbol(e){const t=[...Zn(e,Array.isArray,"array","currencySymbol")];return t.forEach((e=>{if("string"!==typeof e)throw new b("string[]","currencySymbol");if(""===e)throw new C("currencySymbol")})),t}get licenseKeyValidityState(){return zi.get(this).licenseKeyValidityState}getConfig(){return ji(this)}mergeConfig(e){const t=Object.assign({},this.getConfig(),e);return $i.warnDeprecatedOptions(e),new $i(t,!1)}static warnDeprecatedOptions(e){$i.warnDeprecatedIfUsed(e.binarySearchThreshold,"binarySearchThreshold","1.1")}static warnDeprecatedIfUsed(e,t,r,n){void 0!==e&&(void 0===n?console.warn(`${t} option is deprecated since ${r}`):console.warn(`${t} option is deprecated since ${r}, please use ${n}`))}}function ji(e){var t;const r={};for(const n in $i.defaultConfig){const a=null!==(t=e[n])&&void 0!==t?t:$i.defaultConfig[n];Array.isArray(a)?r[n]=[...a]:r[n]=a}return r}function Xi(){return ji({})}$i.defaultConfig={accentSensitive:!1,binarySearchThreshold:20,currencySymbol:["$"],caseSensitive:!1,caseFirst:"lower",chooseAddressMappingPolicy:new ya,dateFormats:["DD/MM/YYYY","DD/MM/YY"],decimalSeparator:".",evaluateNullToZero:!1,functionArgSeparator:",",functionPlugins:[],ignorePunctuation:!1,language:"enGB",ignoreWhiteSpace:"standard",licenseKey:"",leapYear1900:!1,localeLang:"en",matchWholeCell:!0,arrayColumnSeparator:",",arrayRowSeparator:";",maxRows:4e4,maxColumns:18278,nullYear:30,nullDate:{year:1899,month:12,day:30},parseDateTime:ra,precisionEpsilon:1e-13,precisionRounding:14,smartRounding:!0,stringifyDateTime:Va,stringifyDuration:Ya,timeFormats:["hh:mm","hh:mm:ss.sss"],thousandSeparator:"",undoLimit:20,useRegularExpressions:!1,useWildcards:!0,useColumnIndex:!1,useStats:!1,useArrayArithmetic:!1};
/**
 * @license
 * Copyright (c) 2022 Handsoncode. All rights reserved.
 */
const Ki={errors:{CYCLE:"#CYCLE!",DIV_BY_ZERO:"#DIV/0!",ERROR:"#ERROR!",NA:"#N/A",NAME:"#NAME?",NUM:"#NUM!",REF:"#REF!",SPILL:"#SPILL!",VALUE:"#VALUE!"},functions:{FILTER:"FILTER",ARRAY_CONSTRAIN:"ARRAY_CONSTRAIN",ARRAYFORMULA:"ARRAYFORMULA",ABS:"ABS",ACOS:"ACOS",ACOSH:"ACOSH",ACOT:"ACOT",ACOTH:"ACOTH",AND:"AND",ARABIC:"ARABIC",ASIN:"ASIN",ASINH:"ASINH",ATAN2:"ATAN2",ATAN:"ATAN",ATANH:"ATANH",AVERAGE:"AVERAGE",AVERAGEA:"AVERAGEA",AVERAGEIF:"AVERAGEIF",BASE:"BASE",BIN2DEC:"BIN2DEC",BIN2HEX:"BIN2HEX",BIN2OCT:"BIN2OCT",BITAND:"BITAND",BITLSHIFT:"BITLSHIFT",BITOR:"BITOR",BITRSHIFT:"BITRSHIFT",BITXOR:"BITXOR",CEILING:"CEILING",CHAR:"CHAR",CHOOSE:"CHOOSE",CLEAN:"CLEAN",CODE:"CODE",COLUMN:"COLUMN",COLUMNS:"COLUMNS",CONCATENATE:"CONCATENATE",CORREL:"CORREL",COS:"COS",COSH:"COSH",COT:"COT",COTH:"COTH",COUNT:"COUNT",COUNTA:"COUNTA",COUNTBLANK:"COUNTBLANK",COUNTIF:"COUNTIF",COUNTIFS:"COUNTIFS",COUNTUNIQUE:"COUNTUNIQUE",CSC:"CSC",CSCH:"CSCH",CUMIPMT:"CUMIPMT",CUMPRINC:"CUMPRINC",DATE:"DATE",DATEDIF:"DATEDIF",DATEVALUE:"DATEVALUE",DAY:"DAY",DAYS360:"DAYS360",DAYS:"DAYS",DB:"DB",DDB:"DDB",DEC2BIN:"DEC2BIN",DEC2HEX:"DEC2HEX",DEC2OCT:"DEC2OCT",DECIMAL:"DECIMAL",DEGREES:"DEGREES",DELTA:"DELTA",DOLLARDE:"DOLLARDE",DOLLARFR:"DOLLARFR",EDATE:"EDATE",EFFECT:"EFFECT",EOMONTH:"EOMONTH",ERF:"ERF",ERFC:"ERFC",EVEN:"EVEN",EXACT:"EXACT",EXP:"EXP",FALSE:"FALSE",FIND:"FIND",FORMULATEXT:"FORMULATEXT",FV:"FV",FVSCHEDULE:"FVSCHEDULE",HEX2BIN:"HEX2BIN",HEX2DEC:"HEX2DEC",HEX2OCT:"HEX2OCT",HLOOKUP:"HLOOKUP",HOUR:"HOUR",IF:"IF",IFERROR:"IFERROR",IFNA:"IFNA",INDEX:"INDEX",INT:"INT",INTERVAL:"INTERVAL",IPMT:"IPMT",ISBINARY:"ISBINARY",ISBLANK:"ISBLANK",ISERR:"ISERR",ISERROR:"ISERROR",ISEVEN:"ISEVEN",ISFORMULA:"ISFORMULA",ISLOGICAL:"ISLOGICAL",ISNA:"ISNA",ISNONTEXT:"ISNONTEXT",ISNUMBER:"ISNUMBER",ISODD:"ISODD",ISOWEEKNUM:"ISOWEEKNUM",ISPMT:"ISPMT",ISREF:"ISREF",ISTEXT:"ISTEXT",LEFT:"LEFT",LEN:"LEN",LN:"LN",LOG10:"LOG10",LOG:"LOG",LOWER:"LOWER",MATCH:"MATCH",MAX:"MAX",MAXA:"MAXA",MAXIFS:"MAXIFS",MAXPOOL:"MAXPOOL",MEDIAN:"MEDIAN",MEDIANPOOL:"MEDIANPOOL",MID:"MID",MIN:"MIN",MINA:"MINA",MINIFS:"MINIFS",MINUTE:"MINUTE",MIRR:"MIRR",MMULT:"MMULT",MOD:"MOD",MONTH:"MONTH",NA:"NA",NETWORKDAYS:"NETWORKDAYS","NETWORKDAYS.INTL":"NETWORKDAYS.INTL",NOMINAL:"NOMINAL",NOT:"NOT",NOW:"NOW",NPER:"NPER",NPV:"NPV",OCT2BIN:"OCT2BIN",OCT2DEC:"OCT2DEC",OCT2HEX:"OCT2HEX",ODD:"ODD",OFFSET:"OFFSET",OR:"OR",PI:"PI",PMT:"PMT",PDURATION:"PDURATION",PRODUCT:"PRODUCT",POWER:"POWER",PPMT:"PPMT",PROPER:"PROPER",PV:"PV",RADIANS:"RADIANS",RAND:"RAND",RATE:"RATE",REPLACE:"REPLACE",REPT:"REPT",RIGHT:"RIGHT",ROMAN:"ROMAN",ROUND:"ROUND",ROUNDDOWN:"ROUNDDOWN",ROUNDUP:"ROUNDUP",ROW:"ROW",ROWS:"ROWS",RRI:"RRI",SEARCH:"SEARCH",SEC:"SEC",SECH:"SECH",SECOND:"SECOND",SHEET:"SHEET",SHEETS:"SHEETS",SIN:"SIN",SINH:"SINH",SLN:"SLN",SPLIT:"SPLIT",SQRT:"SQRT",STDEVA:"STDEVA","STDEV.P":"STDEV.P",STDEVPA:"STDEVPA","STDEV.S":"STDEV.S",SUBSTITUTE:"SUBSTITUTE",SUBTOTAL:"SUBTOTAL",SUM:"SUM",SUMIF:"SUMIF",SUMIFS:"SUMIFS",SUMPRODUCT:"SUMPRODUCT",SUMSQ:"SUMSQ",SWITCH:"SWITCH",SYD:"SYD",T:"T",TAN:"TAN",TANH:"TANH",TBILLEQ:"TBILLEQ",TBILLPRICE:"TBILLPRICE",TBILLYIELD:"TBILLYIELD",TEXT:"TEXT",TIME:"TIME",TIMEVALUE:"TIMEVALUE",TODAY:"TODAY",TRANSPOSE:"TRANSPOSE",TRIM:"TRIM",TRUE:"TRUE",TRUNC:"TRUNC",UNICHAR:"UNICHAR",UNICODE:"UNICODE",UPPER:"UPPER",VARA:"VARA","VAR.P":"VAR.P",VARPA:"VARPA","VAR.S":"VAR.S",VLOOKUP:"VLOOKUP",WEEKDAY:"WEEKDAY",WEEKNUM:"WEEKNUM",WORKDAY:"WORKDAY","WORKDAY.INTL":"WORKDAY.INTL",XNPV:"XNPV",XOR:"XOR",YEAR:"YEAR",YEARFRAC:"YEARFRAC","HF.ADD":"HF.ADD","HF.CONCAT":"HF.CONCAT","HF.DIVIDE":"HF.DIVIDE","HF.EQ":"HF.EQ","HF.GT":"HF.GT","HF.GTE":"HF.GTE","HF.LT":"HF.LT","HF.LTE":"HF.LTE","HF.MINUS":"HF.MINUS","HF.MULTIPLY":"HF.MULTIPLY","HF.NE":"HF.NE","HF.POW":"HF.POW","HF.UMINUS":"HF.UMINUS","HF.UNARY_PERCENT":"HF.UNARY_PERCENT","HF.UPLUS":"HF.UPLUS",VARP:"VARP",VAR:"VAR",STDEVP:"STDEVP",STDEV:"STDEV","EXPON.DIST":"EXPON.DIST",FISHER:"FISHER",FISHERINV:"FISHERINV",GAMMA:"GAMMA","GAMMA.DIST":"GAMMA.DIST",GAMMALN:"GAMMALN","GAMMALN.PRECISE":"GAMMALN.PRECISE","GAMMA.INV":"GAMMA.INV",GAUSS:"GAUSS",FACT:"FACT",FACTDOUBLE:"FACTDOUBLE",COMBIN:"COMBIN",COMBINA:"COMBINA",GCD:"GCD",LCM:"LCM",MROUND:"MROUND",MULTINOMIAL:"MULTINOMIAL",QUOTIENT:"QUOTIENT",RANDBETWEEN:"RANDBETWEEN",SERIESSUM:"SERIESSUM",SIGN:"SIGN",SQRTPI:"SQRTPI",SUMX2MY2:"SUMX2MY2",SUMX2PY2:"SUMX2PY2",SUMXMY2:"SUMXMY2",EXPONDIST:"EXPONDIST",GAMMADIST:"GAMMADIST",GAMMAINV:"GAMMAINV","BETA.DIST":"BETA.DIST",BETADIST:"BETADIST","BETA.INV":"BETA.INV",BETAINV:"BETAINV","BINOM.DIST":"BINOM.DIST",BINOMDIST:"BINOMDIST","BINOM.INV":"BINOM.INV",BESSELI:"BESSELI",BESSELJ:"BESSELJ",BESSELK:"BESSELK",BESSELY:"BESSELY","CHISQ.DIST":"CHISQ.DIST","CHISQ.DIST.RT":"CHISQ.DIST.RT","CHISQ.INV":"CHISQ.INV","CHISQ.INV.RT":"CHISQ.INV.RT",CHIDIST:"CHIDIST",CHIINV:"CHIINV","F.DIST":"F.DIST","F.DIST.RT":"F.DIST.RT","F.INV":"F.INV","F.INV.RT":"F.INV.RT",FDIST:"FDIST",FINV:"FINV",WEIBULL:"WEIBULL","WEIBULL.DIST":"WEIBULL.DIST",POISSON:"POISSON","POISSON.DIST":"POISSON.DIST","HYPGEOM.DIST":"HYPGEOM.DIST",HYPGEOMDIST:"HYPGEOMDIST","T.DIST":"T.DIST","T.DIST.2T":"T.DIST.2T","T.DIST.RT":"T.DIST.RT","T.INV":"T.INV","T.INV.2T":"T.INV.2T",TDIST:"TDIST",TINV:"TINV",LOGINV:"LOGINV","LOGNORM.DIST":"LOGNORM.DIST","LOGNORM.INV":"LOGNORM.INV",LOGNORMDIST:"LOGNORMDIST","NORM.DIST":"NORM.DIST","NORM.INV":"NORM.INV","NORM.S.DIST":"NORM.S.DIST","NORM.S.INV":"NORM.S.INV",NORMDIST:"NORMDIST",NORMINV:"NORMINV",NORMSDIST:"NORMSDIST",NORMSINV:"NORMSINV",PHI:"PHI","NEGBINOM.DIST":"NEGBINOM.DIST",NEGBINOMDIST:"NEGBINOMDIST",COMPLEX:"COMPLEX",IMABS:"IMABS",IMAGINARY:"IMAGINARY",IMARGUMENT:"IMARGUMENT",IMCONJUGATE:"IMCONJUGATE",IMCOS:"IMCOS",IMCOSH:"IMCOSH",IMCOT:"IMCOT",IMCSC:"IMCSC",IMCSCH:"IMCSCH",IMDIV:"IMDIV",IMEXP:"IMEXP",IMLN:"IMLN",IMLOG10:"IMLOG10",IMLOG2:"IMLOG2",IMPOWER:"IMPOWER",IMPRODUCT:"IMPRODUCT",IMREAL:"IMREAL",IMSEC:"IMSEC",IMSECH:"IMSECH",IMSIN:"IMSIN",IMSINH:"IMSINH",IMSQRT:"IMSQRT",IMSUB:"IMSUB",IMSUM:"IMSUM",IMTAN:"IMTAN",LARGE:"LARGE",SMALL:"SMALL",AVEDEV:"AVEDEV",CONFIDENCE:"CONFIDENCE","CONFIDENCE.NORM":"CONFIDENCE.NORM","CONFIDENCE.T":"CONFIDENCE.T",DEVSQ:"DEVSQ",GEOMEAN:"GEOMEAN",HARMEAN:"HARMEAN",CRITBINOM:"CRITBINOM","COVARIANCE.P":"COVARIANCE.P","COVARIANCE.S":"COVARIANCE.S",COVAR:"COVAR",PEARSON:"PEARSON",RSQ:"RSQ",STANDARDIZE:"STANDARDIZE","Z.TEST":"Z.TEST",ZTEST:"ZTEST","F.TEST":"F.TEST",FTEST:"FTEST",STEYX:"STEYX",SLOPE:"SLOPE","CHISQ.TEST":"CHISQ.TEST",CHITEST:"CHITEST","T.TEST":"T.TEST",TTEST:"TTEST",SKEW:"SKEW","SKEW.P":"SKEW.P",WEIBULLDIST:"WEIBULLDIST",VARS:"VARS",TINV2T:"TINV2T",TDISTRT:"TDISTRT",TDIST2T:"TDIST2T",STDEVS:"STDEVS",FINVRT:"FINVRT",FDISTRT:"FDISTRT",CHIDISTRT:"CHIDISTRT",CHIINVRT:"CHIINVRT",COVARIANCEP:"COVARIANCEP",COVARIANCES:"COVARIANCES",LOGNORMINV:"LOGNORMINV",POISSONDIST:"POISSONDIST",SKEWP:"SKEWP","CEILING.MATH":"CEILING.MATH",FLOOR:"FLOOR","FLOOR.MATH":"FLOOR.MATH","CEILING.PRECISE":"CEILING.PRECISE","FLOOR.PRECISE":"FLOOR.PRECISE","ISO.CEILING":"ISO.CEILING"},langCode:"enGB",ui:{NEW_SHEET_PREFIX:"Sheet"}};var qi=Ki;
/**
 * @license
 * Copyright (c) 2022 Handsoncode. All rights reserved.
 */
class Ji extends Wr{arrayformula(e,t){return this.runFunction(e.args,t,this.metadata("ARRAYFORMULA"),(e=>e))}arrayformulaArraySize(e,t){if(1!==e.args.length)return Gr.error();const r=this.metadata("ARRAYFORMULA"),n=e.args.map((e=>{var n;return this.arraySizeForAst(e,new Qt(t.formulaAddress,t.arraysFlag||null!==(n=null===r||void 0===r?void 0:r.arrayFunction)&&void 0!==n&&n))}));return n[0]}arrayconstrain(e,t){return this.runFunction(e.args,t,this.metadata("ARRAY_CONSTRAIN"),((e,t,r)=>{t=Math.min(t,e.height()),r=Math.min(r,e.width());const n=e.data,a=[];for(let s=0;s<t;s++)a.push(n[s].slice(0,r));return jr.onlyValues(a)}))}arrayconstrainArraySize(e,t){if(3!==e.args.length)return Gr.error();const r=this.metadata("ARRAY_CONSTRAIN"),n=e.args.map((e=>{var n;return this.arraySizeForAst(e,new Qt(t.formulaAddress,t.arraysFlag||null!==(n=null===r||void 0===r?void 0:r.arrayFunction)&&void 0!==n&&n))}));let{height:a,width:s}=n[0];return e.args[1].type===$e.NUMBER&&(a=Math.min(a,e.args[1].value)),e.args[2].type===$e.NUMBER&&(s=Math.min(s,e.args[2].value)),a<1||s<1||!Number.isInteger(a)||!Number.isInteger(s)?Gr.error():new Gr(s,a)}filter(e,t){return this.runFunction(e.args,t,this.metadata("FILTER"),((e,...t)=>{for(const a of t)if(e.width()!==a.width()||e.height()!==a.height())return new Fn(En.NA,It.EqualLength);if(e.width()>1&&e.height()>1)return new Fn(En.NA,It.WrongDimension);const r=e.data,n=[];for(let a=0;a<e.height();a++){const s=[];for(let n=0;n<e.width();n++){let e=!0;for(const r of t){const t=yr(r.data[a][n]);if(!0!==t){e=!1;break}}e&&s.push(r[a][n])}s.length>0&&n.push(s)}return n.length>0?jr.onlyValues(n):new Fn(En.NA,It.EmptyRange)}))}filterArraySize(e,t){if(e.args.length<=1)return Gr.error();const r=this.metadata("FILTER"),n=e.args.map((e=>{var n;return this.arraySizeForAst(e,new Qt(t.formulaAddress,t.arraysFlag||null!==(n=null===r||void 0===r?void 0:r.arrayFunction)&&void 0!==n&&n))})),a=Math.max(...n.map((e=>e.width))),s=Math.max(...n.map((e=>e.height)));return new Gr(a,s)}}Ji.implementedFunctions={ARRAYFORMULA:{method:"arrayformula",arraySizeMethod:"arrayformulaArraySize",arrayFunction:!0,parameters:[{argumentType:Yr.ANY}]},ARRAY_CONSTRAIN:{method:"arrayconstrain",arraySizeMethod:"arrayconstrainArraySize",parameters:[{argumentType:Yr.RANGE},{argumentType:Yr.INTEGER,minValue:1},{argumentType:Yr.INTEGER,minValue:1}],vectorizationForbidden:!0},FILTER:{method:"filter",arraySizeMethod:"filterArraySize",arrayFunction:!0,parameters:[{argumentType:Yr.RANGE},{argumentType:Yr.RANGE}],repeatLastArgs:1}};
/**
 * @license
 * Copyright (c) 2022 Handsoncode. All rights reserved.
 */
class Qi extends Wr{abs(e,t){return this.runFunction(e.args,t,this.metadata("ABS"),Math.abs)}}Qi.implementedFunctions={ABS:{method:"abs",parameters:[{argumentType:Yr.NUMBER}]}};
/**
 * @license
 * Copyright (c) 2022 Handsoncode. All rights reserved.
 */
const Zi=0xffffffffffff,eo=-53,to=53;class ro extends Wr{bitlshift(e,t){return this.runFunction(e.args,t,this.metadata("BITLSHIFT"),no)}bitrshift(e,t){return this.runFunction(e.args,t,this.metadata("BITRSHIFT"),ao)}}function no(e,t){return t<0?ao(e,-t):so(e*Math.pow(2,t))}function ao(e,t){return t<0?no(e,-t):so(Math.floor(e/Math.pow(2,t)))}function so(e){return e>Zi?new Fn(En.NUM,It.BitshiftLong):e}ro.implementedFunctions={BITLSHIFT:{method:"bitlshift",parameters:[{argumentType:Yr.INTEGER,minValue:0},{argumentType:Yr.INTEGER,minValue:eo,maxValue:to}]},BITRSHIFT:{method:"bitrshift",parameters:[{argumentType:Yr.INTEGER,minValue:0},{argumentType:Yr.INTEGER,minValue:eo,maxValue:to}]}};
/**
 * @license
 * Copyright (c) 2022 Handsoncode. All rights reserved.
 */
class io extends Wr{bitand(e,t){return this.runFunction(e.args,t,this.metadata("BITAND"),((e,t)=>e&t))}bitor(e,t){return this.runFunction(e.args,t,this.metadata("BITOR"),((e,t)=>e|t))}bitxor(e,t){return this.runFunction(e.args,t,this.metadata("BITXOR"),((e,t)=>e^t))}}io.implementedFunctions={BITAND:{method:"bitand",parameters:[{argumentType:Yr.INTEGER,minValue:0},{argumentType:Yr.INTEGER,minValue:0}]},BITOR:{method:"bitor",parameters:[{argumentType:Yr.INTEGER,minValue:0},{argumentType:Yr.INTEGER,minValue:0}]},BITXOR:{method:"bitxor",parameters:[{argumentType:Yr.INTEGER,minValue:0},{argumentType:Yr.INTEGER,minValue:0}]}};
/**
 * @license
 * Copyright (c) 2022 Handsoncode. All rights reserved.
 */
class oo extends Wr{literalTrue(e,t){return this.runFunction(e.args,t,this.metadata("TRUE"),(()=>!0))}literalFalse(e,t){return this.runFunction(e.args,t,this.metadata("FALSE"),(()=>!1))}conditionalIf(e,t){return this.runFunction(e.args,t,this.metadata("IF"),((e,t,r)=>e?t:r))}and(e,t){return this.runFunction(e.args,t,this.metadata("AND"),((...e)=>!e.some((e=>!e))))}or(e,t){return this.runFunction(e.args,t,this.metadata("OR"),((...e)=>e.some((e=>e))))}not(e,t){return this.runFunction(e.args,t,this.metadata("NOT"),(e=>!e))}xor(e,t){return this.runFunction(e.args,t,this.metadata("XOR"),((...e)=>{let t=0;return e.forEach((e=>{e&&t++})),t%2===1}))}switch(e,t){return this.runFunction(e.args,t,this.metadata("SWITCH"),((e,...t)=>{const r=t.length;let n=0;for(;n+1<r;n+=2)if(!(t[n]instanceof Fn)&&this.arithmeticHelper.eq(e,t[n]))return t[n+1];return n<r?t[n]:new Fn(En.NA,It.NoDefault)}))}iferror(e,t){return this.runFunction(e.args,t,this.metadata("IFERROR"),((e,t)=>e instanceof Fn?t:e))}ifna(e,t){return this.runFunction(e.args,t,this.metadata("IFNA"),((e,t)=>e instanceof Fn&&e.type===En.NA?t:e))}choose(e,t){return this.runFunction(e.args,t,this.metadata("CHOOSE"),((e,...t)=>e>t.length?new Fn(En.NUM,It.Selector):t[e-1]))}}oo.implementedFunctions={TRUE:{method:"literalTrue",parameters:[]},FALSE:{method:"literalFalse",parameters:[]},IF:{method:"conditionalIf",parameters:[{argumentType:Yr.BOOLEAN},{argumentType:Yr.SCALAR,passSubtype:!0},{argumentType:Yr.SCALAR,defaultValue:!1,passSubtype:!0}]},AND:{method:"and",parameters:[{argumentType:Yr.BOOLEAN}],repeatLastArgs:1,expandRanges:!0},OR:{method:"or",parameters:[{argumentType:Yr.BOOLEAN}],repeatLastArgs:1,expandRanges:!0},XOR:{method:"xor",parameters:[{argumentType:Yr.BOOLEAN}],repeatLastArgs:1,expandRanges:!0},NOT:{method:"not",parameters:[{argumentType:Yr.BOOLEAN}]},SWITCH:{method:"switch",parameters:[{argumentType:Yr.NOERROR},{argumentType:Yr.SCALAR,passSubtype:!0},{argumentType:Yr.SCALAR,passSubtype:!0}],repeatLastArgs:1},IFERROR:{method:"iferror",parameters:[{argumentType:Yr.SCALAR,passSubtype:!0},{argumentType:Yr.SCALAR,passSubtype:!0}]},IFNA:{method:"ifna",parameters:[{argumentType:Yr.SCALAR,passSubtype:!0},{argumentType:Yr.SCALAR,passSubtype:!0}]},CHOOSE:{method:"choose",parameters:[{argumentType:Yr.INTEGER,minValue:1},{argumentType:Yr.SCALAR,passSubtype:!0}],repeatLastArgs:1}};
/**
 * @license
 * Copyright (c) 2022 Handsoncode. All rights reserved.
 */
class co extends Wr{char(e,t){return this.runFunction(e.args,t,this.metadata("CHAR"),(e=>e<1||e>=256?new Fn(En.VALUE,It.CharacterCodeBounds):String.fromCharCode(Math.trunc(e))))}unichar(e,t){return this.runFunction(e.args,t,this.metadata("CHAR"),(e=>e<1||e>=1114112?new Fn(En.VALUE,It.CharacterCodeBounds):String.fromCodePoint(Math.trunc(e))))}}co.implementedFunctions={CHAR:{method:"char",parameters:[{argumentType:Yr.NUMBER}]},UNICHAR:{method:"unichar",parameters:[{argumentType:Yr.NUMBER}]}};
/**
 * @license
 * Copyright (c) 2022 Handsoncode. All rights reserved.
 */
class lo extends Wr{code(e,t){return this.runFunction(e.args,t,this.metadata("CODE"),(e=>0===e.length?new Fn(En.VALUE,It.EmptyString):e.charCodeAt(0)))}unicode(e,t){return this.runFunction(e.args,t,this.metadata("UNICODE"),(e=>{var t;return null!==(t=e.codePointAt(0))&&void 0!==t?t:new Fn(En.VALUE,It.EmptyString)}))}}lo.implementedFunctions={CODE:{method:"code",parameters:[{argumentType:Yr.STRING}]},UNICODE:{method:"unicode",parameters:[{argumentType:Yr.STRING}]}};
/**
 * @license
 * Copyright (c) 2022 Handsoncode. All rights reserved.
 */
class uo extends Wr{countblank(e,t){return this.runFunction(e.args,t,this.metadata("COUNTBLANK"),((...e)=>{let t=0;return e.forEach((e=>{e===rr&&t++})),t}))}}uo.implementedFunctions={COUNTBLANK:{method:"countblank",parameters:[{argumentType:Yr.SCALAR}],repeatLastArgs:1,expandRanges:!0}};
/**
 * @license
 * Copyright (c) 2022 Handsoncode. All rights reserved.
 */
class ho extends Wr{countunique(e,t){return this.runFunction(e.args,t,this.metadata("COUNTUNIQUE"),((...e)=>{const t=new Set,r=new Set;for(const n of e)n instanceof Fn?r.add(n.type):""!==n&&t.add(n);return t.size+r.size}))}}ho.implementedFunctions={COUNTUNIQUE:{method:"countunique",parameters:[{argumentType:Yr.SCALAR}],repeatLastArgs:1,expandRanges:!0}};
/**
 * @license
 * Copyright (c) 2022 Handsoncode. All rights reserved.
 */
class fo extends Wr{constructor(){super(...arguments),this.isoweeknumCore=e=>{const t=Math.floor(this.dateTimeHelper.relativeNumberToAbsoluteNumber(e)),r=this.dateTimeHelper.numberToSimpleDate(e),n=this.dateTimeHelper.dateToNumber({year:r.year,month:1,day:1}),a=this.dateTimeHelper.relativeNumberToAbsoluteNumber(n),s=a+((4-a)%7+7)%7,i=Math.floor((t-1)/7)-Math.floor((s-1)/7)+1;return 0===i?this.isoweeknumCore(e-7)+1:i},this.days360Core=(e,t,r)=>{const n=this.dateTimeHelper.numberToSimpleDate(e),a=this.dateTimeHelper.numberToSimpleDate(t);let s,i;return r?(s=Ra(n),i=Ra(a)):[s,i]=this.dateTimeHelper.toBasisUS(n,a),360*(i.year-s.year)+30*(i.month-s.month)+i.day-s.day}}date(e,t){return this.runFunction(e.args,t,this.metadata("DATE"),((e,t,r)=>{const n=Math.trunc(r);let a=Math.trunc(t),s=Math.trunc(e);s<this.dateTimeHelper.getEpochYearZero()&&(s+=this.dateTimeHelper.getEpochYearZero());const i=Math.floor((a-1)/12);s+=i,a-=12*i;const o={year:s,month:a,day:1};if(this.dateTimeHelper.isValidDate(o)){let e=this.dateTimeHelper.dateToNumber(o)+(n-1);return e=this.dateTimeHelper.getWithinBounds(e),void 0===e?new Fn(En.NUM,It.DateBounds):e}return new Fn(En.VALUE,It.InvalidDate)}))}time(e,t){return this.runFunction(e.args,t,this.metadata("TIME"),((e,t,r)=>{const n=Aa({hours:Math.trunc(e),minutes:Math.trunc(t),seconds:Math.trunc(r)});return n<0?new Fn(En.NUM,It.NegativeTime):n%1}))}eomonth(e,t){return this.runFunction(e.args,t,this.metadata("EOMONTH"),((e,t)=>{const r=this.dateTimeHelper.numberToSimpleDate(e);let n=this.dateTimeHelper.dateToNumber(this.dateTimeHelper.endOfMonth(ga(r,t)));return n=this.dateTimeHelper.getWithinBounds(n),void 0===n?new Fn(En.NUM,It.DateBounds):n}))}day(e,t){return this.runFunction(e.args,t,this.metadata("DAY"),(e=>this.dateTimeHelper.numberToSimpleDate(e).day))}days(e,t){return this.runFunction(e.args,t,this.metadata("DAYS"),((e,t)=>Math.trunc(e)-Math.trunc(t)))}month(e,t){return this.runFunction(e.args,t,this.metadata("MONTH"),(e=>this.dateTimeHelper.numberToSimpleDate(e).month))}year(e,t){return this.runFunction(e.args,t,this.metadata("YEAR"),(e=>this.dateTimeHelper.numberToSimpleDate(e).year))}hour(e,t){return this.runFunction(e.args,t,this.metadata("HOUR"),(e=>Sa(va(e)%1).hours))}minute(e,t){return this.runFunction(e.args,t,this.metadata("MINUTE"),(e=>Sa(va(e)%1).minutes))}second(e,t){return this.runFunction(e.args,t,this.metadata("SECOND"),(e=>Sa(va(e)%1).seconds))}text(e,t){return this.runFunction(e.args,t,this.metadata("TEXT"),((e,t)=>Ua(e,t,this.config,this.dateTimeHelper)))}weekday(e,t){return this.runFunction(e.args,t,this.metadata("WEEKDAY"),((e,t)=>{const r=Math.floor(this.dateTimeHelper.relativeNumberToAbsoluteNumber(e));if(3===t)return(r-1)%7;const n=go.get(t);return void 0===n?new Fn(En.NUM,It.BadMode):(r-n)%7+1}))}weeknum(e,t){return this.runFunction(e.args,t,this.metadata("WEEKNUM"),((e,t)=>{const r=Math.floor(this.dateTimeHelper.relativeNumberToAbsoluteNumber(e)),n=this.dateTimeHelper.numberToSimpleDate(e),a=this.dateTimeHelper.dateToNumber({year:n.year,month:1,day:1}),s=this.dateTimeHelper.relativeNumberToAbsoluteNumber(a);if(21===t)return this.isoweeknumCore(e);const i=go.get(t);return void 0===i?new Fn(En.NUM,It.BadMode):Math.floor((r-i)/7)-Math.floor((s-i)/7)+1}))}isoweeknum(e,t){return this.runFunction(e.args,t,this.metadata("ISOWEEKNUM"),this.isoweeknumCore)}datevalue(e,t){return this.runFunction(e.args,t,this.metadata("DATEVALUE"),(e=>{const{dateTime:t}=this.dateTimeHelper.parseDateTimeFromConfigFormats(e);return void 0===t?new Fn(En.VALUE,It.IncorrectDateTime):ha(t)?(fa(t)?Math.trunc(Aa(t)):0)+this.dateTimeHelper.dateToNumber(t):0}))}timevalue(e,t){return this.runFunction(e.args,t,this.metadata("TIMEVALUE"),(e=>{const t=this.dateTimeHelper.dateStringToDateNumber(e);return void 0===t?new Fn(En.VALUE,It.IncorrectDateTime):nr(t)%1}))}now(e,t){return this.runFunction(e.args,t,this.metadata("NOW"),(()=>{const e=new Date(Date.now());return Aa({hours:e.getHours(),minutes:e.getMinutes(),seconds:e.getSeconds()})+this.dateTimeHelper.dateToNumber({year:e.getFullYear(),month:e.getMonth()+1,day:e.getDate()})}))}today(e,t){return this.runFunction(e.args,t,this.metadata("TODAY"),(()=>{const e=new Date(Date.now());return this.dateTimeHelper.dateToNumber({year:e.getFullYear(),month:e.getMonth()+1,day:e.getDate()})}))}edate(e,t){return this.runFunction(e.args,t,this.metadata("EDATE"),((e,t)=>{const r=this.dateTimeHelper.numberToSimpleDate(e),n=Ea(ga(r,t));let a=this.dateTimeHelper.dateToNumber(n);return a=this.dateTimeHelper.getWithinBounds(a),void 0===a?new Fn(En.NUM,It.DateBounds):a}))}datedif(e,t){return this.runFunction(e.args,t,this.metadata("DATEDIF"),((e,t,r)=>{if(e>t)return new Fn(En.NUM,It.StartEndDate);if("D"===r)return Math.floor(t)-Math.floor(e);const n=this.dateTimeHelper.numberToSimpleDate(e),a=this.dateTimeHelper.numberToSimpleDate(t);switch(r){case"M":return 12*(a.year-n.year)+(a.month-n.month)-(a.day<n.day?1:0);case"YM":return(a.month-n.month+12-(a.day<n.day?1:0))%12;case"Y":return a.month>n.month||a.month===n.month&&a.day>=n.day?a.year-n.year:a.year-n.year-1;case"MD":if(a.day>=n.day)return a.day-n.day;{const e=1===a.month?12:a.month-1,t=1===a.month?a.year-1:a.year;return this.dateTimeHelper.daysInMonth(t,e)+a.day-n.day}case"YD":return a.month>n.month||a.month===n.month&&a.day>=n.day?Math.floor(t)-this.dateTimeHelper.dateToNumber({year:a.year,month:n.month,day:n.day}):Math.floor(t)-Math.floor(e)-365*(a.year-n.year-1)-this.dateTimeHelper.leapYearsCount(a.year-1)+this.dateTimeHelper.leapYearsCount(n.year);default:return new Fn(En.NUM,It.BadMode)}}))}days360(e,t){return this.runFunction(e.args,t,this.metadata("DAYS360"),this.days360Core)}yearfrac(e,t){return this.runFunction(e.args,t,this.metadata("YEARFRAC"),((e,t,r)=>{switch(e=Math.trunc(e),t=Math.trunc(t),e>t&&([e,t]=[t,e]),r){case 0:return this.days360Core(e,t,!1)/360;case 1:return(t-e)/this.dateTimeHelper.yearLengthForBasis(this.dateTimeHelper.numberToSimpleDate(e),this.dateTimeHelper.numberToSimpleDate(t));case 2:return(t-e)/360;case 3:return(t-e)/365;case 4:return this.days360Core(e,t,!0)/360}throw new Error("Should not be reachable.")}))}interval(e,t){return this.runFunction(e.args,t,this.metadata("INTERVAL"),(e=>{e=Math.trunc(e);const t=e%60;e=Math.trunc(e/60);const r=e%60;e=Math.trunc(e/60);const n=e%24;e=Math.trunc(e/24);const a=e%30;e=Math.trunc(e/30);const s=e%12,i=Math.trunc(e/12);return"P"+(i>0?i+"Y":"")+(s>0?s+"M":"")+(a>0?a+"D":"")+"T"+(n>0?n+"H":"")+(r>0?r+"M":"")+(t>0?t+"S":"")}))}networkdays(e,t){return this.runFunction(e.args,t,this.metadata("NETWORKDAYS"),((e,t,r)=>this.networkdayscore(e,t,1,r)))}networkdaysintl(e,t){return this.runFunction(e.args,t,this.metadata("NETWORKDAYS.INTL"),((e,t,r,n)=>this.networkdayscore(e,t,r,n)))}workday(e,t){return this.runFunction(e.args,t,this.metadata("WORKDAY"),((e,t,r)=>this.workdaycore(e,t,1,r)))}workdayintl(e,t){return this.runFunction(e.args,t,this.metadata("WORKDAY.INTL"),((e,t,r,n)=>this.workdaycore(e,t,r,n)))}networkdayscore(e,t,r,n){e=Math.trunc(e),t=Math.trunc(t);let a=1;e>t&&([e,t]=[t,e],a=-1);const s=mo(r);if(s instanceof Fn)return s;const i=this.simpleRangeToFilteredHolidays(s,n);return i instanceof Fn?i:a*this.countWorkdays(e,t,s,i)}workdaycore(e,t,r,n){e=Math.trunc(e),t=Math.trunc(t);const a=mo(r);if(a instanceof Fn)return a;const s=this.simpleRangeToFilteredHolidays(a,n);if(s instanceof Fn)return s;if(t>0){let r=1;while(this.countWorkdays(e+1,e+r,a,s)<t)r*=2;let n=1;while(n+1<r){const i=Math.trunc((n+r)/2);this.countWorkdays(e+1,e+i,a,s)<t?n=i:r=i}return e+r}if(t<0){t*=-1;let r=1;while(this.countWorkdays(e-r,e-1,a,s)<t)r*=2;let n=1;while(n+1<r){const i=Math.trunc((n+r)/2);this.countWorkdays(e-i,e-1,a,s)<t?n=i:r=i}return e-r}return e}countWorkdays(e,t,r,n){const a=Math.floor(this.dateTimeHelper.relativeNumberToAbsoluteNumber(t)),s=Math.floor(this.dateTimeHelper.relativeNumberToAbsoluteNumber(e));let i=0;for(let o=0;o<7;o++)"0"===r.charAt(o)&&(i+=Math.floor((a+6-o)/7),i-=Math.floor((s-1+6-o)/7));return i-=po(t+1,n)-po(e,n),i}simpleRangeToFilteredHolidays(e,t){var r;const n=null!==(r=null===t||void 0===t?void 0:t.valuesFromTopLeftCorner())&&void 0!==r?r:[];for(const s of n)if(s instanceof Fn)return s;const a=[];for(const s of n)if(s!==rr){if(!hr(s))return new Fn(En.VALUE,It.WrongType);a.push(Math.trunc(nr(s)))}return[...new Set(a)].sort(((e,t)=>e-t)).filter((t=>{const r=this.dateTimeHelper.relativeNumberToAbsoluteNumber(t),n=(r-1)%7;return"0"===e.charAt(n)}))}}function po(e,t){if(0===t.length)return 0;if(e<=t[0])return 0;if(t[t.length-1]<e)return t.length;let r=0,n=t.length-1;while(r+1<n){const a=Math.floor((n+r)/2);t[a]>=e?n=a:r=a}return n}function mo(e){var t;return"number"!==typeof e&&"string"!==typeof e?new Fn(En.VALUE,It.WrongType):"string"===typeof e?7===e.length&&/^(0|1)*$/.test(e)&&"1111111"!==e?e:new Fn(En.NUM,It.WeekendString):null!==(t=Eo.get(e))&&void 0!==t?t:new Fn(En.NUM,It.BadMode)}fo.implementedFunctions={DATE:{method:"date",parameters:[{argumentType:Yr.NUMBER},{argumentType:Yr.NUMBER},{argumentType:Yr.NUMBER}],returnNumberType:fr.NUMBER_DATE},TIME:{method:"time",parameters:[{argumentType:Yr.NUMBER},{argumentType:Yr.NUMBER},{argumentType:Yr.NUMBER}],returnNumberType:fr.NUMBER_TIME},MONTH:{method:"month",parameters:[{argumentType:Yr.NUMBER,minValue:0}]},YEAR:{method:"year",parameters:[{argumentType:Yr.NUMBER,minValue:0}]},HOUR:{method:"hour",parameters:[{argumentType:Yr.NUMBER,minValue:0}]},MINUTE:{method:"minute",parameters:[{argumentType:Yr.NUMBER,minValue:0}]},SECOND:{method:"second",parameters:[{argumentType:Yr.NUMBER,minValue:0}]},TEXT:{method:"text",parameters:[{argumentType:Yr.NUMBER},{argumentType:Yr.STRING}]},EOMONTH:{method:"eomonth",parameters:[{argumentType:Yr.NUMBER,minValue:0},{argumentType:Yr.NUMBER}],returnNumberType:fr.NUMBER_DATE},DAY:{method:"day",parameters:[{argumentType:Yr.NUMBER,minValue:0}]},DAYS:{method:"days",parameters:[{argumentType:Yr.NUMBER,minValue:0},{argumentType:Yr.NUMBER,minValue:0}]},WEEKDAY:{method:"weekday",parameters:[{argumentType:Yr.NUMBER,minValue:0},{argumentType:Yr.NUMBER,defaultValue:1}]},WEEKNUM:{method:"weeknum",parameters:[{argumentType:Yr.NUMBER,minValue:0},{argumentType:Yr.NUMBER,defaultValue:1}]},ISOWEEKNUM:{method:"isoweeknum",parameters:[{argumentType:Yr.NUMBER,minValue:0}]},DATEVALUE:{method:"datevalue",parameters:[{argumentType:Yr.STRING}],returnNumberType:fr.NUMBER_DATE},TIMEVALUE:{method:"timevalue",parameters:[{argumentType:Yr.STRING}],returnNumberType:fr.NUMBER_TIME},NOW:{method:"now",parameters:[],isVolatile:!0,returnNumberType:fr.NUMBER_DATETIME},TODAY:{method:"today",parameters:[],isVolatile:!0,returnNumberType:fr.NUMBER_DATE},EDATE:{method:"edate",parameters:[{argumentType:Yr.NUMBER,minValue:0},{argumentType:Yr.NUMBER}],returnNumberType:fr.NUMBER_DATE},DAYS360:{method:"days360",parameters:[{argumentType:Yr.NUMBER,minValue:0},{argumentType:Yr.NUMBER,minValue:0},{argumentType:Yr.BOOLEAN,defaultValue:!1}]},DATEDIF:{method:"datedif",parameters:[{argumentType:Yr.NUMBER,minValue:0},{argumentType:Yr.NUMBER,minValue:0},{argumentType:Yr.STRING}]},YEARFRAC:{method:"yearfrac",parameters:[{argumentType:Yr.NUMBER,minValue:0},{argumentType:Yr.NUMBER,minValue:0},{argumentType:Yr.INTEGER,defaultValue:0,minValue:0,maxValue:4}]},INTERVAL:{method:"interval",parameters:[{argumentType:Yr.NUMBER,minValue:0}]},NETWORKDAYS:{method:"networkdays",parameters:[{argumentType:Yr.NUMBER,minValue:0},{argumentType:Yr.NUMBER,minValue:0},{argumentType:Yr.RANGE,optionalArg:!0}]},"NETWORKDAYS.INTL":{method:"networkdaysintl",parameters:[{argumentType:Yr.NUMBER,minValue:0},{argumentType:Yr.NUMBER,minValue:0},{argumentType:Yr.NOERROR,defaultValue:1},{argumentType:Yr.RANGE,optionalArg:!0}]},WORKDAY:{method:"workday",parameters:[{argumentType:Yr.NUMBER,minValue:0},{argumentType:Yr.NUMBER},{argumentType:Yr.RANGE,optionalArg:!0}]},"WORKDAY.INTL":{method:"workdayintl",parameters:[{argumentType:Yr.NUMBER,minValue:0},{argumentType:Yr.NUMBER},{argumentType:Yr.NOERROR,defaultValue:1},{argumentType:Yr.RANGE,optionalArg:!0}]}};const go=new Map([[1,0],[2,1],[11,1],[12,2],[13,3],[14,4],[15,5],[16,6],[17,0]]),Eo=new Map([[1,"0000011"],[2,"1000001"],[3,"1100000"],[4,"0110000"],[5,"0011000"],[6,"0001100"],[7,"0000110"],[11,"0000001"],[12,"1000000"],[13,"0100000"],[14,"0010000"],[15,"0001000"],[16,"0000100"],[17,"0000010"]]);
/**
 * @license
 * Copyright (c) 2022 Handsoncode. All rights reserved.
 */
class vo extends Wr{degrees(e,t){return this.runFunction(e.args,t,this.metadata("DEGREES"),(e=>e*(180/Math.PI)))}}vo.implementedFunctions={DEGREES:{method:"degrees",parameters:[{argumentType:Yr.NUMBER}]}};
/**
 * @license
 * Copyright (c) 2022 Handsoncode. All rights reserved.
 */
class To extends Wr{delta(e,t){return this.runFunction(e.args,t,this.metadata("DELTA"),((e,t)=>e===t?1:0))}}To.implementedFunctions={DELTA:{method:"delta",parameters:[{argumentType:Yr.NUMBER},{argumentType:Yr.NUMBER,defaultValue:0}]}};
/**
 * @license
 * Copyright (c) 2022 Handsoncode. All rights reserved.
 */
class So extends Wr{exp(e,t){return this.runFunction(e.args,t,this.metadata("EXP"),Math.exp)}}So.implementedFunctions={EXP:{method:"exp",parameters:[{argumentType:Yr.NUMBER}]}};
/**
 * @license
 * Copyright (c) 2022 Handsoncode. All rights reserved.
 */
class Ao extends Wr{pmt(e,t){return this.runFunction(e.args,t,this.metadata("PMT"),Ro)}ipmt(e,t){return this.runFunction(e.args,t,this.metadata("IPMT"),yo)}ppmt(e,t){return this.runFunction(e.args,t,this.metadata("PPMT"),wo)}fv(e,t){return this.runFunction(e.args,t,this.metadata("FV"),No)}cumipmt(e,t){return this.runFunction(e.args,t,this.metadata("CUMIPMT"),((e,t,r,n,a,s)=>{if(n>a)return new Fn(En.NUM,It.EndStartPeriod);let i=0;for(let o=n;o<=a;o++)i+=yo(e,o,t,r,0,s);return i}))}cumprinc(e,t){return this.runFunction(e.args,t,this.metadata("CUMPRINC"),((e,t,r,n,a,s)=>{if(n>a)return new Fn(En.NUM,It.EndStartPeriod);let i=0;for(let o=n;o<=a;o++)i+=wo(e,o,t,r,0,s);return i}))}db(e,t){return this.runFunction(e.args,t,this.metadata("DB"),((e,t,r,n,a)=>{if(12===a&&n>r||n>r+1)return new Fn(En.NUM,It.PeriodLong);if(t>=e)return 0;const s=Math.round(1e3*(1-Math.pow(t/e,1/r)))/1e3,i=e*s*a/12;if(1===n)return i;let o=i;for(let c=0;c<n-2;c++)o+=(e-o)*s;return n===r+1?(e-o)*s*(12-a)/12:(e-o)*s}))}ddb(e,t){return this.runFunction(e.args,t,this.metadata("DDB"),((e,t,r,n,a)=>{if(n>r)return new Fn(En.NUM);let s,i=a/r;i>=1?(i=1,s=1===n?e:0):s=e*Math.pow(1-i,n-1);const o=e*Math.pow(1-i,n);return Math.max(s-Math.max(t,o),0)}))}dollarde(e,t){return this.runFunction(e.args,t,this.metadata("DOLLARDE"),((e,t)=>{if(t<1)return new Fn(En.DIV_BY_ZERO);t=Math.trunc(t);while(t>10)t/=10;return Math.trunc(e)+10*(e-Math.trunc(e))/t}))}dollarfr(e,t){return this.runFunction(e.args,t,this.metadata("DOLLARFR"),((e,t)=>{if(t<1)return new Fn(En.DIV_BY_ZERO);t=Math.trunc(t);while(t>10)t/=10;return Math.trunc(e)+(e-Math.trunc(e))*t/10}))}effect(e,t){return this.runFunction(e.args,t,this.metadata("EFFECT"),((e,t)=>(t=Math.trunc(t),Math.pow(1+e/t,t)-1)))}ispmt(e,t){return this.runFunction(e.args,t,this.metadata("ISPMT"),((e,t,r,n)=>0===r?new Fn(En.DIV_BY_ZERO):n*e*(t/r-1)))}nominal(e,t){return this.runFunction(e.args,t,this.metadata("NOMINAL"),((e,t)=>(t=Math.trunc(t),(Math.pow(e+1,1/t)-1)*t)))}nper(e,t){return this.runFunction(e.args,t,this.metadata("NPER"),((e,t,r,n,a)=>0===e?0===t?new Fn(En.DIV_BY_ZERO):(-r-n)/t:(a&&(t*=1+e),Math.log((t-n*e)/(r*e+t))/Math.log(1+e))))}rate(e,t){return this.runFunction(e.args,t,this.metadata("RATE"),((e,t,r,n,a,s)=>{if(s<=-1)return new Fn(En.VALUE);const i=1e-7,o=50;let c=s;a=a?1:0;for(let l=0;l<o;l++){if(c<=-1)return new Fn(En.NUM);let s,o;if(Math.abs(c)<i)s=r*(1+e*c)+t*(1+c*a)*e+n;else{const i=Math.pow(1+c,e);s=r*i+t*(1/c+a)*(i-1)+n}if(Math.abs(s)<i)return c;if(Math.abs(c)<i)o=r*e+t*a*e;else{const n=Math.pow(1+c,e),s=e*Math.pow(1+c,e-1);o=r*s+t*(1/c+a)*s+t*(-1/(c*c))*(n-1)}c-=s/o}return new Fn(En.NUM)}))}pv(e,t){return this.runFunction(e.args,t,this.metadata("PV"),((e,t,r,n,a)=>(a=a?1:0,-1===e?new Fn(0===t?En.NUM:En.DIV_BY_ZERO):0===e?-r*t-n:((1-Math.pow(1+e,t))*r*(1+e*a)/e-n)/Math.pow(1+e,t))))}rri(e,t){return this.runFunction(e.args,t,this.metadata("RRI"),((e,t,r)=>0===t||r<0&&t>0||r>0&&t<0?new Fn(En.NUM):Math.pow(r/t,1/e)-1))}sln(e,t){return this.runFunction(e.args,t,this.metadata("SLN"),((e,t,r)=>0===r?new Fn(En.DIV_BY_ZERO):(e-t)/r))}syd(e,t){return this.runFunction(e.args,t,this.metadata("SYD"),((e,t,r,n)=>n>r?new Fn(En.NUM):(e-t)*(r-n+1)*2/(r*(r+1))))}tbilleq(e,t){return this.runFunction(e.args,t,this.metadata("TBILLEQ"),((e,t,r)=>{if(e=Math.round(e),t=Math.round(t),e>=t)return new Fn(En.NUM);const n=this.dateTimeHelper.numberToSimpleDate(e),a=this.dateTimeHelper.numberToSimpleDate(t);if(a.year>n.year+1||a.year===n.year+1&&(a.month>n.month||a.month===n.month&&a.day>n.day))return new Fn(En.NUM);const s=360-r*(t-e);return 0===s?0:s<0?new Fn(En.NUM):365*r/s}))}tbillprice(e,t){return this.runFunction(e.args,t,this.metadata("TBILLPRICE"),((e,t,r)=>{if(e=Math.round(e),t=Math.round(t),e>=t)return new Fn(En.NUM);const n=this.dateTimeHelper.numberToSimpleDate(e),a=this.dateTimeHelper.numberToSimpleDate(t);if(a.year>n.year+1||a.year===n.year+1&&(a.month>n.month||a.month===n.month&&a.day>n.day))return new Fn(En.NUM);const s=360-r*(t-e);return 0===s?0:s<0?new Fn(En.NUM):100*(1-r*(t-e)/360)}))}tbillyield(e,t){return this.runFunction(e.args,t,this.metadata("TBILLYIELD"),((e,t,r)=>{if(e=Math.round(e),t=Math.round(t),e>=t)return new Fn(En.NUM);const n=this.dateTimeHelper.numberToSimpleDate(e),a=this.dateTimeHelper.numberToSimpleDate(t);return a.year>n.year+1||a.year===n.year+1&&(a.month>n.month||a.month===n.month&&a.day>n.day)?new Fn(En.NUM):360*(100-r)/(r*(t-e))}))}fvschedule(e,t){return this.runFunction(e.args,t,this.metadata("FVSCHEDULE"),((e,t)=>{const r=t.valuesFromTopLeftCorner();for(const n of r)if(n instanceof Fn)return n;for(const n of r)if(hr(n))e*=1+nr(n);else if(n!==rr)return new Fn(En.VALUE,It.NumberExpected);return e}))}npv(e,t){return this.runFunction(e.args,t,this.metadata("NPV"),((e,...t)=>{const r=this.arithmeticHelper.coerceNumbersExactRanges(t);return r instanceof Fn?r:bo(e,r)}))}mirr(e,t){return this.runFunction(e.args,t,this.metadata("MIRR"),((e,t,r)=>{const n=this.arithmeticHelper.manyToExactNumbers(e.valuesFromTopLeftCorner());if(n instanceof Fn)return n;let a=!1,s=!1;const i=[],o=[];for(const h of n)h>0?(a=!0,i.push(h),o.push(0)):h<0?(s=!0,o.push(h),i.push(0)):(o.push(0),i.push(0));if(!a||!s)return new Fn(En.DIV_BY_ZERO);const c=n.length,l=bo(r,i);if(l instanceof Fn)return l;const u=bo(t,o);return u instanceof Fn?u:Math.pow(-l*Math.pow(1+r,c)/u/(1+t),1/(c-1))-1}))}pduration(e,t){return this.runFunction(e.args,t,this.metadata("PDURATION"),((e,t,r)=>(Math.log(r)-Math.log(t))/Math.log(1+e)))}xnpv(e,t){return this.runFunction(e.args,t,this.metadata("XNPV"),((e,t,r)=>{const n=t.valuesFromTopLeftCorner();for(const l of n)if("number"!==typeof l)return new Fn(En.VALUE,It.NumberExpected);const a=n,s=r.valuesFromTopLeftCorner();for(const l of s)if("number"!==typeof l)return new Fn(En.VALUE,It.NumberExpected);const i=s;if(i.length!==a.length)return new Fn(En.NUM,It.EqualLength);const o=i.length;let c=0;if(i[0]<0)return new Fn(En.NUM,It.ValueSmall);for(let l=0;l<o;l++){if(i[l]=Math.floor(i[l]),i[l]<i[0])return new Fn(En.NUM,It.ValueSmall);c+=a[l]/Math.pow(1+e,(i[l]-i[0])/365)}return c}))}}function Ro(e,t,r,n,a){if(0===e)return(-r-n)/t;{const s=Math.pow(1+e,t);return(n*e+r*e*s)*(a?1/(1+e):1)/(1-s)}}function yo(e,t,r,n,a,s){const i=Ro(e,r,n,a,s);return 1===t?e*(s?0:-n):e*(s?No(e,t-2,i,n,s)-i:No(e,t-1,i,n,s))}function No(e,t,r,n,a){if(0===e)return-n-r*t;{const s=Math.pow(1+e,t);return r*(a?1+e:1)*(1-s)/e-n*s}}function wo(e,t,r,n,a,s){return Ro(e,r,n,a,s)-yo(e,t,r,n,a,s)}function bo(e,t){let r=0;for(let n=t.length-1;n>=0;n--){if(r+=t[n],-1===e){if(0===r)continue;return new Fn(En.DIV_BY_ZERO)}r/=1+e}return r}Ao.implementedFunctions={PMT:{method:"pmt",parameters:[{argumentType:Yr.NUMBER},{argumentType:Yr.NUMBER},{argumentType:Yr.NUMBER},{argumentType:Yr.NUMBER,defaultValue:0},{argumentType:Yr.NUMBER,defaultValue:0}],returnNumberType:fr.NUMBER_CURRENCY},IPMT:{method:"ipmt",parameters:[{argumentType:Yr.NUMBER},{argumentType:Yr.NUMBER},{argumentType:Yr.NUMBER},{argumentType:Yr.NUMBER},{argumentType:Yr.NUMBER,defaultValue:0},{argumentType:Yr.NUMBER,defaultValue:0}],returnNumberType:fr.NUMBER_CURRENCY},PPMT:{method:"ppmt",parameters:[{argumentType:Yr.NUMBER},{argumentType:Yr.NUMBER},{argumentType:Yr.NUMBER},{argumentType:Yr.NUMBER},{argumentType:Yr.NUMBER,defaultValue:0},{argumentType:Yr.NUMBER,defaultValue:0}],returnNumberType:fr.NUMBER_CURRENCY},FV:{method:"fv",parameters:[{argumentType:Yr.NUMBER},{argumentType:Yr.NUMBER},{argumentType:Yr.NUMBER},{argumentType:Yr.NUMBER,defaultValue:0},{argumentType:Yr.NUMBER,defaultValue:0}],returnNumberType:fr.NUMBER_CURRENCY},CUMIPMT:{method:"cumipmt",parameters:[{argumentType:Yr.NUMBER,greaterThan:0},{argumentType:Yr.NUMBER,greaterThan:0},{argumentType:Yr.NUMBER,greaterThan:0},{argumentType:Yr.INTEGER,minValue:1},{argumentType:Yr.INTEGER,minValue:1},{argumentType:Yr.INTEGER,minValue:0,maxValue:1}],returnNumberType:fr.NUMBER_CURRENCY},CUMPRINC:{method:"cumprinc",parameters:[{argumentType:Yr.NUMBER,greaterThan:0},{argumentType:Yr.NUMBER,greaterThan:0},{argumentType:Yr.NUMBER,greaterThan:0},{argumentType:Yr.INTEGER,minValue:1},{argumentType:Yr.INTEGER,minValue:1},{argumentType:Yr.INTEGER,minValue:0,maxValue:1}],returnNumberType:fr.NUMBER_CURRENCY},DB:{method:"db",parameters:[{argumentType:Yr.NUMBER,minValue:0},{argumentType:Yr.NUMBER,minValue:0},{argumentType:Yr.INTEGER,minValue:0},{argumentType:Yr.INTEGER,minValue:0},{argumentType:Yr.INTEGER,minValue:1,maxValue:12,defaultValue:12}],returnNumberType:fr.NUMBER_CURRENCY},DDB:{method:"ddb",parameters:[{argumentType:Yr.NUMBER,minValue:0},{argumentType:Yr.NUMBER,minValue:0},{argumentType:Yr.INTEGER,minValue:0},{argumentType:Yr.NUMBER,minValue:0},{argumentType:Yr.NUMBER,greaterThan:0,defaultValue:2}],returnNumberType:fr.NUMBER_CURRENCY},DOLLARDE:{method:"dollarde",parameters:[{argumentType:Yr.NUMBER},{argumentType:Yr.NUMBER,minValue:0}]},DOLLARFR:{method:"dollarfr",parameters:[{argumentType:Yr.NUMBER},{argumentType:Yr.NUMBER,minValue:0}]},EFFECT:{method:"effect",parameters:[{argumentType:Yr.NUMBER,minValue:0},{argumentType:Yr.NUMBER,minValue:1}],returnNumberType:fr.NUMBER_PERCENT},ISPMT:{method:"ispmt",parameters:[{argumentType:Yr.NUMBER},{argumentType:Yr.NUMBER},{argumentType:Yr.NUMBER},{argumentType:Yr.NUMBER}]},NOMINAL:{method:"nominal",parameters:[{argumentType:Yr.NUMBER,minValue:0},{argumentType:Yr.NUMBER,minValue:1}],returnNumberType:fr.NUMBER_PERCENT},NPER:{method:"nper",parameters:[{argumentType:Yr.NUMBER},{argumentType:Yr.NUMBER},{argumentType:Yr.NUMBER},{argumentType:Yr.NUMBER,defaultValue:0},{argumentType:Yr.NUMBER,defaultValue:0}]},PV:{method:"pv",parameters:[{argumentType:Yr.NUMBER},{argumentType:Yr.NUMBER},{argumentType:Yr.NUMBER},{argumentType:Yr.NUMBER,defaultValue:0},{argumentType:Yr.NUMBER,defaultValue:0}],returnNumberType:fr.NUMBER_CURRENCY},RATE:{method:"rate",parameters:[{argumentType:Yr.NUMBER,greaterThan:0},{argumentType:Yr.NUMBER},{argumentType:Yr.NUMBER},{argumentType:Yr.NUMBER,defaultValue:0},{argumentType:Yr.NUMBER,defaultValue:0},{argumentType:Yr.NUMBER,defaultValue:.1}],returnNumberType:fr.NUMBER_PERCENT},RRI:{method:"rri",parameters:[{argumentType:Yr.NUMBER,greaterThan:0},{argumentType:Yr.NUMBER},{argumentType:Yr.NUMBER}],returnNumberType:fr.NUMBER_PERCENT},SLN:{method:"sln",parameters:[{argumentType:Yr.NUMBER},{argumentType:Yr.NUMBER},{argumentType:Yr.NUMBER}],returnNumberType:fr.NUMBER_CURRENCY},SYD:{method:"syd",parameters:[{argumentType:Yr.NUMBER},{argumentType:Yr.NUMBER},{argumentType:Yr.NUMBER,greaterThan:0},{argumentType:Yr.NUMBER,greaterThan:0}],returnNumberType:fr.NUMBER_CURRENCY},TBILLEQ:{method:"tbilleq",parameters:[{argumentType:Yr.NUMBER,minValue:0},{argumentType:Yr.NUMBER,minValue:0},{argumentType:Yr.NUMBER,greaterThan:0}],returnNumberType:fr.NUMBER_PERCENT},TBILLPRICE:{method:"tbillprice",parameters:[{argumentType:Yr.NUMBER,minValue:0},{argumentType:Yr.NUMBER,minValue:0},{argumentType:Yr.NUMBER,greaterThan:0}],returnNumberType:fr.NUMBER_CURRENCY},TBILLYIELD:{method:"tbillyield",parameters:[{argumentType:Yr.NUMBER,minValue:0},{argumentType:Yr.NUMBER,minValue:0},{argumentType:Yr.NUMBER,greaterThan:0}],returnNumberType:fr.NUMBER_PERCENT},FVSCHEDULE:{method:"fvschedule",parameters:[{argumentType:Yr.NUMBER},{argumentType:Yr.RANGE}],returnNumberType:fr.NUMBER_CURRENCY},NPV:{method:"npv",parameters:[{argumentType:Yr.NUMBER},{argumentType:Yr.ANY}],repeatLastArgs:1,returnNumberType:fr.NUMBER_CURRENCY},MIRR:{method:"mirr",parameters:[{argumentType:Yr.RANGE},{argumentType:Yr.NUMBER},{argumentType:Yr.NUMBER}],returnNumberType:fr.NUMBER_PERCENT},PDURATION:{method:"pduration",parameters:[{argumentType:Yr.NUMBER,greaterThan:0},{argumentType:Yr.NUMBER,greaterThan:0},{argumentType:Yr.NUMBER,greaterThan:0}]},XNPV:{method:"xnpv",parameters:[{argumentType:Yr.NUMBER,greaterThan:-1},{argumentType:Yr.RANGE},{argumentType:Yr.RANGE}]}};
/**
 * @license
 * Copyright (c) 2022 Handsoncode. All rights reserved.
 */
class Co extends Wr{formulatext(e,t){return this.runFunctionWithReferenceArgument(e.args,t,this.metadata("FORMULATEXT"),(()=>new Fn(En.NA,It.WrongArgNumber)),(e=>{var t;return null!==(t=this.serialization.getCellFormula(e))&&void 0!==t?t:new Fn(En.NA,It.Formula)}))}}Co.implementedFunctions={FORMULATEXT:{method:"formulatext",parameters:[{argumentType:Yr.NOERROR}],doesNotNeedArgumentsToBeComputed:!0,isDependentOnSheetStructureChange:!0,vectorizationForbidden:!0}};
/**
 * @license
 * Copyright (c) 2022 Handsoncode. All rights reserved.
 */
class Oo extends Wr{isbinary(e,t){return this.runFunction(e.args,t,this.metadata("ISBINARY"),(e=>/^[01]{1,10}$/.test(e)))}iserr(e,t){return this.runFunction(e.args,t,this.metadata("ISERR"),(e=>e instanceof Fn&&e.type!==En.NA))}iserror(e,t){return this.runFunction(e.args,t,this.metadata("ISERROR"),(e=>e instanceof Fn))}isformula(e,t){return this.runFunctionWithReferenceArgument(e.args,t,this.metadata("ISFORMULA"),(()=>new Fn(En.NA,It.WrongArgNumber)),(e=>{const t=this.dependencyGraph.addressMapping.getCell(e);return t instanceof rn}))}isblank(e,t){return this.runFunction(e.args,t,this.metadata("ISBLANK"),(e=>e===rr))}isna(e,t){return this.runFunction(e.args,t,this.metadata("ISNA"),(e=>e instanceof Fn&&e.type==En.NA))}isnumber(e,t){return this.runFunction(e.args,t,this.metadata("ISNUMBER"),hr)}islogical(e,t){return this.runFunction(e.args,t,this.metadata("ISLOGICAL"),(e=>"boolean"===typeof e))}isref(e,t){return this.runFunction(e.args,t,this.metadata("ISREF"),(e=>e instanceof Fn&&(e.type==En.REF||e.type==En.CYCLE)))}istext(e,t){return this.runFunction(e.args,t,this.metadata("ISTEXT"),(e=>"string"===typeof e))}isnontext(e,t){return this.runFunction(e.args,t,this.metadata("ISNONTEXT"),(e=>!("string"===typeof e)))}column(e,t){return this.runFunctionWithReferenceArgument(e.args,t,this.metadata("COLUMN"),(()=>t.formulaAddress.col+1),(e=>e.col+1))}columns(e,t){if(1!==e.args.length)return new Fn(En.NA,It.WrongArgNumber);if(e.args.some((e=>e.type===$e.EMPTY)))return new Fn(En.NUM,It.EmptyArg);let r=e.args[0];while(r.type===$e.PARENTHESIS)r=r.expression;if(r.type===$e.CELL_RANGE||r.type===$e.COLUMN_RANGE)return r.end.col-r.start.col+1;if(r.type===$e.CELL_REFERENCE)return 1;if(r.type===$e.ROW_RANGE)return this.config.maxColumns;{const e=this.evaluateAst(r,t);return e instanceof jr?e.width():e instanceof Fn?e:1}}row(e,t){return this.runFunctionWithReferenceArgument(e.args,t,this.metadata("ROW"),(()=>t.formulaAddress.row+1),(e=>e.row+1))}rows(e,t){if(1!==e.args.length)return new Fn(En.NA,It.WrongArgNumber);if(e.args.some((e=>e.type===$e.EMPTY)))return new Fn(En.NUM,It.EmptyArg);let r=e.args[0];while(r.type===$e.PARENTHESIS)r=r.expression;if(r.type===$e.CELL_RANGE||r.type===$e.ROW_RANGE)return r.end.row-r.start.row+1;if(r.type===$e.CELL_REFERENCE)return 1;if(r.type===$e.COLUMN_RANGE)return this.config.maxRows;{const e=this.evaluateAst(r,t);return e instanceof jr?e.height():e instanceof Fn?e:1}}index(e,t){return this.runFunction(e.args,t,this.metadata("INDEX"),((e,t,r)=>{var n,a,s,i,o,c;return r<1||t<1?new Fn(En.VALUE,It.LessThanOne):r>e.width()||t>e.height()?new Fn(En.NUM,It.ValueLarge):null!==(c=null!==(s=null===(a=null===(n=null===e||void 0===e?void 0:e.data)||void 0===n?void 0:n[t-1])||void 0===a?void 0:a[r-1])&&void 0!==s?s:null===(o=null===(i=null===e||void 0===e?void 0:e.data)||void 0===i?void 0:i[0])||void 0===o?void 0:o[0])&&void 0!==c?c:new Fn(En.VALUE,It.CellRangeExpected)}))}na(e,t){return new Fn(En.NA)}sheet(e,t){return this.runFunctionWithReferenceArgument(e.args,t,this.metadata("SHEET"),(()=>t.formulaAddress.sheet+1),(e=>e.sheet+1),(e=>{const t=this.dependencyGraph.sheetMapping.get(e);return void 0!==t?t+1:new Fn(En.NA,It.SheetRef)}))}sheets(e,t){return this.runFunctionWithReferenceArgument(e.args,t,this.metadata("SHEETS"),(()=>this.dependencyGraph.sheetMapping.numberOfSheets()),(()=>1),(()=>new Fn(En.VALUE,It.CellRefExpected)))}}Oo.implementedFunctions={COLUMN:{method:"column",parameters:[{argumentType:Yr.NOERROR,optional:!0}],isDependentOnSheetStructureChange:!0,doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0},COLUMNS:{method:"columns",parameters:[{argumentType:Yr.RANGE}],isDependentOnSheetStructureChange:!0,doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0},ISBINARY:{method:"isbinary",parameters:[{argumentType:Yr.STRING}]},ISERR:{method:"iserr",parameters:[{argumentType:Yr.SCALAR}]},ISFORMULA:{method:"isformula",parameters:[{argumentType:Yr.NOERROR}],doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0},ISNA:{method:"isna",parameters:[{argumentType:Yr.SCALAR}]},ISREF:{method:"isref",parameters:[{argumentType:Yr.SCALAR}],vectorizationForbidden:!0},ISERROR:{method:"iserror",parameters:[{argumentType:Yr.SCALAR}]},ISBLANK:{method:"isblank",parameters:[{argumentType:Yr.SCALAR}]},ISNUMBER:{method:"isnumber",parameters:[{argumentType:Yr.SCALAR}]},ISLOGICAL:{method:"islogical",parameters:[{argumentType:Yr.SCALAR}]},ISTEXT:{method:"istext",parameters:[{argumentType:Yr.SCALAR}]},ISNONTEXT:{method:"isnontext",parameters:[{argumentType:Yr.SCALAR}]},INDEX:{method:"index",parameters:[{argumentType:Yr.RANGE},{argumentType:Yr.NUMBER},{argumentType:Yr.NUMBER,defaultValue:1}]},NA:{method:"na",parameters:[]},ROW:{method:"row",parameters:[{argumentType:Yr.NOERROR,optional:!0}],isDependentOnSheetStructureChange:!0,doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0},ROWS:{method:"rows",parameters:[{argumentType:Yr.RANGE}],isDependentOnSheetStructureChange:!0,doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0},SHEET:{method:"sheet",parameters:[{argumentType:Yr.STRING}],doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0},SHEETS:{method:"sheets",parameters:[{argumentType:Yr.STRING}],doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0}};
/**
 * @license
 * Copyright (c) 2022 Handsoncode. All rights reserved.
 */
class Io extends Wr{iseven(e,t){return this.runFunction(e.args,t,this.metadata("ISEVEN"),(e=>e%2===0))}}Io.implementedFunctions={ISEVEN:{method:"iseven",parameters:[{argumentType:Yr.NUMBER}]}};
/**
 * @license
 * Copyright (c) 2022 Handsoncode. All rights reserved.
 */
class Mo extends Wr{isodd(e,t){return this.runFunction(e.args,t,this.metadata("ISODD"),(e=>e%2===1))}}Mo.implementedFunctions={ISODD:{method:"isodd",parameters:[{argumentType:Yr.NUMBER}]}};
/**
 * @license
 * Copyright (c) 2022 Handsoncode. All rights reserved.
 */
class Do extends Wr{log10(e,t){return this.runFunction(e.args,t,this.metadata("LOG10"),Math.log10)}log(e,t){return this.runFunction(e.args,t,this.metadata("LOG"),((e,t)=>Math.log(e)/Math.log(t)))}ln(e,t){return this.runFunction(e.args,t,this.metadata("LN"),Math.log)}}Do.implementedFunctions={LOG10:{method:"log10",parameters:[{argumentType:Yr.NUMBER}]},LOG:{method:"log",parameters:[{argumentType:Yr.NUMBER,greaterThan:0},{argumentType:Yr.NUMBER,defaultValue:10,greaterThan:0}]},LN:{method:"ln",parameters:[{argumentType:Yr.NUMBER}]}};
/**
 * @license
 * Copyright (c) 2022 Handsoncode. All rights reserved.
 */
const Lo=parseFloat(Math.PI.toFixed(14));class ko extends Wr{pi(e,t){return this.runFunction(e.args,t,this.metadata("PI"),(()=>Lo))}sqrtpi(e,t){return this.runFunction(e.args,t,this.metadata("SQRTPI"),(e=>Math.sqrt(Lo*e)))}}
/**
 * @license
 * Copyright (c) 2022 Handsoncode. All rights reserved.
 */
function _o(e,t){return new Gr(t.width,e.height)}function Uo(e,t,r){return new Gr(1+(e.width-t)/r,1+(e.height-t)/r)}ko.implementedFunctions={PI:{method:"pi",parameters:[]},SQRTPI:{method:"sqrtpi",parameters:[{argumentType:Yr.NUMBER,minValue:0}]}};class xo extends Wr{mmult(e,t){return this.runFunction(e.args,t,this.metadata("MMULT"),((e,t)=>{if(!e.hasOnlyNumbers()||!t.hasOnlyNumbers())return new Fn(En.VALUE,It.NumberRange);if(t.height()!==e.width())return new Fn(En.VALUE,It.ArrayDimensions);const r=_o(e.size,t.size),n=this.createKernel((function(e,t,r){let n=0;for(let a=0;a<r;++a)n+=e[this.thread.y][a]*t[a][this.thread.x];return n}),r)(e.rawNumbers(),t.rawNumbers(),e.width());return jr.onlyNumbers(n)}))}mmultArraySize(e,t){if(2!==e.args.length)return Gr.error();const r=this.metadata("MMULT"),n=e.args.map((e=>{var n;return this.arraySizeForAst(e,new Qt(t.formulaAddress,t.arraysFlag||null!==(n=null===r||void 0===r?void 0:r.arrayFunction)&&void 0!==n&&n))})),[a,s]=n;return _o(a,s)}maxpool(e,t){return this.runFunction(e.args,t,this.metadata("MAXPOOL"),((e,t,r=t)=>{if(!e.hasOnlyNumbers())return new Fn(En.VALUE,It.NumberRange);const n=Uo(e.size,t,r),a=this.createKernel((function(e,t,r){const n=this.thread.x*r,a=this.thread.y*r;let s=e[a][n];for(let i=0;i<t;i++)for(let r=0;r<t;r++)s=Math.max(s,e[a+i][n+r]);return s}),n)(e.rawNumbers(),t,r);return jr.onlyNumbers(a)}))}medianpool(e,t){return this.runFunction(e.args,t,this.metadata("MEDIANPOOL"),((e,t,r=t)=>{if(!e.hasOnlyNumbers())return new Fn(En.VALUE,It.NumberRange);const n=Uo(e.size,t,r),a=this.createKernel((function(e,t,r){const n=this.thread.x*r,a=this.thread.y*r;let s=e[a][n];for(let h=0;h<t;h++)for(let r=0;r<t;r++)s=Math.max(s,e[a+h][n+r]);let i=e[a][n];for(let h=0;h<t;h++)for(let r=0;r<t;r++)i=Math.min(i,e[a+h][n+r]);const o=t*t;let c=i,l=s,u=42;for(let h=0;h<32;h++){const r=(c+l)/2;let s=0;for(let i=0;i<t;i++)for(let o=0;o<t;o++)e[a+i][n+o]>r&&s++;if(t%2===0){if(s===o/2){u=r;break}s>o/2?c=r:l=r}else{if(s===(o-1)/2){u=r;break}s>(o-1)/2?c=r:l=r}}return u}),n)(e.rawNumbers(),t,r);return jr.onlyNumbers(a)}))}maxpoolArraySize(e,t){if(e.args.length<2||e.args.length>3)return Gr.error();const r=this.metadata("MAXPOOL"),n=e.args.map((e=>{var n;return this.arraySizeForAst(e,new Qt(t.formulaAddress,t.arraysFlag||null!==(n=null===r||void 0===r?void 0:r.arrayFunction)&&void 0!==n&&n))})),a=n[0],s=e.args[1];let i;i=s.type===$e.NUMBER?s.value:1;let o=i;if(3===e.args.length){const t=e.args[2];o=t.type===$e.NUMBER?t.value:1}return i>a.width||i>a.height||o>i||(a.width-i)%o!==0||(a.height-i)%o!==0?Gr.error():Uo(a,i,o)}medianpoolArraySize(e,t){return this.maxpoolArraySize(e,t)}transpose(e,t){return this.runFunction(e.args,t,this.metadata("TRANSPOSE"),(e=>{const t=e.rawData(),r=e.size,n=[];for(let a=0;a<r.width;++a){n[a]=[];for(let e=0;e<r.height;++e)n[a][e]=t[e][a]}return jr.onlyValues(n)}))}transposeArraySize(e,t){if(1!==e.args.length)return Gr.error();const r=this.metadata("MMULT"),n=e.args.map((e=>{var n;return this.arraySizeForAst(e,new Qt(t.formulaAddress,t.arraysFlag||null!==(n=null===r||void 0===r?void 0:r.arrayFunction)&&void 0!==n&&n))})),[a]=n;return new Gr(a.height,a.width)}createKernel(e,t){return function(...r){const n=[];for(let a=0;a<t.height;++a){n.push([]);for(let s=0;s<t.width;++s)n[a][s]=e.apply({thread:{x:s,y:a}},r)}return n}}}xo.implementedFunctions={MMULT:{method:"mmult",arraySizeMethod:"mmultArraySize",parameters:[{argumentType:Yr.RANGE},{argumentType:Yr.RANGE}],vectorizationForbidden:!0},TRANSPOSE:{method:"transpose",arraySizeMethod:"transposeArraySize",parameters:[{argumentType:Yr.RANGE}],vectorizationForbidden:!0},MAXPOOL:{method:"maxpool",arraySizeMethod:"maxpoolArraySize",parameters:[{argumentType:Yr.RANGE},{argumentType:Yr.NUMBER},{argumentType:Yr.NUMBER,optionalArg:!0}],vectorizationForbidden:!0},MEDIANPOOL:{method:"medianpool",arraySizeMethod:"medianpoolArraySize",parameters:[{argumentType:Yr.RANGE},{argumentType:Yr.NUMBER},{argumentType:Yr.NUMBER,optionalArg:!0}],vectorizationForbidden:!0}};
/**
 * @license
 * Copyright (c) 2022 Handsoncode. All rights reserved.
 */
class Fo extends Wr{median(e,t){return this.runFunction(e.args,t,this.metadata("MEDIAN"),((...e)=>{const t=this.arithmeticHelper.coerceNumbersExactRanges(e);return t instanceof Fn?t:0===t.length?new Fn(En.NUM,It.OneValue):(t.sort(((e,t)=>e-t)),t.length%2===0?(t[t.length/2-1]+t[t.length/2])/2:t[Math.floor(t.length/2)])}))}large(e,t){return this.runFunction(e.args,t,this.metadata("LARGE"),((e,t)=>{const r=this.arithmeticHelper.manyToExactNumbers(e.valuesFromTopLeftCorner());return r instanceof Fn?r:(r.sort(((e,t)=>e-t)),t=Math.trunc(t),t>r.length?new Fn(En.NUM,It.ValueLarge):r[r.length-t])}))}small(e,t){return this.runFunction(e.args,t,this.metadata("SMALL"),((e,t)=>{const r=this.arithmeticHelper.manyToExactNumbers(e.valuesFromTopLeftCorner());return r instanceof Fn?r:(r.sort(((e,t)=>e-t)),t=Math.trunc(t),t>r.length?new Fn(En.NUM,It.ValueLarge):r[t-1])}))}}Fo.implementedFunctions={MEDIAN:{method:"median",parameters:[{argumentType:Yr.ANY}],repeatLastArgs:1},LARGE:{method:"large",parameters:[{argumentType:Yr.RANGE},{argumentType:Yr.NUMBER,minValue:1}]},SMALL:{method:"small",parameters:[{argumentType:Yr.RANGE},{argumentType:Yr.NUMBER,minValue:1}]}};
/**
 * @license
 * Copyright (c) 2022 Handsoncode. All rights reserved.
 */
class Po extends Wr{mod(e,t){return this.runFunction(e.args,t,this.metadata("MOD"),((e,t)=>0===t?new Fn(En.DIV_BY_ZERO):e%t))}}
/**
 * @license
 * Copyright (c) 2022 Handsoncode. All rights reserved.
 */
function Bo(e){return hr(e)&&!Number.isFinite(nr(e))?0:e}Po.implementedFunctions={MOD:{method:"mod",parameters:[{argumentType:Yr.NUMBER},{argumentType:Yr.NUMBER}]}};class Yo{constructor(e,t,r){this.sumsq=e,this.sum=t,this.count=r}static single(e){return new Yo(e*e,e,1)}compose(e){return new Yo(this.sumsq+e.sumsq,this.sum+e.sum,this.count+e.count)}averageValue(){return this.count>0?this.sum/this.count:void 0}varSValue(){return this.count>1?(this.sumsq-this.sum*this.sum/this.count)/(this.count-1):void 0}varPValue(){return this.count>0?(this.sumsq-this.sum*this.sum/this.count)/this.count:void 0}}Yo.empty=new Yo(0,0,0);class Vo extends Wr{constructor(){super(...arguments),this.addWithEpsilonRaw=(e,t)=>this.arithmeticHelper.addWithEpsilonRaw(e,t)}sum(e,t){return this.doSum(e.args,t)}sumsq(e,t){return this.reduce(e.args,t,0,"SUMSQ",this.addWithEpsilonRaw,(e=>Math.pow(nr(e),2)),Wo)}max(e,t){return this.doMax(e.args,t)}maxa(e,t){const r=this.reduce(e.args,t,Number.NEGATIVE_INFINITY,"MAXA",((e,t)=>Math.max(e,t)),nr,Go);return Bo(r)}min(e,t){return this.doMin(e.args,t)}mina(e,t){const r=this.reduce(e.args,t,Number.POSITIVE_INFINITY,"MINA",((e,t)=>Math.min(e,t)),nr,Go);return Bo(r)}count(e,t){return this.doCount(e.args,t)}counta(e,t){return this.doCounta(e.args,t)}average(e,t){return this.doAverage(e.args,t)}averagea(e,t){var r;const n=this.reduce(e.args,t,Yo.empty,"_AGGREGATE_A",((e,t)=>e.compose(t)),(e=>Yo.single(nr(e))),Go);return n instanceof Fn?n:null!==(r=n.averageValue())&&void 0!==r?r:new Fn(En.DIV_BY_ZERO)}vars(e,t){return this.doVarS(e.args,t)}varp(e,t){return this.doVarP(e.args,t)}vara(e,t){var r;const n=this.reduceAggregateA(e.args,t);return n instanceof Fn?n:null!==(r=n.varSValue())&&void 0!==r?r:new Fn(En.DIV_BY_ZERO)}varpa(e,t){var r;const n=this.reduceAggregateA(e.args,t);return n instanceof Fn?n:null!==(r=n.varPValue())&&void 0!==r?r:new Fn(En.DIV_BY_ZERO)}stdevs(e,t){return this.doStdevS(e.args,t)}stdevp(e,t){return this.doStdevP(e.args,t)}stdeva(e,t){const r=this.reduceAggregateA(e.args,t);if(r instanceof Fn)return r;{const e=r.varSValue();return void 0===e?new Fn(En.DIV_BY_ZERO):Math.sqrt(e)}}stdevpa(e,t){const r=this.reduceAggregateA(e.args,t);if(r instanceof Fn)return r;{const e=r.varPValue();return void 0===e?new Fn(En.DIV_BY_ZERO):Math.sqrt(e)}}product(e,t){return this.doProduct(e.args,t)}subtotal(e,t){if(e.args.length<2)return new Fn(En.NA,It.WrongArgNumber);const r=this.coerceToType(this.evaluateAst(e.args[0],t),{argumentType:Yr.NUMBER},t),n=e.args.slice(1);switch(r){case 1:case 101:return this.doAverage(n,t);case 2:case 102:return this.doCount(n,t);case 3:case 103:return this.doCounta(n,t);case 4:case 104:return this.doMax(n,t);case 5:case 105:return this.doMin(n,t);case 6:case 106:return this.doProduct(n,t);case 7:case 107:return this.doStdevS(n,t);case 8:case 108:return this.doStdevP(n,t);case 9:case 109:return this.doSum(n,t);case 10:case 110:return this.doVarS(n,t);case 11:case 111:return this.doVarP(n,t);default:return new Fn(En.VALUE,It.BadMode)}}reduceAggregate(e,t){return this.reduce(e,t,Yo.empty,"_AGGREGATE",((e,t)=>e.compose(t)),(e=>Yo.single(nr(e))),Wo)}reduceAggregateA(e,t){return this.reduce(e,t,Yo.empty,"_AGGREGATE_A",((e,t)=>e.compose(t)),(e=>Yo.single(nr(e))),Go)}doAverage(e,t){var r;const n=this.reduceAggregate(e,t);return n instanceof Fn?n:null!==(r=n.averageValue())&&void 0!==r?r:new Fn(En.DIV_BY_ZERO)}doVarS(e,t){var r;const n=this.reduceAggregate(e,t);return n instanceof Fn?n:null!==(r=n.varSValue())&&void 0!==r?r:new Fn(En.DIV_BY_ZERO)}doVarP(e,t){var r;const n=this.reduceAggregate(e,t);return n instanceof Fn?n:null!==(r=n.varPValue())&&void 0!==r?r:new Fn(En.DIV_BY_ZERO)}doStdevS(e,t){const r=this.reduceAggregate(e,t);if(r instanceof Fn)return r;{const e=r.varSValue();return void 0===e?new Fn(En.DIV_BY_ZERO):Math.sqrt(e)}}doStdevP(e,t){const r=this.reduceAggregate(e,t);if(r instanceof Fn)return r;{const e=r.varPValue();return void 0===e?new Fn(En.DIV_BY_ZERO):Math.sqrt(e)}}doCount(e,t){return this.reduce(e,t,0,"COUNT",((e,t)=>e+t),nr,(e=>hr(e)?1:0))}doCounta(e,t){return this.reduce(e,t,0,"COUNTA",((e,t)=>e+t),nr,(e=>e===rr?0:1))}doMax(e,t){const r=this.reduce(e,t,Number.NEGATIVE_INFINITY,"MAX",((e,t)=>Math.max(e,t)),nr,Wo);return Bo(r)}doMin(e,t){const r=this.reduce(e,t,Number.POSITIVE_INFINITY,"MIN",((e,t)=>Math.min(e,t)),nr,Wo);return Bo(r)}doSum(e,t){return this.reduce(e,t,0,"SUM",this.addWithEpsilonRaw,nr,Wo)}doProduct(e,t){return this.reduce(e,t,1,"PRODUCT",((e,t)=>e*t),nr,Wo)}reduce(e,t,r,n,a,s,i){return e.length<1?new Fn(En.NA,It.WrongArgNumber):e.reduce(((e,o)=>{if(e instanceof Fn)return e;if(o.type===$e.CELL_RANGE||o.type===$e.COLUMN_RANGE||o.type===$e.ROW_RANGE){const c=this.evaluateRange(o,t,r,n,a,s,i);return c instanceof Fn?c:a(c,e)}let c;if(c=this.evaluateAst(o,t),c instanceof jr){const t=Array.from(c.valuesFromTopLeftCorner()).map(i).filter((e=>void 0!==e));return t.map((e=>e instanceof Fn?e:s(e))).reduce(((e,t)=>e instanceof Fn?e:t instanceof Fn?t:a(e,t)),e)}if(o.type===$e.CELL_REFERENCE){if(c=i(c),void 0===c)return e}else if(c=this.coerceScalarToNumberOrError(c),c=i(c),void 0===c)return e;return c instanceof Fn?c:a(e,s(c))}),r)}evaluateRange(e,t,r,n,a,s,i){let o;try{o=jt.fromAst(e,t.formulaAddress)}catch(u){if(u instanceof E)return new Fn(En.REF,It.RangeManySheets);throw u}const c=this.dependencyGraph.getRange(o.start,o.end);if(void 0===c)throw new Error("Range does not exists in graph");let l=c.getFunctionValue(n);if(void 0===l){const e=this.getRangeValues(n,o,c,s,i);l=e.reduce(((e,t)=>e instanceof Fn?e:t instanceof Fn?t:a(e,t)),r),c.setFunctionValue(n,l)}return l}getRangeValues(e,t,r,n,a){const s=[],{smallerRangeVertex:i,restRange:o}=this.dependencyGraph.rangeMapping.findSmallerRange(t);let c;if(void 0!==i&&this.dependencyGraph.existsEdge(i,r)){const t=i.getFunctionValue(e);if(void 0!==t)s.push(t);else for(const e of i.range.addresses(this.dependencyGraph)){const t=a(this.dependencyGraph.getScalarValue(e));t instanceof Fn?s.push(t):void 0!==t&&s.push(n(t))}c=o}else c=t;for(const l of c.addresses(this.dependencyGraph)){const e=a(this.dependencyGraph.getScalarValue(l));e instanceof Fn?s.push(e):void 0!==e&&s.push(n(e))}return s}}function Wo(e){return hr(e)||e instanceof Fn?e:void 0}function Go(e){return"boolean"===typeof e?Ar(e):hr(e)||e instanceof Fn?e:"string"===typeof e?0:void 0}Vo.implementedFunctions={SUM:{method:"sum",parameters:[{argumentType:Yr.ANY}],repeatLastArgs:1},SUMSQ:{method:"sumsq",parameters:[{argumentType:Yr.ANY}],repeatLastArgs:1},MAX:{method:"max",parameters:[{argumentType:Yr.ANY}],repeatLastArgs:1},MIN:{method:"min",parameters:[{argumentType:Yr.ANY}],repeatLastArgs:1},MAXA:{method:"maxa",parameters:[{argumentType:Yr.ANY}],repeatLastArgs:1},MINA:{method:"mina",parameters:[{argumentType:Yr.ANY}],repeatLastArgs:1},COUNT:{method:"count",parameters:[{argumentType:Yr.ANY}],repeatLastArgs:1},COUNTA:{method:"counta",parameters:[{argumentType:Yr.ANY}],repeatLastArgs:1},AVERAGE:{method:"average",parameters:[{argumentType:Yr.ANY}],repeatLastArgs:1},AVERAGEA:{method:"averagea",parameters:[{argumentType:Yr.ANY}],repeatLastArgs:1},PRODUCT:{method:"product",parameters:[{argumentType:Yr.ANY}],repeatLastArgs:1},"VAR.S":{method:"vars",parameters:[{argumentType:Yr.ANY}],repeatLastArgs:1},"VAR.P":{method:"varp",parameters:[{argumentType:Yr.ANY}],repeatLastArgs:1},VARA:{method:"vara",parameters:[{argumentType:Yr.ANY}],repeatLastArgs:1},VARPA:{method:"varpa",parameters:[{argumentType:Yr.ANY}],repeatLastArgs:1},"STDEV.S":{method:"stdevs",parameters:[{argumentType:Yr.ANY}],repeatLastArgs:1},"STDEV.P":{method:"stdevp",parameters:[{argumentType:Yr.ANY}],repeatLastArgs:1},STDEVA:{method:"stdeva",parameters:[{argumentType:Yr.ANY}],repeatLastArgs:1},STDEVPA:{method:"stdevpa",parameters:[{argumentType:Yr.ANY}],repeatLastArgs:1},SUBTOTAL:{method:"subtotal",parameters:[{argumentType:Yr.NUMBER},{argumentType:Yr.ANY}],repeatLastArgs:1}},Vo.aliases={VAR:"VAR.S",VARP:"VAR.P",STDEV:"STDEV.S",STDEVP:"STDEV.P",VARS:"VAR.S",STDEVS:"STDEV.S"};
/**
 * @license
 * Copyright (c) 2022 Handsoncode. All rights reserved.
 */
class Ho extends Wr{power(e,t){return this.runFunction(e.args,t,this.metadata("POWER"),Math.pow)}}Ho.implementedFunctions={POWER:{method:"power",parameters:[{argumentType:Yr.NUMBER},{argumentType:Yr.NUMBER}]}};
/**
 * @license
 * Copyright (c) 2022 Handsoncode. All rights reserved.
 */
class zo extends Wr{radians(e,t){return this.runFunction(e.args,t,this.metadata("RADIANS"),(e=>e*(Math.PI/180)))}}zo.implementedFunctions={RADIANS:{method:"radians",parameters:[{argumentType:Yr.NUMBER}]}};
/**
 * @license
 * Copyright (c) 2022 Handsoncode. All rights reserved.
 */
const $o=10,jo=255,Xo=2,Ko=36,qo="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ";class Jo extends Wr{dec2bin(e,t){return this.runFunction(e.args,t,this.metadata("DEC2BIN"),((e,t)=>Zo(e,2,t)))}dec2oct(e,t){return this.runFunction(e.args,t,this.metadata("DEC2OCT"),((e,t)=>Zo(e,8,t)))}dec2hex(e,t){return this.runFunction(e.args,t,this.metadata("DEC2HEX"),((e,t)=>Zo(e,16,t)))}bin2dec(e,t){return this.runFunction(e.args,t,this.metadata("BIN2DEC"),(e=>{const t=Qo(e,2,$o);return void 0===t?new Fn(En.NUM,It.NotBinary):ac(t,2)}))}bin2oct(e,t){return this.runFunction(e.args,t,this.metadata("BIN2OCT"),((e,t)=>{const r=Qo(e,2,$o);return void 0===r?new Fn(En.NUM,It.NotBinary):Zo(ac(r,2),8,t)}))}bin2hex(e,t){return this.runFunction(e.args,t,this.metadata("BIN2HEX"),((e,t)=>{const r=Qo(e,2,$o);return void 0===r?new Fn(En.NUM,It.NotBinary):Zo(ac(r,2),16,t)}))}oct2dec(e,t){return this.runFunction(e.args,t,this.metadata("OCT2DEC"),(e=>{const t=Qo(e,8,$o);return void 0===t?new Fn(En.NUM,It.NotOctal):ac(t,8)}))}oct2bin(e,t){return this.runFunction(e.args,t,this.metadata("OCT2BIN"),((e,t)=>{const r=Qo(e,8,$o);return void 0===r?new Fn(En.NUM,It.NotOctal):Zo(ac(r,8),2,t)}))}oct2hex(e,t){return this.runFunction(e.args,t,this.metadata("OCT2HEX"),((e,t)=>{const r=Qo(e,8,$o);return void 0===r?new Fn(En.NUM,It.NotOctal):Zo(ac(r,8),16,t)}))}hex2dec(e,t){return this.runFunction(e.args,t,this.metadata("HEX2DEC"),(e=>{const t=Qo(e,16,$o);return void 0===t?new Fn(En.NUM,It.NotHex):ac(t,16)}))}hex2bin(e,t){return this.runFunction(e.args,t,this.metadata("HEX2BIN"),((e,t)=>{const r=Qo(e,16,$o);return void 0===r?new Fn(En.NUM,It.NotHex):Zo(ac(r,16),2,t)}))}hex2oct(e,t){return this.runFunction(e.args,t,this.metadata("HEX2OCT"),((e,t)=>{const r=Qo(e,16,$o);return void 0===r?new Fn(En.NUM,It.NotHex):Zo(ac(r,16),8,t)}))}base(e,t){return this.runFunction(e.args,t,this.metadata("BASE"),rc)}decimal(e,t){return this.runFunction(e.args,t,this.metadata("DECIMAL"),((e,t)=>{const r=Qo(e,t,jo);return void 0===r?new Fn(En.NUM,It.NotHex):parseInt(r,t)}))}}function Qo(e,t,r){const n=qo.substr(0,t),a=new RegExp(`^[${n}]+$`);if(!(e.length>r)&&a.test(e))return e}function Zo(e,t,r){if(e>tc(t))return new Fn(En.NUM,It.ValueBaseLarge);if(e<ec(t))return new Fn(En.NUM,It.ValueBaseSmall);const n=nc(e,t);return void 0===r||e<0?n:n.length>r?new Fn(En.NUM,It.ValueBaseLong):xa(n,r)}function ec(e){return-Math.pow(e,$o)/2}function tc(e){return-ec(e)-1}function rc(e,t,r){const n=nc(e,t);return void 0!==r&&r>n.length?xa(n,r):n}function nc(e,t){const r=e<0?Math.pow(t,$o):0;return(e+r).toString(t).toUpperCase()}function ac(e,t){const r=parseInt(e,t),n=Math.pow(t,$o);return r>=n/2?r-n:r}Jo.implementedFunctions={DEC2BIN:{method:"dec2bin",parameters:[{argumentType:Yr.NUMBER},{argumentType:Yr.NUMBER,optionalArg:!0,minValue:1,maxValue:10}]},DEC2OCT:{method:"dec2oct",parameters:[{argumentType:Yr.NUMBER},{argumentType:Yr.NUMBER,optionalArg:!0,minValue:1,maxValue:10}]},DEC2HEX:{method:"dec2hex",parameters:[{argumentType:Yr.NUMBER},{argumentType:Yr.NUMBER,optionalArg:!0,minValue:1,maxValue:10}]},BIN2DEC:{method:"bin2dec",parameters:[{argumentType:Yr.STRING}]},BIN2OCT:{method:"bin2oct",parameters:[{argumentType:Yr.STRING},{argumentType:Yr.NUMBER,optionalArg:!0,minValue:0,maxValue:$o}]},BIN2HEX:{method:"bin2hex",parameters:[{argumentType:Yr.STRING},{argumentType:Yr.NUMBER,optionalArg:!0,minValue:0,maxValue:$o}]},OCT2DEC:{method:"oct2dec",parameters:[{argumentType:Yr.STRING}]},OCT2BIN:{method:"oct2bin",parameters:[{argumentType:Yr.STRING},{argumentType:Yr.NUMBER,optionalArg:!0,minValue:0,maxValue:$o}]},OCT2HEX:{method:"oct2hex",parameters:[{argumentType:Yr.STRING},{argumentType:Yr.NUMBER,optionalArg:!0,minValue:0,maxValue:$o}]},HEX2DEC:{method:"hex2dec",parameters:[{argumentType:Yr.STRING}]},HEX2BIN:{method:"hex2bin",parameters:[{argumentType:Yr.STRING},{argumentType:Yr.NUMBER,optionalArg:!0,minValue:0,maxValue:$o}]},HEX2OCT:{method:"hex2oct",parameters:[{argumentType:Yr.STRING},{argumentType:Yr.NUMBER,optionalArg:!0,minValue:0,maxValue:$o}]},DECIMAL:{method:"decimal",parameters:[{argumentType:Yr.STRING},{argumentType:Yr.NUMBER,minValue:Xo,maxValue:Ko}]},BASE:{method:"base",parameters:[{argumentType:Yr.NUMBER,minValue:0},{argumentType:Yr.NUMBER,minValue:Xo,maxValue:Ko},{argumentType:Yr.NUMBER,optionalArg:!0,minValue:0,maxValue:jo}]}};
/**
 * @license
 * Copyright (c) 2022 Handsoncode. All rights reserved.
 */
class sc extends Wr{rand(e,t){return this.runFunction(e.args,t,this.metadata("RAND"),Math.random)}randbetween(e,t){return this.runFunction(e.args,t,this.metadata("RANDBETWEEN"),((e,t)=>t<e?new Fn(En.NUM,It.WrongOrder):(e=Math.ceil(e),t=Math.floor(t)+1,e===t&&(t+=1),e+Math.floor(Math.random()*(t-e)))))}}
/**
 * @license
 * Copyright (c) 2022 Handsoncode. All rights reserved.
 */
function ic(e){const t=Math.ceil(e);return t%2===1?t:t+1}function oc(e){const t=Math.ceil(e);return t%2===0?t:t+1}sc.implementedFunctions={RAND:{method:"rand",parameters:[],isVolatile:!0},RANDBETWEEN:{method:"randbetween",parameters:[{argumentType:Yr.NUMBER},{argumentType:Yr.NUMBER}],isVolatile:!0}};class cc extends Wr{roundup(e,t){return this.runFunction(e.args,t,this.metadata("ROUNDDOWN"),((e,t)=>{const r=Math.pow(10,t);return e<0?-Math.ceil(-e*r)/r:Math.ceil(e*r)/r}))}rounddown(e,t){return this.runFunction(e.args,t,this.metadata("ROUNDDOWN"),((e,t)=>{const r=Math.pow(10,t);return e<0?-Math.floor(-e*r)/r:Math.floor(e*r)/r}))}round(e,t){return this.runFunction(e.args,t,this.metadata("ROUND"),((e,t)=>{const r=Math.pow(10,t);return e<0?-Math.round(-e*r)/r:Math.round(e*r)/r}))}intFunc(e,t){return this.runFunction(e.args,t,this.metadata("INT"),(e=>e<0?-Math.floor(-e):Math.floor(e)))}even(e,t){return this.runFunction(e.args,t,this.metadata("EVEN"),(e=>e<0?-oc(-e):oc(e)))}odd(e,t){return this.runFunction(e.args,t,this.metadata("ODD"),(e=>e<0?-ic(-e):ic(e)))}ceilingmath(e,t){return this.runFunction(e.args,t,this.metadata("CEILING.MATH"),((e,t,r)=>0===t||0===e?0:(t=Math.abs(t),1===r&&e<0&&(t=-t),Math.ceil(e/t)*t)))}ceiling(e,t){return this.runFunction(e.args,t,this.metadata("CEILING"),((e,t)=>0===e?0:0===t?new Fn(En.DIV_BY_ZERO):e>0&&t<0?new Fn(En.NUM,It.DistinctSigns):Math.ceil(e/t)*t))}ceilingprecise(e,t){return this.runFunction(e.args,t,this.metadata("CEILING.PRECISE"),((e,t)=>0===t||0===e?0:(t=Math.abs(t),Math.ceil(e/t)*t)))}floormath(e,t){return this.runFunction(e.args,t,this.metadata("FLOOR.MATH"),((e,t,r)=>0===t||0===e?0:(t=Math.abs(t),1===r&&e<0&&(t*=-1),Math.floor(e/t)*t)))}floor(e,t){return this.runFunction(e.args,t,this.metadata("FLOOR"),((e,t)=>0===e?0:0===t?new Fn(En.DIV_BY_ZERO):e>0&&t<0?new Fn(En.NUM,It.DistinctSigns):Math.floor(e/t)*t))}floorprecise(e,t){return this.runFunction(e.args,t,this.metadata("FLOOR.PRECISE"),((e,t)=>0===t||0===e?0:(t=Math.abs(t),Math.floor(e/t)*t)))}}cc.implementedFunctions={ROUNDUP:{method:"roundup",parameters:[{argumentType:Yr.NUMBER},{argumentType:Yr.NUMBER,defaultValue:0}]},ROUNDDOWN:{method:"rounddown",parameters:[{argumentType:Yr.NUMBER},{argumentType:Yr.NUMBER,defaultValue:0}]},ROUND:{method:"round",parameters:[{argumentType:Yr.NUMBER},{argumentType:Yr.NUMBER,defaultValue:0}]},INT:{method:"intFunc",parameters:[{argumentType:Yr.NUMBER}]},EVEN:{method:"even",parameters:[{argumentType:Yr.NUMBER}]},ODD:{method:"odd",parameters:[{argumentType:Yr.NUMBER}]},"CEILING.MATH":{method:"ceilingmath",parameters:[{argumentType:Yr.NUMBER},{argumentType:Yr.NUMBER,defaultValue:1},{argumentType:Yr.NUMBER,defaultValue:0}]},CEILING:{method:"ceiling",parameters:[{argumentType:Yr.NUMBER},{argumentType:Yr.NUMBER}]},"CEILING.PRECISE":{method:"ceilingprecise",parameters:[{argumentType:Yr.NUMBER},{argumentType:Yr.NUMBER,defaultValue:1}]},"FLOOR.MATH":{method:"floormath",parameters:[{argumentType:Yr.NUMBER},{argumentType:Yr.NUMBER,defaultValue:1},{argumentType:Yr.NUMBER,defaultValue:0}]},FLOOR:{method:"floor",parameters:[{argumentType:Yr.NUMBER},{argumentType:Yr.NUMBER}]},"FLOOR.PRECISE":{method:"floorprecise",parameters:[{argumentType:Yr.NUMBER},{argumentType:Yr.NUMBER,defaultValue:1}]}},cc.aliases={"ISO.CEILING":"CEILING.PRECISE",TRUNC:"ROUNDDOWN"};
/**
 * @license
 * Copyright (c) 2022 Handsoncode. All rights reserved.
 */
class lc extends Wr{sqrt(e,t){return this.runFunction(e.args,t,this.metadata("SQRT"),Math.sqrt)}}
/**
 * @license
 * Copyright (c) 2022 Handsoncode. All rights reserved.
 */
function*uc(){}function hc(e){const t=e[Symbol.iterator](),{done:r,value:n}=t.next();return r?{rest:uc()}:{value:n,rest:t}}lc.implementedFunctions={SQRT:{method:"sqrt",parameters:[{argumentType:Yr.NUMBER}]}};
/**
 * @license
 * Copyright (c) 2022 Handsoncode. All rights reserved.
 */
const fc=(e,t,r)=>{if(r.end.row>r.start.row){const n=Wn(r.end.sheet,r.end.col,r.end.row-1),a=e.getRange(r.start,n);if(void 0!==a)return{smallerRangeVertex:a,restValuesRange:r.withStart(Wn(r.start.sheet,r.start.col,r.end.row)),restConditionRanges:t.map((e=>e.withStart(Wn(e.start.sheet,e.start.col,e.end.row))))}}return{restValuesRange:r,restConditionRanges:t}};class dc{constructor(e,t,r,n,a){this.interpreter=e,this.cacheKey=t,this.reduceInitialValue=r,this.composeFunction=n,this.mapFunction=a,this.dependencyGraph=this.interpreter.dependencyGraph}compute(e,t){for(const a of t)if(!a.conditionRange.sameDimensionsAs(e))return new Fn(En.VALUE,It.EqualLength);const r=this.tryToGetRangeVertexForRangeValue(e),n=t.map((e=>this.tryToGetRangeVertexForRangeValue(e.conditionRange)));if(r&&n.every((e=>void 0!==e))){const a=t.map((e=>e.criterionPackage.raw)).join(","),s=this.findAlreadyComputedValueInCache(r,this.cacheKey(t),a);if(void 0!==s)return this.interpreter.stats.incrementCriterionFunctionFullCacheUsed(),s;const i=this.buildNewCriterionCache(this.cacheKey(t),t.map((e=>e.conditionRange.range)),e.range);return i.has(a)||i.set(a,[this.evaluateRangeValue(e,t),t.map((e=>e.criterionPackage.lambda))]),r.setCriterionFunctionValues(this.cacheKey(t),i),n.forEach((e=>{void 0!==e&&e.addDependentCacheRange(r)})),i.get(a)[0]}return this.evaluateRangeValue(e,t)}tryToGetRangeVertexForRangeValue(e){const t=e.range;return void 0===t?void 0:this.dependencyGraph.getRange(t.start,t.end)}reduceFunction(e){let t=this.reduceInitialValue;for(const r of e)t=this.composeFunction(t,r);return t}findAlreadyComputedValueInCache(e,t,r){return e.getCriterionFunctionValue(t,r)}evaluateRangeValue(e,t){const r=t.map((e=>e.criterionPackage.lambda)),n=Array.from(e.valuesFromTopLeftCorner()).map(this.mapFunction)[Symbol.iterator](),a=t.map((e=>e.conditionRange.iterateValuesFromTopLeftCorner())),s=gc(r,a,n);return this.reduceFunction(s)}buildNewCriterionCache(e,t,r){const n=this.dependencyGraph.getRange(r.start,r.end),{smallerRangeVertex:a,restConditionRanges:s,restValuesRange:i}=fc(this.dependencyGraph,t,r);let o;o=void 0!==a&&this.dependencyGraph.existsEdge(a,n)?a.getCriterionFunctionValues(e):new Map;const c=new Map;return o.forEach((([e,t],r)=>{const n=gc(t,s.map((e=>mc(this.dependencyGraph,e))),Array.from(mc(this.dependencyGraph,i)).map(this.mapFunction)[Symbol.iterator]()),a=this.composeFunction(e,this.reduceFunction(n));this.interpreter.stats.incrementCriterionFunctionPartialCacheUsed(),c.set(r,[a,t])})),c}}class pc{constructor(e,t){this.conditionRange=e,this.criterionPackage=t}}function*mc(e,t){for(const r of t.addresses(e))yield nr(e.getScalarValue(r))}function*gc(e,t,r){for(const n of r){const r=t.map((e=>hc(e)));if(!r.every((e=>Object.prototype.hasOwnProperty.call(e,"value"))))return;const a=r.map((e=>nr(e.value)));Ec(a,e).every((([e,t])=>t(e)))&&(yield n),t=r.map((e=>e.rest))}}function Ec(e,t){const r=[];for(let n=0;n<Math.min(e.length,t.length);n++)r.push([e[n],t[n]]);return r}
/**
 * @license
 * Copyright (c) 2022 Handsoncode. All rights reserved.
 */
class vc{constructor(e,t){this.sum=e,this.count=t}static single(e){return new vc(e,1)}compose(e){return new vc(this.sum+e.sum,this.count+e.count)}averageValue(){return this.count>0?this.sum/this.count:void 0}}function Tc(e){return t=>{const r=t.map((e=>`${e.conditionRange.range.sheet},${e.conditionRange.range.start.col},${e.conditionRange.range.start.row}`));return[e,...r].join(",")}}function Sc(e){return hr(e)&&!Number.isFinite(nr(e))?0:e}function Ac(e){return e instanceof Fn?e:hr(e)?nr(e):void 0}vc.empty=new vc(0,0);class Rc extends Wr{sumif(e,t){const r="SUMIF",n=(e,t,n)=>this.computeConditionalAggregationFunction(null!==n&&void 0!==n?n:e,[e,t],r,0,((e,t)=>this.arithmeticHelper.nonstrictadd(e,t)),Ac);return this.runFunction(e.args,t,this.metadata(r),n)}sumifs(e,t){const r="SUMIFS",n=(e,...t)=>this.computeConditionalAggregationFunction(e,t,r,0,((e,t)=>this.arithmeticHelper.nonstrictadd(e,t)),Ac);return this.runFunction(e.args,t,this.metadata(r),n)}averageif(e,t){const r="AVERAGEIF",n=(e,t,n)=>{const a=this.computeConditionalAggregationFunction(null!==n&&void 0!==n?n:e,[e,t],r,vc.empty,((e,t)=>e.compose(t)),(e=>hr(e)?vc.single(nr(e)):vc.empty));return a instanceof Fn?a:a.averageValue()||new Fn(En.DIV_BY_ZERO)};return this.runFunction(e.args,t,this.metadata(r),n)}countif(e,t){const r="COUNTIF",n=(e,t)=>this.computeConditionalAggregationFunction(e,[e,t],r,0,((e,t)=>e+t),(()=>1));return this.runFunction(e.args,t,this.metadata(r),n)}countifs(e,t){const r="COUNTIFS",n=(...e)=>this.computeConditionalAggregationFunction(e[0],e,r,0,((e,t)=>e+t),(()=>1));return this.runFunction(e.args,t,this.metadata(r),n)}minifs(e,t){const r="MINIFS",n=(e,t)=>void 0===t||void 0===e?void 0===t?e:t:Math.min(e,t),a=(e,...t)=>{const a=this.computeConditionalAggregationFunction(e,t,r,Number.POSITIVE_INFINITY,n,Ac);return Sc(a)};return this.runFunction(e.args,t,this.metadata(r),a)}maxifs(e,t){const r="MAXIFS",n=(e,t)=>void 0===t||void 0===e?void 0===t?e:t:Math.max(e,t),a=(e,...t)=>{const a=this.computeConditionalAggregationFunction(e,t,r,Number.NEGATIVE_INFINITY,n,Ac);return Sc(a)};return this.runFunction(e.args,t,this.metadata(r),a)}computeConditionalAggregationFunction(e,t,r,n,a,s){const i=[];for(let o=0;o<t.length;o+=2){const e=t[o],r=this.interpreter.criterionBuilder.fromCellValue(t[o+1],this.arithmeticHelper);if(void 0===r)return new Fn(En.VALUE,It.BadCriterion);i.push(new pc(e,r))}return new dc(this.interpreter,Tc(r),n,a,s).compute(e,i)}}Rc.implementedFunctions={SUMIF:{method:"sumif",parameters:[{argumentType:Yr.RANGE},{argumentType:Yr.NOERROR},{argumentType:Yr.RANGE,optionalArg:!0}]},COUNTIF:{method:"countif",parameters:[{argumentType:Yr.RANGE},{argumentType:Yr.NOERROR}]},AVERAGEIF:{method:"averageif",parameters:[{argumentType:Yr.RANGE},{argumentType:Yr.NOERROR},{argumentType:Yr.RANGE,optionalArg:!0}]},SUMIFS:{method:"sumifs",parameters:[{argumentType:Yr.RANGE},{argumentType:Yr.RANGE},{argumentType:Yr.NOERROR}],repeatLastArgs:2},COUNTIFS:{method:"countifs",parameters:[{argumentType:Yr.RANGE},{argumentType:Yr.NOERROR}],repeatLastArgs:2},MINIFS:{method:"minifs",parameters:[{argumentType:Yr.RANGE},{argumentType:Yr.RANGE},{argumentType:Yr.NOERROR}],repeatLastArgs:2},MAXIFS:{method:"maxifs",parameters:[{argumentType:Yr.RANGE},{argumentType:Yr.RANGE},{argumentType:Yr.NOERROR}],repeatLastArgs:2}};
/**
 * @license
 * Copyright (c) 2022 Handsoncode. All rights reserved.
 */
class yc extends Wr{sumproduct(e,t){return this.runFunction(e.args,t,this.metadata("SUMPRODUCT"),((...e)=>{const t=e[0].width(),r=e[0].height();for(const s of e)if(s.width()!==t||s.height()!==r)return new Fn(En.VALUE,It.EqualLength);let n=0;const a=e.map((e=>e.iterateValuesFromTopLeftCorner()));for(let s=0;s<t*r;s++){let e=1;for(const t of a){const r=t.next().value;if(r instanceof Fn)return r;const n=this.coerceScalarToNumberOrError(r);hr(n)?e*=nr(n):e=0}n+=e}return n}))}}yc.implementedFunctions={SUMPRODUCT:{method:"sumproduct",parameters:[{argumentType:Yr.RANGE}],repeatLastArgs:1}};
/**
 * @license
 * Copyright (c) 2022 Handsoncode. All rights reserved.
 */
class Nc extends Wr{concatenate(e,t){return this.runFunction(e.args,t,this.metadata("CONCATENATE"),((...e)=>"".concat(...e)))}split(e,t){return this.runFunction(e.args,t,this.metadata("SPLIT"),((e,t)=>{const r=e.split(" ");return t>=r.length||t<0?new Fn(En.VALUE,It.IndexBounds):r[t]}))}len(e,t){return this.runFunction(e.args,t,this.metadata("LEN"),(e=>e.length))}lower(e,t){return this.runFunction(e.args,t,this.metadata("LOWER"),(e=>e.toLowerCase()))}trim(e,t){return this.runFunction(e.args,t,this.metadata("TRIM"),(e=>e.replace(/^ +| +$/g,"").replace(/ +/g," ")))}proper(e,t){return this.runFunction(e.args,t,this.metadata("PROPER"),(e=>e.replace(/\p{L}+/gu,(e=>e.charAt(0).toUpperCase()+e.substring(1).toLowerCase()))))}clean(e,t){return this.runFunction(e.args,t,this.metadata("CLEAN"),(e=>e.replace(/[\u0000-\u001F]/g,"")))}exact(e,t){return this.runFunction(e.args,t,this.metadata("EXACT"),((e,t)=>e===t))}rept(e,t){return this.runFunction(e.args,t,this.metadata("REPT"),((e,t)=>t<0?new Fn(En.VALUE,It.NegativeCount):e.repeat(t)))}right(e,t){return this.runFunction(e.args,t,this.metadata("RIGHT"),((e,t)=>t<0?new Fn(En.VALUE,It.NegativeLength):0===t?"":e.slice(-t)))}left(e,t){return this.runFunction(e.args,t,this.metadata("LEFT"),((e,t)=>t<0?new Fn(En.VALUE,It.NegativeLength):e.slice(0,t)))}mid(e,t){return this.runFunction(e.args,t,this.metadata("MID"),((e,t,r)=>t<1?new Fn(En.VALUE,It.LessThanOne):r<0?new Fn(En.VALUE,It.NegativeLength):e.substring(t-1,t+r-1)))}replace(e,t){return this.runFunction(e.args,t,this.metadata("REPLACE"),((e,t,r,n)=>t<1?new Fn(En.VALUE,It.LessThanOne):r<0?new Fn(En.VALUE,It.NegativeLength):e.substring(0,t-1)+n+e.substring(t+r-1)))}search(e,t){return this.runFunction(e.args,t,this.metadata("SEARCH"),((e,t,r)=>{if(r<1||r>t.length)return new Fn(En.VALUE,It.LengthBounds);const n=t.substring(r-1).toLowerCase();let a;return a=this.arithmeticHelper.requiresRegex(e)?this.arithmeticHelper.searchString(e,n):n.indexOf(e.toLowerCase()),a+=r,a>0?a:new Fn(En.VALUE,It.PatternNotFound)}))}substitute(e,t){return this.runFunction(e.args,t,this.metadata("SUBSTITUTE"),((e,t,r,n)=>{const a=new RegExp(t,"g");if(void 0===n)return e.replace(a,r);if(n<1)return new Fn(En.VALUE,It.LessThanOne);let s,i=0;while(null!==(s=a.exec(e)))if(n===++i)return e.substring(0,s.index)+r+e.substring(a.lastIndex);return e}))}find(e,t){return this.runFunction(e.args,t,this.metadata("FIND"),((e,t,r)=>{if(r<1||r>t.length)return new Fn(En.VALUE,It.IndexBounds);const n=t.substring(r-1),a=n.indexOf(e)+r;return a>0?a:new Fn(En.VALUE,It.PatternNotFound)}))}t(e,t){return this.runFunction(e.args,t,this.metadata("T"),(e=>e instanceof Fn||"string"===typeof e?e:""))}upper(e,t){return this.runFunction(e.args,t,this.metadata("UPPER"),(e=>e.toUpperCase()))}}Nc.implementedFunctions={CONCATENATE:{method:"concatenate",parameters:[{argumentType:Yr.STRING}],repeatLastArgs:1,expandRanges:!0},EXACT:{method:"exact",parameters:[{argumentType:Yr.STRING},{argumentType:Yr.STRING}]},SPLIT:{method:"split",parameters:[{argumentType:Yr.STRING},{argumentType:Yr.NUMBER}]},LEN:{method:"len",parameters:[{argumentType:Yr.STRING}]},LOWER:{method:"lower",parameters:[{argumentType:Yr.STRING}]},MID:{method:"mid",parameters:[{argumentType:Yr.STRING},{argumentType:Yr.NUMBER},{argumentType:Yr.NUMBER}]},TRIM:{method:"trim",parameters:[{argumentType:Yr.STRING}]},T:{method:"t",parameters:[{argumentType:Yr.SCALAR}]},PROPER:{method:"proper",parameters:[{argumentType:Yr.STRING}]},CLEAN:{method:"clean",parameters:[{argumentType:Yr.STRING}]},REPT:{method:"rept",parameters:[{argumentType:Yr.STRING},{argumentType:Yr.NUMBER}]},RIGHT:{method:"right",parameters:[{argumentType:Yr.STRING},{argumentType:Yr.NUMBER,defaultValue:1}]},LEFT:{method:"left",parameters:[{argumentType:Yr.STRING},{argumentType:Yr.NUMBER,defaultValue:1}]},REPLACE:{method:"replace",parameters:[{argumentType:Yr.STRING},{argumentType:Yr.NUMBER},{argumentType:Yr.NUMBER},{argumentType:Yr.STRING}]},SEARCH:{method:"search",parameters:[{argumentType:Yr.STRING},{argumentType:Yr.STRING},{argumentType:Yr.NUMBER,defaultValue:1}]},SUBSTITUTE:{method:"substitute",parameters:[{argumentType:Yr.STRING},{argumentType:Yr.STRING},{argumentType:Yr.STRING},{argumentType:Yr.NUMBER,optionalArg:!0}]},FIND:{method:"find",parameters:[{argumentType:Yr.STRING},{argumentType:Yr.STRING},{argumentType:Yr.NUMBER,defaultValue:1}]},UPPER:{method:"upper",parameters:[{argumentType:Yr.STRING}]}};
/**
 * @license
 * Copyright (c) 2022 Handsoncode. All rights reserved.
 */
class wc extends Wr{acos(e,t){return this.runFunction(e.args,t,this.metadata("ACOS"),Math.acos)}asin(e,t){return this.runFunction(e.args,t,this.metadata("ASIN"),Math.asin)}cos(e,t){return this.runFunction(e.args,t,this.metadata("COS"),Math.cos)}sin(e,t){return this.runFunction(e.args,t,this.metadata("SIN"),Math.sin)}tan(e,t){return this.runFunction(e.args,t,this.metadata("TAN"),Math.tan)}atan(e,t){return this.runFunction(e.args,t,this.metadata("ATAN"),Math.atan)}atan2(e,t){return this.runFunction(e.args,t,this.metadata("ATAN2"),((e,t)=>0===e&&0===t?new Fn(En.DIV_BY_ZERO):Math.atan2(t,e)))}cot(e,t){return this.runFunction(e.args,t,this.metadata("COT"),(e=>0===e?new Fn(En.DIV_BY_ZERO):1/Math.tan(e)))}acot(e,t){return this.runFunction(e.args,t,this.metadata("ACOT"),(e=>0===e?Lo/2:Math.atan(1/e)))}sec(e,t){return this.runFunction(e.args,t,this.metadata("SEC"),(e=>1/Math.cos(e)))}csc(e,t){return this.runFunction(e.args,t,this.metadata("CSC"),(e=>0===e?new Fn(En.DIV_BY_ZERO):1/Math.sin(e)))}sinh(e,t){return this.runFunction(e.args,t,this.metadata("SINH"),Math.sinh)}asinh(e,t){return this.runFunction(e.args,t,this.metadata("ASINH"),Math.asinh)}cosh(e,t){return this.runFunction(e.args,t,this.metadata("COSH"),Math.cosh)}acosh(e,t){return this.runFunction(e.args,t,this.metadata("ACOSH"),Math.acosh)}tanh(e,t){return this.runFunction(e.args,t,this.metadata("TANH"),Math.tanh)}atanh(e,t){return this.runFunction(e.args,t,this.metadata("ATANH"),Math.atanh)}coth(e,t){return this.runFunction(e.args,t,this.metadata("COTH"),(e=>0===e?new Fn(En.DIV_BY_ZERO):1/Math.tanh(e)))}acoth(e,t){return this.runFunction(e.args,t,this.metadata("ACOTH"),(e=>0===e?new Fn(En.NUM,It.NonZero):Math.atanh(1/e)))}sech(e,t){return this.runFunction(e.args,t,this.metadata("SECH"),(e=>1/Math.cosh(e)))}csch(e,t){return this.runFunction(e.args,t,this.metadata("CSCH"),(e=>0===e?new Fn(En.DIV_BY_ZERO):1/Math.sinh(e)))}}wc.implementedFunctions={ACOS:{method:"acos",parameters:[{argumentType:Yr.NUMBER}]},ASIN:{method:"asin",parameters:[{argumentType:Yr.NUMBER}]},COS:{method:"cos",parameters:[{argumentType:Yr.NUMBER}]},SIN:{method:"sin",parameters:[{argumentType:Yr.NUMBER}]},TAN:{method:"tan",parameters:[{argumentType:Yr.NUMBER}]},ATAN:{method:"atan",parameters:[{argumentType:Yr.NUMBER}]},ATAN2:{method:"atan2",parameters:[{argumentType:Yr.NUMBER},{argumentType:Yr.NUMBER}]},COT:{method:"cot",parameters:[{argumentType:Yr.NUMBER}]},SEC:{method:"sec",parameters:[{argumentType:Yr.NUMBER}]},CSC:{method:"csc",parameters:[{argumentType:Yr.NUMBER}]},SINH:{method:"sinh",parameters:[{argumentType:Yr.NUMBER}]},COSH:{method:"cosh",parameters:[{argumentType:Yr.NUMBER}]},TANH:{method:"tanh",parameters:[{argumentType:Yr.NUMBER}]},COTH:{method:"coth",parameters:[{argumentType:Yr.NUMBER}]},SECH:{method:"sech",parameters:[{argumentType:Yr.NUMBER}]},CSCH:{method:"csch",parameters:[{argumentType:Yr.NUMBER}]},ACOT:{method:"acot",parameters:[{argumentType:Yr.NUMBER}]},ASINH:{method:"asinh",parameters:[{argumentType:Yr.NUMBER}]},ACOSH:{method:"acosh",parameters:[{argumentType:Yr.NUMBER}]},ATANH:{method:"atanh",parameters:[{argumentType:Yr.NUMBER}]},ACOTH:{method:"acoth",parameters:[{argumentType:Yr.NUMBER}]}};
/**
 * @license
 * Copyright (c) 2022 Handsoncode. All rights reserved.
 */
class bc extends Di{constructor(e){super(e),this.dependencyGraph=e}find(e,t,r){return this.basicFind(e,t,"col",r)}}
/**
 * @license
 * Copyright (c) 2022 Handsoncode. All rights reserved.
 */
class Cc extends Wr{constructor(){super(...arguments),this.rowSearch=new bc(this.dependencyGraph)}vlookup(e,t){return this.runFunction(e.args,t,this.metadata("VLOOKUP"),((e,t,r,n)=>{const a=t.range;return void 0===a?new Fn(En.VALUE,It.WrongType):r<1?new Fn(En.VALUE,It.LessThanOne):r>a.width()?new Fn(En.REF,It.IndexLarge):this.doVlookup(wr(e),t,r-1,n)}))}hlookup(e,t){return this.runFunction(e.args,t,this.metadata("HLOOKUP"),((e,t,r,n)=>{const a=t.range;return void 0===a?new Fn(En.VALUE,It.WrongType):r<1?new Fn(En.VALUE,It.LessThanOne):r>a.height()?new Fn(En.REF,It.IndexLarge):this.doHlookup(wr(e),t,r-1,n)}))}match(e,t){return this.runFunction(e.args,t,this.metadata("MATCH"),((e,t,r)=>this.doMatch(wr(e),t,r)))}searchInRange(e,t,r,n){if(!r&&"string"===typeof e&&this.arithmeticHelper.requiresRegex(e))return n.advancedFind(this.arithmeticHelper.eqMatcherFunction(e),t);{const a=r?{ordering:"asc"}:{ordering:"none",matchExactly:!0};return n.find(e,t,a)}}doVlookup(e,t,r,n){this.dependencyGraph.stats.start(Vr.VLOOKUP);const a=t.range;let s;s=void 0===a?jr.onlyValues(t.data.map((e=>[e[0]]))):jr.onlyRange(jt.spanFrom(a.start,1,a.height()),this.dependencyGraph);const i=this.searchInRange(e,s,n,this.columnSearch);if(this.dependencyGraph.stats.end(Vr.VLOOKUP),-1===i)return new Fn(En.NA,It.ValueNotFound);let o;if(void 0===a)o=t.data[i][r];else{const e=Wn(a.sheet,a.start.col+r,a.start.row+i);o=this.dependencyGraph.getCellValue(e)}return o instanceof jr?new Fn(En.VALUE,It.WrongType):o}doHlookup(e,t,r,n){const a=t.range;let s;s=void 0===a?jr.onlyValues([t.data[0]]):jr.onlyRange(jt.spanFrom(a.start,a.width(),1),this.dependencyGraph);const i=this.searchInRange(e,s,n,this.rowSearch);if(-1===i)return new Fn(En.NA,It.ValueNotFound);let o;if(void 0===a)o=t.data[r][i];else{const e=Wn(a.sheet,a.start.col+i,a.start.row+r);o=this.dependencyGraph.getCellValue(e)}return o instanceof jr?new Fn(En.VALUE,It.WrongType):o}doMatch(e,t,r){if(![-1,0,1].includes(r))return new Fn(En.VALUE,It.BadMode);if(t.width()>1&&t.height()>1)return new Fn(En.NA);const n=1===t.width()?this.columnSearch:this.rowSearch,a=0===r?{ordering:"none",matchExactly:!0}:{ordering:-1===r?"desc":"asc"},s=n.find(e,t,a);return-1===s?new Fn(En.NA,It.ValueNotFound):s+1}}Cc.implementedFunctions={VLOOKUP:{method:"vlookup",parameters:[{argumentType:Yr.NOERROR},{argumentType:Yr.RANGE},{argumentType:Yr.NUMBER},{argumentType:Yr.BOOLEAN,defaultValue:!0}]},HLOOKUP:{method:"hlookup",parameters:[{argumentType:Yr.NOERROR},{argumentType:Yr.RANGE},{argumentType:Yr.NUMBER},{argumentType:Yr.BOOLEAN,defaultValue:!0}]},MATCH:{method:"match",parameters:[{argumentType:Yr.NOERROR},{argumentType:Yr.RANGE},{argumentType:Yr.NUMBER,defaultValue:1}]}};
/**
 * @license
 * Copyright (c) 2022 Handsoncode. All rights reserved.
 */
class Oc extends Wr{roman(e,t){return this.runFunction(e.args,t,this.metadata("ROMAN"),((e,t)=>(e=Math.trunc(e),!1===t?t=4:!0===t&&(t=0),t=nr(this.coerceScalarToNumberOrError(t)),t instanceof Fn?t:(t=Math.trunc(t),t<0?new Fn(En.VALUE,It.ValueSmall):t>4?new Fn(En.VALUE,It.ValueLarge):Mc(e,t)))))}arabic(e,t){return this.runFunction(e.args,t,this.metadata("ARABIC"),(e=>{e=e.trim().toUpperCase();let t=!1;if(e.startsWith("-")&&(e=e.slice(1),t=!0,""===e))return new Fn(En.VALUE,It.InvalidRoman);const r={input:e,acc:0};return Ic(r,{token:"MMM",val:3e3},{token:"MM",val:2e3},{token:"M",val:1e3}),Ic(r,{token:"IM",val:999},{token:"VM",val:995},{token:"XM",val:990},{token:"LM",val:950},{token:"CM",val:900}),Ic(r,{token:"D",val:500},{token:"ID",val:499},{token:"VD",val:495},{token:"XD",val:490},{token:"LD",val:450},{token:"CD",val:400}),Ic(r,{token:"CCC",val:300},{token:"CC",val:200},{token:"C",val:100}),Ic(r,{token:"IC",val:99},{token:"VC",val:95},{token:"XC",val:90}),Ic(r,{token:"L",val:50},{token:"IL",val:49},{token:"VL",val:45},{token:"XL",val:40}),Ic(r,{token:"XXX",val:30},{token:"XX",val:20},{token:"X",val:10}),Ic(r,{token:"IX",val:9}),Ic(r,{token:"V",val:5},{token:"IV",val:4}),Ic(r,{token:"III",val:3},{token:"II",val:2},{token:"I",val:1}),""!==r.input?new Fn(En.VALUE,It.InvalidRoman):t?-r.acc:r.acc}))}}function Ic(e,...t){for(const r of t)if(e.input.startsWith(r.token)){e.input=e.input.slice(r.token.length),e.acc+=r.val;break}}function Mc(e,t){const r={val:e%1e3,acc:"M".repeat(Math.floor(e/1e3))};return 4===t&&(Dc(r,"IM",999,1e3),Dc(r,"ID",499,500)),t>=3&&(Dc(r,"VM",995,1e3),Dc(r,"VD",495,500)),t>=2&&(Dc(r,"XM",990,1e3),Dc(r,"XD",490,500)),t>=1&&(Dc(r,"LM",950,1e3),Dc(r,"LD",450,500)),Dc(r,"CM",900,1e3),Dc(r,"CD",400,500),Dc(r,"D",500,900),r.acc+="C".repeat(Math.floor(r.val/100)),r.val%=100,t>=2&&(Dc(r,"IC",99,100),Dc(r,"IL",49,50)),t>=1&&(Dc(r,"VC",95,100),Dc(r,"VL",45,50)),Dc(r,"XC",90,100),Dc(r,"XL",40,50),Dc(r,"L",50,90),r.acc+="X".repeat(Math.floor(r.val/10)),r.val%=10,Dc(r,"IX",9,10),Dc(r,"IV",4,5),Dc(r,"V",5,9),r.acc+="I".repeat(r.val),r.acc}function Dc(e,t,r,n){e.val>=r&&e.val<n&&(e.val-=r,e.acc+=t)}Oc.implementedFunctions={ROMAN:{method:"roman",parameters:[{argumentType:Yr.NUMBER,minValue:1,lessThan:4e3},{argumentType:Yr.NOERROR,optionalArg:!0,defaultValue:0}]},ARABIC:{method:"arabic",parameters:[{argumentType:Yr.STRING}]}};
/**
 * @license
 * Copyright (c) 2022 Handsoncode. All rights reserved.
 */
class Lc extends Wr{add(e,t){return this.runFunction(e.args,t,this.metadata("HF.ADD"),this.arithmeticHelper.addWithEpsilon)}concat(e,t){return this.runFunction(e.args,t,this.metadata("HF.CONCAT"),this.arithmeticHelper.concat)}divide(e,t){return this.runFunction(e.args,t,this.metadata("HF.DIVIDE"),this.arithmeticHelper.divide)}eq(e,t){return this.runFunction(e.args,t,this.metadata("HF.EQ"),this.arithmeticHelper.eq)}gt(e,t){return this.runFunction(e.args,t,this.metadata("HF.GT"),this.arithmeticHelper.gt)}gte(e,t){return this.runFunction(e.args,t,this.metadata("HF.GTE"),this.arithmeticHelper.geq)}lt(e,t){return this.runFunction(e.args,t,this.metadata("HF.LT"),this.arithmeticHelper.lt)}lte(e,t){return this.runFunction(e.args,t,this.metadata("HF.LTE"),this.arithmeticHelper.leq)}minus(e,t){return this.runFunction(e.args,t,this.metadata("HF.MINUS"),this.arithmeticHelper.subtract)}multiply(e,t){return this.runFunction(e.args,t,this.metadata("HF.MULTIPLY"),this.arithmeticHelper.multiply)}ne(e,t){return this.runFunction(e.args,t,this.metadata("HF.NE"),this.arithmeticHelper.neq)}pow(e,t){return this.runFunction(e.args,t,this.metadata("HF.POW"),this.arithmeticHelper.pow)}uminus(e,t){return this.runFunction(e.args,t,this.metadata("HF.UMINUS"),this.arithmeticHelper.unaryMinus)}upercent(e,t){return this.runFunction(e.args,t,this.metadata("HF.UNARY_PERCENT"),this.arithmeticHelper.unaryPercent)}uplus(e,t){return this.runFunction(e.args,t,this.metadata("HF.UPLUS"),this.arithmeticHelper.unaryPlus)}}Lc.implementedFunctions={"HF.ADD":{method:"add",parameters:[{argumentType:Yr.NUMBER,passSubtype:!0},{argumentType:Yr.NUMBER,passSubtype:!0}]},"HF.CONCAT":{method:"concat",parameters:[{argumentType:Yr.STRING,passSubtype:!0},{argumentType:Yr.STRING,passSubtype:!0}]},"HF.DIVIDE":{method:"divide",parameters:[{argumentType:Yr.NUMBER,passSubtype:!0},{argumentType:Yr.NUMBER,passSubtype:!0}]},"HF.EQ":{method:"eq",parameters:[{argumentType:Yr.NOERROR,passSubtype:!0},{argumentType:Yr.NOERROR,passSubtype:!0}]},"HF.GT":{method:"gt",parameters:[{argumentType:Yr.NOERROR,passSubtype:!0},{argumentType:Yr.NOERROR,passSubtype:!0}]},"HF.GTE":{method:"gte",parameters:[{argumentType:Yr.NOERROR,passSubtype:!0},{argumentType:Yr.NOERROR,passSubtype:!0}]},"HF.LT":{method:"lt",parameters:[{argumentType:Yr.NOERROR,passSubtype:!0},{argumentType:Yr.NOERROR,passSubtype:!0}]},"HF.LTE":{method:"lte",parameters:[{argumentType:Yr.NOERROR,passSubtype:!0},{argumentType:Yr.NOERROR,passSubtype:!0}]},"HF.MINUS":{method:"minus",parameters:[{argumentType:Yr.NUMBER,passSubtype:!0},{argumentType:Yr.NUMBER,passSubtype:!0}]},"HF.MULTIPLY":{method:"multiply",parameters:[{argumentType:Yr.NUMBER,passSubtype:!0},{argumentType:Yr.NUMBER,passSubtype:!0}]},"HF.NE":{method:"ne",parameters:[{argumentType:Yr.NOERROR,passSubtype:!0},{argumentType:Yr.NOERROR,passSubtype:!0}]},"HF.POW":{method:"pow",parameters:[{argumentType:Yr.NUMBER,passSubtype:!0},{argumentType:Yr.NUMBER,passSubtype:!0}]},"HF.UMINUS":{method:"uminus",parameters:[{argumentType:Yr.NUMBER,passSubtype:!0}]},"HF.UNARY_PERCENT":{method:"upercent",parameters:[{argumentType:Yr.NUMBER,passSubtype:!0}]},"HF.UPLUS":{method:"uplus",parameters:[{argumentType:Yr.NUMBER,passSubtype:!0}]}};
/**
 * @license
 bessel.js (C) 2013-present SheetJS -- http://sheetjs.com

 Apache License
 Version 2.0, January 2004
 http://www.apache.org/licenses/

 TERMS AND CONDITIONS FOR USE, REPRODUCTION, AND DISTRIBUTION

 1. Definitions.

 "License" shall mean the terms and conditions for use, reproduction,
 and distribution as defined by Sections 1 through 9 of this document.

 "Licensor" shall mean the copyright owner or entity authorized by
 the copyright owner that is granting the License.

 "Legal Entity" shall mean the union of the acting entity and all
 other entities that control, are controlled by, or are under common
 control with that entity. For the purposes of this definition,
 "control" means (i) the power, direct or indirect, to cause the
 direction or management of such entity, whether by contract or
 otherwise, or (ii) ownership of fifty percent (50%) or more of the
 outstanding shares, or (iii) beneficial ownership of such entity.

 "You" (or "Your") shall mean an individual or Legal Entity
 exercising permissions granted by this License.

 "Source" form shall mean the preferred form for making modifications,
 including but not limited to software source code, documentation
 source, and configuration files.

 "Object" form shall mean any form resulting from mechanical
 transformation or translation of a Source form, including but
 not limited to compiled object code, generated documentation,
 and conversions to other media types.

 "Work" shall mean the work of authorship, whether in Source or
 Object form, made available under the License, as indicated by a
 copyright notice that is included in or attached to the work
 (an example is provided in the Appendix below).

 "Derivative Works" shall mean any work, whether in Source or Object
 form, that is based on (or derived from) the Work and for which the
 editorial revisions, annotations, elaborations, or other modifications
 represent, as a whole, an original work of authorship. For the purposes
 of this License, Derivative Works shall not include works that remain
 separable from, or merely link (or bind by name) to the interfaces of,
 the Work and Derivative Works thereof.

 "Contribution" shall mean any work of authorship, including
 the original version of the Work and any modifications or additions
 to that Work or Derivative Works thereof, that is intentionally
 submitted to Licensor for inclusion in the Work by the copyright owner
 or by an individual or Legal Entity authorized to submit on behalf of
 the copyright owner. For the purposes of this definition, "submitted"
 means any form of electronic, verbal, or written communication sent
 to the Licensor or its representatives, including but not limited to
 communication on electronic mailing lists, source code control systems,
 and issue tracking systems that are managed by, or on behalf of, the
 Licensor for the purpose of discussing and improving the Work, but
 excluding communication that is conspicuously marked or otherwise
 designated in writing by the copyright owner as "Not a Contribution."

 "Contributor" shall mean Licensor and any individual or Legal Entity
 on behalf of whom a Contribution has been received by Licensor and
 subsequently incorporated within the Work.

 2. Grant of Copyright License. Subject to the terms and conditions of
 this License, each Contributor hereby grants to You a perpetual,
 worldwide, non-exclusive, no-charge, royalty-free, irrevocable
 copyright license to reproduce, prepare Derivative Works of,
 publicly display, publicly perform, sublicense, and distribute the
 Work and such Derivative Works in Source or Object form.

 3. Grant of Patent License. Subject to the terms and conditions of
 this License, each Contributor hereby grants to You a perpetual,
 worldwide, non-exclusive, no-charge, royalty-free, irrevocable
 (except as stated in this section) patent license to make, have made,
 use, offer to sell, sell, import, and otherwise transfer the Work,
 where such license applies only to those patent claims licensable
 by such Contributor that are necessarily infringed by their
 Contribution(s) alone or by combination of their Contribution(s)
 with the Work to which such Contribution(s) was submitted. If You
 institute patent litigation against any entity (including a
 cross-claim or counterclaim in a lawsuit) alleging that the Work
 or a Contribution incorporated within the Work constitutes direct
 or contributory patent infringement, then any patent licenses
 granted to You under this License for that Work shall terminate
 as of the date such litigation is filed.

 4. Redistribution. You may reproduce and distribute copies of the
 Work or Derivative Works thereof in any medium, with or without
 modifications, and in Source or Object form, provided that You
 meet the following conditions:

 (a) You must give any other recipients of the Work or
 Derivative Works a copy of this License; and

 (b) You must cause any modified files to carry prominent notices
 stating that You changed the files; and

 (c) You must retain, in the Source form of any Derivative Works
 that You distribute, all copyright, patent, trademark, and
 attribution notices from the Source form of the Work,
 excluding those notices that do not pertain to any part of
 the Derivative Works; and

 (d) If the Work includes a "NOTICE" text file as part of its
 distribution, then any Derivative Works that You distribute must
 include a readable copy of the attribution notices contained
 within such NOTICE file, excluding those notices that do not
 pertain to any part of the Derivative Works, in at least one
 of the following places: within a NOTICE text file distributed
 as part of the Derivative Works; within the Source form or
 documentation, if provided along with the Derivative Works; or,
 within a display generated by the Derivative Works, if and
 wherever such third-party notices normally appear. The contents
 of the NOTICE file are for informational purposes only and
 do not modify the License. You may add Your own attribution
 notices within Derivative Works that You distribute, alongside
 or as an addendum to the NOTICE text from the Work, provided
 that such additional attribution notices cannot be construed
 as modifying the License.

 You may add Your own copyright statement to Your modifications and
 may provide additional or different license terms and conditions
 for use, reproduction, or distribution of Your modifications, or
 for any such Derivative Works as a whole, provided Your use,
 reproduction, and distribution of the Work otherwise complies with
 the conditions stated in this License.

 5. Submission of Contributions. Unless You explicitly state otherwise,
 any Contribution intentionally submitted for inclusion in the Work
 by You to the Licensor shall be under the terms and conditions of
 this License, without any additional terms or conditions.
 Notwithstanding the above, nothing herein shall supersede or modify
 the terms of any separate license agreement you may have executed
 with Licensor regarding such Contributions.

 6. Trademarks. This License does not grant permission to use the trade
 names, trademarks, service marks, or product names of the Licensor,
 except as required for reasonable and customary use in describing the
 origin of the Work and reproducing the content of the NOTICE file.

 7. Disclaimer of Warranty. Unless required by applicable law or
 agreed to in writing, Licensor provides the Work (and each
 Contributor provides its Contributions) on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or
 implied, including, without limitation, any warranties or conditions
 of TITLE, NON-INFRINGEMENT, MERCHANTABILITY, or FITNESS FOR A
 PARTICULAR PURPOSE. You are solely responsible for determining the
 appropriateness of using or redistributing the Work and assume any
 risks associated with Your exercise of permissions under this License.

 8. Limitation of Liability. In no event and under no legal theory,
 whether in tort (including negligence), contract, or otherwise,
 unless required by applicable law (such as deliberate and grossly
 negligent acts) or agreed to in writing, shall any Contributor be
 liable to You for damages, including any direct, indirect, special,
 incidental, or consequential damages of any character arising as a
 result of this License or out of the use or inability to use the
 Work (including but not limited to damages for loss of goodwill,
 work stoppage, computer failure or malfunction, or any and all
 other commercial damages or losses), even if such Contributor
 has been advised of the possibility of such damages.

 9. Accepting Warranty or Additional Liability. While redistributing
 the Work or Derivative Works thereof, You may choose to offer,
 and charge a fee for, acceptance of support, warranty, indemnity,
 or other liability obligations and/or rights consistent with this
 License. However, in accepting such obligations, You may act only
 on Your own behalf and on Your sole responsibility, not on behalf
 of any other Contributor, and only if You agree to indemnify,
 defend, and hold each Contributor harmless for any liability
 incurred by, or claims asserted against, such Contributor by reason
 of your accepting any such warranty or additional liability.

 END OF TERMS AND CONDITIONS

 APPENDIX: How to apply the Apache License to your work.

 To apply the Apache License to your work, attach the following
 boilerplate notice, with the fields enclosed by brackets "{}"
 replaced with your own identifying information. (Don't include
 the brackets!)  The text should be enclosed in the appropriate
 comment syntax for the file format. We also recommend that a
 file or class name and description of purpose be included on the
 same "printed page" as the copyright notice for easier
 identification within third-party archives.

 Copyright (C) 2013-present   SheetJS LLC

 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

 http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 */
var kc=Math;function _c(e,t){for(var r=0,n=0;r<e.length;++r)n=t*n+e[r];return n}function Uc(e,t,r,n,a){if(0===t)return r;if(1===t)return n;for(var s=2/e,i=n,o=1;o<t;++o)i=n*o*s+a*r,r=n,n=i;return i}function xc(e,t,r,n,a){return function(r,s){if(n){if(0===r)return 1==n?-1/0:1/0;if(r<0)return NaN}if(0===s)return e(r);if(1===s)return t(r);if(s<0)return NaN;s|=0;var i=e(r),o=t(r);return Uc(r,s,i,o,a)}}var Fc=function(){var e=.636619772,t=[57568490574,-13362590354,651619640.7,-11214424.18,77392.33017,-184.9052456].reverse(),r=[57568490411,1029532985,9494680.718,59272.64853,267.8532712,1].reverse(),n=[1,-.001098628627,2734510407e-14,-2073370639e-15,2.093887211e-7].reverse(),a=[-.01562499995,.0001430488765,-6911147651e-15,7.621095161e-7,-9.34935152e-8].reverse();function s(s){var i=0,o=0,c=0,l=s*s;if(s<8)o=_c(t,l),c=_c(r,l),i=o/c;else{var u=s-.785398164;l=64/l,o=_c(n,l),c=_c(a,l),i=kc.sqrt(e/s)*(kc.cos(u)*o-kc.sin(u)*c*8/s)}return i}var i=[72362614232,-7895059235,242396853.1,-2972611.439,15704.4826,-30.16036606].reverse(),o=[144725228442,2300535178,18583304.74,99447.43394,376.9991397,1].reverse(),c=[1,.00183105,-3516396496e-14,2457520174e-15,-2.40337019e-7].reverse(),l=[.04687499995,-.0002002690873,8449199096e-15,-8.8228987e-7,1.05787412e-7].reverse();function u(t){var r=0,n=0,a=0,s=t*t,u=kc.abs(t)-2.356194491;return Math.abs(t)<8?(n=t*_c(i,s),a=_c(o,s),r=n/a):(s=64/s,n=_c(c,s),a=_c(l,s),r=kc.sqrt(e/kc.abs(t))*(kc.cos(u)*n-kc.sin(u)*a*8/kc.abs(t)),t<0&&(r=-r)),r}return function e(t,r){if(r=Math.round(r),!isFinite(t))return isNaN(t)?t:0;if(r<0)return(r%2?-1:1)*e(t,-r);if(t<0)return(r%2?-1:1)*e(-t,r);if(0===r)return s(t);if(1===r)return u(t);if(0===t)return 0;var n=0;if(t>r)n=Uc(t,r,s(t),u(t),-1);else{for(var a=2*kc.floor((r+kc.floor(kc.sqrt(40*r)))/2),i=!1,o=0,c=0,l=1,h=0,f=2/t,d=a;d>0;d--)h=d*f*l-o,o=l,l=h,kc.abs(l)>1e10&&(l*=1e-10,o*=1e-10,n*=1e-10,c*=1e-10),i&&(c+=l),i=!i,d==r&&(n=o);c=2*c-l,n/=c}return n}}(),Pc=function(){var e=.636619772,t=[-2957821389,7062834065,-512359803.6,10879881.29,-86327.92757,228.4622733].reverse(),r=[40076544269,745249964.8,7189466.438,47447.2647,226.1030244,1].reverse(),n=[1,-.001098628627,2734510407e-14,-2073370639e-15,2.093887211e-7].reverse(),a=[-.01562499995,.0001430488765,-6911147651e-15,7.621095161e-7,-9.34945152e-8].reverse();function s(s){var i=0,o=0,c=0,l=s*s,u=s-.785398164;return s<8?(o=_c(t,l),c=_c(r,l),i=o/c+e*Fc(s,0)*kc.log(s)):(l=64/l,o=_c(n,l),c=_c(a,l),i=kc.sqrt(e/s)*(kc.sin(u)*o+kc.cos(u)*c*8/s)),i}var i=[-4900604943e3,127527439e4,-51534381390,734926455.1,-4237922.726,8511.937935].reverse(),o=[249958057e5,424441966400,3733650367,22459040.02,102042.605,354.9632885,1].reverse(),c=[1,.00183105,-3516396496e-14,2457520174e-15,-2.40337019e-7].reverse(),l=[.04687499995,-.0002002690873,8449199096e-15,-8.8228987e-7,1.05787412e-7].reverse();function u(t){var r=0,n=0,a=0,s=t*t,u=t-2.356194491;return t<8?(n=t*_c(i,s),a=_c(o,s),r=n/a+e*(Fc(t,1)*kc.log(t)-1/t)):(s=64/s,n=_c(c,s),a=_c(l,s),r=kc.sqrt(e/t)*(kc.sin(u)*n+kc.cos(u)*a*8/t)),r}return xc(s,u,"BESSELY",1,-1)}(),Bc=function(){var e=[1,3.5156229,3.0899424,1.2067492,.2659732,.0360768,.0045813].reverse(),t=[.39894228,.01328592,.00225319,-.00157565,.00916281,-.02057706,.02635537,-.01647633,.00392377].reverse();function r(r){return r<=3.75?_c(e,r*r/14.0625):kc.exp(kc.abs(r))/kc.sqrt(kc.abs(r))*_c(t,3.75/kc.abs(r))}var n=[.5,.87890594,.51498869,.15084934,.02658733,.00301532,32411e-8].reverse(),a=[.39894228,-.03988024,-.00362018,.00163801,-.01031555,.02282967,-.02895312,.01787654,-.00420059].reverse();function s(e){return e<3.75?e*_c(n,e*e/14.0625):(e<0?-1:1)*kc.exp(kc.abs(e))/kc.sqrt(kc.abs(e))*_c(a,3.75/kc.abs(e))}return function e(t,n){if(n=Math.round(n),0===n)return r(t);if(1===n)return s(t);if(n<0)return NaN;if(0===kc.abs(t))return 0;if(t==1/0)return 1/0;var a,i=0,o=2/kc.abs(t),c=0,l=1,u=0,h=2*kc.round((n+kc.round(kc.sqrt(40*n)))/2);for(a=h;a>0;a--)u=a*o*l+c,c=l,l=u,kc.abs(l)>1e10&&(l*=1e-10,c*=1e-10,i*=1e-10),a==n&&(i=c);return i*=e(t,0)/l,t<0&&n%2?-i:i}}(),Yc=function(){var e=[-.57721566,.4227842,.23069756,.0348859,.00262698,1075e-7,74e-7].reverse(),t=[1.25331414,-.07832358,.02189568,-.01062446,.00587872,-.0025154,53208e-8].reverse();function r(r){return r<=2?-kc.log(r/2)*Bc(r,0)+_c(e,r*r/4):kc.exp(-r)/kc.sqrt(r)*_c(t,2/r)}var n=[1,.15443144,-.67278579,-.18156897,-.01919402,-.00110404,-4686e-8].reverse(),a=[1.25331414,.23498619,-.0365562,.01504268,-.00780353,.00325614,-68245e-8].reverse();function s(e){return e<=2?kc.log(e/2)*Bc(e,1)+1/e*_c(n,e*e/4):kc.exp(-e)/kc.sqrt(e)*_c(a,2/e)}return xc(r,s,"BESSELK",2,1)}();
/**
 * @license
 Copyright (c) 2013 jStat

 Permission is hereby granted, free of charge, to any person obtaining a copy
 of this software and associated documentation files (the "Software"), to deal
 in the Software without restriction, including without limitation the rights
 to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 copies of the Software, and to permit persons to whom the Software is
 furnished to do so, subject to the following conditions:

 The above copyright notice and this permission notice shall be included in
 all copies or substantial portions of the Software.

 THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 THE SOFTWARE.
 */
function Vc(e){const t=[-1.3026537197817094,.6419697923564902,.019476473204185836,-.00956151478680863,-.000946595344482036,.000366839497852761,42523324806907e-18,-20278578112534e-18,-1624290004647e-18,130365583558e-17,1.5626441722e-8,-8.5238095915e-8,6.529054439e-9,5.059343495e-9,-9.91364156e-10,-2.27365122e-10,96467911e-18,2394038e-18,-6886027e-18,894487e-18,313092e-18,-112708e-18,381e-18,7106e-18,-1523e-18,-94e-18,121e-18,-28e-18];let r,n,a,s,i=t.length-1,o=!1,c=0,l=0;if(0===e)return 0;for(e<0&&(e=-e,o=!0),r=2/(2+e),n=4*r-2;i>0;i--)a=c,c=n*c-l+t[i],l=a;return s=r*Math.exp(-e*e+.5*(t[0]+n*c)-l),o?s-1:1-s}function Wc(e){return 1-Vc(e)}function Gc(e){let t,r,n,a,s=0;if(e>=2)return-100;if(e<=0)return 100;for(a=e<1?e:2-e,n=Math.sqrt(-2*Math.log(a/2)),t=-.70711*((2.30753+.27061*n)/(1+n*(.99229+.04481*n))-n);s<2;s++)r=Wc(t)-a,t+=r/(1.1283791670955126*Math.exp(-t*t)-t*r);return e<1?t:-t}const Hc={pdf:(e,t)=>e<0?0:t*Math.exp(-t*e),cdf:(e,t)=>e<0?0:1-Math.exp(-t*e)};function zc(e){const t=[-1.716185138865495,24.76565080557592,-379.80425647094563,629.3311553128184,866.9662027904133,-31451.272968848367,-36144.413418691176,66456.14382024054],r=[-30.8402300119739,315.35062697960416,-1015.1563674902192,-3107.771671572311,22538.11842098015,4755.846277527881,-134659.9598649693,-115132.2596755535];let n,a,s,i,o=!1,c=0,l=0,u=0,h=e;if(e>171.6243769536076)return 1/0;if(h<=0){if(i=h%1,!i)return 1/0;o=(1&h?-1:1)*Math.PI/Math.sin(Math.PI*i),h=1-h}for(s=h,a=h<1?h++:(h-=c=(0|h)-1)-1,n=0;n<8;++n)u=(u+t[n])*a,l=l*a+r[n];if(i=u/l+1,s<h)i/=s;else if(s>h)for(n=0;n<c;++n)i*=h,h++;return o&&(i=o/i),i}const $c={pdf:function(e,t,r){return e<0?0:0===e&&1===t?1/r:Math.exp((t-1)*Math.log(e)-e/r-jc(t)-t*Math.log(r))},cdf:function(e,t,r){return e<0?0:Xc(t,e/r)},inv:function(e,t,r){return Kc(e,t)*r}};function jc(e){let t=0;const r=[76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18];let n,a,s,i=1.000000000190015;for(s=(a=n=e)+5.5,s-=(n+.5)*Math.log(s);t<6;t++)i+=r[t]/++a;return Math.log(2.5066282746310007*i/n)-s}function Xc(e,t){const r=jc(e);let n=e,a=1/e,s=a,i=t+1-e,o=1/1e-30,c=1/i,l=c,u=1;const h=-~(8.5*Math.log(e>=1?e:1/e)+.4*e+17);let f;if(t<0||e<=0)return NaN;if(t<e+1){for(;u<=h;u++)a+=s*=t/++n;return a*Math.exp(-t+e*Math.log(t)-r)}for(;u<=h;u++)f=-u*(u-e),i+=2,c=f*c+i,o=i+f/o,c=1/c,l*=c*o;return 1-l*Math.exp(-t+e*Math.log(t)-r)}function Kc(e,t){let r=0;const n=t-1,a=1e-8,s=jc(t);let i,o,c,l,u,h,f;if(e>=1)return Math.max(100,t+100*Math.sqrt(t));if(e<=0)return 0;for(t>1?(h=Math.log(n),f=Math.exp(n*(h-1)-s),u=e<.5?e:1-e,c=Math.sqrt(-2*Math.log(u)),i=(2.30753+.27061*c)/(1+c*(.99229+.04481*c))-c,e<.5&&(i=-i),i=Math.max(.001,t*Math.pow(1-1/(9*t)-i/(3*Math.sqrt(t)),3))):(c=1-t*(.253+.12*t),i=e<c?Math.pow(e/c,1/t):1-Math.log(1-(e-c)/(1-c)));r<12;r++){if(i<=0)return 0;if(o=Xc(t,i)-e,c=t>1?f*Math.exp(-(i-n)+n*(Math.log(i)-h)):Math.exp(-i+n*Math.log(i)-s),l=o/c,i-=c=l/(1-.5*Math.min(1,l*((t-1)/i-1))),i<=0&&(i=.5*(i+c)),Math.abs(c)<a*i)break}return i}const qc={pdf:function(e,t,r){return Math.exp(-.5*Math.log(2*Math.PI)-Math.log(r)-Math.pow(e-t,2)/(2*r*r))},cdf:function(e,t,r){return.5*(1+Vc((e-t)/Math.sqrt(2*r*r)))},inv:function(e,t,r){return-1.4142135623730951*r*Gc(2*e)+t}},Jc={pdf:function(e,t,r){return e>1||e<0?0:1==t&&1==r?1:t<512&&r<512?Math.pow(e,t-1)*Math.pow(1-e,r-1)/Qc(t,r):Math.exp((t-1)*Math.log(e)+(r-1)*Math.log(1-e)-Zc(t,r))},cdf:function(e,t,r){return e>1||e<0?+(e>1):tl(e,t,r)},inv:function(e,t,r){return el(e,t,r)}};function Qc(e,t){if(!(e<=0||t<=0))return e+t>170?Math.exp(Zc(e,t)):zc(e)*zc(t)/zc(e+t)}function Zc(e,t){return jc(e)+jc(t)-jc(e+t)}function el(e,t,r){var n,a,s,i,o,c,l,u,h,f,d,p=1e-8,m=t-1,g=r-1,E=0;if(e<=0)return 0;if(e>=1)return 1;for(t>=1&&r>=1?(s=e<.5?e:1-e,i=Math.sqrt(-2*Math.log(s)),l=(2.30753+.27061*i)/(1+i*(.99229+.04481*i))-i,e<.5&&(l=-l),u=(l*l-3)/6,h=2/(1/(2*t-1)+1/(2*r-1)),f=l*Math.sqrt(u+h)/h-(1/(2*r-1)-1/(2*t-1))*(u+5/6-2/(3*h)),l=t/(t+r*Math.exp(2*f))):(n=Math.log(t/(t+r)),a=Math.log(r/(t+r)),i=Math.exp(t*n)/t,o=Math.exp(r*a)/r,f=i+o,l=e<i/f?Math.pow(t*f*e,1/t):1-Math.pow(r*f*(1-e),1/r)),d=-jc(t)-jc(r)+jc(t+r);E<10;E++){if(0===l||1===l)return l;if(c=tl(l,t,r)-e,i=Math.exp(m*Math.log(l)+g*Math.log(1-l)+d),o=c/i,l-=i=o/(1-.5*Math.min(1,o*(m/l-g/(1-l)))),l<=0&&(l=.5*(l+i)),l>=1&&(l=.5*(l+i+1)),Math.abs(i)<p*l&&E>0)break}return l}function tl(e,t,r){var n=0===e||1===e?0:Math.exp(jc(t+r)-jc(t)-jc(r)+t*Math.log(e)+r*Math.log(1-e));return!(e<0||e>1)&&(e<(t+1)/(t+r+2)?n*rl(e,t,r)/t:1-n*rl(1-e,r,t)/r)}function rl(e,t,r){var n,a,s,i,o=1e-30,c=1,l=t+r,u=t+1,h=t-1,f=1,d=1-l*e/u;for(Math.abs(d)<o&&(d=o),d=1/d,i=d;c<=100;c++)if(n=2*c,a=c*(r-c)*e/((h+n)*(t+n)),d=1+a*d,Math.abs(d)<o&&(d=o),f=1+a/f,Math.abs(f)<o&&(f=o),d=1/d,i*=d*f,a=-(t+c)*(l+c)*e/((t+n)*(u+n)),d=1+a*d,Math.abs(d)<o&&(d=o),f=1+a/f,Math.abs(f)<o&&(f=o),d=1/d,s=d*f,i*=s,Math.abs(s-1)<3e-7)break;return i}const nl={pdf:function(e,t,r){return 0===r||1===r?t*r===e?1:0:sl(t,e)*Math.pow(r,e)*Math.pow(1-r,t-e)},cdf:function(e,t,r){var n,a=1e-10;if(e<0)return 0;if(e>=t)return 1;if(r<0||r>1||t<=0)return NaN;e=Math.floor(e);var s=r,i=e+1,o=t-e,c=i+o,l=Math.exp(jc(c)-jc(o)-jc(i)+i*Math.log(s)+o*Math.log(1-s));return n=s<(i+1)/(c+2)?l*al(s,i,o,a):1-l*al(1-s,o,i,a),Math.round(1/a*(1-n))/(1/a)}};function al(e,t,r,n){var a,s=0,i=1,o=1,c=1,l=0,u=0;while(Math.abs((o-u)/o)>n)u=o,a=-(t+l)*(t+r+l)*e/(t+2*l)/(t+2*l+1),s=o+a*s,i=c+a*i,l+=1,a=l*(r-l)*e/(t+2*l-1)/(t+2*l),o=s+a*o,c=i+a*c,s/=c,i/=c,o/=c,c=1;return o/t}function sl(e,t){return e>170||t>170?Math.exp(il(e,t)):cl(e)/cl(t)/cl(e-t)}function il(e,t){return ol(e)-ol(t)-ol(e-t)}function ol(e){return e<0?NaN:jc(e+1)}function cl(e){return e<0?NaN:zc(e+1)}const ll={pdf:function(e,t){return e<0?0:0===e&&2===t?.5:Math.exp((t/2-1)*Math.log(e)-e/2-t/2*Math.log(2)-jc(t/2))},cdf:function(e,t){return e<0?0:Xc(t/2,e/2)},inv:function(e,t){return 2*Kc(e,.5*t)}},ul={pdf:function(e,t,r){var n,a,s;return e<0?0:t<=2?0===e&&t<2?1/0:0===e&&2===t?1:1/Qc(t/2,r/2)*Math.pow(t/r,t/2)*Math.pow(e,t/2-1)*Math.pow(1+t/r*e,-(t+r)/2):(n=t*e/(r+e*t),a=r/(r+e*t),s=t*a/2,s*nl.pdf((t-2)/2,(t+r-2)/2,n))},cdf:function(e,t,r){return e<0?0:tl(t*e/(t*e+r),t/2,r/2)},inv:function(e,t,r){return r/(t*(1/el(e,t/2,r/2)-1))}},hl={pdf:function(e,t,r){return e<0||t<0||r<0?0:r/t*Math.pow(e/t,r-1)*Math.exp(-Math.pow(e/t,r))},cdf:function(e,t,r){return e<0?0:1-Math.exp(-Math.pow(e/t,r))}},fl={pdf:function(e,t){return t<0||e%1!==0||e<0?0:Math.pow(t,e)*Math.exp(-t)/cl(e)},cdf:function(e,t){var r=0;if(e<0)return 0;for(var n=0;r<=e;r++)n+=fl.pdf(r,t);return n}},dl={pdf:function(e,t,r,n){if(e<0||e<r-(t-n))return 0;if(e>n||e>r)return 0;if(2*r>t)return 2*n>t?dl.pdf(t-r-n+e,t,t-r,t-n):dl.pdf(n-e,t,t-r,n);if(2*n>t)return dl.pdf(r-e,t,r,t-n);if(r<n)return dl.pdf(e,t,n,r);for(var a=1,s=0,i=0;i<e;i++){while(a>1&&s<n)a*=1-r/(t-s),s++;a*=(n-i)*(r-i)/((i+1)*(t-r-n+i+1))}for(;s<n;s++)a*=1-r/(t-s);return Math.min(1,Math.max(0,a))},cdf:function e(t,r,n,a){if(t<0||t<n-(r-a))return 0;if(t>=a||t>=n)return 1;if(2*n>r)return 2*a>r?e(r-n-a+t,r,r-n,r-a):1-dl.cdf(a-t-1,r,r-n,a);if(2*a>r)return 1-dl.cdf(n-t-1,r,n,r-a);if(n<a)return dl.cdf(t,r,a,n);for(var s=1,i=1,o=0,c=0;c<t;c++){while(s>1&&o<a){var l=1-n/(r-o);i*=l,s*=l,o++}i*=(a-c)*(n-c)/((c+1)*(r-n-a+c+1)),s+=i}for(;o<a;o++)s*=1-n/(r-o);return Math.min(1,Math.max(0,s))}},pl={pdf:function(e,t){return t=t>1e100?1e100:t,1/(Math.sqrt(t)*Qc(.5,t/2))*Math.pow(1+e*e/t,-(t+1)/2)},cdf:function(e,t){var r=t/2;return tl((e+Math.sqrt(e*e+t))/(2*Math.sqrt(e*e+t)),r,r)},inv:function(e,t){var r=el(2*Math.min(e,1-e),.5*t,.5);return r=Math.sqrt(t*(1-r)/r),e>.5?r:-r}},ml={pdf:function(e,t,r){return e<=0?0:Math.exp(-Math.log(e)-.5*Math.log(2*Math.PI)-Math.log(r)-Math.pow(Math.log(e)-t,2)/(2*r*r))},cdf:function(e,t,r){return e<0?0:.5+.5*Vc((Math.log(e)-t)/Math.sqrt(2*r*r))},inv:function(e,t,r){return Math.exp(-1.4142135623730951*r*Gc(2*e)+t)}},gl={pdf:function(e,t,r){return e===e>>>0&&(e<0?0:sl(e+t-1,t-1)*Math.pow(1-r,e)*Math.pow(r,t))},cdf:function(e,t,r){var n=0,a=0;if(e<0)return 0;for(;a<=e;a++)n+=gl.pdf(a,t,r);return n}};function El(e){var t=0,r=e.length;while(--r>=0)t+=e[r];return t}function vl(e){return El(e)/e.length}function Tl(e){var t,r=vl(e),n=0,a=e.length;while(--a>=0)t=e[a]-r,n+=t*t;return n}function Sl(e,t){return Tl(e)/(e.length-(t?1:0))}function Al(e,t){return Math.sqrt(Sl(e,t))}function Rl(){var e,t=[].slice.call(arguments),r=new Array(2);return e=4===t.length?Math.abs(qc.inv(t[1]/2,0,1)*t[2]/Math.sqrt(t[3])):Math.abs(qc.inv(t[1]/2,0,1)*Al(t[2])/Math.sqrt(t[2].length)),r[0]=t[0]-e,r[1]=t[0]+e,r}function yl(){var e,t=[].slice.call(arguments),r=new Array(2);return e=4===t.length?Math.abs(pl.inv(t[1]/2,t[3]-1)*t[2]/Math.sqrt(t[3])):Math.abs(pl.inv(t[1]/2,t[2].length-1)*Al(t[2],!0)/Math.sqrt(t[2].length)),r[0]=t[0]-e,r[1]=t[0]+e,r}function Nl(e){var t=1,r=e.length;while(--r>=0)t*=e[r];return t}function wl(e){return Math.pow(Nl(e),1/e.length)}function bl(e,t){var r,n=vl(e),a=vl(t),s=e.length,i=new Array(s);for(r=0;r<s;r++)i[r]=(e[r]-n)*(t[r]-a);return El(i)/(s-1)}function Cl(e,t){return bl(e,t)/Al(e,1)/Al(t,1)}
/**
 * @license
 * Copyright (c) 2022 Handsoncode. All rights reserved.
 */
class Ol extends Wr{erf(e,t){return this.runFunction(e.args,t,this.metadata("ERF"),((e,t)=>void 0===t?Vc(e):Vc(t)-Vc(e)))}erfc(e,t){return this.runFunction(e.args,t,this.metadata("ERFC"),Wc)}expondist(e,t){return this.runFunction(e.args,t,this.metadata("EXPON.DIST"),((e,t,r)=>r?Hc.cdf(e,t):Hc.pdf(e,t)))}fisher(e,t){return this.runFunction(e.args,t,this.metadata("FISHER"),(e=>Math.log((1+e)/(1-e))/2))}fisherinv(e,t){return this.runFunction(e.args,t,this.metadata("FISHERINV"),(e=>1-2/(Math.exp(2*e)+1)))}gamma(e,t){return this.runFunction(e.args,t,this.metadata("GAMMA"),zc)}gammadist(e,t){return this.runFunction(e.args,t,this.metadata("GAMMA.DIST"),((e,t,r,n)=>n?$c.cdf(e,t,r):$c.pdf(e,t,r)))}gammaln(e,t){return this.runFunction(e.args,t,this.metadata("GAMMALN"),jc)}gammainv(e,t){return this.runFunction(e.args,t,this.metadata("GAMMA.INV"),$c.inv)}gauss(e,t){return this.runFunction(e.args,t,this.metadata("GAUSS"),(e=>qc.cdf(e,0,1)-.5))}betadist(e,t){return this.runFunction(e.args,t,this.metadata("BETA.DIST"),((e,t,r,n,a,s)=>e<=a?new Fn(En.NUM,It.ValueSmall):e>=s?new Fn(En.NUM,It.ValueLarge):(e=(e-a)/(s-a),n?Jc.cdf(e,t,r):Jc.pdf(e,t,r))))}betainv(e,t){return this.runFunction(e.args,t,this.metadata("BETA.INV"),((e,t,r,n,a)=>n>=a?new Fn(En.NUM,It.WrongOrder):Jc.inv(e,t,r)*(a-n)+n))}binomialdist(e,t){return this.runFunction(e.args,t,this.metadata("BINOM.DIST"),((e,t,r,n)=>e>t?new Fn(En.NUM,It.WrongOrder):(e=Math.trunc(e),t=Math.trunc(t),n?nl.cdf(e,t,r):nl.pdf(e,t,r))))}binomialinv(e,t){return this.runFunction(e.args,t,this.metadata("BINOM.INV"),((e,t,r)=>{e=Math.trunc(e);let n=-1,a=e;while(a>n+1){const s=Math.trunc((n+a)/2);nl.cdf(s,e,t)>=r?a=s:n=s}return a}))}besselifn(e,t){return this.runFunction(e.args,t,this.metadata("BESSELI"),((e,t)=>Bc(e,Math.trunc(t))))}besseljfn(e,t){return this.runFunction(e.args,t,this.metadata("BESSELJ"),((e,t)=>Fc(e,Math.trunc(t))))}besselkfn(e,t){return this.runFunction(e.args,t,this.metadata("BESSELK"),((e,t)=>Yc(e,Math.trunc(t))))}besselyfn(e,t){return this.runFunction(e.args,t,this.metadata("BESSELY"),((e,t)=>Pc(e,Math.trunc(t))))}chisqdist(e,t){return this.runFunction(e.args,t,this.metadata("CHISQ.DIST"),((e,t,r)=>(t=Math.trunc(t),r?ll.cdf(e,t):ll.pdf(e,t))))}chisqdistrt(e,t){return this.runFunction(e.args,t,this.metadata("CHISQ.DIST.RT"),((e,t)=>1-ll.cdf(e,Math.trunc(t))))}chisqinv(e,t){return this.runFunction(e.args,t,this.metadata("CHISQ.INV"),((e,t)=>ll.inv(e,Math.trunc(t))))}chisqinvrt(e,t){return this.runFunction(e.args,t,this.metadata("CHISQ.INV.RT"),((e,t)=>ll.inv(1-e,Math.trunc(t))))}fdist(e,t){return this.runFunction(e.args,t,this.metadata("F.DIST"),((e,t,r,n)=>(t=Math.trunc(t),r=Math.trunc(r),n?ul.cdf(e,t,r):ul.pdf(e,t,r))))}fdistrt(e,t){return this.runFunction(e.args,t,this.metadata("F.DIST.RT"),((e,t,r)=>1-ul.cdf(e,Math.trunc(t),Math.trunc(r))))}finv(e,t){return this.runFunction(e.args,t,this.metadata("F.INV"),((e,t,r)=>ul.inv(e,Math.trunc(t),Math.trunc(r))))}finvrt(e,t){return this.runFunction(e.args,t,this.metadata("F.INV.RT"),((e,t,r)=>ul.inv(1-e,Math.trunc(t),Math.trunc(r))))}weibulldist(e,t){return this.runFunction(e.args,t,this.metadata("WEIBULL.DIST"),((e,t,r,n)=>n?hl.cdf(e,r,t):hl.pdf(e,r,t)))}poissondist(e,t){return this.runFunction(e.args,t,this.metadata("POISSON.DIST"),((e,t,r)=>(e=Math.trunc(e),r?fl.cdf(e,t):fl.pdf(e,t))))}hypgeomdist(e,t){return this.runFunction(e.args,t,this.metadata("HYPGEOM.DIST"),((e,t,r,n,a)=>e>t||e>r||t>n||r>n||e+n<r+t?new Fn(En.NUM,It.ValueLarge):(e=Math.trunc(e),t=Math.trunc(t),r=Math.trunc(r),n=Math.trunc(n),a?dl.cdf(e,n,r,t):dl.pdf(e,n,r,t))))}tdist(e,t){return this.runFunction(e.args,t,this.metadata("T.DIST"),((e,t,r)=>(t=Math.trunc(t),r?pl.cdf(e,t):pl.pdf(e,t))))}tdist2t(e,t){return this.runFunction(e.args,t,this.metadata("T.DIST.2T"),((e,t)=>2*(1-pl.cdf(e,Math.trunc(t)))))}tdistrt(e,t){return this.runFunction(e.args,t,this.metadata("T.DIST.RT"),((e,t)=>1-pl.cdf(e,Math.trunc(t))))}tdistold(e,t){return this.runFunction(e.args,t,this.metadata("TDIST"),((e,t,r)=>r*(1-pl.cdf(e,Math.trunc(t)))))}tinv(e,t){return this.runFunction(e.args,t,this.metadata("T.INV"),((e,t)=>pl.inv(e,Math.trunc(t))))}tinv2t(e,t){return this.runFunction(e.args,t,this.metadata("T.INV.2T"),((e,t)=>pl.inv(1-e/2,Math.trunc(t))))}lognormdist(e,t){return this.runFunction(e.args,t,this.metadata("LOGNORM.DIST"),((e,t,r,n)=>n?ml.cdf(e,t,r):ml.pdf(e,t,r)))}lognorminv(e,t){return this.runFunction(e.args,t,this.metadata("LOGNORM.INV"),((e,t,r)=>ml.inv(e,t,r)))}normdist(e,t){return this.runFunction(e.args,t,this.metadata("NORM.DIST"),((e,t,r,n)=>n?qc.cdf(e,t,r):qc.pdf(e,t,r)))}norminv(e,t){return this.runFunction(e.args,t,this.metadata("NORM.INV"),((e,t,r)=>qc.inv(e,t,r)))}normsdist(e,t){return this.runFunction(e.args,t,this.metadata("NORM.S.DIST"),((e,t)=>t?qc.cdf(e,0,1):qc.pdf(e,0,1)))}normsinv(e,t){return this.runFunction(e.args,t,this.metadata("NORM.S.INV"),(e=>qc.inv(e,0,1)))}phi(e,t){return this.runFunction(e.args,t,this.metadata("PHI"),(e=>qc.pdf(e,0,1)))}negbinomdist(e,t){return this.runFunction(e.args,t,this.metadata("NEGBINOM.DIST"),((e,t,r,n)=>(e=Math.trunc(e),t=Math.trunc(t),n?gl.cdf(e,t,r):gl.pdf(e,t,r))))}confidencenorm(e,t){return this.runFunction(e.args,t,this.metadata("CONFIDENCE.NORM"),((e,t,r)=>Rl(1,e,t,Math.trunc(r))[1]-1))}confidencet(e,t){return this.runFunction(e.args,t,this.metadata("CONFIDENCE.T"),((e,t,r)=>(r=Math.trunc(r),1===r?new Fn(En.DIV_BY_ZERO):yl(1,e,t,r)[1]-1)))}standardize(e,t){return this.runFunction(e.args,t,this.metadata("STANDARDIZE"),((e,t,r)=>(e-t)/r))}}Ol.implementedFunctions={ERF:{method:"erf",parameters:[{argumentType:Yr.NUMBER},{argumentType:Yr.NUMBER,optionalArg:!0}]},ERFC:{method:"erfc",parameters:[{argumentType:Yr.NUMBER}]},"EXPON.DIST":{method:"expondist",parameters:[{argumentType:Yr.NUMBER,minValue:0},{argumentType:Yr.NUMBER,greaterThan:0},{argumentType:Yr.BOOLEAN}]},FISHER:{method:"fisher",parameters:[{argumentType:Yr.NUMBER,greaterThan:-1,lessThan:1}]},FISHERINV:{method:"fisherinv",parameters:[{argumentType:Yr.NUMBER}]},GAMMA:{method:"gamma",parameters:[{argumentType:Yr.NUMBER}]},"GAMMA.DIST":{method:"gammadist",parameters:[{argumentType:Yr.NUMBER,minValue:0},{argumentType:Yr.NUMBER,greaterThan:0},{argumentType:Yr.NUMBER,greaterThan:0},{argumentType:Yr.BOOLEAN}]},GAMMALN:{method:"gammaln",parameters:[{argumentType:Yr.NUMBER,greaterThan:0}]},"GAMMA.INV":{method:"gammainv",parameters:[{argumentType:Yr.NUMBER,minValue:0,lessThan:1},{argumentType:Yr.NUMBER,greaterThan:0},{argumentType:Yr.NUMBER,greaterThan:0}]},GAUSS:{method:"gauss",parameters:[{argumentType:Yr.NUMBER}]},"BETA.DIST":{method:"betadist",parameters:[{argumentType:Yr.NUMBER},{argumentType:Yr.NUMBER,greaterThan:0},{argumentType:Yr.NUMBER,greaterThan:0},{argumentType:Yr.BOOLEAN},{argumentType:Yr.NUMBER,defaultValue:0},{argumentType:Yr.NUMBER,defaultValue:1}]},"BETA.INV":{method:"betainv",parameters:[{argumentType:Yr.NUMBER,greaterThan:0,maxValue:1},{argumentType:Yr.NUMBER,greaterThan:0},{argumentType:Yr.NUMBER,greaterThan:0},{argumentType:Yr.NUMBER,defaultValue:0},{argumentType:Yr.NUMBER,defaultValue:1}]},"BINOM.DIST":{method:"binomialdist",parameters:[{argumentType:Yr.NUMBER,minValue:0},{argumentType:Yr.NUMBER,minValue:0},{argumentType:Yr.NUMBER,minValue:0,maxValue:1},{argumentType:Yr.BOOLEAN}]},"BINOM.INV":{method:"binomialinv",parameters:[{argumentType:Yr.NUMBER,minValue:0},{argumentType:Yr.NUMBER,minValue:0,maxValue:1},{argumentType:Yr.NUMBER,greaterThan:0,lessThan:1}]},BESSELI:{method:"besselifn",parameters:[{argumentType:Yr.NUMBER},{argumentType:Yr.NUMBER,minValue:0}]},BESSELJ:{method:"besseljfn",parameters:[{argumentType:Yr.NUMBER},{argumentType:Yr.NUMBER,minValue:0}]},BESSELK:{method:"besselkfn",parameters:[{argumentType:Yr.NUMBER},{argumentType:Yr.NUMBER,minValue:0}]},BESSELY:{method:"besselyfn",parameters:[{argumentType:Yr.NUMBER},{argumentType:Yr.NUMBER,minValue:0}]},"CHISQ.DIST":{method:"chisqdist",parameters:[{argumentType:Yr.NUMBER},{argumentType:Yr.NUMBER,minValue:1,maxValue:1e10},{argumentType:Yr.BOOLEAN}]},"CHISQ.DIST.RT":{method:"chisqdistrt",parameters:[{argumentType:Yr.NUMBER},{argumentType:Yr.NUMBER,minValue:1,maxValue:1e10}]},"CHISQ.INV":{method:"chisqinv",parameters:[{argumentType:Yr.NUMBER,minValue:0,maxValue:1},{argumentType:Yr.NUMBER,minValue:1,maxValue:1e10}]},"CHISQ.INV.RT":{method:"chisqinvrt",parameters:[{argumentType:Yr.NUMBER,minValue:0,maxValue:1},{argumentType:Yr.NUMBER,minValue:1}]},"F.DIST":{method:"fdist",parameters:[{argumentType:Yr.NUMBER,minValue:0},{argumentType:Yr.NUMBER,minValue:1},{argumentType:Yr.NUMBER,minValue:1},{argumentType:Yr.BOOLEAN}]},"F.DIST.RT":{method:"fdistrt",parameters:[{argumentType:Yr.NUMBER,minValue:0},{argumentType:Yr.NUMBER,minValue:1},{argumentType:Yr.NUMBER,minValue:1}]},"F.INV":{method:"finv",parameters:[{argumentType:Yr.NUMBER,minValue:0,maxValue:1},{argumentType:Yr.NUMBER,minValue:1},{argumentType:Yr.NUMBER,minValue:1}]},"F.INV.RT":{method:"finvrt",parameters:[{argumentType:Yr.NUMBER,minValue:0,maxValue:1},{argumentType:Yr.NUMBER,minValue:1},{argumentType:Yr.NUMBER,minValue:1}]},"WEIBULL.DIST":{method:"weibulldist",parameters:[{argumentType:Yr.NUMBER,minValue:0},{argumentType:Yr.NUMBER,greaterThan:0},{argumentType:Yr.NUMBER,greaterThan:0},{argumentType:Yr.BOOLEAN}]},"POISSON.DIST":{method:"poissondist",parameters:[{argumentType:Yr.NUMBER,minValue:0},{argumentType:Yr.NUMBER,minValue:0},{argumentType:Yr.BOOLEAN}]},"HYPGEOM.DIST":{method:"hypgeomdist",parameters:[{argumentType:Yr.NUMBER,minValue:0},{argumentType:Yr.NUMBER,greaterThan:0},{argumentType:Yr.NUMBER,greaterThan:0},{argumentType:Yr.NUMBER,greaterThan:0},{argumentType:Yr.BOOLEAN}]},"T.DIST":{method:"tdist",parameters:[{argumentType:Yr.NUMBER},{argumentType:Yr.NUMBER,minValue:1},{argumentType:Yr.BOOLEAN}]},"T.DIST.2T":{method:"tdist2t",parameters:[{argumentType:Yr.NUMBER,minValue:0},{argumentType:Yr.NUMBER,minValue:1}]},"T.DIST.RT":{method:"tdistrt",parameters:[{argumentType:Yr.NUMBER},{argumentType:Yr.NUMBER,minValue:1}]},TDIST:{method:"tdistold",parameters:[{argumentType:Yr.NUMBER,minValue:0},{argumentType:Yr.NUMBER,minValue:1},{argumentType:Yr.INTEGER,minValue:1,maxValue:2}]},"T.INV":{method:"tinv",parameters:[{argumentType:Yr.NUMBER,greaterThan:0,lessThan:1},{argumentType:Yr.NUMBER,minValue:1}]},"T.INV.2T":{method:"tinv2t",parameters:[{argumentType:Yr.NUMBER,greaterThan:0,maxValue:1},{argumentType:Yr.NUMBER,minValue:1}]},"LOGNORM.DIST":{method:"lognormdist",parameters:[{argumentType:Yr.NUMBER,greaterThan:0},{argumentType:Yr.NUMBER},{argumentType:Yr.NUMBER,greaterThan:0},{argumentType:Yr.BOOLEAN}]},"LOGNORM.INV":{method:"lognorminv",parameters:[{argumentType:Yr.NUMBER,greaterThan:0,lessThan:1},{argumentType:Yr.NUMBER},{argumentType:Yr.NUMBER,greaterThan:0}]},"NORM.DIST":{method:"normdist",parameters:[{argumentType:Yr.NUMBER},{argumentType:Yr.NUMBER},{argumentType:Yr.NUMBER,greaterThan:0},{argumentType:Yr.BOOLEAN}]},"NORM.INV":{method:"norminv",parameters:[{argumentType:Yr.NUMBER,greaterThan:0,lessThan:1},{argumentType:Yr.NUMBER},{argumentType:Yr.NUMBER,greaterThan:0}]},"NORM.S.DIST":{method:"normsdist",parameters:[{argumentType:Yr.NUMBER},{argumentType:Yr.BOOLEAN}]},"NORM.S.INV":{method:"normsinv",parameters:[{argumentType:Yr.NUMBER,greaterThan:0,lessThan:1}]},PHI:{method:"phi",parameters:[{argumentType:Yr.NUMBER}]},"NEGBINOM.DIST":{method:"negbinomdist",parameters:[{argumentType:Yr.NUMBER,minValue:0},{argumentType:Yr.NUMBER,minValue:1},{argumentType:Yr.NUMBER,minValue:0,maxValue:1},{argumentType:Yr.BOOLEAN}]},"CONFIDENCE.NORM":{method:"confidencenorm",parameters:[{argumentType:Yr.NUMBER,greaterThan:0,lessThan:1},{argumentType:Yr.NUMBER,greaterThan:0},{argumentType:Yr.NUMBER,minValue:1}]},"CONFIDENCE.T":{method:"confidencet",parameters:[{argumentType:Yr.NUMBER,greaterThan:0,lessThan:1},{argumentType:Yr.NUMBER,greaterThan:0},{argumentType:Yr.NUMBER,minValue:1}]},STANDARDIZE:{method:"standardize",parameters:[{argumentType:Yr.NUMBER},{argumentType:Yr.NUMBER},{argumentType:Yr.NUMBER,greaterThan:0}]}},Ol.aliases={NEGBINOMDIST:"NEGBINOM.DIST",EXPONDIST:"EXPON.DIST",BETADIST:"BETA.DIST",NORMDIST:"NORM.DIST",NORMINV:"NORM.INV",NORMSDIST:"NORM.S.DIST",NORMSINV:"NORM.S.INV",LOGNORMDIST:"LOGNORM.DIST",LOGINV:"LOGNORM.INV",TINV:"T.INV.2T",HYPGEOMDIST:"HYPGEOM.DIST",POISSON:"POISSON.DIST",WEIBULL:"WEIBULL.DIST",FINV:"F.INV.RT",FDIST:"F.DIST.RT",CHIDIST:"CHISQ.DIST.RT",CHIINV:"CHISQ.INV.RT",GAMMADIST:"GAMMA.DIST","GAMMALN.PRECISE":"GAMMALN",GAMMAINV:"GAMMA.INV",BETAINV:"BETA.INV",BINOMDIST:"BINOM.DIST",CONFIDENCE:"CONFIDENCE.NORM",CRITBINOM:"BINOM.INV",WEIBULLDIST:"WEIBULL.DIST",TINV2T:"T.INV.2T",TDISTRT:"T.DIST.RT",TDIST2T:"T.DIST.2T",FINVRT:"F.INV.RT",FDISTRT:"F.DIST.RT",CHIDISTRT:"CHISQ.DIST.RT",CHIINVRT:"CHISQ.INV.RT",LOGNORMINV:"LOGNORM.INV",POISSONDIST:"POISSON.DIST"};
/**
 * @license
 * Copyright (c) 2022 Handsoncode. All rights reserved.
 */
class Il extends Wr{fact(e,t){return this.runFunction(e.args,t,this.metadata("FACT"),(e=>{e=Math.trunc(e);let t=1;for(let r=1;r<=e;r++)t*=r;return t}))}factdouble(e,t){return this.runFunction(e.args,t,this.metadata("FACTDOUBLE"),(e=>{e=Math.trunc(e);let t=1;for(let r=e;r>=1;r-=2)t*=r;return t}))}combin(e,t){return this.runFunction(e.args,t,this.metadata("COMBIN"),((e,t)=>t>e?new Fn(En.NUM,It.WrongOrder):(e=Math.trunc(e),t=Math.trunc(t),Ml(e,t))))}combina(e,t){return this.runFunction(e.args,t,this.metadata("COMBINA"),((e,t)=>(e=Math.trunc(e),t=Math.trunc(t),e+t-1>=1030?new Fn(En.NUM,It.ValueLarge):0===e&&0===t?1:Ml(e+t-1,t))))}gcd(e,t){return this.runFunction(e.args,t,this.metadata("GCD"),((...e)=>{const t=this.arithmeticHelper.coerceNumbersCoerceRangesDropNulls(e);if(t instanceof Fn)return t;let r=0;for(const n of t){if(n<0)return new Fn(En.NUM,It.ValueSmall);r=Dl(r,Math.trunc(n))}return r>Number.MAX_SAFE_INTEGER?new Fn(En.NUM,It.ValueLarge):r}))}lcm(e,t){return this.runFunction(e.args,t,this.metadata("LCM"),((...e)=>{const t=this.arithmeticHelper.coerceNumbersCoerceRangesDropNulls(e);if(t instanceof Fn)return t;let r=1;for(const n of t){if(n<0)return new Fn(En.NUM,It.ValueSmall);r=Ll(r,Math.trunc(n))}return r>Number.MAX_SAFE_INTEGER?new Fn(En.NUM,It.ValueLarge):r}))}mround(e,t){return this.runFunction(e.args,t,this.metadata("MROUND"),((e,t)=>0===t?0:e>0&&t<0||e<0&&t>0?new Fn(En.NUM,It.DistinctSigns):Math.round(e/t)*t))}multinomial(e,t){return this.runFunction(e.args,t,this.metadata("MULTINOMIAL"),((...e)=>{let t=0,r=1;for(let n of e){if(n<0)return new Fn(En.NUM,It.ValueSmall);n=Math.trunc(n);for(let e=1;e<=n;e++)r*=(t+e)/e;t+=n}return Math.round(r)}))}quotient(e,t){return this.runFunction(e.args,t,this.metadata("QUOTIENT"),((e,t)=>0===t?new Fn(En.DIV_BY_ZERO):Math.trunc(e/t)))}seriessum(e,t){return this.runFunction(e.args,t,this.metadata("SERIESSUM"),((e,t,r,n)=>{const a=this.arithmeticHelper.manyToOnlyNumbersDropNulls(n.valuesFromTopLeftCorner());if(a instanceof Fn)return a;let s=0;a.reverse();for(const i of a)s*=Math.pow(e,r),s+=i;return s*Math.pow(e,t)}))}sign(e,t){return this.runFunction(e.args,t,this.metadata("SIGN"),(e=>e>0?1:e<0?-1:0))}sumx2my2(e,t){return this.runFunction(e.args,t,this.metadata("SUMX2MY2"),((e,t)=>{const r=e.valuesFromTopLeftCorner(),n=t.valuesFromTopLeftCorner();if(r.length!==n.length)return new Fn(En.NA,It.EqualLength);const a=r.length;let s=0;for(let i=0;i<a;i++){const e=r[i],t=n[i];if(e instanceof Fn)return e;if(t instanceof Fn)return t;"number"===typeof e&&"number"===typeof t&&(s+=Math.pow(e,2)-Math.pow(t,2))}return s}))}sumx2py2(e,t){return this.runFunction(e.args,t,this.metadata("SUMX2PY2"),((e,t)=>{const r=e.valuesFromTopLeftCorner(),n=t.valuesFromTopLeftCorner();if(r.length!==n.length)return new Fn(En.NA,It.EqualLength);const a=r.length;let s=0;for(let i=0;i<a;i++){const e=r[i],t=n[i];if(e instanceof Fn)return e;if(t instanceof Fn)return t;"number"===typeof e&&"number"===typeof t&&(s+=Math.pow(e,2)+Math.pow(t,2))}return s}))}sumxmy2(e,t){return this.runFunction(e.args,t,this.metadata("SUMXMY2"),((e,t)=>{const r=e.valuesFromTopLeftCorner(),n=t.valuesFromTopLeftCorner();if(r.length!==n.length)return new Fn(En.NA,It.EqualLength);const a=r.length;let s=0;for(let i=0;i<a;i++){const e=r[i],t=n[i];if(e instanceof Fn)return e;if(t instanceof Fn)return t;"number"===typeof e&&"number"===typeof t&&(s+=Math.pow(e-t,2))}return s}))}}function Ml(e,t){2*t>e&&(t=e-t);let r=1;for(let n=1;n<=t;n++)r*=(e-t+n)/n;return Math.round(r)}function Dl(e,t){e<t&&([e,t]=[t,e]);while(t>0)[e,t]=[t,e%t];return e}function Ll(e,t){return 0===e||0===t?0:e*(t/Dl(e,t))}Il.implementedFunctions={FACT:{method:"fact",parameters:[{argumentType:Yr.NUMBER,minValue:0,maxValue:170}]},FACTDOUBLE:{method:"factdouble",parameters:[{argumentType:Yr.NUMBER,minValue:0,maxValue:288}]},COMBIN:{method:"combin",parameters:[{argumentType:Yr.NUMBER,minValue:0,lessThan:1030},{argumentType:Yr.NUMBER,minValue:0}]},COMBINA:{method:"combina",parameters:[{argumentType:Yr.NUMBER,minValue:0},{argumentType:Yr.NUMBER,minValue:0}]},GCD:{method:"gcd",parameters:[{argumentType:Yr.ANY}],repeatLastArgs:1},LCM:{method:"lcm",parameters:[{argumentType:Yr.ANY}],repeatLastArgs:1},MROUND:{method:"mround",parameters:[{argumentType:Yr.NUMBER},{argumentType:Yr.NUMBER}]},MULTINOMIAL:{method:"multinomial",parameters:[{argumentType:Yr.NUMBER}],repeatLastArgs:1,expandRanges:!0},QUOTIENT:{method:"quotient",parameters:[{argumentType:Yr.NUMBER},{argumentType:Yr.NUMBER}]},SERIESSUM:{method:"seriessum",parameters:[{argumentType:Yr.NUMBER},{argumentType:Yr.NUMBER},{argumentType:Yr.NUMBER},{argumentType:Yr.RANGE}]},SIGN:{method:"sign",parameters:[{argumentType:Yr.NUMBER}]},SUMX2MY2:{method:"sumx2my2",parameters:[{argumentType:Yr.RANGE},{argumentType:Yr.RANGE}]},SUMX2PY2:{method:"sumx2py2",parameters:[{argumentType:Yr.RANGE},{argumentType:Yr.RANGE}]},SUMXMY2:{method:"sumxmy2",parameters:[{argumentType:Yr.RANGE},{argumentType:Yr.RANGE}]}};
/**
 * @license
 * Copyright (c) 2022 Handsoncode. All rights reserved.
 */
class kl extends Wr{complex(e,t){return this.runFunction(e.args,t,this.metadata("COMPLEX"),((e,t,r)=>"i"!==r&&"j"!==r?new Fn(En.VALUE,It.ShouldBeIorJ):Tr([e,t],r)))}imabs(e,t){return this.runFunction(e.args,t,this.metadata("IMABS"),Gl)}imaginary(e,t){return this.runFunction(e.args,t,this.metadata("IMAGINARY"),(([e,t])=>t))}imreal(e,t){return this.runFunction(e.args,t,this.metadata("IMREAL"),(([e,t])=>e))}imargument(e,t){return this.runFunction(e.args,t,this.metadata("IMARGUMENT"),(([e,t])=>0===e&&0===t?new Fn(En.DIV_BY_ZERO):Math.atan2(t,e)))}imconjugate(e,t){return this.runFunction(e.args,t,this.metadata("IMCONJUGATE"),(([e,t])=>Tr([e,-t])))}imcos(e,t){return this.runFunction(e.args,t,this.metadata("IMCOS"),(e=>Tr(Pl(e))))}imcosh(e,t){return this.runFunction(e.args,t,this.metadata("IMCOSH"),(e=>Tr(Bl(e))))}imcot(e,t){return this.runFunction(e.args,t,this.metadata("IMCOT"),(e=>Tr(Fl(Pl(e),Yl(e)))))}imcsc(e,t){return this.runFunction(e.args,t,this.metadata("IMCSC"),(e=>Tr(Fl([1,0],Yl(e)))))}imcsch(e,t){return this.runFunction(e.args,t,this.metadata("IMCSCH"),(e=>Tr(Fl([1,0],Vl(e)))))}imsec(e,t){return this.runFunction(e.args,t,this.metadata("IMSEC"),(e=>Tr(Fl([1,0],Pl(e)))))}imsech(e,t){return this.runFunction(e.args,t,this.metadata("IMSECH"),(e=>Tr(Fl([1,0],Bl(e)))))}imsin(e,t){return this.runFunction(e.args,t,this.metadata("IMSIN"),(e=>Tr(Yl(e))))}imsinh(e,t){return this.runFunction(e.args,t,this.metadata("IMSINH"),(e=>Tr(Vl(e))))}imtan(e,t){return this.runFunction(e.args,t,this.metadata("IMTAN"),(e=>Tr(Fl(Yl(e),Pl(e)))))}imdiv(e,t){return this.runFunction(e.args,t,this.metadata("IMDIV"),((e,t)=>Tr(Fl(e,t))))}improduct(e,t){return this.runFunction(e.args,t,this.metadata("IMPRODUCT"),((...e)=>{const t=this.arithmeticHelper.coerceComplexExactRanges(e);if(t instanceof Fn)return t;let r=[1,0];for(const n of t)r=xl(r,n);return Tr(r)}))}imsum(e,t){return this.runFunction(e.args,t,this.metadata("IMSUM"),((...e)=>{const t=this.arithmeticHelper.coerceComplexExactRanges(e);if(t instanceof Fn)return t;let r=[0,0];for(const n of t)r=_l(r,n);return Tr(r)}))}imsub(e,t){return this.runFunction(e.args,t,this.metadata("IMSUB"),((e,t)=>Tr(Ul(e,t))))}imexp(e,t){return this.runFunction(e.args,t,this.metadata("IMEXP"),(e=>Tr(Wl(e))))}imln(e,t){return this.runFunction(e.args,t,this.metadata("IMLN"),(e=>Tr(Hl(e))))}imlog10(e,t){return this.runFunction(e.args,t,this.metadata("IMLOG10"),(e=>{const[t,r]=Hl(e),n=Math.log(10);return Tr([t/n,r/n])}))}imlog2(e,t){return this.runFunction(e.args,t,this.metadata("IMLOG2"),(e=>{const[t,r]=Hl(e),n=Math.log(2);return Tr([t/n,r/n])}))}impower(e,t){return this.runFunction(e.args,t,this.metadata("IMPOWER"),((e,t)=>Tr(zl(e,t))))}imsqrt(e,t){return this.runFunction(e.args,t,this.metadata("IMSQRT"),(e=>Tr(zl(e,.5))))}}function _l([e,t],[r,n]){return[e+r,t+n]}function Ul([e,t],[r,n]){return[e-r,t-n]}function xl([e,t],[r,n]){return[e*r-t*n,e*n+r*t]}function Fl([e,t],[r,n]){const a=Math.pow(r,2)+Math.pow(n,2),[s,i]=xl([e,t],[r,-n]);return[s/a,i/a]}function Pl([e,t]){return[Math.cos(e)*Math.cosh(t),-Math.sin(e)*Math.sinh(t)]}function Bl([e,t]){return[Math.cosh(e)*Math.cos(t),Math.sinh(e)*Math.sin(t)]}function Yl([e,t]){return[Math.sin(e)*Math.cosh(t),Math.cos(e)*Math.sinh(t)]}function Vl([e,t]){return[Math.sinh(e)*Math.cos(t),Math.cosh(e)*Math.sin(t)]}function Wl([e,t]){return[Math.exp(e)*Math.cos(t),Math.exp(e)*Math.sin(t)]}function Gl([e,t]){return Math.sqrt(e*e+t*t)}function Hl([e,t]){return[Math.log(Gl([e,t])),Math.atan2(t,e)]}function zl(e,t){const[r,n]=Hl(e);return Wl([t*r,t*n])}kl.implementedFunctions={COMPLEX:{method:"complex",parameters:[{argumentType:Yr.NUMBER},{argumentType:Yr.NUMBER},{argumentType:Yr.STRING,defaultValue:"i"}]},IMABS:{method:"imabs",parameters:[{argumentType:Yr.COMPLEX}]},IMAGINARY:{method:"imaginary",parameters:[{argumentType:Yr.COMPLEX}]},IMREAL:{method:"imreal",parameters:[{argumentType:Yr.COMPLEX}]},IMARGUMENT:{method:"imargument",parameters:[{argumentType:Yr.COMPLEX}]},IMCONJUGATE:{method:"imconjugate",parameters:[{argumentType:Yr.COMPLEX}]},IMCOS:{method:"imcos",parameters:[{argumentType:Yr.COMPLEX}]},IMCOSH:{method:"imcosh",parameters:[{argumentType:Yr.COMPLEX}]},IMCOT:{method:"imcot",parameters:[{argumentType:Yr.COMPLEX}]},IMCSC:{method:"imcsc",parameters:[{argumentType:Yr.COMPLEX}]},IMCSCH:{method:"imcsch",parameters:[{argumentType:Yr.COMPLEX}]},IMSEC:{method:"imsec",parameters:[{argumentType:Yr.COMPLEX}]},IMSECH:{method:"imsech",parameters:[{argumentType:Yr.COMPLEX}]},IMSIN:{method:"imsin",parameters:[{argumentType:Yr.COMPLEX}]},IMSINH:{method:"imsinh",parameters:[{argumentType:Yr.COMPLEX}]},IMTAN:{method:"imtan",parameters:[{argumentType:Yr.COMPLEX}]},IMDIV:{method:"imdiv",parameters:[{argumentType:Yr.COMPLEX},{argumentType:Yr.COMPLEX}]},IMPRODUCT:{method:"improduct",parameters:[{argumentType:Yr.ANY}],repeatLastArgs:1},IMSUM:{method:"imsum",parameters:[{argumentType:Yr.ANY}],repeatLastArgs:1},IMSUB:{method:"imsub",parameters:[{argumentType:Yr.COMPLEX},{argumentType:Yr.COMPLEX}]},IMEXP:{method:"imexp",parameters:[{argumentType:Yr.COMPLEX}]},IMLN:{method:"imln",parameters:[{argumentType:Yr.COMPLEX}]},IMLOG10:{method:"imlog10",parameters:[{argumentType:Yr.COMPLEX}]},IMLOG2:{method:"imlog2",parameters:[{argumentType:Yr.COMPLEX}]},IMPOWER:{method:"impower",parameters:[{argumentType:Yr.COMPLEX},{argumentType:Yr.NUMBER}]},IMSQRT:{method:"imsqrt",parameters:[{argumentType:Yr.COMPLEX}]}};
/**
 * @license
 * Copyright (c) 2022 Handsoncode. All rights reserved.
 */
class $l extends Wr{avedev(e,t){return this.runFunction(e.args,t,this.metadata("AVEDEV"),((...e)=>{const t=this.arithmeticHelper.coerceNumbersExactRanges(e);if(t instanceof Fn)return t;if(0===t.length)return new Fn(En.DIV_BY_ZERO);const r=vl(t);return t.reduce(((e,t)=>e+Math.abs(t-r)),0)/t.length}))}devsq(e,t){return this.runFunction(e.args,t,this.metadata("DEVSQ"),((...e)=>{const t=this.arithmeticHelper.coerceNumbersExactRanges(e);return t instanceof Fn?t:0===t.length?0:Tl(t)}))}geomean(e,t){return this.runFunction(e.args,t,this.metadata("GEOMEAN"),((...e)=>{const t=this.arithmeticHelper.coerceNumbersExactRanges(e);if(t instanceof Fn)return t;if(0===t.length)return new Fn(En.NUM,It.OneValue);for(const r of t)if(r<=0)return new Fn(En.NUM,It.ValueSmall);return wl(t)}))}harmean(e,t){return this.runFunction(e.args,t,this.metadata("HARMEAN"),((...e)=>{const t=this.arithmeticHelper.coerceNumbersExactRanges(e);if(t instanceof Fn)return t;if(0===t.length)return new Fn(En.NUM,It.OneValue);for(const r of t)if(r<=0)return new Fn(En.NUM,It.ValueSmall);return t.length/t.reduce(((e,t)=>e+1/t),0)}))}correl(e,t){return this.runFunction(e.args,t,this.metadata("CORREL"),((e,t)=>{if(e.numberOfElements()!==t.numberOfElements())return new Fn(En.NA,It.EqualLength);const r=jl(e,t);if(r instanceof Fn)return r;const n=r[0].length;return n<=1?new Fn(En.DIV_BY_ZERO,It.TwoValues):Cl(r[0],r[1])}))}rsq(e,t){return this.runFunction(e.args,t,this.metadata("RSQ"),((e,t)=>{if(e.numberOfElements()!==t.numberOfElements())return new Fn(En.NA,It.EqualLength);const r=jl(e,t);if(r instanceof Fn)return r;const n=r[0].length;return n<=1?new Fn(En.DIV_BY_ZERO,It.TwoValues):Math.pow(Cl(r[0],r[1]),2)}))}covariancep(e,t){return this.runFunction(e.args,t,this.metadata("COVARIANCE.P"),((e,t)=>{if(e.numberOfElements()!==t.numberOfElements())return new Fn(En.NA,It.EqualLength);const r=jl(e,t);if(r instanceof Fn)return r;const n=r[0].length;return n<1?new Fn(En.DIV_BY_ZERO,It.OneValue):1===n?0:bl(r[0],r[1])*(n-1)/n}))}covariances(e,t){return this.runFunction(e.args,t,this.metadata("COVARIANCE.S"),((e,t)=>{if(e.numberOfElements()!==t.numberOfElements())return new Fn(En.NA,It.EqualLength);const r=jl(e,t);if(r instanceof Fn)return r;const n=r[0].length;return n<=1?new Fn(En.DIV_BY_ZERO,It.TwoValues):bl(r[0],r[1])}))}ztest(e,t){return this.runFunction(e.args,t,this.metadata("Z.TEST"),((e,t,r)=>{const n=this.arithmeticHelper.manyToExactNumbers(e.valuesFromTopLeftCorner());if(n instanceof Fn)return n;const a=n.length;if(void 0===r){if(a<2)return new Fn(En.DIV_BY_ZERO,It.TwoValues);r=Al(n,!0)}return a<1?new Fn(En.NA,It.OneValue):0===r?new Fn(En.DIV_BY_ZERO):1-qc.cdf((vl(n)-t)/(r/Math.sqrt(a)),0,1)}))}ftest(e,t){return this.runFunction(e.args,t,this.metadata("F.TEST"),((e,t)=>{const r=this.arithmeticHelper.manyToExactNumbers(e.valuesFromTopLeftCorner()),n=this.arithmeticHelper.manyToExactNumbers(t.valuesFromTopLeftCorner());if(r instanceof Fn)return r;if(n instanceof Fn)return n;if(r.length<=1||n.length<=1)return new Fn(En.DIV_BY_ZERO);const a=Sl(r,!0),s=Sl(n,!0);if(0===a||0===s)return new Fn(En.DIV_BY_ZERO);const i=a/s,o=ul.cdf(i,r.length-1,n.length-1);return 2*Math.min(o,1-o)}))}steyx(e,t){return this.runFunction(e.args,t,this.metadata("STEYX"),((e,t)=>{if(e.numberOfElements()!==t.numberOfElements())return new Fn(En.NA,It.EqualLength);const r=jl(e,t);if(r instanceof Fn)return r;const n=r[0].length;return n<=2?new Fn(En.DIV_BY_ZERO,It.ThreeValues):Math.sqrt((Tl(r[0])-Math.pow(bl(r[0],r[1])*(n-1),2)/Tl(r[1]))/(n-2))}))}slope(e,t){return this.runFunction(e.args,t,this.metadata("SLOPE"),((e,t)=>{if(e.numberOfElements()!==t.numberOfElements())return new Fn(En.NA,It.EqualLength);const r=jl(e,t);if(r instanceof Fn)return r;const n=r[0].length;return n<=1?new Fn(En.DIV_BY_ZERO,It.TwoValues):bl(r[0],r[1])*(n-1)/Tl(r[1])}))}chisqtest(e,t){return this.runFunction(e.args,t,this.metadata("CHISQ.TEST"),((e,t)=>{const r=e.height(),n=e.width();if(t.height()!==r||t.width()!==n)return new Fn(En.NA,It.EqualLength);const a=jl(e,t);if(a instanceof Fn)return a;if(a[0].length<=1)return new Fn(En.DIV_BY_ZERO,It.TwoValues);let s=0;for(let i=0;i<a[0].length;i++){if(0===a[1][i])return new Fn(En.DIV_BY_ZERO);s+=Math.pow(a[0][i]-a[1][i],2)/a[1][i]}return s<0?new Fn(En.NUM,It[NaN]):1-ll.cdf(s,r>1&&n>1?(r-1)*(n-1):r*n-1)}))}ttest(e,t){return this.runFunction(e.args,t,this.metadata("T.TEST"),((e,t,r,n)=>{const a=this.arithmeticHelper.manyToExactNumbers(e.valuesFromTopLeftCorner()),s=this.arithmeticHelper.manyToExactNumbers(t.valuesFromTopLeftCorner());if(a instanceof Fn)return a;if(s instanceof Fn)return s;const i=a.length,o=s.length;if(1===n){if(o!==i)return new Fn(En.NA,It.EqualLength);if(i<=1)return new Fn(En.DIV_BY_ZERO,It.TwoValues);const e=Array(i);for(let r=0;r<i;r++)e[r]=a[r]-s[r];const t=Al(e,!0);if(0===t)return new Fn(En.DIV_BY_ZERO);const n=Math.abs(Math.sqrt(i)*vl(e)/t);return r*(1-pl.cdf(n,i-1))}if(2===n){if(i<=1||o<=1)return new Fn(En.DIV_BY_ZERO,It.TwoValues);const e=(Tl(a)+Tl(s))/(i+o-2);if(0===e)return new Fn(En.DIV_BY_ZERO);const t=Math.abs((vl(a)-vl(s))/Math.sqrt(e*(1/i+1/o)));return r*(1-pl.cdf(t,i+o-2))}{if(i<=1||o<=1)return new Fn(En.DIV_BY_ZERO,It.TwoValues);const e=Sl(a,!0),t=Sl(s,!0);if(0===e&&0===t)return new Fn(En.DIV_BY_ZERO);const n=Math.abs((vl(a)-vl(s))/Math.sqrt(e/i+t/o)),c=Math.pow(e/i+t/o,2)/(Math.pow(e/i,2)/(i-1)+Math.pow(t/o,2)/(o-1));return r*(1-pl.cdf(n,c))}}))}skew(e,t){return this.runFunction(e.args,t,this.metadata("SKEW"),((...e)=>{const t=this.arithmeticHelper.coerceNumbersExactRanges(e);if(t instanceof Fn)return t;const r=t.length;if(r<3)return new Fn(En.DIV_BY_ZERO,It.ThreeValues);const n=vl(t),a=Al(t,!0);return 0===a?new Fn(En.DIV_BY_ZERO):t.reduce(((e,t)=>e+Math.pow((t-n)/a,3)),0)*r/(r-1)/(r-2)}))}skewp(e,t){return this.runFunction(e.args,t,this.metadata("SKEW.P"),((...e)=>{const t=this.arithmeticHelper.coerceNumbersExactRanges(e);if(t instanceof Fn)return t;const r=t.length;if(r<3)return new Fn(En.DIV_BY_ZERO,It.ThreeValues);const n=vl(t),a=Al(t,!1);return 0===a?new Fn(En.DIV_BY_ZERO):t.reduce(((e,t)=>e+Math.pow((t-n)/a,3)),0)/r}))}}function jl(e,t){const r=e.iterateValuesFromTopLeftCorner(),n=t.iterateValuesFromTopLeftCorner();let a,s;const i=[],o=[];while(a=r.next(),s=n.next(),!a.done&&!s.done){const e=a.value,t=s.value;if(e instanceof Fn)return e;if(t instanceof Fn)return t;hr(e)&&hr(t)&&(i.push(nr(e)),o.push(nr(t)))}return[i,o]}$l.implementedFunctions={AVEDEV:{method:"avedev",parameters:[{argumentType:Yr.ANY}],repeatLastArgs:1},DEVSQ:{method:"devsq",parameters:[{argumentType:Yr.ANY}],repeatLastArgs:1},GEOMEAN:{method:"geomean",parameters:[{argumentType:Yr.ANY}],repeatLastArgs:1},HARMEAN:{method:"harmean",parameters:[{argumentType:Yr.ANY}],repeatLastArgs:1},CORREL:{method:"correl",parameters:[{argumentType:Yr.RANGE},{argumentType:Yr.RANGE}]},RSQ:{method:"rsq",parameters:[{argumentType:Yr.RANGE},{argumentType:Yr.RANGE}]},"COVARIANCE.P":{method:"covariancep",parameters:[{argumentType:Yr.RANGE},{argumentType:Yr.RANGE}]},"COVARIANCE.S":{method:"covariances",parameters:[{argumentType:Yr.RANGE},{argumentType:Yr.RANGE}]},"Z.TEST":{method:"ztest",parameters:[{argumentType:Yr.RANGE},{argumentType:Yr.NUMBER},{argumentType:Yr.NUMBER,optionalArg:!0}]},"F.TEST":{method:"ftest",parameters:[{argumentType:Yr.RANGE},{argumentType:Yr.RANGE}]},STEYX:{method:"steyx",parameters:[{argumentType:Yr.RANGE},{argumentType:Yr.RANGE}]},SLOPE:{method:"slope",parameters:[{argumentType:Yr.RANGE},{argumentType:Yr.RANGE}]},"CHISQ.TEST":{method:"chisqtest",parameters:[{argumentType:Yr.RANGE},{argumentType:Yr.RANGE}]},"T.TEST":{method:"ttest",parameters:[{argumentType:Yr.RANGE},{argumentType:Yr.RANGE},{argumentType:Yr.INTEGER,minValue:1,maxValue:2},{argumentType:Yr.INTEGER,minValue:1,maxValue:3}]},SKEW:{method:"skew",parameters:[{argumentType:Yr.ANY}],repeatLastArgs:1},"SKEW.P":{method:"skewp",parameters:[{argumentType:Yr.ANY}],repeatLastArgs:1}},$l.aliases={COVAR:"COVARIANCE.P",FTEST:"F.TEST",PEARSON:"CORREL",ZTEST:"Z.TEST",CHITEST:"CHISQ.TEST",TTEST:"T.TEST",COVARIANCEP:"COVARIANCE.P",COVARIANCES:"COVARIANCE.S",SKEWP:"SKEW.P"};
/**
 * @license
 * Copyright (c) 2022 Handsoncode. All rights reserved.
 */
class Xl extends Hi{}Xl.HyperFormula=Hi,Xl.ErrorType=En,Xl.CellType=vn,Xl.CellValueType=Dn,Xl.CellValueDetailedType=Ln,Xl.DetailedCellError=Kn,Xl.ExportedCellChange=ii,Xl.ExportedNamedExpressionChange=oi,Xl.ConfigValueTooBigError=I,Xl.ConfigValueTooSmallError=O,Xl.EvaluationSuspendedError=D,Xl.ExpectedOneOfValuesError=M,Xl.ExpectedValueOfTypeError=b,Xl.FunctionPlugin=Wr,Xl.FunctionPluginValidationError=x,Xl.InvalidAddressError=m,Xl.InvalidArgumentsError=g,Xl.LanguageNotRegisteredError=_,Xl.LanguageAlreadyRegisteredError=U,Xl.MissingTranslationError=L,Xl.NamedExpressionDoesNotExistError=S,Xl.NamedExpressionNameIsAlreadyTakenError=v,Xl.NamedExpressionNameIsInvalidError=T,Xl.NoOperationToRedoError=R,Xl.NoOperationToUndoError=A,Xl.NoRelativeAddressesAllowedError=Y,Xl.NoSheetWithIdError=u,Xl.NoSheetWithNameError=h,Xl.NotAFormulaError=p,Xl.NothingToPasteError=y,Xl.ProtectedFunctionTranslationError=k,Xl.SheetNameAlreadyTakenError=f,Xl.SheetSizeLimitExceededError=d,Xl.SourceLocationHasArrayError=P,Xl.TargetLocationHasArrayError=B,Xl.UnableToParseError=w;const Kl=$i.defaultConfig.language;Hi.registerLanguage(Kl,qi),Hi.languages[qi.langCode]=qi;for(const $ of Object.getOwnPropertyNames(n))$.startsWith("_")||Hi.registerFunctionPlugin(n[$]);var ql,Jl=r(7110),Ql=r(5769),Zl=r(8147),eu=r(5439),tu=r(3019),ru=(r(8675),r(7380),r(1118),r(2087),{version:"0.19.2"}),nu=1200,au=1252,su=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],iu={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},ou=function(e){-1!=su.indexOf(e)&&(au=iu[0]=e)};function cu(){ou(1252)}var lu=function(e){nu=e,ou(e)};function uu(){lu(1200),cu()}function hu(e){for(var t=[],r=0,n=e.length;r<n;++r)t[r]=e.charCodeAt(r);return t}function fu(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function du(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var pu=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return 255==t&&254==r?fu(e.slice(2)):254==t&&255==r?du(e.slice(2)):65279==t?e.slice(1):e},mu=function(e){return String.fromCharCode(e)},gu=function(e){return String.fromCharCode(e)};function Eu(e){ql=e,lu=function(e){nu=e,ou(e)},pu=function(e){return 255===e.charCodeAt(0)&&254===e.charCodeAt(1)?ql.utils.decode(1200,hu(e.slice(2))):e},mu=function(e){return 1200===nu?String.fromCharCode(e):ql.utils.decode(nu,[255&e,e>>8])[0]},gu=function(e){return ql.utils.decode(au,[e])[0]},sp()}var vu=null,Tu=!0,Su="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Au(e){for(var t="",r=0,n=0,a=0,s=0,i=0,o=0,c=0,l=0;l<e.length;)r=e.charCodeAt(l++),s=r>>2,n=e.charCodeAt(l++),i=(3&r)<<4|n>>4,a=e.charCodeAt(l++),o=(15&n)<<2|a>>6,c=63&a,isNaN(n)?o=c=64:isNaN(a)&&(c=64),t+=Su.charAt(s)+Su.charAt(i)+Su.charAt(o)+Su.charAt(c);return t}function Ru(e){for(var t="",r=0,n=0,a=0,s=0,i=0,o=0,c=0,l=0;l<e.length;)r=e.charCodeAt(l++),r>255&&(r=95),s=r>>2,n=e.charCodeAt(l++),n>255&&(n=95),i=(3&r)<<4|n>>4,a=e.charCodeAt(l++),a>255&&(a=95),o=(15&n)<<2|a>>6,c=63&a,isNaN(n)?o=c=64:isNaN(a)&&(c=64),t+=Su.charAt(s)+Su.charAt(i)+Su.charAt(o)+Su.charAt(c);return t}function yu(e){var t="",r=0,n=0,a=0,s=0,i=0,o=0,c=0;e=e.replace(/^data:([^\/]+\/[^\/]+)?;base64\,/,"").replace(/[^\w\+\/\=]/g,"");for(var l=0;l<e.length;)s=Su.indexOf(e.charAt(l++)),i=Su.indexOf(e.charAt(l++)),r=s<<2|i>>4,t+=String.fromCharCode(r),o=Su.indexOf(e.charAt(l++)),n=(15&i)<<4|o>>2,64!==o&&(t+=String.fromCharCode(n)),c=Su.indexOf(e.charAt(l++)),a=(3&o)<<6|c,64!==c&&(t+=String.fromCharCode(a));return t}var Nu=function(){return"undefined"!==typeof Buffer&&"undefined"!==typeof process&&"undefined"!==typeof process.versions&&!!process.versions.node}(),wu=function(){if("undefined"!==typeof Buffer){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch(t){e=!0}return e?function(e,t){return t?new Buffer(e,t):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}(),bu=function(){if("undefined"===typeof Buffer)return!1;var e=wu([65,0]);if(!e)return!1;var t=e.toString("utf16le");return 1==t.length}();function Cu(e){return Nu?Buffer.alloc?Buffer.alloc(e):new Buffer(e):"undefined"!=typeof Uint8Array?new Uint8Array(e):new Array(e)}function Ou(e){return Nu?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):"undefined"!=typeof Uint8Array?new Uint8Array(e):new Array(e)}var Iu=function(e){return Nu?wu(e,"binary"):e.split("").map((function(e){return 255&e.charCodeAt(0)}))};function Mu(e){if("undefined"===typeof ArrayBuffer)return Iu(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n!=e.length;++n)r[n]=255&e.charCodeAt(n);return t}function Du(e){if(Array.isArray(e))return e.map((function(e){return String.fromCharCode(e)})).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function Lu(e){if("undefined"===typeof Uint8Array)throw new Error("Unsupported");return new Uint8Array(e)}function ku(e){if("undefined"==typeof ArrayBuffer)throw new Error("Unsupported");if(e instanceof ArrayBuffer)return ku(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var _u=Nu?function(e){return Buffer.concat(e.map((function(e){return Buffer.isBuffer(e)?e:wu(e)})))}:function(e){if("undefined"!==typeof Uint8Array){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),a=0;for(t=0,r=0;t<e.length;r+=a,++t)a=e[t].length,e[t]instanceof Uint8Array?n.set(e[t],r):"string"==typeof e[t]?n.set(new Uint8Array(Iu(e[t])),r):n.set(new Uint8Array(e[t]),r);return n}return[].concat.apply([],e.map((function(e){return Array.isArray(e)?e:[].slice.call(e)})))};function Uu(e){for(var t=[],r=0,n=e.length+250,a=Cu(e.length+255),s=0;s<e.length;++s){var i=e.charCodeAt(s);if(i<128)a[r++]=i;else if(i<2048)a[r++]=192|i>>6&31,a[r++]=128|63&i;else if(i>=55296&&i<57344){i=64+(1023&i);var o=1023&e.charCodeAt(++s);a[r++]=240|i>>8&7,a[r++]=128|i>>2&63,a[r++]=128|o>>6&15|(3&i)<<4,a[r++]=128|63&o}else a[r++]=224|i>>12&15,a[r++]=128|i>>6&63,a[r++]=128|63&i;r>n&&(t.push(a.slice(0,r)),r=0,a=Cu(65535),n=65530)}return t.push(a.slice(0,r)),_u(t)}var xu=/\u0000/g,Fu=/[\u0001-\u0006]/g;function Pu(e){var t="",r=e.length-1;while(r>=0)t+=e.charAt(r--);return t}function Bu(e,t){var r=""+e;return r.length>=t?r:wf("0",t-r.length)+r}function Yu(e,t){var r=""+e;return r.length>=t?r:wf(" ",t-r.length)+r}function Vu(e,t){var r=""+e;return r.length>=t?r:r+wf(" ",t-r.length)}function Wu(e,t){var r=""+Math.round(e);return r.length>=t?r:wf("0",t-r.length)+r}function Gu(e,t){var r=""+e;return r.length>=t?r:wf("0",t-r.length)+r}var Hu=Math.pow(2,32);function zu(e,t){if(e>Hu||e<-Hu)return Wu(e,t);var r=Math.round(e);return Gu(r,t)}function $u(e,t){return t=t||0,e.length>=7+t&&103===(32|e.charCodeAt(t))&&101===(32|e.charCodeAt(t+1))&&110===(32|e.charCodeAt(t+2))&&101===(32|e.charCodeAt(t+3))&&114===(32|e.charCodeAt(t+4))&&97===(32|e.charCodeAt(t+5))&&108===(32|e.charCodeAt(t+6))}var ju=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Xu=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function Ku(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"上午/下午 "hh"時"mm"分"ss"秒 "',e}var qu={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"上午/下午 "hh"時"mm"分"ss"秒 "'},Ju={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},Qu={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Zu(e,t,r){var n=e<0?-1:1,a=e*n,s=0,i=1,o=0,c=1,l=0,u=0,h=Math.floor(a);while(l<t){if(h=Math.floor(a),o=h*i+s,u=h*l+c,a-h<5e-8)break;a=1/(a-h),s=i,i=o,c=l,l=u}if(u>t&&(l>t?(u=c,o=s):(u=l,o=i)),!r)return[0,n*o,u];var f=Math.floor(n*o/u);return[f,n*o-f*u,u]}function eh(e,t,r){if(e>2958465||e<0)return null;var n=0|e,a=Math.floor(86400*(e-n)),s=0,i=[],o={D:n,T:a,u:86400*(e-n)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),t&&t.date1904&&(n+=1462),o.u>.9999&&(o.u=0,86400==++a&&(o.T=a=0,++n,++o.D)),60===n)i=r?[1317,10,29]:[1900,2,29],s=3;else if(0===n)i=r?[1317,8,29]:[1900,1,0],s=6;else{n>60&&--n;var c=new Date(1900,0,1);c.setDate(c.getDate()+n-1),i=[c.getFullYear(),c.getMonth()+1,c.getDate()],s=c.getDay(),n<60&&(s=(s+6)%7),r&&(s=hh(c,i))}return o.y=i[0],o.m=i[1],o.d=i[2],o.S=a%60,a=Math.floor(a/60),o.M=a%60,a=Math.floor(a/60),o.H=a,o.q=s,o}var th=new Date(1899,11,31,0,0,0),rh=th.getTime(),nh=new Date(1900,2,1,0,0,0);function ah(e,t){var r=e.getTime();return t?r-=1262304e5:e>=nh&&(r+=864e5),(r-(rh+6e4*(e.getTimezoneOffset()-th.getTimezoneOffset())))/864e5}function sh(e){return-1==e.indexOf(".")?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function ih(e){return-1==e.indexOf("E")?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function oh(e){var t=e<0?12:11,r=sh(e.toFixed(12));return r.length<=t?r:(r=e.toPrecision(10),r.length<=t?r:e.toExponential(5))}function ch(e){var t=sh(e.toFixed(11));return t.length>(e<0?12:11)||"0"===t||"-0"===t?e.toPrecision(6):t}function lh(e){var t,r=Math.floor(Math.log(Math.abs(e))*Math.LOG10E);return t=r>=-4&&r<=-1?e.toPrecision(10+r):Math.abs(r)<=9?oh(e):10===r?e.toFixed(10).substr(0,12):ch(e),sh(ih(t.toUpperCase()))}function uh(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(0|e)===e?e.toString(10):lh(e);case"undefined":return"";case"object":if(null==e)return"";if(e instanceof Date)return Wh(14,ah(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function hh(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function fh(e,t,r,n){var a,s="",i=0,o=0,c=r.y,l=0;switch(e){case 98:c=r.y+543;case 121:switch(t.length){case 1:case 2:a=c%100,l=2;break;default:a=c%1e4,l=4;break}break;case 109:switch(t.length){case 1:case 2:a=r.m,l=t.length;break;case 3:return Xu[r.m-1][1];case 5:return Xu[r.m-1][0];default:return Xu[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:a=r.d,l=t.length;break;case 3:return ju[r.q][0];default:return ju[r.q][1]}break;case 104:switch(t.length){case 1:case 2:a=1+(r.H+11)%12,l=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:a=r.H,l=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:a=r.M,l=t.length;break;default:throw"bad minute format: "+t}break;case 115:if("s"!=t&&"ss"!=t&&".0"!=t&&".00"!=t&&".000"!=t)throw"bad second format: "+t;return 0!==r.u||"s"!=t&&"ss"!=t?(o=n>=2?3===n?1e3:100:1===n?10:1,i=Math.round(o*(r.S+r.u)),i>=60*o&&(i=0),"s"===t?0===i?"0":""+i/o:(s=Bu(i,2+n),"ss"===t?s.substr(0,2):"."+s.substr(2,t.length-1))):Bu(r.S,t.length);case 90:switch(t){case"[h]":case"[hh]":a=24*r.D+r.H;break;case"[m]":case"[mm]":a=60*(24*r.D+r.H)+r.M;break;case"[s]":case"[ss]":a=60*(60*(24*r.D+r.H)+r.M)+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}l=3===t.length?1:2;break;case 101:a=c,l=1;break}var u=l>0?Bu(a,l):"";return u}function dh(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var ph=/%/g;function mh(e,t,r){var n=t.replace(ph,""),a=t.length-n.length;return _h(e,n,r*Math.pow(10,2*a))+wf("%",a)}function gh(e,t,r){var n=t.length-1;while(44===t.charCodeAt(n-1))--n;return _h(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function Eh(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(0==t)return"0.0E+0";if(t<0)return"-"+Eh(e,-t);var a=e.indexOf(".");-1===a&&(a=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%a;if(s<0&&(s+=a),r=(t/Math.pow(10,s)).toPrecision(n+1+(a+s)%a),-1===r.indexOf("e")){var i=Math.floor(Math.log(t)*Math.LOG10E);-1===r.indexOf(".")?r=r.charAt(0)+"."+r.substr(1)+"E+"+(i-r.length+s):r+="E+"+(i-s);while("0."===r.substr(0,2))r=r.charAt(0)+r.substr(2,a)+"."+r.substr(2+a),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,(function(e,t,r,n){return t+r+n.substr(0,(a+s)%a)+"."+n.substr(s)+"E"}))}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var vh=/# (\?+)( ?)\/( ?)(\d+)/;function Th(e,t,r){var n=parseInt(e[4],10),a=Math.round(t*n),s=Math.floor(a/n),i=a-s*n,o=n;return r+(0===s?"":""+s)+" "+(0===i?wf(" ",e[1].length+1+e[4].length):Yu(i,e[1].length)+e[2]+"/"+e[3]+Bu(o,e[4].length))}function Sh(e,t,r){return r+(0===t?"":""+t)+wf(" ",e[1].length+2+e[4].length)}var Ah=/^#*0*\.([0#]+)/,Rh=/\).*[0#]/,yh=/\(###\) ###\\?-####/;function Nh(e){for(var t,r="",n=0;n!=e.length;++n)switch(t=e.charCodeAt(n)){case 35:break;case 63:r+=" ";break;case 48:r+="0";break;default:r+=String.fromCharCode(t)}return r}function wh(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function bh(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function Ch(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function Oh(e){return e<2147483647&&e>-2147483648?""+(e>=0?0|e:e-1|0):""+Math.floor(e)}function Ih(e,t,r){if(40===e.charCodeAt(0)&&!t.match(Rh)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Ih("n",n,r):"("+Ih("n",n,-r)+")"}if(44===t.charCodeAt(t.length-1))return gh(e,t,r);if(-1!==t.indexOf("%"))return mh(e,t,r);if(-1!==t.indexOf("E"))return Eh(t,r);if(36===t.charCodeAt(0))return"$"+Ih(e,t.substr(" "==t.charAt(1)?2:1),r);var a,s,i,o,c=Math.abs(r),l=r<0?"-":"";if(t.match(/^00+$/))return l+zu(c,t.length);if(t.match(/^[#?]+$/))return a=zu(r,0),"0"===a&&(a=""),a.length>t.length?a:Nh(t.substr(0,t.length-a.length))+a;if(s=t.match(vh))return Th(s,c,l);if(t.match(/^#+0+$/))return l+zu(c,t.length-t.indexOf("0"));if(s=t.match(Ah))return a=wh(r,s[1].length).replace(/^([^\.]+)$/,"$1."+Nh(s[1])).replace(/\.$/,"."+Nh(s[1])).replace(/\.(\d*)$/,(function(e,t){return"."+t+wf("0",Nh(s[1]).length-t.length)})),-1!==t.indexOf("0.")?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return l+wh(c,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return l+dh(zu(c,0));if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Ih(e,t,-r):dh(""+(Math.floor(r)+Ch(r,s[1].length)))+"."+Bu(bh(r,s[1].length),s[1].length);if(s=t.match(/^#,#*,#0/))return Ih(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=Pu(Ih(e,t.replace(/[\\-]/g,""),r)),i=0,Pu(Pu(t.replace(/\\/g,"")).replace(/[0#]/g,(function(e){return i<a.length?a.charAt(i++):"0"===e?"0":""})));if(t.match(yh))return a=Ih(e,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var u="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(s[4].length,7),o=Zu(c,Math.pow(10,i)-1,!1),a=""+l,u=_h("n",s[1],o[1])," "==u.charAt(u.length-1)&&(u=u.substr(0,u.length-1)+"0"),a+=u+s[2]+"/"+s[3],u=Vu(o[2],i),u.length<s[4].length&&(u=Nh(s[4].substr(s[4].length-u.length))+u),a+=u,a;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(s[1].length,s[4].length),7),o=Zu(c,Math.pow(10,i)-1,!0),l+(o[0]||(o[1]?"":"0"))+" "+(o[1]?Yu(o[1],i)+s[2]+"/"+s[3]+Vu(o[2],i):wf(" ",2*i+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return a=zu(r,0),t.length<=a.length?a:Nh(t.substr(0,t.length-a.length))+a;if(s=t.match(/^([#0?]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),i=a.indexOf(".");var h=t.indexOf(".")-i,f=t.length-a.length-h;return Nh(t.substr(0,h)+a+t.substr(t.length-f))}if(s=t.match(/^00,000\.([#0]*0)$/))return i=bh(r,s[1].length),r<0?"-"+Ih(e,t,-r):dh(Oh(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,(function(e){return"00,"+(e.length<3?Bu(0,3-e.length):"")+e}))+"."+Bu(i,s[1].length);switch(t){case"###,##0.00":return Ih(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var d=dh(zu(c,0));return"0"!==d?l+d:"";case"###,###.00":return Ih(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Ih(e,"#,##0.00",r).replace(/^0\./,".");default:}throw new Error("unsupported format |"+t+"|")}function Mh(e,t,r){var n=t.length-1;while(44===t.charCodeAt(n-1))--n;return _h(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function Dh(e,t,r){var n=t.replace(ph,""),a=t.length-n.length;return _h(e,n,r*Math.pow(10,2*a))+wf("%",a)}function Lh(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(0==t)return"0.0E+0";if(t<0)return"-"+Lh(e,-t);var a=e.indexOf(".");-1===a&&(a=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%a;if(s<0&&(s+=a),r=(t/Math.pow(10,s)).toPrecision(n+1+(a+s)%a),!r.match(/[Ee]/)){var i=Math.floor(Math.log(t)*Math.LOG10E);-1===r.indexOf(".")?r=r.charAt(0)+"."+r.substr(1)+"E+"+(i-r.length+s):r+="E+"+(i-s),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,(function(e,t,r,n){return t+r+n.substr(0,(a+s)%a)+"."+n.substr(s)+"E"}))}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function kh(e,t,r){if(40===e.charCodeAt(0)&&!t.match(Rh)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?kh("n",n,r):"("+kh("n",n,-r)+")"}if(44===t.charCodeAt(t.length-1))return Mh(e,t,r);if(-1!==t.indexOf("%"))return Dh(e,t,r);if(-1!==t.indexOf("E"))return Lh(t,r);if(36===t.charCodeAt(0))return"$"+kh(e,t.substr(" "==t.charAt(1)?2:1),r);var a,s,i,o,c=Math.abs(r),l=r<0?"-":"";if(t.match(/^00+$/))return l+Bu(c,t.length);if(t.match(/^[#?]+$/))return a=""+r,0===r&&(a=""),a.length>t.length?a:Nh(t.substr(0,t.length-a.length))+a;if(s=t.match(vh))return Sh(s,c,l);if(t.match(/^#+0+$/))return l+Bu(c,t.length-t.indexOf("0"));if(s=t.match(Ah))return a=(""+r).replace(/^([^\.]+)$/,"$1."+Nh(s[1])).replace(/\.$/,"."+Nh(s[1])),a=a.replace(/\.(\d*)$/,(function(e,t){return"."+t+wf("0",Nh(s[1]).length-t.length)})),-1!==t.indexOf("0.")?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return l+(""+c).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return l+dh(""+c);if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+kh(e,t,-r):dh(""+r)+"."+wf("0",s[1].length);if(s=t.match(/^#,#*,#0/))return kh(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=Pu(kh(e,t.replace(/[\\-]/g,""),r)),i=0,Pu(Pu(t.replace(/\\/g,"")).replace(/[0#]/g,(function(e){return i<a.length?a.charAt(i++):"0"===e?"0":""})));if(t.match(yh))return a=kh(e,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var u="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(s[4].length,7),o=Zu(c,Math.pow(10,i)-1,!1),a=""+l,u=_h("n",s[1],o[1])," "==u.charAt(u.length-1)&&(u=u.substr(0,u.length-1)+"0"),a+=u+s[2]+"/"+s[3],u=Vu(o[2],i),u.length<s[4].length&&(u=Nh(s[4].substr(s[4].length-u.length))+u),a+=u,a;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(s[1].length,s[4].length),7),o=Zu(c,Math.pow(10,i)-1,!0),l+(o[0]||(o[1]?"":"0"))+" "+(o[1]?Yu(o[1],i)+s[2]+"/"+s[3]+Vu(o[2],i):wf(" ",2*i+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return a=""+r,t.length<=a.length?a:Nh(t.substr(0,t.length-a.length))+a;if(s=t.match(/^([#0]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),i=a.indexOf(".");var h=t.indexOf(".")-i,f=t.length-a.length-h;return Nh(t.substr(0,h)+a+t.substr(t.length-f))}if(s=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+kh(e,t,-r):dh(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,(function(e){return"00,"+(e.length<3?Bu(0,3-e.length):"")+e}))+"."+Bu(0,s[1].length);switch(t){case"###,###":case"##,###":case"#,###":var d=dh(""+c);return"0"!==d?l+d:"";default:if(t.match(/\.[0#?]*$/))return kh(e,t.slice(0,t.lastIndexOf(".")),r)+Nh(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function _h(e,t,r){return(0|r)===r?kh(e,t,r):Ih(e,t,r)}function Uh(e){for(var t=[],r=!1,n=0,a=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(a,n-a),a=n+1}if(t[t.length]=e.substr(a),!0===r)throw new Error("Format |"+e+"| unterminated string ");return t}var xh=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Fh(e){var t=0,r="",n="";while(t<e.length)switch(r=e.charAt(t)){case"G":$u(e,t)&&(t+=6),t++;break;case'"':for(;34!==e.charCodeAt(++t)&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if("1"===e.charAt(t+1)||"2"===e.charAt(t+1))return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"上":if("A/P"===e.substr(t,3).toUpperCase())return!0;if("AM/PM"===e.substr(t,5).toUpperCase())return!0;if("上午/下午"===e.substr(t,5).toUpperCase())return!0;++t;break;case"[":n=r;while("]"!==e.charAt(t++)&&t<e.length)n+=e.charAt(t);if(n.match(xh))return!0;break;case".":case"0":case"#":while(t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||"\\"==r&&"-"==e.charAt(t+1)&&"0#".indexOf(e.charAt(t+2))>-1));break;case"?":while(e.charAt(++t)===r);break;case"*":++t," "!=e.charAt(t)&&"*"!=e.charAt(t)||++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":while(t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1);break;case" ":++t;break;default:++t;break}return!1}function Ph(e,t,r,n){var a,s,i,o=[],c="",l=0,u="",h="t",f="H";while(l<e.length)switch(u=e.charAt(l)){case"G":if(!$u(e,l))throw new Error("unrecognized character "+u+" in "+e);o[o.length]={t:"G",v:"General"},l+=7;break;case'"':for(c="";34!==(i=e.charCodeAt(++l))&&l<e.length;)c+=String.fromCharCode(i);o[o.length]={t:"t",v:c},++l;break;case"\\":var d=e.charAt(++l),p="("===d||")"===d?d:"t";o[o.length]={t:p,v:d},++l;break;case"_":o[o.length]={t:"t",v:" "},l+=2;break;case"@":o[o.length]={t:"T",v:t},++l;break;case"B":case"b":if("1"===e.charAt(l+1)||"2"===e.charAt(l+1)){if(null==a&&(a=eh(t,r,"2"===e.charAt(l+1)),null==a))return"";o[o.length]={t:"X",v:e.substr(l,2)},h=u,l+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":u=u.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0)return"";if(null==a&&(a=eh(t,r),null==a))return"";c=u;while(++l<e.length&&e.charAt(l).toLowerCase()===u)c+=u;"m"===u&&"h"===h.toLowerCase()&&(u="M"),"h"===u&&(u=f),o[o.length]={t:u,v:c},h=u;break;case"A":case"a":case"上":var m={t:u,v:u};if(null==a&&(a=eh(t,r)),"A/P"===e.substr(l,3).toUpperCase()?(null!=a&&(m.v=a.H>=12?e.charAt(l+2):u),m.t="T",f="h",l+=3):"AM/PM"===e.substr(l,5).toUpperCase()?(null!=a&&(m.v=a.H>=12?"PM":"AM"),m.t="T",l+=5,f="h"):"上午/下午"===e.substr(l,5).toUpperCase()?(null!=a&&(m.v=a.H>=12?"下午":"上午"),m.t="T",l+=5,f="h"):(m.t="t",++l),null==a&&"T"===m.t)return"";o[o.length]=m,h=u;break;case"[":c=u;while("]"!==e.charAt(l++)&&l<e.length)c+=e.charAt(l);if("]"!==c.slice(-1))throw'unterminated "[" block: |'+c+"|";if(c.match(xh)){if(null==a&&(a=eh(t,r),null==a))return"";o[o.length]={t:"Z",v:c.toLowerCase()},h=c.charAt(1)}else c.indexOf("$")>-1&&(c=(c.match(/\$([^-\[\]]*)/)||[])[1]||"$",Fh(e)||(o[o.length]={t:"t",v:c}));break;case".":if(null!=a){c=u;while(++l<e.length&&"0"===(u=e.charAt(l)))c+=u;o[o.length]={t:"s",v:c};break}case"0":case"#":c=u;while(++l<e.length&&"0#?.,E+-%".indexOf(u=e.charAt(l))>-1)c+=u;o[o.length]={t:"n",v:c};break;case"?":c=u;while(e.charAt(++l)===u)c+=u;o[o.length]={t:u,v:c},h=u;break;case"*":++l," "!=e.charAt(l)&&"*"!=e.charAt(l)||++l;break;case"(":case")":o[o.length]={t:1===n?"t":u,v:u},++l;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":c=u;while(l<e.length&&"0123456789".indexOf(e.charAt(++l))>-1)c+=e.charAt(l);o[o.length]={t:"D",v:c};break;case" ":o[o.length]={t:u,v:u},++l;break;case"$":o[o.length]={t:"t",v:"$"},++l;break;default:if(-1===",$-+/():!^&'~{}<>=€acfijklopqrtuvwxzP".indexOf(u))throw new Error("unrecognized character "+u+" in "+e);o[o.length]={t:"t",v:u},++l;break}var g,E=0,v=0;for(l=o.length-1,h="t";l>=0;--l)switch(o[l].t){case"h":case"H":o[l].t=f,h="h",E<1&&(E=1);break;case"s":(g=o[l].v.match(/\.0+$/))&&(v=Math.max(v,g[0].length-1)),E<3&&(E=3);case"d":case"y":case"M":case"e":h=o[l].t;break;case"m":"s"===h&&(o[l].t="M",E<2&&(E=2));break;case"X":break;case"Z":E<1&&o[l].v.match(/[Hh]/)&&(E=1),E<2&&o[l].v.match(/[Mm]/)&&(E=2),E<3&&o[l].v.match(/[Ss]/)&&(E=3)}switch(E){case 0:break;case 1:a.u>=.5&&(a.u=0,++a.S),a.S>=60&&(a.S=0,++a.M),a.M>=60&&(a.M=0,++a.H);break;case 2:a.u>=.5&&(a.u=0,++a.S),a.S>=60&&(a.S=0,++a.M);break}var T,S="";for(l=0;l<o.length;++l)switch(o[l].t){case"t":case"T":case" ":case"D":break;case"X":o[l].v="",o[l].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":o[l].v=fh(o[l].t.charCodeAt(0),o[l].v,a,v),o[l].t="t";break;case"n":case"?":T=l+1;while(null!=o[T]&&("?"===(u=o[T].t)||"D"===u||(" "===u||"t"===u)&&null!=o[T+1]&&("?"===o[T+1].t||"t"===o[T+1].t&&"/"===o[T+1].v)||"("===o[l].t&&(" "===u||"n"===u||")"===u)||"t"===u&&("/"===o[T].v||" "===o[T].v&&null!=o[T+1]&&"?"==o[T+1].t)))o[l].v+=o[T].v,o[T]={v:"",t:";"},++T;S+=o[l].v,l=T-1;break;case"G":o[l].t="t",o[l].v=uh(t,r);break}var A,R,y="";if(S.length>0){40==S.charCodeAt(0)?(A=t<0&&45===S.charCodeAt(0)?-t:t,R=_h("n",S,A)):(A=t<0&&n>1?-t:t,R=_h("n",S,A),A<0&&o[0]&&"t"==o[0].t&&(R=R.substr(1),o[0].v="-"+o[0].v)),T=R.length-1;var N=o.length;for(l=0;l<o.length;++l)if(null!=o[l]&&"t"!=o[l].t&&o[l].v.indexOf(".")>-1){N=l;break}var w=o.length;if(N===o.length&&-1===R.indexOf("E")){for(l=o.length-1;l>=0;--l)null!=o[l]&&-1!=="n?".indexOf(o[l].t)&&(T>=o[l].v.length-1?(T-=o[l].v.length,o[l].v=R.substr(T+1,o[l].v.length)):T<0?o[l].v="":(o[l].v=R.substr(0,T+1),T=-1),o[l].t="t",w=l);T>=0&&w<o.length&&(o[w].v=R.substr(0,T+1)+o[w].v)}else if(N!==o.length&&-1===R.indexOf("E")){for(T=R.indexOf(".")-1,l=N;l>=0;--l)if(null!=o[l]&&-1!=="n?".indexOf(o[l].t)){for(s=o[l].v.indexOf(".")>-1&&l===N?o[l].v.indexOf(".")-1:o[l].v.length-1,y=o[l].v.substr(s+1);s>=0;--s)T>=0&&("0"===o[l].v.charAt(s)||"#"===o[l].v.charAt(s))&&(y=R.charAt(T--)+y);o[l].v=y,o[l].t="t",w=l}for(T>=0&&w<o.length&&(o[w].v=R.substr(0,T+1)+o[w].v),T=R.indexOf(".")+1,l=N;l<o.length;++l)if(null!=o[l]&&(-1!=="n?(".indexOf(o[l].t)||l===N)){for(s=o[l].v.indexOf(".")>-1&&l===N?o[l].v.indexOf(".")+1:0,y=o[l].v.substr(0,s);s<o[l].v.length;++s)T<R.length&&(y+=R.charAt(T++));o[l].v=y,o[l].t="t",w=l}}}for(l=0;l<o.length;++l)null!=o[l]&&"n?".indexOf(o[l].t)>-1&&(A=n>1&&t<0&&l>0&&"-"===o[l-1].v?-t:t,o[l].v=_h(o[l].t,o[l].v,A),o[l].t="t");var b="";for(l=0;l!==o.length;++l)null!=o[l]&&(b+=o[l].v);return b}var Bh=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Yh(e,t){if(null==t)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function Vh(e,t){var r=Uh(e),n=r.length,a=r[n-1].indexOf("@");if(n<4&&a>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if("number"!==typeof t)return[4,4===r.length||a>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=a>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=a>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=a>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break;case 4:break}var s=t>0?r[0]:t<0?r[1]:r[2];if(-1===r[0].indexOf("[")&&-1===r[1].indexOf("["))return[n,s];if(null!=r[0].match(/\[[=<>]/)||null!=r[1].match(/\[[=<>]/)){var i=r[0].match(Bh),o=r[1].match(Bh);return Yh(t,i)?[n,r[0]]:Yh(t,o)?[n,r[1]]:[n,r[null!=i&&null!=o?2:1]]}return[n,s]}function Wh(e,t,r){null==r&&(r={});var n="";switch(typeof e){case"string":n="m/d/yy"==e&&r.dateNF?r.dateNF:e;break;case"number":n=14==e&&r.dateNF?r.dateNF:(null!=r.table?r.table:qu)[e],null==n&&(n=r.table&&r.table[Ju[e]]||qu[Ju[e]]),null==n&&(n=Qu[e]||"General");break}if($u(n,0))return uh(t,r);t instanceof Date&&(t=ah(t,r.date1904));var a=Vh(n,t);if($u(a[1]))return uh(t,r);if(!0===t)t="TRUE";else if(!1===t)t="FALSE";else if(""===t||null==t)return"";return Ph(a[1],t,r,a[0])}function Gh(e,t){if("number"!=typeof t){t=+t||-1;for(var r=0;r<392;++r)if(void 0!=qu[r]){if(qu[r]==e){t=r;break}}else t<0&&(t=r);t<0&&(t=391)}return qu[t]=e,t}function Hh(e){for(var t=0;392!=t;++t)void 0!==e[t]&&Gh(e[t],t)}function zh(){qu=Ku()}var $h={format:Wh,load:Gh,_table:qu,load_table:Hh,parse_date_code:eh,is_date:Fh,get_table:function(){return $h._table=qu}},jh={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},Xh=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function Kh(e){var t="number"==typeof e?qu[e]:e;return t=t.replace(Xh,"(\\d+)"),new RegExp("^"+t+"$")}function qh(e,t,r){var n=-1,a=-1,s=-1,i=-1,o=-1,c=-1;(t.match(Xh)||[]).forEach((function(e,t){var l=parseInt(r[t+1],10);switch(e.toLowerCase().charAt(0)){case"y":n=l;break;case"d":s=l;break;case"h":i=l;break;case"s":c=l;break;case"m":i>=0?o=l:a=l;break}})),c>=0&&-1==o&&a>=0&&(o=a,a=-1);var l=(""+(n>=0?n:(new Date).getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);7==l.length&&(l="0"+l),8==l.length&&(l="20"+l);var u=("00"+(i>=0?i:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2);return-1==i&&-1==o&&-1==c?l:-1==n&&-1==a&&-1==s?u:l+"T"+u}var Jh={"d.m":"d\\.m"};function Qh(e,t){return Gh(Jh[e]||e,t)}var Zh,ef=function(){var e={};function t(){for(var e=0,t=new Array(256),r=0;256!=r;++r)e=r,e=1&e?-306674912^e>>>1:e>>>1,e=1&e?-306674912^e>>>1:e>>>1,e=1&e?-306674912^e>>>1:e>>>1,e=1&e?-306674912^e>>>1:e>>>1,e=1&e?-306674912^e>>>1:e>>>1,e=1&e?-306674912^e>>>1:e>>>1,e=1&e?-306674912^e>>>1:e>>>1,e=1&e?-306674912^e>>>1:e>>>1,t[r]=e;return"undefined"!==typeof Int32Array?new Int32Array(t):t}e.version="1.2.0";var r=t();function n(e){var t=0,r=0,n=0,a="undefined"!==typeof Int32Array?new Int32Array(4096):new Array(4096);for(n=0;256!=n;++n)a[n]=e[n];for(n=0;256!=n;++n)for(r=e[n],t=256+n;t<4096;t+=256)r=a[t]=r>>>8^e[255&r];var s=[];for(n=1;16!=n;++n)s[n-1]="undefined"!==typeof Int32Array?a.subarray(256*n,256*n+256):a.slice(256*n,256*n+256);return s}var a=n(r),s=a[0],i=a[1],o=a[2],c=a[3],l=a[4],u=a[5],h=a[6],f=a[7],d=a[8],p=a[9],m=a[10],g=a[11],E=a[12],v=a[13],T=a[14];function S(e,t){for(var n=-1^t,a=0,s=e.length;a<s;)n=n>>>8^r[255&(n^e.charCodeAt(a++))];return~n}function A(e,t){for(var n=-1^t,a=e.length-15,S=0;S<a;)n=T[e[S++]^255&n]^v[e[S++]^n>>8&255]^E[e[S++]^n>>16&255]^g[e[S++]^n>>>24]^m[e[S++]]^p[e[S++]]^d[e[S++]]^f[e[S++]]^h[e[S++]]^u[e[S++]]^l[e[S++]]^c[e[S++]]^o[e[S++]]^i[e[S++]]^s[e[S++]]^r[e[S++]];a+=15;while(S<a)n=n>>>8^r[255&(n^e[S++])];return~n}function R(e,t){for(var n=-1^t,a=0,s=e.length,i=0,o=0;a<s;)i=e.charCodeAt(a++),i<128?n=n>>>8^r[255&(n^i)]:i<2048?(n=n>>>8^r[255&(n^(192|i>>6&31))],n=n>>>8^r[255&(n^(128|63&i))]):i>=55296&&i<57344?(i=64+(1023&i),o=1023&e.charCodeAt(a++),n=n>>>8^r[255&(n^(240|i>>8&7))],n=n>>>8^r[255&(n^(128|i>>2&63))],n=n>>>8^r[255&(n^(128|o>>6&15|(3&i)<<4))],n=n>>>8^r[255&(n^(128|63&o))]):(n=n>>>8^r[255&(n^(224|i>>12&15))],n=n>>>8^r[255&(n^(128|i>>6&63))],n=n>>>8^r[255&(n^(128|63&i))]);return~n}return e.table=r,e.bstr=S,e.buf=A,e.str=R,e}(),tf=function(){var e,t={};function r(e,t){for(var r=e.split("/"),n=t.split("/"),a=0,s=0,i=Math.min(r.length,n.length);a<i;++a){if(s=r[a].length-n[a].length)return s;if(r[a]!=n[a])return r[a]<n[a]?-1:1}return r.length-n.length}function n(e){if("/"==e.charAt(e.length-1))return-1===e.slice(0,-1).indexOf("/")?e:n(e.slice(0,-1));var t=e.lastIndexOf("/");return-1===t?e:e.slice(0,t+1)}function a(e){if("/"==e.charAt(e.length-1))return a(e.slice(0,-1));var t=e.lastIndexOf("/");return-1===t?e:e.slice(t+1)}function s(e,t){"string"===typeof t&&(t=new Date(t));var r=t.getHours();r=r<<6|t.getMinutes(),r=r<<5|t.getSeconds()>>>1,e.write_shift(2,r);var n=t.getFullYear()-1980;n=n<<4|t.getMonth()+1,n=n<<5|t.getDate(),e.write_shift(2,n)}function i(e){var t=65535&e.read_shift(2),r=65535&e.read_shift(2),n=new Date,a=31&r;r>>>=5;var s=15&r;r>>>=4,n.setMilliseconds(0),n.setFullYear(r+1980),n.setMonth(s-1),n.setDate(a);var i=31&t;t>>>=5;var o=63&t;return t>>>=6,n.setHours(t),n.setMinutes(o),n.setSeconds(i<<1),n}function o(e){vp(e,0);var t={},r=0;while(e.l<=e.length-4){var n=e.read_shift(2),a=e.read_shift(2),s=e.l+a,i={};switch(n){case 21589:r=e.read_shift(1),1&r&&(i.mtime=e.read_shift(4)),a>5&&(2&r&&(i.atime=e.read_shift(4)),4&r&&(i.ctime=e.read_shift(4))),i.mtime&&(i.mt=new Date(1e3*i.mtime));break;case 1:var o=e.read_shift(4),c=e.read_shift(4);i.usz=c*Math.pow(2,32)+o,o=e.read_shift(4),c=e.read_shift(4),i.csz=c*Math.pow(2,32)+o;break}e.l=s,t[n]=i}return t}function c(){return e||(e=Zh)}function l(e,t){if(80==e[0]&&75==e[1])return Ae(e,t);if(109==(32|e[0])&&105==(32|e[1]))return Me(e,t);if(e.length<512)throw new Error("CFB file size "+e.length+" < 512");var r=3,n=512,a=0,s=0,i=0,o=0,c=0,l=[],p=e.slice(0,512);vp(p,0);var g=u(p);switch(r=g[0],r){case 3:n=512;break;case 4:n=4096;break;case 0:if(0==g[1])return Ae(e,t);default:throw new Error("Major Version: Expected 3 or 4 saw "+r)}512!==n&&(p=e.slice(0,n),vp(p,28));var T=e.slice(0,n);h(p,r);var S=p.read_shift(4,"i");if(3===r&&0!==S)throw new Error("# Directory Sectors: Expected 0 saw "+S);p.l+=4,i=p.read_shift(4,"i"),p.l+=4,p.chk("00100000","Mini Stream Cutoff Size: "),o=p.read_shift(4,"i"),a=p.read_shift(4,"i"),c=p.read_shift(4,"i"),s=p.read_shift(4,"i");for(var A=-1,R=0;R<109;++R){if(A=p.read_shift(4,"i"),A<0)break;l[R]=A}var y=f(e,n);m(c,s,y,n,l);var N=E(y,i,l,n);i<N.length&&(N[i].name="!Directory"),a>0&&o!==I&&(N[o].name="!MiniFAT"),N[l[0]].name="!FAT",N.fat_addrs=l,N.ssz=n;var w={},b=[],C=[],O=[];v(i,N,y,b,a,w,C,o),d(C,O,b),b.shift();var M={FileIndex:C,FullPaths:O};return t&&t.raw&&(M.raw={header:T,sectors:y}),M}function u(e){if(80==e[e.l]&&75==e[e.l+1])return[0,0];e.chk(M,"Header Signature: "),e.l+=16;var t=e.read_shift(2,"u");return[e.read_shift(2,"u"),t]}function h(e,t){var r=9;switch(e.l+=2,r=e.read_shift(2)){case 9:if(3!=t)throw new Error("Sector Shift: Expected 9 saw "+r);break;case 12:if(4!=t)throw new Error("Sector Shift: Expected 12 saw "+r);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+r)}e.chk("0600","Mini Sector Shift: "),e.chk("000000000000","Reserved: ")}function f(e,t){for(var r=Math.ceil(e.length/t)-1,n=[],a=1;a<r;++a)n[a-1]=e.slice(a*t,(a+1)*t);return n[r-1]=e.slice(r*t),n}function d(e,t,r){for(var n=0,a=0,s=0,i=0,o=0,c=r.length,l=[],u=[];n<c;++n)l[n]=u[n]=n,t[n]=r[n];for(;o<u.length;++o)n=u[o],a=e[n].L,s=e[n].R,i=e[n].C,l[n]===n&&(-1!==a&&l[a]!==a&&(l[n]=l[a]),-1!==s&&l[s]!==s&&(l[n]=l[s])),-1!==i&&(l[i]=n),-1!==a&&n!=l[n]&&(l[a]=l[n],u.lastIndexOf(a)<o&&u.push(a)),-1!==s&&n!=l[n]&&(l[s]=l[n],u.lastIndexOf(s)<o&&u.push(s));for(n=1;n<c;++n)l[n]===n&&(-1!==s&&l[s]!==s?l[n]=l[s]:-1!==a&&l[a]!==a&&(l[n]=l[a]));for(n=1;n<c;++n)if(0!==e[n].type){if(o=n,o!=l[o])do{o=l[o],t[n]=t[o]+"/"+t[n]}while(0!==o&&-1!==l[o]&&o!=l[o]);l[n]=-1}for(t[0]+="/",n=1;n<c;++n)2!==e[n].type&&(t[n]+="/")}function p(e,t,r){var n=e.start,a=e.size,s=[],i=n;while(r&&a>0&&i>=0)s.push(t.slice(i*O,i*O+O)),a-=O,i=up(r,4*i);return 0===s.length?Sp(0):_u(s).slice(0,e.size)}function m(e,t,r,n,a){var s=I;if(e===I){if(0!==t)throw new Error("DIFAT chain shorter than expected")}else if(-1!==e){var i=r[e],o=(n>>>2)-1;if(!i)return;for(var c=0;c<o;++c){if((s=up(i,4*c))===I)break;a.push(s)}t>=1&&m(up(i,n-4),t-1,r,n,a)}}function g(e,t,r,n,a){var s=[],i=[];a||(a=[]);var o=n-1,c=0,l=0;for(c=t;c>=0;){a[c]=!0,s[s.length]=c,i.push(e[c]);var u=r[Math.floor(4*c/n)];if(l=4*c&o,n<4+l)throw new Error("FAT boundary crossed: "+c+" 4 "+n);if(!e[u])break;c=up(e[u],l)}return{nodes:s,data:Bd([i])}}function E(e,t,r,n){var a=e.length,s=[],i=[],o=[],c=[],l=n-1,u=0,h=0,f=0,d=0;for(u=0;u<a;++u)if(o=[],f=u+t,f>=a&&(f-=a),!i[f]){c=[];var p=[];for(h=f;h>=0;){p[h]=!0,i[h]=!0,o[o.length]=h,c.push(e[h]);var m=r[Math.floor(4*h/n)];if(d=4*h&l,n<4+d)throw new Error("FAT boundary crossed: "+h+" 4 "+n);if(!e[m])break;if(h=up(e[m],d),p[h])break}s[f]={nodes:o,data:Bd([c])}}return s}function v(e,t,r,n,a,s,i,o){for(var c,l=0,u=n.length?2:0,h=t[e].data,f=0,d=0;f<h.length;f+=128){var m=h.slice(f,f+128);vp(m,64),d=m.read_shift(2),c=Vd(m,0,d-u),n.push(c);var E={name:c,type:m.read_shift(1),color:m.read_shift(1),L:m.read_shift(4,"i"),R:m.read_shift(4,"i"),C:m.read_shift(4,"i"),clsid:m.read_shift(16),state:m.read_shift(4,"i"),start:0,size:0},v=m.read_shift(2)+m.read_shift(2)+m.read_shift(2)+m.read_shift(2);0!==v&&(E.ct=T(m,m.l-8));var S=m.read_shift(2)+m.read_shift(2)+m.read_shift(2)+m.read_shift(2);0!==S&&(E.mt=T(m,m.l-8)),E.start=m.read_shift(4,"i"),E.size=m.read_shift(4,"i"),E.size<0&&E.start<0&&(E.size=E.type=0,E.start=I,E.name=""),5===E.type?(l=E.start,a>0&&l!==I&&(t[l].name="!StreamData")):E.size>=4096?(E.storage="fat",void 0===t[E.start]&&(t[E.start]=g(r,E.start,t.fat_addrs,t.ssz)),t[E.start].name=E.name,E.content=t[E.start].data.slice(0,E.size)):(E.storage="minifat",E.size<0?E.size=0:l!==I&&E.start!==I&&t[l]&&(E.content=p(E,t[l].data,(t[o]||{}).data))),E.content&&vp(E.content,0),s[c]=E,i.push(E)}}function T(e,t){return new Date(1e3*(lp(e,t+4)/1e7*Math.pow(2,32)+lp(e,t)/1e7-11644473600))}function S(t,r){return c(),l(e.readFileSync(t),r)}function A(e,t){var r=t&&t.type;switch(r||Nu&&Buffer.isBuffer(e)&&(r="buffer"),r||"base64"){case"file":return S(e,t);case"base64":return l(Iu(yu(e)),t);case"binary":return l(Iu(e),t)}return l(e,t)}function R(e,t){var r=t||{},n=r.root||"Root Entry";if(e.FullPaths||(e.FullPaths=[]),e.FileIndex||(e.FileIndex=[]),e.FullPaths.length!==e.FileIndex.length)throw new Error("inconsistent CFB structure");0===e.FullPaths.length&&(e.FullPaths[0]=n+"/",e.FileIndex[0]={name:n,type:5}),r.CLSID&&(e.FileIndex[0].clsid=r.CLSID),y(e)}function y(e){var t="Sh33tJ5";if(!tf.find(e,"/"+t)){var r=Sp(4);r[0]=55,r[1]=r[3]=50,r[2]=54,e.FileIndex.push({name:t,type:2,content:r,size:4,L:69,R:69,C:69}),e.FullPaths.push(e.FullPaths[0]+t),N(e)}}function N(e,t){R(e);for(var s=!1,i=!1,o=e.FullPaths.length-1;o>=0;--o){var c=e.FileIndex[o];switch(c.type){case 0:i?s=!0:(e.FileIndex.pop(),e.FullPaths.pop());break;case 1:case 2:case 5:i=!0,isNaN(c.R*c.L*c.C)&&(s=!0),c.R>-1&&c.L>-1&&c.R==c.L&&(s=!0);break;default:s=!0;break}}if(s||t){var l=new Date(1987,1,19),u=0,h=Object.create?Object.create(null):{},f=[];for(o=0;o<e.FullPaths.length;++o)h[e.FullPaths[o]]=!0,0!==e.FileIndex[o].type&&f.push([e.FullPaths[o],e.FileIndex[o]]);for(o=0;o<f.length;++o){var d=n(f[o][0]);i=h[d];while(!i){while(n(d)&&!h[n(d)])d=n(d);f.push([d,{name:a(d).replace("/",""),type:1,clsid:L,ct:l,mt:l,content:null}]),h[d]=!0,d=n(f[o][0]),i=h[d]}}for(f.sort((function(e,t){return r(e[0],t[0])})),e.FullPaths=[],e.FileIndex=[],o=0;o<f.length;++o)e.FullPaths[o]=f[o][0],e.FileIndex[o]=f[o][1];for(o=0;o<f.length;++o){var p=e.FileIndex[o],m=e.FullPaths[o];if(p.name=a(m).replace("/",""),p.L=p.R=p.C=-(p.color=1),p.size=p.content?p.content.length:0,p.start=0,p.clsid=p.clsid||L,0===o)p.C=f.length>1?1:-1,p.size=0,p.type=5;else if("/"==m.slice(-1)){for(u=o+1;u<f.length;++u)if(n(e.FullPaths[u])==m)break;for(p.C=u>=f.length?-1:u,u=o+1;u<f.length;++u)if(n(e.FullPaths[u])==n(m))break;p.R=u>=f.length?-1:u,p.type=1}else n(e.FullPaths[o+1]||"")==n(m)&&(p.R=o+1),p.type=2}}}function w(e,t){var r=t||{};if("mad"==r.fileType)return De(e,r);switch(N(e),r.fileType){case"zip":return ye(e,r)}var n=function(e){for(var t=0,r=0,n=0;n<e.FileIndex.length;++n){var a=e.FileIndex[n];if(a.content){var s=a.content.length;s>0&&(s<4096?t+=s+63>>6:r+=s+511>>9)}}var i=e.FullPaths.length+3>>2,o=t+7>>3,c=t+127>>7,l=o+r+i+c,u=l+127>>7,h=u<=109?0:Math.ceil((u-109)/127);while(l+u+h+127>>7>u)h=++u<=109?0:Math.ceil((u-109)/127);var f=[1,h,u,c,i,r,t,0];return e.FileIndex[0].size=t<<6,f[7]=(e.FileIndex[0].start=f[0]+f[1]+f[2]+f[3]+f[4]+f[5])+(f[6]+7>>3),f}(e),a=Sp(n[7]<<9),s=0,i=0;for(s=0;s<8;++s)a.write_shift(1,D[s]);for(s=0;s<8;++s)a.write_shift(2,0);for(a.write_shift(2,62),a.write_shift(2,3),a.write_shift(2,65534),a.write_shift(2,9),a.write_shift(2,6),s=0;s<3;++s)a.write_shift(2,0);for(a.write_shift(4,0),a.write_shift(4,n[2]),a.write_shift(4,n[0]+n[1]+n[2]+n[3]-1),a.write_shift(4,0),a.write_shift(4,4096),a.write_shift(4,n[3]?n[0]+n[1]+n[2]-1:I),a.write_shift(4,n[3]),a.write_shift(-4,n[1]?n[0]-1:I),a.write_shift(4,n[1]),s=0;s<109;++s)a.write_shift(-4,s<n[2]?n[1]+s:-1);if(n[1])for(i=0;i<n[1];++i){for(;s<236+127*i;++s)a.write_shift(-4,s<n[2]?n[1]+s:-1);a.write_shift(-4,i===n[1]-1?I:i+1)}var o=function(e){for(i+=e;s<i-1;++s)a.write_shift(-4,s+1);e&&(++s,a.write_shift(-4,I))};for(i=s=0,i+=n[1];s<i;++s)a.write_shift(-4,k.DIFSECT);for(i+=n[2];s<i;++s)a.write_shift(-4,k.FATSECT);o(n[3]),o(n[4]);for(var c=0,l=0,u=e.FileIndex[0];c<e.FileIndex.length;++c)u=e.FileIndex[c],u.content&&(l=u.content.length,l<4096||(u.start=i,o(l+511>>9)));o(n[6]+7>>3);while(511&a.l)a.write_shift(-4,k.ENDOFCHAIN);for(i=s=0,c=0;c<e.FileIndex.length;++c)u=e.FileIndex[c],u.content&&(l=u.content.length,!l||l>=4096||(u.start=i,o(l+63>>6)));while(511&a.l)a.write_shift(-4,k.ENDOFCHAIN);for(s=0;s<n[4]<<2;++s){var h=e.FullPaths[s];if(h&&0!==h.length){u=e.FileIndex[s],0===s&&(u.start=u.size?u.start-1:I);var f=0===s&&r.root||u.name;if(f.length>32&&(console.error("Name "+f+" will be truncated to "+f.slice(0,32)),f=f.slice(0,32)),l=2*(f.length+1),a.write_shift(64,f,"utf16le"),a.write_shift(2,l),a.write_shift(1,u.type),a.write_shift(1,u.color),a.write_shift(-4,u.L),a.write_shift(-4,u.R),a.write_shift(-4,u.C),u.clsid)a.write_shift(16,u.clsid,"hex");else for(c=0;c<4;++c)a.write_shift(4,0);a.write_shift(4,u.state||0),a.write_shift(4,0),a.write_shift(4,0),a.write_shift(4,0),a.write_shift(4,0),a.write_shift(4,u.start),a.write_shift(4,u.size),a.write_shift(4,0)}else{for(c=0;c<17;++c)a.write_shift(4,0);for(c=0;c<3;++c)a.write_shift(4,-1);for(c=0;c<12;++c)a.write_shift(4,0)}}for(s=1;s<e.FileIndex.length;++s)if(u=e.FileIndex[s],u.size>=4096)if(a.l=u.start+1<<9,Nu&&Buffer.isBuffer(u.content))u.content.copy(a,a.l,0,u.size),a.l+=u.size+511&-512;else{for(c=0;c<u.size;++c)a.write_shift(1,u.content[c]);for(;511&c;++c)a.write_shift(1,0)}for(s=1;s<e.FileIndex.length;++s)if(u=e.FileIndex[s],u.size>0&&u.size<4096)if(Nu&&Buffer.isBuffer(u.content))u.content.copy(a,a.l,0,u.size),a.l+=u.size+63&-64;else{for(c=0;c<u.size;++c)a.write_shift(1,u.content[c]);for(;63&c;++c)a.write_shift(1,0)}if(Nu)a.l=a.length;else while(a.l<a.length)a.write_shift(1,0);return a}function b(e,t){var r=e.FullPaths.map((function(e){return e.toUpperCase()})),n=r.map((function(e){var t=e.split("/");return t[t.length-("/"==e.slice(-1)?2:1)]})),a=!1;47===t.charCodeAt(0)?(a=!0,t=r[0].slice(0,-1)+t):a=-1!==t.indexOf("/");var s=t.toUpperCase(),i=!0===a?r.indexOf(s):n.indexOf(s);if(-1!==i)return e.FileIndex[i];var o=!s.match(Fu);for(s=s.replace(xu,""),o&&(s=s.replace(Fu,"!")),i=0;i<r.length;++i){if((o?r[i].replace(Fu,"!"):r[i]).replace(xu,"")==s)return e.FileIndex[i];if((o?n[i].replace(Fu,"!"):n[i]).replace(xu,"")==s)return e.FileIndex[i]}return null}t.version="1.2.2";var C,O=64,I=-2,M="d0cf11e0a1b11ae1",D=[208,207,17,224,161,177,26,225],L="00000000000000000000000000000000",k={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:I,FREESECT:-1,HEADER_SIGNATURE:M,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:L,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function _(t,r,n){c();var a=w(t,n);e.writeFileSync(r,a)}function U(e){for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function x(t,r){var n=w(t,r);switch(r&&r.type||"buffer"){case"file":return c(),e.writeFileSync(r.filename,n),n;case"binary":return"string"==typeof n?n:U(n);case"base64":return Au("string"==typeof n?n:U(n));case"buffer":if(Nu)return Buffer.isBuffer(n)?n:wu(n);case"array":return"string"==typeof n?Iu(n):n}return n}function F(e){try{var t=e.InflateRaw,r=new t;if(r._processChunk(new Uint8Array([3,0]),r._finishFlushFlag),!r.bytesRead)throw new Error("zlib does not expose bytesRead");C=e}catch(n){console.error("cannot use native zlib: "+(n.message||n))}}function P(e,t){if(!C)return Te(e,t);var r=C.InflateRaw,n=new r,a=n._processChunk(e.slice(e.l),n._finishFlushFlag);return e.l+=n.bytesRead,a}function B(e){return C?C.deflateRawSync(e):he(e)}var Y=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],V=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],W=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function G(e){var t=139536&(e<<1|e<<11)|558144&(e<<5|e<<15);return 255&(t>>16|t>>8|t)}for(var H="undefined"!==typeof Uint8Array,z=H?new Uint8Array(256):[],$=0;$<256;++$)z[$]=G($);function j(e,t){var r=z[255&e];return t<=8?r>>>8-t:(r=r<<8|z[e>>8&255],t<=16?r>>>16-t:(r=r<<8|z[e>>16&255],r>>>24-t))}function X(e,t){var r=7&t,n=t>>>3;return(e[n]|(r<=6?0:e[n+1]<<8))>>>r&3}function K(e,t){var r=7&t,n=t>>>3;return(e[n]|(r<=5?0:e[n+1]<<8))>>>r&7}function q(e,t){var r=7&t,n=t>>>3;return(e[n]|(r<=4?0:e[n+1]<<8))>>>r&15}function J(e,t){var r=7&t,n=t>>>3;return(e[n]|(r<=3?0:e[n+1]<<8))>>>r&31}function Q(e,t){var r=7&t,n=t>>>3;return(e[n]|(r<=1?0:e[n+1]<<8))>>>r&127}function Z(e,t,r){var n=7&t,a=t>>>3,s=(1<<r)-1,i=e[a]>>>n;return r<8-n?i&s:(i|=e[a+1]<<8-n,r<16-n?i&s:(i|=e[a+2]<<16-n,r<24-n||(i|=e[a+3]<<24-n),i&s))}function ee(e,t,r){var n=7&t,a=t>>>3;return n<=5?e[a]|=(7&r)<<n:(e[a]|=r<<n&255,e[a+1]=(7&r)>>8-n),t+3}function te(e,t,r){var n=7&t,a=t>>>3;return r=(1&r)<<n,e[a]|=r,t+1}function re(e,t,r){var n=7&t,a=t>>>3;return r<<=n,e[a]|=255&r,r>>>=8,e[a+1]=r,t+8}function ne(e,t,r){var n=7&t,a=t>>>3;return r<<=n,e[a]|=255&r,r>>>=8,e[a+1]=255&r,e[a+2]=r>>>8,t+16}function ae(e,t){var r=e.length,n=2*r>t?2*r:t+5,a=0;if(r>=t)return e;if(Nu){var s=Ou(n);if(e.copy)e.copy(s);else for(;a<e.length;++a)s[a]=e[a];return s}if(H){var i=new Uint8Array(n);if(i.set)i.set(e);else for(;a<r;++a)i[a]=e[a];return i}return e.length=n,e}function se(e){for(var t=new Array(e),r=0;r<e;++r)t[r]=0;return t}function ie(e,t,r){var n=1,a=0,s=0,i=0,o=0,c=e.length,l=H?new Uint16Array(32):se(32);for(s=0;s<32;++s)l[s]=0;for(s=c;s<r;++s)e[s]=0;c=e.length;var u=H?new Uint16Array(c):se(c);for(s=0;s<c;++s)l[a=e[s]]++,n<a&&(n=a),u[s]=0;for(l[0]=0,s=1;s<=n;++s)l[s+16]=o=o+l[s-1]<<1;for(s=0;s<c;++s)o=e[s],0!=o&&(u[s]=l[o+16]++);var h=0;for(s=0;s<c;++s)if(h=e[s],0!=h)for(o=j(u[s],n)>>n-h,i=(1<<n+4-h)-1;i>=0;--i)t[o|i<<h]=15&h|s<<4;return n}var oe=H?new Uint16Array(512):se(512),ce=H?new Uint16Array(32):se(32);if(!H){for(var le=0;le<512;++le)oe[le]=0;for(le=0;le<32;++le)ce[le]=0}(function(){for(var e=[],t=0;t<32;t++)e.push(5);ie(e,ce,32);var r=[];for(t=0;t<=143;t++)r.push(8);for(;t<=255;t++)r.push(9);for(;t<=279;t++)r.push(7);for(;t<=287;t++)r.push(8);ie(r,oe,288)})();var ue=function(){for(var e=H?new Uint8Array(32768):[],t=0,r=0;t<W.length-1;++t)for(;r<W[t+1];++r)e[r]=t;for(;r<32768;++r)e[r]=29;var n=H?new Uint8Array(259):[];for(t=0,r=0;t<V.length-1;++t)for(;r<V[t+1];++r)n[r]=t;function a(e,t){var r=0;while(r<e.length){var n=Math.min(65535,e.length-r),a=r+n==e.length;t.write_shift(1,+a),t.write_shift(2,n),t.write_shift(2,65535&~n);while(n-- >0)t[t.l++]=e[r++]}return t.l}function s(t,r){var a=0,s=0,i=H?new Uint16Array(32768):[];while(s<t.length){var o=Math.min(65535,t.length-s);if(o<10){a=ee(r,a,+!(s+o!=t.length)),7&a&&(a+=8-(7&a)),r.l=a/8|0,r.write_shift(2,o),r.write_shift(2,65535&~o);while(o-- >0)r[r.l++]=t[s++];a=8*r.l}else{a=ee(r,a,+!(s+o!=t.length)+2);var c=0;while(o-- >0){var l=t[s];c=32767&(c<<5^l);var u=-1,h=0;if((u=i[c])&&(u|=-32768&s,u>s&&(u-=32768),u<s))while(t[u+h]==t[s+h]&&h<250)++h;if(h>2){l=n[h],l<=22?a=re(r,a,z[l+1]>>1)-1:(re(r,a,3),a+=5,re(r,a,z[l-23]>>5),a+=3);var f=l<8?0:l-4>>2;f>0&&(ne(r,a,h-V[l]),a+=f),l=e[s-u],a=re(r,a,z[l]>>3),a-=3;var d=l<4?0:l-2>>1;d>0&&(ne(r,a,s-u-W[l]),a+=d);for(var p=0;p<h;++p)i[c]=32767&s,c=32767&(c<<5^t[s]),++s;o-=h-1}else l<=143?l+=48:a=te(r,a,1),a=re(r,a,z[l]),i[c]=32767&s,++s}a=re(r,a,0)-1}}return r.l=(a+7)/8|0,r.l}return function(e,t){return e.length<8?a(e,t):s(e,t)}}();function he(e){var t=Sp(50+Math.floor(1.1*e.length)),r=ue(e,t);return t.slice(0,r)}var fe=H?new Uint16Array(32768):se(32768),de=H?new Uint16Array(32768):se(32768),pe=H?new Uint16Array(128):se(128),me=1,ge=1;function Ee(e,t){var r=J(e,t)+257;t+=5;var n=J(e,t)+1;t+=5;var a=q(e,t)+4;t+=4;for(var s=0,i=H?new Uint8Array(19):se(19),o=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],c=1,l=H?new Uint8Array(8):se(8),u=H?new Uint8Array(8):se(8),h=i.length,f=0;f<a;++f)i[Y[f]]=s=K(e,t),c<s&&(c=s),l[s]++,t+=3;var d=0;for(l[0]=0,f=1;f<=c;++f)u[f]=d=d+l[f-1]<<1;for(f=0;f<h;++f)0!=(d=i[f])&&(o[f]=u[d]++);var p=0;for(f=0;f<h;++f)if(p=i[f],0!=p){d=z[o[f]]>>8-p;for(var m=(1<<7-p)-1;m>=0;--m)pe[d|m<<p]=7&p|f<<3}var g=[];for(c=1;g.length<r+n;)switch(d=pe[Q(e,t)],t+=7&d,d>>>=3){case 16:s=3+X(e,t),t+=2,d=g[g.length-1];while(s-- >0)g.push(d);break;case 17:s=3+K(e,t),t+=3;while(s-- >0)g.push(0);break;case 18:s=11+Q(e,t),t+=7;while(s-- >0)g.push(0);break;default:g.push(d),c<d&&(c=d);break}var E=g.slice(0,r),v=g.slice(r);for(f=r;f<286;++f)E[f]=0;for(f=n;f<30;++f)v[f]=0;return me=ie(E,fe,286),ge=ie(v,de,30),t}function ve(e,t){if(3==e[0]&&!(3&e[1]))return[Cu(t),2];var r=0,n=0,a=Ou(t||1<<18),s=0,i=a.length>>>0,o=0,c=0;while(0==(1&n))if(n=K(e,r),r+=3,n>>>1!=0)for(n>>1==1?(o=9,c=5):(r=Ee(e,r),o=me,c=ge);;){!t&&i<s+32767&&(a=ae(a,s+32767),i=a.length);var l=Z(e,r,o),u=n>>>1==1?oe[l]:fe[l];if(r+=15&u,u>>>=4,0===(u>>>8&255))a[s++]=u;else{if(256==u)break;u-=257;var h=u<8?0:u-4>>2;h>5&&(h=0);var f=s+V[u];h>0&&(f+=Z(e,r,h),r+=h),l=Z(e,r,c),u=n>>>1==1?ce[l]:de[l],r+=15&u,u>>>=4;var d=u<4?0:u-2>>1,p=W[u];d>0&&(p+=Z(e,r,d),r+=d),!t&&i<f&&(a=ae(a,f+100),i=a.length);while(s<f)a[s]=a[s-p],++s}}else{7&r&&(r+=8-(7&r));var m=e[r>>>3]|e[1+(r>>>3)]<<8;if(r+=32,m>0){!t&&i<s+m&&(a=ae(a,s+m),i=a.length);while(m-- >0)a[s++]=e[r>>>3],r+=8}}return t?[a,r+7>>>3]:[a.slice(0,s),r+7>>>3]}function Te(e,t){var r=e.slice(e.l||0),n=ve(r,t);return e.l+=n[1],n[0]}function Se(e,t){if(!e)throw new Error(t);"undefined"!==typeof console&&console.error(t)}function Ae(e,t){var r=e;vp(r,0);var n=[],a=[],s={FileIndex:n,FullPaths:a};R(s,{root:t.root});var i=r.length-4;while((80!=r[i]||75!=r[i+1]||5!=r[i+2]||6!=r[i+3])&&i>=0)--i;r.l=i+4,r.l+=4;var c=r.read_shift(2);r.l+=6;var l=r.read_shift(4);for(r.l=l,i=0;i<c;++i){r.l+=20;var u=r.read_shift(4),h=r.read_shift(4),f=r.read_shift(2),d=r.read_shift(2),p=r.read_shift(2);r.l+=8;var m=r.read_shift(4),g=o(r.slice(r.l+f,r.l+f+d));r.l+=f+d+p;var E=r.l;r.l=m+4,g&&g[1]&&((g[1]||{}).usz&&(h=g[1].usz),(g[1]||{}).csz&&(u=g[1].csz)),Re(r,u,h,s,g),r.l=E}return s}function Re(e,t,r,n,a){e.l+=2;var s=e.read_shift(2),c=e.read_shift(2),l=i(e);if(8257&s)throw new Error("Unsupported ZIP encryption");for(var u=e.read_shift(4),h=e.read_shift(4),f=e.read_shift(4),d=e.read_shift(2),p=e.read_shift(2),m="",g=0;g<d;++g)m+=String.fromCharCode(e[e.l++]);if(p){var E=o(e.slice(e.l,e.l+p));(E[21589]||{}).mt&&(l=E[21589].mt),(E[1]||{}).usz&&(f=E[1].usz),(E[1]||{}).csz&&(h=E[1].csz),a&&((a[21589]||{}).mt&&(l=a[21589].mt),(a[1]||{}).usz&&(f=E[1].usz),(a[1]||{}).csz&&(h=E[1].csz))}e.l+=p;var v=e.slice(e.l,e.l+h);switch(c){case 8:v=P(e,f);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+c)}var T=!1;8&s&&(u=e.read_shift(4),134695760==u&&(u=e.read_shift(4),T=!0),h=e.read_shift(4),f=e.read_shift(4)),h!=t&&Se(T,"Bad compressed size: "+t+" != "+h),f!=r&&Se(T,"Bad uncompressed size: "+r+" != "+f),ke(n,m,v,{unsafe:!0,mt:l})}function ye(e,t){var r=t||{},n=[],a=[],i=Sp(1),o=r.compression?8:0,c=0,l=!1;l&&(c|=8);var u=0,h=0,f=0,d=0,p=e.FullPaths[0],m=p,g=e.FileIndex[0],E=[],v=0;for(u=1;u<e.FullPaths.length;++u)if(m=e.FullPaths[u].slice(p.length),g=e.FileIndex[u],g.size&&g.content&&"Sh33tJ5"!=m){var T=f,S=Sp(m.length);for(h=0;h<m.length;++h)S.write_shift(1,127&m.charCodeAt(h));S=S.slice(0,S.l),E[d]="string"==typeof g.content?ef.bstr(g.content,0):ef.buf(g.content,0);var A="string"==typeof g.content?Iu(g.content):g.content;8==o&&(A=B(A)),i=Sp(30),i.write_shift(4,67324752),i.write_shift(2,20),i.write_shift(2,c),i.write_shift(2,o),g.mt?s(i,g.mt):i.write_shift(4,0),i.write_shift(-4,8&c?0:E[d]),i.write_shift(4,8&c?0:A.length),i.write_shift(4,8&c?0:g.content.length),i.write_shift(2,S.length),i.write_shift(2,0),f+=i.length,n.push(i),f+=S.length,n.push(S),f+=A.length,n.push(A),8&c&&(i=Sp(12),i.write_shift(-4,E[d]),i.write_shift(4,A.length),i.write_shift(4,g.content.length),f+=i.l,n.push(i)),i=Sp(46),i.write_shift(4,33639248),i.write_shift(2,0),i.write_shift(2,20),i.write_shift(2,c),i.write_shift(2,o),i.write_shift(4,0),i.write_shift(-4,E[d]),i.write_shift(4,A.length),i.write_shift(4,g.content.length),i.write_shift(2,S.length),i.write_shift(2,0),i.write_shift(2,0),i.write_shift(2,0),i.write_shift(2,0),i.write_shift(4,0),i.write_shift(4,T),v+=i.l,a.push(i),v+=S.length,a.push(S),++d}return i=Sp(22),i.write_shift(4,101010256),i.write_shift(2,0),i.write_shift(2,0),i.write_shift(2,d),i.write_shift(2,d),i.write_shift(4,v),i.write_shift(4,f),i.write_shift(2,0),_u([_u(n),_u(a),i])}var Ne={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function we(e,t){if(e.ctype)return e.ctype;var r=e.name||"",n=r.match(/\.([^\.]+)$/);return n&&Ne[n[1]]||t&&(n=(r=t).match(/[\.\\]([^\.\\])+$/),n&&Ne[n[1]])?Ne[n[1]]:"application/octet-stream"}function be(e){for(var t=Au(e),r=[],n=0;n<t.length;n+=76)r.push(t.slice(n,n+76));return r.join("\r\n")+"\r\n"}function Ce(e){var t=e.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,(function(e){var t=e.charCodeAt(0).toString(16).toUpperCase();return"="+(1==t.length?"0"+t:t)}));t=t.replace(/ $/gm,"=20").replace(/\t$/gm,"=09"),"\n"==t.charAt(0)&&(t="=0D"+t.slice(1)),t=t.replace(/\r(?!\n)/gm,"=0D").replace(/\n\n/gm,"\n=0A").replace(/([^\r\n])\n/gm,"$1=0A");for(var r=[],n=t.split("\r\n"),a=0;a<n.length;++a){var s=n[a];if(0!=s.length)for(var i=0;i<s.length;){var o=76,c=s.slice(i,i+o);"="==c.charAt(o-1)?o--:"="==c.charAt(o-2)?o-=2:"="==c.charAt(o-3)&&(o-=3),c=s.slice(i,i+o),i+=o,i<s.length&&(c+="="),r.push(c)}else r.push("")}return r.join("\r\n")}function Oe(e){for(var t=[],r=0;r<e.length;++r){var n=e[r];while(r<=e.length&&"="==n.charAt(n.length-1))n=n.slice(0,n.length-1)+e[++r];t.push(n)}for(var a=0;a<t.length;++a)t[a]=t[a].replace(/[=][0-9A-Fa-f]{2}/g,(function(e){return String.fromCharCode(parseInt(e.slice(1),16))}));return Iu(t.join("\r\n"))}function Ie(e,t,r){for(var n,a="",s="",i="",o=0;o<10;++o){var c=t[o];if(!c||c.match(/^\s*$/))break;var l=c.match(/^(.*?):\s*([^\s].*)$/);if(l)switch(l[1].toLowerCase()){case"content-location":a=l[2].trim();break;case"content-type":i=l[2].trim();break;case"content-transfer-encoding":s=l[2].trim();break}}switch(++o,s.toLowerCase()){case"base64":n=Iu(yu(t.slice(o).join("")));break;case"quoted-printable":n=Oe(t.slice(o));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+s)}var u=ke(e,a.slice(r.length),n,{unsafe:!0});i&&(u.ctype=i)}function Me(e,t){if("mime-version:"!=U(e.slice(0,13)).toLowerCase())throw new Error("Unsupported MAD header");var r=t&&t.root||"",n=(Nu&&Buffer.isBuffer(e)?e.toString("binary"):U(e)).split("\r\n"),a=0,s="";for(a=0;a<n.length;++a)if(s=n[a],/^Content-Location:/i.test(s)&&(s=s.slice(s.indexOf("file")),r||(r=s.slice(0,s.lastIndexOf("/")+1)),s.slice(0,r.length)!=r))while(r.length>0)if(r=r.slice(0,r.length-1),r=r.slice(0,r.lastIndexOf("/")+1),s.slice(0,r.length)==r)break;var i=(n[1]||"").match(/boundary="(.*?)"/);if(!i)throw new Error("MAD cannot find boundary");var o="--"+(i[1]||""),c=[],l=[],u={FileIndex:c,FullPaths:l};R(u);var h,f=0;for(a=0;a<n.length;++a){var d=n[a];d!==o&&d!==o+"--"||(f++&&Ie(u,n.slice(h,a),r),h=a)}return u}function De(e,t){var r=t||{},n=r.boundary||"SheetJS";n="------="+n;for(var a=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+n.slice(2)+'"',"","",""],s=e.FullPaths[0],i=s,o=e.FileIndex[0],c=1;c<e.FullPaths.length;++c)if(i=e.FullPaths[c].slice(s.length),o=e.FileIndex[c],o.size&&o.content&&"Sh33tJ5"!=i){i=i.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,(function(e){return"_x"+e.charCodeAt(0).toString(16)+"_"})).replace(/[\u0080-\uFFFF]/g,(function(e){return"_u"+e.charCodeAt(0).toString(16)+"_"}));for(var l=o.content,u=Nu&&Buffer.isBuffer(l)?l.toString("binary"):U(l),h=0,f=Math.min(1024,u.length),d=0,p=0;p<=f;++p)(d=u.charCodeAt(p))>=32&&d<128&&++h;var m=h>=4*f/5;a.push(n),a.push("Content-Location: "+(r.root||"file:///C:/SheetJS/")+i),a.push("Content-Transfer-Encoding: "+(m?"quoted-printable":"base64")),a.push("Content-Type: "+we(o,i)),a.push(""),a.push(m?Ce(u):be(u))}return a.push(n+"--\r\n"),a.join("\r\n")}function Le(e){var t={};return R(t,e),t}function ke(e,t,r,n){var s=n&&n.unsafe;s||R(e);var i=!s&&tf.find(e,t);if(!i){var o=e.FullPaths[0];t.slice(0,o.length)==o?o=t:("/"!=o.slice(-1)&&(o+="/"),o=(o+t).replace("//","/")),i={name:a(t),type:2},e.FileIndex.push(i),e.FullPaths.push(o),s||tf.utils.cfb_gc(e)}return i.content=r,i.size=r?r.length:0,n&&(n.CLSID&&(i.clsid=n.CLSID),n.mt&&(i.mt=n.mt),n.ct&&(i.ct=n.ct)),i}function _e(e,t){R(e);var r=tf.find(e,t);if(r)for(var n=0;n<e.FileIndex.length;++n)if(e.FileIndex[n]==r)return e.FileIndex.splice(n,1),e.FullPaths.splice(n,1),!0;return!1}function Ue(e,t,r){R(e);var n=tf.find(e,t);if(n)for(var s=0;s<e.FileIndex.length;++s)if(e.FileIndex[s]==n)return e.FileIndex[s].name=a(r),e.FullPaths[s]=r,!0;return!1}function xe(e){N(e,!0)}return t.find=b,t.read=A,t.parse=l,t.write=x,t.writeFile=_,t.utils={cfb_new:Le,cfb_add:ke,cfb_del:_e,cfb_mov:Ue,cfb_gc:xe,ReadShift:fp,CheckField:Ep,prep_blob:vp,bconcat:_u,use_zlib:F,_deflateRaw:he,_inflateRaw:Te,consts:k},t}();function rf(e){Zh=e}function nf(e){return"string"===typeof e?Mu(e):Array.isArray(e)?Lu(e):e}function af(e,t,r){if("undefined"!==typeof Zh&&Zh.writeFileSync)return r?Zh.writeFileSync(e,t,r):Zh.writeFileSync(e,t);if("undefined"!==typeof Deno){if(r&&"string"==typeof t)switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=Mu(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var n="utf8"==r?vd(t):t;if("undefined"!==typeof IE_SaveFile)return IE_SaveFile(n,e);if("undefined"!==typeof Blob){var a=new Blob([nf(n)],{type:"application/octet-stream"});if("undefined"!==typeof navigator&&navigator.msSaveBlob)return navigator.msSaveBlob(a,e);if("undefined"!==typeof saveAs)return saveAs(a,e);if("undefined"!==typeof URL&&"undefined"!==typeof document&&document.createElement&&URL.createObjectURL){var s=URL.createObjectURL(a);if("object"===typeof chrome&&"function"==typeof(chrome.downloads||{}).download)return URL.revokeObjectURL&&"undefined"!==typeof setTimeout&&setTimeout((function(){URL.revokeObjectURL(s)}),6e4),chrome.downloads.download({url:s,filename:e,saveAs:!0});var i=document.createElement("a");if(null!=i.download)return i.download=e,i.href=s,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL&&"undefined"!==typeof setTimeout&&setTimeout((function(){URL.revokeObjectURL(s)}),6e4),s}}if("undefined"!==typeof $&&"undefined"!==typeof File&&"undefined"!==typeof Folder)try{var o=File(e);return o.open("w"),o.encoding="binary",Array.isArray(t)&&(t=Du(t)),o.write(t),o.close(),t}catch(c){if(!c.message||!c.message.match(/onstruct/))throw c}throw new Error("cannot save file "+e)}function sf(e){if("undefined"!==typeof Zh)return Zh.readFileSync(e);if("undefined"!==typeof Deno)return Deno.readFileSync(e);if("undefined"!==typeof $&&"undefined"!==typeof File&&"undefined"!==typeof Folder)try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}function of(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function cf(e,t){for(var r=[],n=of(e),a=0;a!==n.length;++a)null==r[e[n[a]][t]]&&(r[e[n[a]][t]]=n[a]);return r}function lf(e){for(var t=[],r=of(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}function uf(e){for(var t=[],r=of(e),n=0;n!==r.length;++n)t[e[r[n]]]=parseInt(r[n],10);return t}function hf(e){for(var t=[],r=of(e),n=0;n!==r.length;++n)null==t[e[r[n]]]&&(t[e[r[n]]]=[]),t[e[r[n]]].push(r[n]);return t}var ff=new Date(1899,11,30,0,0,0);function df(e,t){var r=e.getTime();t&&(r-=1263168e5);var n=ff.getTime()+6e4*(e.getTimezoneOffset()-ff.getTimezoneOffset());return(r-n)/864e5}var pf=new Date,mf=ff.getTime()+6e4*(pf.getTimezoneOffset()-ff.getTimezoneOffset()),gf=pf.getTimezoneOffset();function Ef(e){var t=new Date;return t.setTime(24*e*60*60*1e3+mf),t.getTimezoneOffset()!==gf&&t.setTime(t.getTime()+6e4*(t.getTimezoneOffset()-gf)),t}function vf(e){var t=0,r=0,n=!1,a=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!a)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var s=1;s!=a.length;++s)if(a[s]){switch(r=1,s>3&&(n=!0),a[s].slice(a[s].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+a[s].slice(a[s].length-1));case"D":r*=24;case"H":r*=60;case"M":if(!n)throw new Error("Unsupported ISO Duration Field: M");r*=60;case"S":break}t+=r*parseInt(a[s],10)}return t}var Tf=new Date("2017-02-19T19:06:09.000Z"),Sf=isNaN(Tf.getFullYear())?new Date("2/19/17"):Tf,Af=2017==Sf.getFullYear();function Rf(e,t){var r=new Date(e);if(Af)return t>0?r.setTime(r.getTime()+60*r.getTimezoneOffset()*1e3):t<0&&r.setTime(r.getTime()-60*r.getTimezoneOffset()*1e3),r;if(e instanceof Date)return e;if(1917==Sf.getFullYear()&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var a=e.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return e.indexOf("Z")>-1&&(s=new Date(s.getTime()-60*s.getTimezoneOffset()*1e3)),s}function yf(e,t){if(Nu&&Buffer.isBuffer(e)){if(t&&bu){if(255==e[0]&&254==e[1])return vd(e.slice(2).toString("utf16le"));if(254==e[1]&&255==e[2])return vd(du(e.slice(2).toString("binary")))}return e.toString("binary")}if("undefined"!==typeof TextDecoder)try{if(t){if(255==e[0]&&254==e[1])return vd(new TextDecoder("utf-16le").decode(e.slice(2)));if(254==e[0]&&255==e[1])return vd(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"€":"","‚":"","ƒ":"","„":"","…":"","†":"","‡":"","ˆ":"","‰":"","Š":"","‹":"","Œ":"","Ž":"","‘":"","’":"","“":"","”":"","•":"","–":"","—":"","˜":"","™":"","š":"","›":"","œ":"","ž":"","Ÿ":""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[€‚ƒ„…†‡ˆ‰Š‹ŒŽ‘’“”•–—˜™š›œžŸ]/g,(function(e){return r[e]||e}))}catch(s){}for(var n=[],a=0;a!=e.length;++a)n.push(String.fromCharCode(e[a]));return n.join("")}function Nf(e){if("undefined"!=typeof JSON&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if("object"!=typeof e||null==e)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=Nf(e[r]));return t}function wf(e,t){var r="";while(r.length<t)r+=e;return r}function bf(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,(function(){return r*=100,""}));return isNaN(t=Number(n))?(n=n.replace(/[(](.*)[)]/,(function(e,t){return r=-r,t})),isNaN(t=Number(n))?t:t/r):t/r}var Cf=/^(0?\d|1[0-2])(?:|:([0-5]?\d)(?:|(\.\d+)(?:|:([0-5]?\d))|:([0-5]?\d)(|\.\d+)))\s+([ap])m?$/;function Of(e){return e[2]?e[3]?e[4]?new Date(1899,11,30,+e[1]%12+("p"==e[7]?12:0),+e[2],+e[4],1e3*parseFloat(e[3])):new Date(1899,11,30,"p"==e[7]?12:0,+e[1],+e[2],1e3*parseFloat(e[3])):e[5]?new Date(1899,11,30,+e[1]%12+("p"==e[7]?12:0),+e[2],+e[5],e[6]?1e3*parseFloat(e[6]):0):new Date(1899,11,30,+e[1]%12+("p"==e[7]?12:0),+e[2],0,0):new Date(1899,11,30,+e[1]%12+("p"==e[7]?12:0),0,0,0)}var If=["january","february","march","april","may","june","july","august","september","october","november","december"];function Mf(e){var t=e.toLowerCase(),r=t.replace(/\s+/g," ").trim(),n=r.match(Cf);if(n)return Of(n);var a=new Date(e),s=new Date(NaN),i=a.getYear(),o=(a.getMonth(),a.getDate());if(isNaN(o))return s;if(t.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(t=t.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),t.length>3&&-1==If.indexOf(t))return s}else if(t.replace(/[ap]m?/,"").match(/[a-z]/))return s;return i<0||i>8099||e.match(/[^-0-9:,\/\\]/)?s:a}var Df=function(){var e=5=="abacaba".split(/(:?b)/i).length;return function(t,r,n){if(e||"string"==typeof r)return t.split(r);for(var a=t.split(r),s=[a[0]],i=1;i<a.length;++i)s.push(n),s.push(a[i]);return s}}();function Lf(e){return e?e.content&&e.type?yf(e.content,!0):e.data?pu(e.data):e.asNodeBuffer&&Nu?pu(e.asNodeBuffer().toString("binary")):e.asBinary?pu(e.asBinary()):e._data&&e._data.getContent?pu(yf(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function kf(e){if(!e)return null;if(e.data)return hu(e.data);if(e.asNodeBuffer&&Nu)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return"string"==typeof t?hu(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function _f(e){return e&&".bin"===e.name.slice(-4)?kf(e):Lf(e)}function Uf(e,t){for(var r=e.FullPaths||of(e.files),n=t.toLowerCase().replace(/[\/]/g,"\\"),a=n.replace(/\\/g,"/"),s=0;s<r.length;++s){var i=r[s].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==i||a==i)return e.files?e.files[r[s]]:e.FileIndex[s]}return null}function xf(e,t){var r=Uf(e,t);if(null==r)throw new Error("Cannot find file "+t+" in zip");return r}function Ff(e,t,r){if(!r)return _f(xf(e,t));if(!t)return null;try{return Ff(e,t)}catch(n){return null}}function Pf(e,t,r){if(!r)return Lf(xf(e,t));if(!t)return null;try{return Pf(e,t)}catch(n){return null}}function Bf(e,t,r){if(!r)return kf(xf(e,t));if(!t)return null;try{return Bf(e,t)}catch(n){return null}}function Yf(e){for(var t=e.FullPaths||of(e.files),r=[],n=0;n<t.length;++n)"/"!=t[n].slice(-1)&&r.push(t[n].replace(/^Root Entry[\/]/,""));return r.sort()}function Vf(e,t,r){if(e.FullPaths){var n;if("string"==typeof r)return n=Nu?wu(r):Uu(r),tf.utils.cfb_add(e,t,n);tf.utils.cfb_add(e,t,r)}else e.file(t,r)}function Wf(){return tf.utils.cfb_new()}function Gf(e,t){switch(t.type){case"base64":return tf.read(e,{type:"base64"});case"binary":return tf.read(e,{type:"binary"});case"buffer":case"array":return tf.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function Hf(e,t){if("/"==e.charAt(0))return e.slice(1);var r=t.split("/");"/"!=t.slice(-1)&&r.pop();var n=e.split("/");while(0!==n.length){var a=n.shift();".."===a?r.pop():"."!==a&&r.push(a)}return r.join("/")}var zf='<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r\n',$f=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,jf=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/gm,Xf=/<[^>]*>/g,Kf=zf.match(jf)?jf:Xf,qf=/<\w*:/,Jf=/<(\/?)\w+:/;function Qf(e,t,r){for(var n={},a=0,s=0;a!==e.length;++a)if(32===(s=e.charCodeAt(a))||10===s||13===s)break;if(t||(n[0]=e.slice(0,a)),a===e.length)return n;var i=e.match($f),o=0,c="",l=0,u="",h="",f=1;if(i)for(l=0;l!=i.length;++l){for(h=i[l],s=0;s!=h.length;++s)if(61===h.charCodeAt(s))break;u=h.slice(0,s).trim();while(32==h.charCodeAt(s+1))++s;for(f=34==(a=h.charCodeAt(s+1))||39==a?1:0,c=h.slice(s+1+f,h.length-f),o=0;o!=u.length;++o)if(58===u.charCodeAt(o))break;if(o===u.length)u.indexOf("_")>0&&(u=u.slice(0,u.indexOf("_"))),n[u]=c,r||(n[u.toLowerCase()]=c);else{var d=(5===o&&"xmlns"===u.slice(0,5)?"xmlns":"")+u.slice(o+1);if(n[d]&&"ext"==u.slice(o-3,o))continue;n[d]=c,r||(n[d.toLowerCase()]=c)}}return n}function Zf(e){return e.replace(Jf,"<$1")}var ed={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},td=lf(ed),rd=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/gi,t=/_x([\da-fA-F]{4})_/gi;function r(n){var a=n+"",s=a.indexOf("<![CDATA[");if(-1==s)return a.replace(e,(function(e,t){return ed[e]||String.fromCharCode(parseInt(t,e.indexOf("x")>-1?16:10))||e})).replace(t,(function(e,t){return String.fromCharCode(parseInt(t,16))}));var i=a.indexOf("]]>");return r(a.slice(0,s))+a.slice(s+9,i)+r(a.slice(i+3))}return function(e,t){var n=r(e);return t?n.replace(/\r\n/g,"\n"):n}}(),nd=/[&<>'"]/g,ad=/[\u0000-\u0008\u000b-\u001f\uFFFE-\uFFFF]/g;function sd(e){var t=e+"";return t.replace(nd,(function(e){return td[e]})).replace(ad,(function(e){return"_x"+("000"+e.charCodeAt(0).toString(16)).slice(-4)+"_"}))}function id(e){return sd(e).replace(/ /g,"_x0020_")}var od=/[\u0000-\u001f]/g;function cd(e){var t=e+"";return t.replace(nd,(function(e){return td[e]})).replace(/\n/g,"<br/>").replace(od,(function(e){return"&#x"+("000"+e.charCodeAt(0).toString(16)).slice(-4)+";"}))}function ld(e){var t=e+"";return t.replace(nd,(function(e){return td[e]})).replace(od,(function(e){return"&#x"+e.charCodeAt(0).toString(16).toUpperCase()+";"}))}var ud=function(){var e=/&#(\d+);/g;function t(e,t){return String.fromCharCode(parseInt(t,10))}return function(r){return r.replace(e,t)}}();function hd(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function fd(e){switch(e){case 1:case!0:case"1":case"true":return!0;case 0:case!1:case"0":case"false":return!1}return!1}function dd(e){var t="",r=0,n=0,a=0,s=0,i=0,o=0;while(r<e.length)n=e.charCodeAt(r++),n<128?t+=String.fromCharCode(n):(a=e.charCodeAt(r++),n>191&&n<224?(i=(31&n)<<6,i|=63&a,t+=String.fromCharCode(i)):(s=e.charCodeAt(r++),n<240?t+=String.fromCharCode((15&n)<<12|(63&a)<<6|63&s):(i=e.charCodeAt(r++),o=((7&n)<<18|(63&a)<<12|(63&s)<<6|63&i)-65536,t+=String.fromCharCode(55296+(o>>>10&1023)),t+=String.fromCharCode(56320+(1023&o)))));return t}function pd(e){var t,r,n,a=Cu(2*e.length),s=1,i=0,o=0;for(r=0;r<e.length;r+=s)s=1,(n=e.charCodeAt(r))<128?t=n:n<224?(t=64*(31&n)+(63&e.charCodeAt(r+1)),s=2):n<240?(t=4096*(15&n)+64*(63&e.charCodeAt(r+1))+(63&e.charCodeAt(r+2)),s=3):(s=4,t=262144*(7&n)+4096*(63&e.charCodeAt(r+1))+64*(63&e.charCodeAt(r+2))+(63&e.charCodeAt(r+3)),t-=65536,o=55296+(t>>>10&1023),t=56320+(1023&t)),0!==o&&(a[i++]=255&o,a[i++]=o>>>8,o=0),a[i++]=t%256,a[i++]=t>>>8;return a.slice(0,i).toString("ucs2")}function md(e){return wu(e,"binary").toString("utf8")}var gd="foo bar bazâð£",Ed=Nu&&(md(gd)==dd(gd)&&md||pd(gd)==dd(gd)&&pd)||dd,vd=Nu?function(e){return wu(e,"utf8").toString("binary")}:function(e){var t=[],r=0,n=0,a=0;while(r<e.length)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(63&n)));break;case n>=55296&&n<57344:n-=55296,a=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(a>>18&7))),t.push(String.fromCharCode(144+(a>>12&63))),t.push(String.fromCharCode(128+(a>>6&63))),t.push(String.fromCharCode(128+(63&a)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(63&n)))}return t.join("")},Td=function(){var e={};return function(t,r){var n=t+"|"+(r||"");return e[n]?e[n]:e[n]=new RegExp("<(?:\\w+:)?"+t+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+t+">",r||"")}}(),Sd=function(){var e=[["nbsp"," "],["middot","·"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map((function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]}));return function(t){for(var r=t.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,"\n").replace(/<[^>]*>/g,""),n=0;n<e.length;++n)r=r.replace(e[n][0],e[n][1]);return r}}(),Ad=function(){var e={};return function(t){return void 0!==e[t]?e[t]:e[t]=new RegExp("<(?:vt:)?"+t+">([\\s\\S]*?)</(?:vt:)?"+t+">","g")}}(),Rd=/<\/?(?:vt:)?variant>/g,yd=/<(?:vt:)([^>]*)>([\s\S]*)</;function Nd(e,t){var r=Qf(e),n=e.match(Ad(r.baseType))||[],a=[];if(n.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return a}return n.forEach((function(e){var t=e.replace(Rd,"").match(yd);t&&a.push({v:Ed(t[2]),t:t[1]})})),a}var wd=/(^\s|\s$|\n)/;function bd(e,t){return"<"+e+(t.match(wd)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function Cd(e){return of(e).map((function(t){return" "+t+'="'+e[t]+'"'})).join("")}function Od(e,t,r){return"<"+e+(null!=r?Cd(r):"")+(null!=t?(t.match(wd)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function Id(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function Md(e,t){switch(typeof e){case"string":var r=Od("vt:lpwstr",sd(e));return t&&(r=r.replace(/&quot;/g,"_x0022_")),r;case"number":return Od((0|e)==e?"vt:i4":"vt:r8",sd(String(e)));case"boolean":return Od("vt:bool",e?"true":"false")}if(e instanceof Date)return Od("vt:filetime",Id(e));throw new Error("Unable to serialize "+e)}function Dd(e){if(Nu&&Buffer.isBuffer(e))return e.toString("utf8");if("string"===typeof e)return e;if("undefined"!==typeof Uint8Array&&e instanceof Uint8Array)return Ed(Du(ku(e)));throw new Error("Bad input format: expected Buffer or string")}var Ld=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/](?:[^>=]|="[^"]*?")*)?>/gm,kd={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},_d=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Ud={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function xd(e,t){for(var r=1-2*(e[t+7]>>>7),n=((127&e[t+7])<<4)+(e[t+6]>>>4&15),a=15&e[t+6],s=5;s>=0;--s)a=256*a+e[t+s];return 2047==n?0==a?r*(1/0):NaN:(0==n?n=-1022:(n-=1023,a+=Math.pow(2,52)),r*Math.pow(2,n-52)*a)}function Fd(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,a=0,s=0,i=n?-t:t;isFinite(i)?0==i?a=s=0:(a=Math.floor(Math.log(i)/Math.LN2),s=i*Math.pow(2,52-a),a<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?a=-1022:(s-=Math.pow(2,52),a+=1023)):(a=2047,s=isNaN(t)?26985:0);for(var o=0;o<=5;++o,s/=256)e[r+o]=255&s;e[r+6]=(15&a)<<4|15&s,e[r+7]=a>>4|n}var Pd=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var a=0,s=e[0][n].length;a<s;a+=r)t.push.apply(t,e[0][n].slice(a,a+r));return t},Bd=Nu?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map((function(e){return Buffer.isBuffer(e)?e:wu(e)}))):Pd(e)}:Pd,Yd=function(e,t,r){for(var n=[],a=t;a<r;a+=2)n.push(String.fromCharCode(op(e,a)));return n.join("").replace(xu,"")},Vd=Nu?function(e,t,r){return Buffer.isBuffer(e)&&bu?e.toString("utf16le",t,r).replace(xu,""):Yd(e,t,r)}:Yd,Wd=function(e,t,r){for(var n=[],a=t;a<t+r;++a)n.push(("0"+e[a].toString(16)).slice(-2));return n.join("")},Gd=Nu?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):Wd(e,t,r)}:Wd,Hd=function(e,t,r){for(var n=[],a=t;a<r;a++)n.push(String.fromCharCode(ip(e,a)));return n.join("")},zd=Nu?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf8",t,r):Hd(e,t,r)}:Hd,$d=function(e,t){var r=lp(e,t);return r>0?zd(e,t+4,t+4+r-1):""},jd=$d,Xd=function(e,t){var r=lp(e,t);return r>0?zd(e,t+4,t+4+r-1):""},Kd=Xd,qd=function(e,t){var r=2*lp(e,t);return r>0?zd(e,t+4,t+4+r-1):""},Jd=qd,Qd=function(e,t){var r=lp(e,t);return r>0?Vd(e,t+4,t+4+r):""},Zd=Qd,ep=function(e,t){var r=lp(e,t);return r>0?zd(e,t+4,t+4+r):""},tp=ep,rp=function(e,t){return xd(e,t)},np=rp,ap=function(e){return Array.isArray(e)||"undefined"!==typeof Uint8Array&&e instanceof Uint8Array};function sp(){Vd=function(e,t,r){return ql.utils.decode(1200,e.slice(t,r)).replace(xu,"")},zd=function(e,t,r){return ql.utils.decode(65001,e.slice(t,r))},jd=function(e,t){var r=lp(e,t);return r>0?ql.utils.decode(au,e.slice(t+4,t+4+r-1)):""},Kd=function(e,t){var r=lp(e,t);return r>0?ql.utils.decode(nu,e.slice(t+4,t+4+r-1)):""},Jd=function(e,t){var r=2*lp(e,t);return r>0?ql.utils.decode(1200,e.slice(t+4,t+4+r-1)):""},Zd=function(e,t){var r=lp(e,t);return r>0?ql.utils.decode(1200,e.slice(t+4,t+4+r)):""},tp=function(e,t){var r=lp(e,t);return r>0?ql.utils.decode(65001,e.slice(t+4,t+4+r)):""}}Nu&&(jd=function(e,t){if(!Buffer.isBuffer(e))return $d(e,t);var r=e.readUInt32LE(t);return r>0?e.toString("utf8",t+4,t+4+r-1):""},Kd=function(e,t){if(!Buffer.isBuffer(e))return Xd(e,t);var r=e.readUInt32LE(t);return r>0?e.toString("utf8",t+4,t+4+r-1):""},Jd=function(e,t){if(!Buffer.isBuffer(e)||!bu)return qd(e,t);var r=2*e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+r-1)},Zd=function(e,t){if(!Buffer.isBuffer(e)||!bu)return Qd(e,t);var r=e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+r)},tp=function(e,t){if(!Buffer.isBuffer(e))return ep(e,t);var r=e.readUInt32LE(t);return e.toString("utf8",t+4,t+4+r)},np=function(e,t){return Buffer.isBuffer(e)?e.readDoubleLE(t):rp(e,t)},ap=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||"undefined"!==typeof Uint8Array&&e instanceof Uint8Array}),"undefined"!==typeof ql&&sp();var ip=function(e,t){return e[t]},op=function(e,t){return 256*e[t+1]+e[t]},cp=function(e,t){var r=256*e[t+1]+e[t];return r<32768?r:-1*(65535-r+1)},lp=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},up=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},hp=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function fp(e,t){var r,n,a,s,i,o,c="",l=[];switch(t){case"dbcs":if(o=this.l,Nu&&Buffer.isBuffer(this)&&bu)c=this.slice(this.l,this.l+2*e).toString("utf16le");else for(i=0;i<e;++i)c+=String.fromCharCode(op(this,o)),o+=2;e*=2;break;case"utf8":c=zd(this,this.l,this.l+e);break;case"utf16le":e*=2,c=Vd(this,this.l,this.l+e);break;case"wstr":if("undefined"===typeof ql)return fp.call(this,e,"dbcs");c=ql.utils.decode(nu,this.slice(this.l,this.l+2*e)),e*=2;break;case"lpstr-ansi":c=jd(this,this.l),e=4+lp(this,this.l);break;case"lpstr-cp":c=Kd(this,this.l),e=4+lp(this,this.l);break;case"lpwstr":c=Jd(this,this.l),e=4+2*lp(this,this.l);break;case"lpp4":e=4+lp(this,this.l),c=Zd(this,this.l),2&e&&(e+=2);break;case"8lpp4":e=4+lp(this,this.l),c=tp(this,this.l),3&e&&(e+=4-(3&e));break;case"cstr":e=0,c="";while(0!==(a=ip(this,this.l+e++)))l.push(mu(a));c=l.join("");break;case"_wstr":e=0,c="";while(0!==(a=op(this,this.l+e)))l.push(mu(a)),e+=2;e+=2,c=l.join("");break;case"dbcs-cont":for(c="",o=this.l,i=0;i<e;++i){if(this.lens&&-1!==this.lens.indexOf(o))return a=ip(this,o),this.l=o+1,s=fp.call(this,e-i,a?"dbcs-cont":"sbcs-cont"),l.join("")+s;l.push(mu(op(this,o))),o+=2}c=l.join(""),e*=2;break;case"cpstr":if("undefined"!==typeof ql){c=ql.utils.decode(nu,this.slice(this.l,this.l+e));break}case"sbcs-cont":for(c="",o=this.l,i=0;i!=e;++i){if(this.lens&&-1!==this.lens.indexOf(o))return a=ip(this,o),this.l=o+1,s=fp.call(this,e-i,a?"dbcs-cont":"sbcs-cont"),l.join("")+s;l.push(mu(ip(this,o))),o+=1}c=l.join("");break;default:switch(e){case 1:return r=ip(this,this.l),this.l++,r;case 2:return r=("i"===t?cp:op)(this,this.l),this.l+=2,r;case 4:case-4:return"i"===t||0===(128&this[this.l+3])?(r=(e>0?up:hp)(this,this.l),this.l+=4,r):(n=lp(this,this.l),this.l+=4,n);case 8:case-8:if("f"===t)return n=8==e?np(this,this.l):np([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,n;e=8;case 16:c=Gd(this,this.l,e);break}}return this.l+=e,c}var dp=function(e,t,r){e[r]=255&t,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},pp=function(e,t,r){e[r]=255&t,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},mp=function(e,t,r){e[r]=255&t,e[r+1]=t>>>8&255};function gp(e,t,r){var n=0,a=0;if("dbcs"===r){for(a=0;a!=t.length;++a)mp(this,t.charCodeAt(a),this.l+2*a);n=2*t.length}else if("sbcs"===r||"cpstr"==r)if("undefined"!==typeof ql&&874==au){for(a=0;a!=t.length;++a){var s=ql.utils.encode(au,t.charAt(a));this[this.l+a]=s[0]}n=t.length}else if("undefined"!==typeof ql&&"cpstr"==r){if(s=ql.utils.encode(nu,t),s.length==t.length)for(a=0;a<t.length;++a)0==s[a]&&0!=t.charCodeAt(a)&&(s[a]=95);if(s.length==2*t.length)for(a=0;a<t.length;++a)0==s[2*a]&&0==s[2*a+1]&&0!=t.charCodeAt(a)&&(s[2*a]=95);for(a=0;a<s.length;++a)this[this.l+a]=s[a];n=s.length}else{for(t=t.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=t.length;++a)this[this.l+a]=255&t.charCodeAt(a);n=t.length}else{if("hex"===r){for(;a<e;++a)this[this.l++]=parseInt(t.slice(2*a,2*a+2),16)||0;return this}if("utf16le"===r){var i=Math.min(this.l+e,this.length);for(a=0;a<Math.min(t.length,e);++a){var o=t.charCodeAt(a);this[this.l++]=255&o,this[this.l++]=o>>8}while(this.l<i)this[this.l++]=0;return this}switch(e){case 1:n=1,this[this.l]=255&t;break;case 2:n=2,this[this.l]=255&t,t>>>=8,this[this.l+1]=255&t;break;case 3:n=3,this[this.l]=255&t,t>>>=8,this[this.l+1]=255&t,t>>>=8,this[this.l+2]=255&t;break;case 4:n=4,dp(this,t,this.l);break;case 8:if(n=8,"f"===r){Fd(this,t,this.l);break}case 16:break;case-4:n=4,pp(this,t,this.l);break}}return this.l+=n,this}function Ep(e,t){var r=Gd(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function vp(e,t){e.l=t,e.read_shift=fp,e.chk=Ep,e.write_shift=gp}function Tp(e,t){e.l+=t}function Sp(e){var t=Cu(e);return vp(t,0),t}function Ap(e,t,r){if(e){var n,a,s;vp(e,e.l||0);var i=e.length,o=0,c=0;while(e.l<i){o=e.read_shift(1),128&o&&(o=(127&o)+((127&e.read_shift(1))<<7));var l=DO[o]||DO[65535];for(n=e.read_shift(1),s=127&n,a=1;a<4&&128&n;++a)s+=(127&(n=e.read_shift(1)))<<7*a;c=e.l+s;var u=l.f&&l.f(e,s,r);if(e.l=c,t(u,l,o))return}}}function Rp(){var e=[],t=Nu?256:2048,r=function(e){var t=Sp(e);return vp(t,0),t},n=r(t),a=function(){n&&(n.l&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n)),n=null)},s=function(e){return n&&e<n.length-n.l?n:(a(),n=r(Math.max(e+1,t)))},i=function(){return a(),_u(e)},o=function(e){a(),n=e,null==n.l&&(n.l=n.length),s(t)};return{next:s,push:o,end:i,_bufs:e}}function yp(e,t,r,n){var a,s=+t;if(!isNaN(s)){n||(n=DO[s].p||(r||[]).length||0),a=1+(s>=128?1:0)+1,n>=128&&++a,n>=16384&&++a,n>=2097152&&++a;var i=e.next(a);s<=127?i.write_shift(1,s):(i.write_shift(1,128+(127&s)),i.write_shift(1,s>>7));for(var o=0;4!=o;++o){if(!(n>=128)){i.write_shift(1,n);break}i.write_shift(1,128+(127&n)),n>>=7}n>0&&ap(r)&&e.push(r)}}function Np(e,t,r){var n=Nf(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){while(n.c>=256)n.c-=256;while(n.r>=65536)n.r-=65536}return n}function wp(e,t,r){var n=Nf(e);return n.s=Np(n.s,t.s,r),n.e=Np(n.e,t.s,r),n}function bp(e,t){if(e.cRel&&e.c<0){e=Nf(e);while(e.c<0)e.c+=t>8?16384:256}if(e.rRel&&e.r<0){e=Nf(e);while(e.r<0)e.r+=t>8?1048576:t>5?65536:16384}var r=Pp(e);return e.cRel||null==e.cRel||(r=_p(r)),e.rRel||null==e.rRel||(r=Mp(r)),r}function Cp(e,t){return 0!=e.s.r||e.s.rRel||e.e.r!=(t.biff>=12?1048575:t.biff>=8?65536:16384)||e.e.rRel?0!=e.s.c||e.s.cRel||e.e.c!=(t.biff>=12?16383:255)||e.e.cRel?bp(e.s,t.biff)+":"+bp(e.e,t.biff):(e.s.rRel?"":"$")+Ip(e.s.r)+":"+(e.e.rRel?"":"$")+Ip(e.e.r):(e.s.cRel?"":"$")+kp(e.s.c)+":"+(e.e.cRel?"":"$")+kp(e.e.c)}function Op(e){return parseInt(Dp(e),10)-1}function Ip(e){return""+(e+1)}function Mp(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function Dp(e){return e.replace(/\$(\d+)$/,"$1")}function Lp(e){for(var t=Up(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function kp(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function _p(e){return e.replace(/^([A-Z])/,"$$$1")}function Up(e){return e.replace(/^\$([A-Z])/,"$1")}function xp(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Fp(e){for(var t=0,r=0,n=0;n<e.length;++n){var a=e.charCodeAt(n);a>=48&&a<=57?t=10*t+(a-48):a>=65&&a<=90&&(r=26*r+(a-64))}return{c:r-1,r:t-1}}function Pp(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function Bp(e){var t=e.indexOf(":");return-1==t?{s:Fp(e),e:Fp(e)}:{s:Fp(e.slice(0,t)),e:Fp(e.slice(t+1))}}function Yp(e,t){return"undefined"===typeof t||"number"===typeof t?Yp(e.s,e.e):("string"!==typeof e&&(e=Pp(e)),"string"!==typeof t&&(t=Pp(t)),e==t?e:e+":"+t)}function Vp(e){var t=Bp(e);return"$"+kp(t.s.c)+"$"+Ip(t.s.r)+":$"+kp(t.e.c)+"$"+Ip(t.e.r)}function Wp(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e.replace(/'/g,"''")+"'":e}function Gp(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,a=0,s=e.length;for(r=0;n<s;++n){if((a=e.charCodeAt(n)-64)<1||a>26)break;r=26*r+a}for(t.s.c=--r,r=0;n<s;++n){if((a=e.charCodeAt(n)-48)<0||a>9)break;r=10*r+a}if(t.s.r=--r,n===s||10!=a)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=s;++n){if((a=e.charCodeAt(n)-64)<1||a>26)break;r=26*r+a}for(t.e.c=--r,r=0;n!=s;++n){if((a=e.charCodeAt(n)-48)<0||a>9)break;r=10*r+a}return t.e.r=--r,t}function Hp(e,t){var r="d"==e.t&&t instanceof Date;if(null!=e.z)try{return e.w=Wh(e.z,r?df(t):t)}catch(n){}try{return e.w=Wh((e.XF||{}).numFmtId||(r?14:0),r?df(t):t)}catch(n){return""+t}}function zp(e,t,r){return null==e||null==e.t||"z"==e.t?"":void 0!==e.w?e.w:("d"==e.t&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),"e"==e.t?Jm[e.v]||e.v:Hp(e,void 0==t?e.v:t))}function $p(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function jp(e,t,r){var n=r||{},a=e?null!=e["!data"]:n.dense;null!=vu&&null==a&&(a=vu);var s=e||{};a&&!s["!data"]&&(s["!data"]=[]);var i=0,o=0;if(s&&null!=n.origin){if("number"==typeof n.origin)i=n.origin;else{var c="string"==typeof n.origin?Fp(n.origin):n.origin;i=c.r,o=c.c}s["!ref"]||(s["!ref"]="A1:A1")}var l={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var u=Gp(s["!ref"]);l.s.c=u.s.c,l.s.r=u.s.r,l.e.c=Math.max(l.e.c,u.e.c),l.e.r=Math.max(l.e.r,u.e.r),-1==i&&(l.e.r=i=u.e.r+1)}for(var h=[],f=0;f!=t.length;++f)if(t[f]){if(!Array.isArray(t[f]))throw new Error("aoa_to_sheet expects an array of arrays");var d=i+f,p=""+(d+1);a&&(s["!data"][d]||(s["!data"][d]=[]),h=s["!data"][d]);for(var m=0;m!=t[f].length;++m)if("undefined"!==typeof t[f][m]){var g={v:t[f][m]},E=o+m;if(l.s.r>d&&(l.s.r=d),l.s.c>E&&(l.s.c=E),l.e.r<d&&(l.e.r=d),l.e.c<E&&(l.e.c=E),!t[f][m]||"object"!==typeof t[f][m]||Array.isArray(t[f][m])||t[f][m]instanceof Date)if(Array.isArray(g.v)&&(g.f=t[f][m][1],g.v=g.v[0]),null===g.v)if(g.f)g.t="n";else if(n.nullError)g.t="e",g.v=0;else{if(!n.sheetStubs)continue;g.t="z"}else"number"===typeof g.v?g.t="n":"boolean"===typeof g.v?g.t="b":g.v instanceof Date?(g.z=n.dateNF||qu[14],n.cellDates?(g.t="d",g.w=Wh(g.z,df(g.v,n.date1904))):(g.t="n",g.v=df(g.v,n.date1904),g.w=Wh(g.z,g.v))):g.t="s";else g=t[f][m];if(a)h[E]&&h[E].z&&(g.z=h[E].z),h[E]=g;else{var v=kp(E)+p;s[v]&&s[v].z&&(g.z=s[v].z),s[v]=g}}}return l.s.c<1e7&&(s["!ref"]=Yp(l)),s}function Xp(e,t){return jp(null,e,t)}function Kp(e){return e.read_shift(4,"i")}function qp(e,t){return t||(t=Sp(4)),t.write_shift(4,e),t}function Jp(e){var t=e.read_shift(4);return 0===t?"":e.read_shift(t,"dbcs")}function Qp(e,t){var r=!1;return null==t&&(r=!0,t=Sp(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function Zp(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function em(e,t){return t||(t=Sp(4)),t.write_shift(2,e.ich||0),t.write_shift(2,e.ifnt||0),t}function tm(e,t){var r=e.l,n=e.read_shift(1),a=Jp(e),s=[],i={t:a,h:a};if(0!==(1&n)){for(var o=e.read_shift(4),c=0;c!=o;++c)s.push(Zp(e));i.r=s}else i.r=[{ich:0,ifnt:0}];return e.l=r+t,i}function rm(e,t){var r=!1;return null==t&&(r=!0,t=Sp(15+4*e.t.length)),t.write_shift(1,0),Qp(e.t,t),r?t.slice(0,t.l):t}var nm=tm;function am(e,t){var r=!1;return null==t&&(r=!0,t=Sp(23+4*e.t.length)),t.write_shift(1,1),Qp(e.t,t),t.write_shift(4,1),em({ich:0,ifnt:0},t),r?t.slice(0,t.l):t}function sm(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function im(e,t){return null==t&&(t=Sp(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function om(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function cm(e,t){return null==t&&(t=Sp(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var lm=Jp,um=Qp;function hm(e){var t=e.read_shift(4);return 0===t||4294967295===t?"":e.read_shift(t,"dbcs")}function fm(e,t){var r=!1;return null==t&&(r=!0,t=Sp(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var dm=Jp,pm=hm,mm=fm;function gm(e){var t=e.slice(e.l,e.l+4),r=1&t[0],n=2&t[0];e.l+=4;var a=0===n?np([0,0,0,0,252&t[0],t[1],t[2],t[3]],0):up(t,0)>>2;return r?a/100:a}function Em(e,t){null==t&&(t=Sp(4));var r=0,n=0,a=100*e;if(e==(0|e)&&e>=-(1<<29)&&e<1<<29?n=1:a==(0|a)&&a>=-(1<<29)&&a<1<<29&&(n=1,r=1),!n)throw new Error("unsupported RkNumber "+e);t.write_shift(-4,((r?a:e)<<2)+(r+2))}function vm(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function Tm(e,t){return t||(t=Sp(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var Sm=vm,Am=Tm;function Rm(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function ym(e,t){return(t||Sp(8)).write_shift(8,e,"f")}function Nm(e){var t={},r=e.read_shift(1),n=r>>>1,a=e.read_shift(1),s=e.read_shift(2,"i"),i=e.read_shift(1),o=e.read_shift(1),c=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=a;var l=qm[a];l&&(t.rgb=bS(l));break;case 2:t.rgb=bS([i,o,c]);break;case 3:t.theme=a;break}return 0!=s&&(t.tint=s>0?s/32767:s/32768),t}function wm(e,t){if(t||(t=Sp(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;null!=e.index?(t.write_shift(1,2),t.write_shift(1,e.index)):null!=e.theme?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),e.rgb&&null==e.theme){var n=e.rgb||"FFFFFF";"number"==typeof n&&(n=("000000"+n.toString(16)).slice(-6)),t.write_shift(1,parseInt(n.slice(0,2),16)),t.write_shift(1,parseInt(n.slice(2,4),16)),t.write_shift(1,parseInt(n.slice(4,6),16)),t.write_shift(1,255)}else t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);return t}function bm(e){var t=e.read_shift(1);e.l++;var r={fBold:1&t,fItalic:2&t,fUnderline:4&t,fStrikeout:8&t,fOutline:16&t,fShadow:32&t,fCondense:64&t,fExtend:128&t};return r}function Cm(e,t){t||(t=Sp(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}function Om(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,1==t?"lpstr":"lpwstr")}function Im(e){return Om(e,1)}function Mm(e){return Om(e,2)}var Dm=2,Lm=3,km=11,_m=12,Um=19,xm=64,Fm=65,Pm=71,Bm=4108,Ym=4126,Vm=80,Wm=81,Gm=[Vm,Wm],Hm={1:{n:"CodePage",t:Dm},2:{n:"Category",t:Vm},3:{n:"PresentationFormat",t:Vm},4:{n:"ByteCount",t:Lm},5:{n:"LineCount",t:Lm},6:{n:"ParagraphCount",t:Lm},7:{n:"SlideCount",t:Lm},8:{n:"NoteCount",t:Lm},9:{n:"HiddenCount",t:Lm},10:{n:"MultimediaClipCount",t:Lm},11:{n:"ScaleCrop",t:km},12:{n:"HeadingPairs",t:Bm},13:{n:"TitlesOfParts",t:Ym},14:{n:"Manager",t:Vm},15:{n:"Company",t:Vm},16:{n:"LinksUpToDate",t:km},17:{n:"CharacterCount",t:Lm},19:{n:"SharedDoc",t:km},22:{n:"HyperlinksChanged",t:km},23:{n:"AppVersion",t:Lm,p:"version"},24:{n:"DigSig",t:Fm},26:{n:"ContentType",t:Vm},27:{n:"ContentStatus",t:Vm},28:{n:"Language",t:Vm},29:{n:"Version",t:Vm},255:{},2147483648:{n:"Locale",t:Um},2147483651:{n:"Behavior",t:Um},1919054434:{}},zm={1:{n:"CodePage",t:Dm},2:{n:"Title",t:Vm},3:{n:"Subject",t:Vm},4:{n:"Author",t:Vm},5:{n:"Keywords",t:Vm},6:{n:"Comments",t:Vm},7:{n:"Template",t:Vm},8:{n:"LastAuthor",t:Vm},9:{n:"RevNumber",t:Vm},10:{n:"EditTime",t:xm},11:{n:"LastPrinted",t:xm},12:{n:"CreatedDate",t:xm},13:{n:"ModifiedDate",t:xm},14:{n:"PageCount",t:Lm},15:{n:"WordCount",t:Lm},16:{n:"CharCount",t:Lm},17:{n:"Thumbnail",t:Pm},18:{n:"Application",t:Vm},19:{n:"DocSecurity",t:Lm},255:{},2147483648:{n:"Locale",t:Um},2147483651:{n:"Behavior",t:Um},1919054434:{}},$m={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},jm=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function Xm(e){return e.map((function(e){return[e>>16&255,e>>8&255,255&e]}))}var Km=Xm([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,0,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),qm=Nf(Km),Jm={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},Qm={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},Zm=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"],eg={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},tg={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function rg(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function ng(e){var t=rg();if(!e||!e.match)return t;var r={};if((e.match(Kf)||[]).forEach((function(e){var n=Qf(e);switch(n[0].replace(qf,"<")){case"<?xml":break;case"<Types":t.xmlns=n["xmlns"+(n[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[n.Extension.toLowerCase()]=n.ContentType;break;case"<Override":void 0!==t[eg[n.ContentType]]&&t[eg[n.ContentType]].push(n.PartName);break}})),t.xmlns!==kd.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}function ag(e,t,r){var n,a=hf(eg),s=[];r||(s[s.length]=zf,s[s.length]=Od("Types",null,{xmlns:kd.CT,"xmlns:xsd":kd.xsd,"xmlns:xsi":kd.xsi}),s=s.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map((function(e){return Od("Default",null,{Extension:e[0],ContentType:e[1]})}))));var i=function(r){e[r]&&e[r].length>0&&(n=e[r][0],s[s.length]=Od("Override",null,{PartName:("/"==n[0]?"":"/")+n,ContentType:tg[r][t.bookType]||tg[r]["xlsx"]}))},o=function(r){(e[r]||[]).forEach((function(e){s[s.length]=Od("Override",null,{PartName:("/"==e[0]?"":"/")+e,ContentType:tg[r][t.bookType]||tg[r]["xlsx"]})}))},c=function(t){(e[t]||[]).forEach((function(e){s[s.length]=Od("Override",null,{PartName:("/"==e[0]?"":"/")+e,ContentType:a[t][0]})}))};return i("workbooks"),o("sheets"),o("charts"),c("themes"),["strs","styles"].forEach(i),["coreprops","extprops","custprops"].forEach(c),c("vba"),c("comments"),c("threadedcomments"),c("drawings"),o("metadata"),c("people"),!r&&s.length>2&&(s[s.length]="</Types>",s[1]=s[1].replace("/>",">")),s.join("")}var sg={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",CONN:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/connections",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function ig(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function og(e,t){var r={"!id":{}};if(!e)return r;"/"!==t.charAt(0)&&(t="/"+t);var n={};return(e.match(Kf)||[]).forEach((function(e){var a=Qf(e);if("<Relationship"===a[0]){var s={};s.Type=a.Type,s.Target=rd(a.Target),s.Id=a.Id,a.TargetMode&&(s.TargetMode=a.TargetMode);var i="External"===a.TargetMode?a.Target:Hf(a.Target,t);r[i]=s,n[a.Id]=s}})),r["!id"]=n,r}function cg(e){var t=[zf,Od("Relationships",null,{xmlns:kd.RELS})];return of(e["!id"]).forEach((function(r){t[t.length]=Od("Relationship",null,e["!id"][r])})),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function lg(e,t,r,n,a,s){if(a||(a={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,a.Id="rId"+t,a.Type=n,a.Target=r,s?a.TargetMode=s:[sg.HLINK,sg.XPATH,sg.XMISS].indexOf(a.Type)>-1&&(a.TargetMode="External"),e["!id"][a.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][a.Id]=a,e[("/"+a.Target).replace("//","/")]=a,t}var ug="application/vnd.oasis.opendocument.spreadsheet";function hg(e,t){var r,n,a=Dd(e);while(r=Ld.exec(a))switch(r[3]){case"manifest":break;case"file-entry":if(n=Qf(r[0],!1),"/"==n.path&&n.type!==ug)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw r}}function fg(e){var t=[zf];t.push('<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">\n'),t.push('  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>\n');for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+'"/>\n');return t.push("</manifest:manifest>"),t.join("")}function dg(e,t,r){return['  <rdf:Description rdf:about="'+e+'">\n','    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+'"/>\n',"  </rdf:Description>\n"].join("")}function pg(e,t){return['  <rdf:Description rdf:about="'+e+'">\n','    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+'"/>\n',"  </rdf:Description>\n"].join("")}function mg(e){var t=[zf];t.push('<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">\n');for(var r=0;r!=e.length;++r)t.push(dg(e[r][0],e[r][1])),t.push(pg("",e[r][0]));return t.push(dg("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function gg(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+ru.version+"</meta:generator></office:meta></office:document-meta>"}var Eg=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],vg=function(){for(var e=new Array(Eg.length),t=0;t<Eg.length;++t){var r=Eg[t],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e}();function Tg(e){var t={};e=Ed(e);for(var r=0;r<Eg.length;++r){var n=Eg[r],a=e.match(vg[r]);null!=a&&a.length>0&&(t[n[1]]=rd(a[1])),"date"===n[2]&&t[n[1]]&&(t[n[1]]=Rf(t[n[1]]))}return t}function Sg(e,t,r,n,a){null==a[e]&&null!=t&&""!==t&&(a[e]=t,t=sd(t),n[n.length]=r?Od(e,t,r):bd(e,t))}function Ag(e,t){var r=t||{},n=[zf,Od("cp:coreProperties",null,{"xmlns:cp":kd.CORE_PROPS,"xmlns:dc":kd.dc,"xmlns:dcterms":kd.dcterms,"xmlns:dcmitype":kd.dcmitype,"xmlns:xsi":kd.xsi})],a={};if(!e&&!r.Props)return n.join("");e&&(null!=e.CreatedDate&&Sg("dcterms:created","string"===typeof e.CreatedDate?e.CreatedDate:Id(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a),null!=e.ModifiedDate&&Sg("dcterms:modified","string"===typeof e.ModifiedDate?e.ModifiedDate:Id(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a));for(var s=0;s!=Eg.length;++s){var i=Eg[s],o=r.Props&&null!=r.Props[i[1]]?r.Props[i[1]]:e?e[i[1]]:null;!0===o?o="1":!1===o?o="0":"number"==typeof o&&(o=String(o)),null!=o&&Sg(i[0],o,null,n,a)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var Rg=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],yg=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function Ng(e,t,r,n){var a=[];if("string"==typeof e)a=Nd(e,n);else for(var s=0;s<e.length;++s)a=a.concat(e[s].map((function(e){return{v:e}})));var i="string"==typeof t?Nd(t,n).map((function(e){return e.v})):t,o=0,c=0;if(i.length>0)for(var l=0;l!==a.length;l+=2){switch(c=+a[l+1].v,a[l].v){case"Worksheets":case"工作表":case"Листы":case"أوراق العمل":case"ワークシート":case"גליונות עבודה":case"Arbeitsblätter":case"Çalışma Sayfaları":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de cálculo":case"Planilhas":case"Regneark":case"Hojas de cálculo":case"Werkbladen":r.Worksheets=c,r.SheetNames=i.slice(o,o+c);break;case"Named Ranges":case"Rangos con nombre":case"名前付き一覧":case"Benannte Bereiche":case"Navngivne områder":r.NamedRanges=c,r.DefinedNames=i.slice(o,o+c);break;case"Charts":case"Diagramme":r.Chartsheets=c,r.ChartNames=i.slice(o,o+c);break}o+=c}}function wg(e,t,r){var n={};return t||(t={}),e=Ed(e),Rg.forEach((function(r){var a=(e.match(Td(r[0]))||[])[1];switch(r[2]){case"string":a&&(t[r[1]]=rd(a));break;case"bool":t[r[1]]="true"===a;break;case"raw":var s=e.match(new RegExp("<"+r[0]+"[^>]*>([\\s\\S]*?)</"+r[0]+">"));s&&s.length>0&&(n[r[1]]=s[1]);break}})),n.HeadingPairs&&n.TitlesOfParts&&Ng(n.HeadingPairs,n.TitlesOfParts,t,r),t}function bg(e){var t=[],r=Od;return e||(e={}),e.Application="SheetJS",t[t.length]=zf,t[t.length]=Od("Properties",null,{xmlns:kd.EXT_PROPS,"xmlns:vt":kd.vt}),Rg.forEach((function(n){if(void 0!==e[n[1]]){var a;switch(n[2]){case"string":a=sd(String(e[n[1]]));break;case"bool":a=e[n[1]]?"true":"false";break}void 0!==a&&(t[t.length]=r(n[0],a))}})),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map((function(e){return"<vt:lpstr>"+sd(e)+"</vt:lpstr>"})).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var Cg=/<[^>]+>[^<]*/g;function Og(e,t){var r={},n="",a=e.match(Cg);if(a)for(var s=0;s!=a.length;++s){var i=a[s],o=Qf(i);switch(Zf(o[0])){case"<?xml":break;case"<Properties":break;case"<property":n=rd(o.name);break;case"</property>":n=null;break;default:if(0===i.indexOf("<vt:")){var c=i.split(">"),l=c[0].slice(4),u=c[1];switch(l){case"lpstr":case"bstr":case"lpwstr":r[n]=rd(u);break;case"bool":r[n]=fd(u);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(u,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(u);break;case"filetime":case"date":r[n]=Rf(u);break;case"cy":case"error":r[n]=rd(u);break;default:if("/"==l.slice(-1))break;t.WTF&&"undefined"!==typeof console&&console.warn("Unexpected",i,l,c)}}else if("</"===i.slice(0,2));else if(t.WTF)throw new Error(i)}}return r}function Ig(e){var t=[zf,Od("Properties",null,{xmlns:kd.CUST_PROPS,"xmlns:vt":kd.vt})];if(!e)return t.join("");var r=1;return of(e).forEach((function(n){++r,t[t.length]=Od("property",Md(e[n],!0),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:sd(n)})})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var Mg,Dg={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function Lg(e,t,r){Mg||(Mg=lf(Dg)),t=Mg[t]||t,e[t]=r}function kg(e,t){var r=[];return of(Dg).map((function(e){for(var t=0;t<Eg.length;++t)if(Eg[t][1]==e)return Eg[t];for(t=0;t<Rg.length;++t)if(Rg[t][1]==e)return Rg[t];throw e})).forEach((function(n){if(null!=e[n[1]]){var a=t&&t.Props&&null!=t.Props[n[1]]?t.Props[n[1]]:e[n[1]];switch(n[2]){case"date":a=new Date(a).toISOString().replace(/\.\d*Z/,"Z");break}"number"==typeof a?a=String(a):!0===a||!1===a?a=a?"1":"0":a instanceof Date&&(a=new Date(a).toISOString().replace(/\.\d*Z/,"")),r.push(bd(Dg[n[1]]||n[1],a))}})),Od("DocumentProperties",r.join(""),{xmlns:Ud.o})}function _g(e,t){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",a=[];return e&&of(e).forEach((function(t){if(Object.prototype.hasOwnProperty.call(e,t)){for(var n=0;n<Eg.length;++n)if(t==Eg[n][1])return;for(n=0;n<Rg.length;++n)if(t==Rg[n][1])return;for(n=0;n<r.length;++n)if(t==r[n])return;var s=e[t],i="string";"number"==typeof s?(i="float",s=String(s)):!0===s||!1===s?(i="boolean",s=s?"1":"0"):s=String(s),a.push(Od(id(t),s,{"dt:dt":i}))}})),t&&of(t).forEach((function(r){if(Object.prototype.hasOwnProperty.call(t,r)&&(!e||!Object.prototype.hasOwnProperty.call(e,r))){var n=t[r],s="string";"number"==typeof n?(s="float",n=String(n)):!0===n||!1===n?(s="boolean",n=n?"1":"0"):n instanceof Date?(s="dateTime.tz",n=n.toISOString()):n=String(n),a.push(Od(id(r),n,{"dt:dt":s}))}})),"<"+n+' xmlns="'+Ud.o+'">'+a.join("")+"</"+n+">"}function Ug(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date(1e3*(r/1e7*Math.pow(2,32)+t/1e7-11644473600)).toISOString().replace(/\.000/,"")}function xg(e){var t="string"==typeof e?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,n=r%Math.pow(2,32),a=(r-n)/Math.pow(2,32);n*=1e7,a*=1e7;var s=n/Math.pow(2,32)|0;s>0&&(n%=Math.pow(2,32),a+=s);var i=Sp(8);return i.write_shift(4,n),i.write_shift(4,a),i}function Fg(e,t,r){var n=e.l,a=e.read_shift(0,"lpstr-cp");if(r)while(e.l-n&3)++e.l;return a}function Pg(e,t,r){var n=e.read_shift(0,"lpwstr");return r&&(e.l+=4-(n.length+1&3)&3),n}function Bg(e,t,r){return 31===t?Pg(e):Fg(e,t,r)}function Yg(e,t,r){return Bg(e,t,!1===r?0:4)}function Vg(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return Bg(e,t,0)}function Wg(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n){var a=e.l;r[n]=e.read_shift(0,"lpwstr").replace(xu,""),e.l-a&2&&(e.l+=2)}return r}function Gg(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n)r[n]=e.read_shift(0,"lpstr-cp").replace(xu,"");return r}function Hg(e){var t=e.l,r=Kg(e,Wm);0==e[e.l]&&0==e[e.l+1]&&e.l-t&2&&(e.l+=2);var n=Kg(e,Lm);return[r,n]}function zg(e){for(var t=e.read_shift(4),r=[],n=0;n<t/2;++n)r.push(Hg(e));return r}function $g(e,t){for(var r=e.read_shift(4),n={},a=0;a!=r;++a){var s=e.read_shift(4),i=e.read_shift(4);n[s]=e.read_shift(i,1200===t?"utf16le":"utf8").replace(xu,"").replace(Fu,"!"),1200===t&&i%2&&(e.l+=2)}return 3&e.l&&(e.l=e.l>>3<<2),n}function jg(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(3&t)>0&&(e.l+=4-(3&t)&3),r}function Xg(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function Kg(e,t,r){var n,a=e.read_shift(2),s=r||{};if(e.l+=2,t!==_m&&a!==t&&-1===Gm.indexOf(t)&&(4126!=(65534&t)||4126!=(65534&a)))throw new Error("Expected type "+t+" saw "+a);switch(t===_m?a:t){case 2:return n=e.read_shift(2,"i"),s.raw||(e.l+=2),n;case 3:return n=e.read_shift(4,"i"),n;case 11:return 0!==e.read_shift(4);case 19:return n=e.read_shift(4),n;case 30:return Fg(e,a,4).replace(xu,"");case 31:return Pg(e);case 64:return Ug(e);case 65:return jg(e);case 71:return Xg(e);case 80:return Yg(e,a,!s.raw).replace(xu,"");case 81:return Vg(e,a).replace(xu,"");case 4108:return zg(e);case 4126:case 4127:return 4127==a?Wg(e):Gg(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+a)}}function qg(e,t){var r=Sp(4),n=Sp(4);switch(r.write_shift(4,80==e?31:e),e){case 3:n.write_shift(-4,t);break;case 5:n=Sp(8),n.write_shift(8,t,"f");break;case 11:n.write_shift(4,t?1:0);break;case 64:n=xg(t);break;case 31:case 80:n=Sp(4+2*(t.length+1)+(t.length%2?0:2)),n.write_shift(4,t.length+1),n.write_shift(0,t,"dbcs");while(n.l!=n.length)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return _u([r,n])}function Jg(e,t){var r=e.l,n=e.read_shift(4),a=e.read_shift(4),s=[],i=0,o=0,c=-1,l={};for(i=0;i!=a;++i){var u=e.read_shift(4),h=e.read_shift(4);s[i]=[u,h+r]}s.sort((function(e,t){return e[1]-t[1]}));var f={};for(i=0;i!=a;++i){if(e.l!==s[i][1]){var d=!0;if(i>0&&t)switch(t[s[i-1][0]].t){case 2:e.l+2===s[i][1]&&(e.l+=2,d=!1);break;case 80:e.l<=s[i][1]&&(e.l=s[i][1],d=!1);break;case 4108:e.l<=s[i][1]&&(e.l=s[i][1],d=!1);break}if((!t||0==i)&&e.l<=s[i][1]&&(d=!1,e.l=s[i][1]),d)throw new Error("Read Error: Expected address "+s[i][1]+" at "+e.l+" :"+i)}if(t){if(0==s[i][0]&&s.length>i+1&&s[i][1]==s[i+1][1])continue;var p=t[s[i][0]];if(f[p.n]=Kg(e,p.t,{raw:!0}),"version"===p.p&&(f[p.n]=String(f[p.n]>>16)+"."+("0000"+String(65535&f[p.n])).slice(-4)),"CodePage"==p.n)switch(f[p.n]){case 0:f[p.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:lu(o=f[p.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+f[p.n])}}else if(1===s[i][0]){if(o=f.CodePage=Kg(e,Dm),lu(o),-1!==c){var m=e.l;e.l=s[c][1],l=$g(e,o),e.l=m}}else if(0===s[i][0]){if(0===o){c=i,e.l=s[i+1][1];continue}l=$g(e,o)}else{var g,E=l[s[i][0]];switch(e[e.l]){case 65:e.l+=4,g=jg(e);break;case 30:e.l+=4,g=Yg(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,g=Yg(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,g=e.read_shift(4,"i");break;case 19:e.l+=4,g=e.read_shift(4);break;case 5:e.l+=4,g=e.read_shift(8,"f");break;case 11:e.l+=4,g=iE(e,4);break;case 64:e.l+=4,g=Rf(Ug(e));break;default:throw new Error("unparsed value: "+e[e.l])}f[E]=g}}return e.l=r+n,f}var Qg=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function Zg(e){switch(typeof e){case"boolean":return 11;case"number":return(0|e)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function eE(e,t,r){var n=Sp(8),a=[],s=[],i=8,o=0,c=Sp(8),l=Sp(8);if(c.write_shift(4,2),c.write_shift(4,1200),l.write_shift(4,1),s.push(c),a.push(l),i+=8+c.length,!t){l=Sp(8),l.write_shift(4,0),a.unshift(l);var u=[Sp(4)];for(u[0].write_shift(4,e.length),o=0;o<e.length;++o){var h=e[o][0];c=Sp(8+2*(h.length+1)+(h.length%2?0:2)),c.write_shift(4,o+2),c.write_shift(4,h.length+1),c.write_shift(0,h,"dbcs");while(c.l!=c.length)c.write_shift(1,0);u.push(c)}c=_u(u),s.unshift(c),i+=8+c.length}for(o=0;o<e.length;++o)if((!t||t[e[o][0]])&&!(Qg.indexOf(e[o][0])>-1||yg.indexOf(e[o][0])>-1)&&null!=e[o][1]){var f=e[o][1],d=0;if(t){d=+t[e[o][0]];var p=r[d];if("version"==p.p&&"string"==typeof f){var m=f.split(".");f=(+m[0]<<16)+(+m[1]||0)}c=qg(p.t,f)}else{var g=Zg(f);-1==g&&(g=31,f=String(f)),c=qg(g,f)}s.push(c),l=Sp(8),l.write_shift(4,t?d:2+o),a.push(l),i+=8+c.length}var E=8*(s.length+1);for(o=0;o<s.length;++o)a[o].write_shift(4,E),E+=s[o].length;return n.write_shift(4,i),n.write_shift(4,s.length),_u([n].concat(a).concat(s))}function tE(e,t,r){var n=e.content;if(!n)return{};vp(n,0);var a,s,i,o,c=0;n.chk("feff","Byte Order: "),n.read_shift(2);var l=n.read_shift(4),u=n.read_shift(16);if(u!==tf.utils.consts.HEADER_CLSID&&u!==r)throw new Error("Bad PropertySet CLSID "+u);if(a=n.read_shift(4),1!==a&&2!==a)throw new Error("Unrecognized #Sets: "+a);if(s=n.read_shift(16),o=n.read_shift(4),1===a&&o!==n.l)throw new Error("Length mismatch: "+o+" !== "+n.l);2===a&&(i=n.read_shift(16),c=n.read_shift(4));var h,f=Jg(n,t),d={SystemIdentifier:l};for(var p in f)d[p]=f[p];if(d.FMTID=s,1===a)return d;if(c-n.l==2&&(n.l+=2),n.l!==c)throw new Error("Length mismatch 2: "+n.l+" !== "+c);try{h=Jg(n,null)}catch(m){}for(p in h)d[p]=h[p];return d.FMTID=[s,i],d}function rE(e,t,r,n,a,s){var i=Sp(a?68:48),o=[i];i.write_shift(2,65534),i.write_shift(2,0),i.write_shift(4,842412599),i.write_shift(16,tf.utils.consts.HEADER_CLSID,"hex"),i.write_shift(4,a?2:1),i.write_shift(16,t,"hex"),i.write_shift(4,a?68:48);var c=eE(e,r,n);if(o.push(c),a){var l=eE(a,null,null);i.write_shift(16,s,"hex"),i.write_shift(4,68+c.length),o.push(l)}return _u(o)}function nE(e,t){return e.read_shift(t),null}function aE(e,t){t||(t=Sp(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function sE(e,t,r){var n=[],a=e.l+t;while(e.l<a)n.push(r(e,a-e.l));if(a!==e.l)throw new Error("Slurp error");return n}function iE(e,t){return 1===e.read_shift(t)}function oE(e,t){return t||(t=Sp(2)),t.write_shift(2,+!!e),t}function cE(e){return e.read_shift(2,"u")}function lE(e,t){return t||(t=Sp(2)),t.write_shift(2,e),t}function uE(e,t){return sE(e,t,cE)}function hE(e){var t=e.read_shift(1),r=e.read_shift(1);return 1===r?t:1===t}function fE(e,t,r){return r||(r=Sp(2)),r.write_shift(1,"e"==t?+e:+!!e),r.write_shift(1,"e"==t?1:0),r}function dE(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),a="sbcs-cont",s=nu;if(r&&r.biff>=8&&(nu=1200),r&&8!=r.biff)12==r.biff&&(a="wstr");else{var i=e.read_shift(1);i&&(a="dbcs-cont")}r.biff>=2&&r.biff<=5&&(a="cpstr");var o=n?e.read_shift(n,a):"";return nu=s,o}function pE(e){var t=nu;nu=1200;var r,n=e.read_shift(2),a=e.read_shift(1),s=4&a,i=8&a,o=1+(1&a),c=0,l={};i&&(c=e.read_shift(2)),s&&(r=e.read_shift(4));var u=2==o?"dbcs-cont":"sbcs-cont",h=0===n?"":e.read_shift(n,u);return i&&(e.l+=4*c),s&&(e.l+=r),l.t=h,i||(l.raw="<t>"+l.t+"</t>",l.r=l.t),nu=t,l}function mE(e){var t=e.t||"",r=1,n=Sp(3+(r>1?2:0));n.write_shift(2,t.length),n.write_shift(1,1|(r>1?8:0)),r>1&&n.write_shift(2,r);var a=Sp(2*t.length);a.write_shift(2*t.length,t,"utf16le");var s=[n,a];return _u(s)}function gE(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var a=e.read_shift(1);return n=0===a?e.read_shift(t,"sbcs-cont"):e.read_shift(t,"dbcs-cont"),n}function EE(e,t,r){var n=e.read_shift(r&&2==r.biff?1:2);return 0===n?(e.l++,""):gE(e,n,r)}function vE(e,t,r){if(r.biff>5)return EE(e,t,r);var n=e.read_shift(1);return 0===n?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function TE(e,t,r){return r||(r=Sp(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function SE(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function AE(e){var t=e.read_shift(4),r=e.l,n=!1;t>24&&(e.l+=t-24,"795881f43b1d7f48af2c825dc4852763"===e.read_shift(16)&&(n=!0),e.l=r);var a=e.read_shift((n?t-24:t)>>1,"utf16le").replace(xu,"");return n&&(e.l+=24),a}function RE(e){var t=e.read_shift(2),r="";while(t-- >0)r+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,57005!=e.read_shift(2))throw new Error("Bad FileMoniker");var a=e.read_shift(4);if(0===a)return r+n.replace(/\\/g,"/");var s=e.read_shift(4);if(3!=e.read_shift(2))throw new Error("Bad FileMoniker");var i=e.read_shift(s>>1,"utf16le").replace(xu,"");return r+i}function yE(e,t){var r=e.read_shift(16);switch(t-=16,r){case"e0c9ea79f9bace118c8200aa004ba90b":return AE(e,t);case"0303000000000000c000000000000046":return RE(e,t);default:throw new Error("Unsupported Moniker "+r)}}function NE(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(xu,""):"";return r}function wE(e,t){t||(t=Sp(6+2*e.length)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function bE(e,t){var r=e.l+t,n=e.read_shift(4);if(2!==n)throw new Error("Unrecognized streamVersion: "+n);var a=e.read_shift(2);e.l+=2;var s,i,o,c,l,u,h="";16&a&&(s=NE(e,r-e.l)),128&a&&(i=NE(e,r-e.l)),257===(257&a)&&(o=NE(e,r-e.l)),1===(257&a)&&(c=yE(e,r-e.l)),8&a&&(h=NE(e,r-e.l)),32&a&&(l=e.read_shift(16)),64&a&&(u=Ug(e)),e.l=r;var f=i||o||c||"";f&&h&&(f+="#"+h),f||(f="#"+h),2&a&&"/"==f.charAt(0)&&"/"!=f.charAt(1)&&(f="file://"+f);var d={Target:f};return l&&(d.guid=l),u&&(d.time=u),s&&(d.Tooltip=s),d}function CE(e){var t=Sp(512),r=0,n=e.Target;"file://"==n.slice(0,7)&&(n=n.slice(7));var a=n.indexOf("#"),s=a>-1?31:23;switch(n.charAt(0)){case"#":s=28;break;case".":s&=-3;break}t.write_shift(4,2),t.write_shift(4,s);var i=[8,6815827,6619237,4849780,83];for(r=0;r<i.length;++r)t.write_shift(4,i[r]);if(28==s)n=n.slice(1),wE(n,t);else if(2&s){for(i="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<i.length;++r)t.write_shift(1,parseInt(i[r],16));var o=a>-1?n.slice(0,a):n;for(t.write_shift(4,2*(o.length+1)),r=0;r<o.length;++r)t.write_shift(2,o.charCodeAt(r));t.write_shift(2,0),8&s&&wE(a>-1?n.slice(a+1):"",t)}else{for(i="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<i.length;++r)t.write_shift(1,parseInt(i[r],16));var c=0;while("../"==n.slice(3*c,3*c+3)||"..\\"==n.slice(3*c,3*c+3))++c;for(t.write_shift(2,c),t.write_shift(4,n.length-3*c+1),r=0;r<n.length-3*c;++r)t.write_shift(1,255&n.charCodeAt(r+3*c));for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function OE(e){var t=e.read_shift(1),r=e.read_shift(1),n=e.read_shift(1),a=e.read_shift(1);return[t,r,n,a]}function IE(e,t){var r=OE(e,t);return r[3]=0,r}function ME(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return{r:t,c:r,ixfe:n}}function DE(e,t,r,n){return n||(n=Sp(6)),n.write_shift(2,e),n.write_shift(2,t),n.write_shift(2,r||0),n}function LE(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function kE(e,t,r){return 0===t?"":vE(e,t,r)}function _E(e,t,r){var n=r.biff>8?4:2,a=e.read_shift(n),s=e.read_shift(n,"i"),i=e.read_shift(n,"i");return[a,s,i]}function UE(e){var t=e.read_shift(2),r=gm(e);return[t,r]}function xE(e,t,r){e.l+=4,t-=4;var n=e.l+t,a=dE(e,t,r),s=e.read_shift(2);if(n-=e.l,s!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+s);return e.l+=s,a}function FE(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2);return{s:{c:n,r:t},e:{c:a,r:r}}}function PE(e,t){return t||(t=Sp(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function BE(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(1),a=e.read_shift(1);return{s:{c:n,r:t},e:{c:a,r:r}}}var YE=BE;function VE(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[r,t,n]}function WE(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function GE(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function HE(e){e.l+=2,e.l+=e.read_shift(2)}var zE={0:HE,4:HE,5:HE,6:HE,7:GE,8:HE,9:HE,10:HE,11:HE,12:HE,13:WE,14:HE,15:HE,16:HE,17:HE,18:HE,19:HE,20:HE,21:VE};function $E(e,t){var r=e.l+t,n=[];while(e.l<r){var a=e.read_shift(2);e.l-=2;try{n.push(zE[a](e,r-e.l))}catch(s){return e.l=r,n}}return e.l!=r&&(e.l=r),n}function jE(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function XE(e,t,r){var n=1536,a=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,a=8;break;case"biff4":n=4,a=6;break;case"biff3":n=3,a=6;break;case"biff2":n=2,a=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var s=Sp(a);return s.write_shift(2,n),s.write_shift(2,t),a>4&&s.write_shift(2,29282),a>6&&s.write_shift(2,1997),a>8&&(s.write_shift(2,49161),s.write_shift(2,1),s.write_shift(2,1798),s.write_shift(2,0)),s}function KE(e,t){return 0===t||e.read_shift(2),1200}function qE(e,t,r){if(r.enc)return e.l+=t,"";var n=e.l,a=vE(e,0,r);return e.read_shift(t+n-e.l),a}function JE(e,t){var r=!t||8==t.biff,n=Sp(r?112:54);n.write_shift(8==t.biff?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));while(n.l<n.length)n.write_shift(1,r?0:32);return n}function QE(e,t,r){var n=r&&8==r.biff||2==t?e.read_shift(2):(e.l+=t,0);return{fDialog:16&n,fBelow:64&n,fRight:128&n}}function ZE(e,t,r){var n=e.read_shift(4),a=3&e.read_shift(1),s=e.read_shift(1);switch(s){case 0:s="Worksheet";break;case 1:s="Macrosheet";break;case 2:s="Chartsheet";break;case 6:s="VBAModule";break}var i=dE(e,0,r);return 0===i.length&&(i="Sheet1"),{pos:n,hs:a,dt:s,name:i}}function ev(e,t){var r=!t||t.biff>=8?2:1,n=Sp(8+r*e.name.length);n.write_shift(4,e.pos),n.write_shift(1,e.hs||0),n.write_shift(1,e.dt),n.write_shift(1,e.name.length),t.biff>=8&&n.write_shift(1,1),n.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var a=n.slice(0,n.l);return a.l=n.l,a}function tv(e,t){for(var r=e.l+t,n=e.read_shift(4),a=e.read_shift(4),s=[],i=0;i!=a&&e.l<r;++i)s.push(pE(e));return s.Count=n,s.Unique=a,s}function rv(e,t){var r=Sp(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var n=[],a=0;a<e.length;++a)n[a]=mE(e[a],t);var s=_u([r].concat(n));return s.parts=[r.length].concat(n.map((function(e){return e.length}))),s}function nv(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function av(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,7&n&&(t.level=7&n),32&n&&(t.hidden=!0),64&n&&(t.hpt=r/20),t}function sv(e){var t=LE(e);if(2211!=t.type)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return 0!==r}function iv(e){return e.read_shift(2),e.read_shift(4)}function ov(e,t,r){var n=0;r&&2==r.biff||(n=e.read_shift(2));var a=e.read_shift(2);r&&2==r.biff&&(n=1-(a>>15),a&=32767);var s={Unsynced:1&n,DyZero:(2&n)>>1,ExAsc:(4&n)>>2,ExDsc:(8&n)>>3};return[s,a]}function cv(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2),i=e.read_shift(2),o=e.read_shift(2),c=e.read_shift(2),l=e.read_shift(2);return{Pos:[t,r],Dim:[n,a],Flags:s,CurTab:i,FirstTab:o,Selected:c,TabRatio:l}}function lv(){var e=Sp(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function uv(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=e.read_shift(2);return{RTL:64&n}}function hv(e){var t=Sp(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function fv(){}function dv(e,t,r){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=dE(e,0,r),n}function pv(e,t){var r=e.name||"Arial",n=t&&5==t.biff,a=n?15+r.length:16+2*r.length,s=Sp(a);return s.write_shift(2,20*(e.sz||12)),s.write_shift(4,0),s.write_shift(2,400),s.write_shift(4,0),s.write_shift(2,0),s.write_shift(1,r.length),n||s.write_shift(1,1),s.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),s}function mv(e){var t=ME(e);return t.isst=e.read_shift(4),t}function gv(e,t,r,n){var a=Sp(10);return DE(e,t,n,a),a.write_shift(4,r),a}function Ev(e,t,r){r.biffguess&&2==r.biff&&(r.biff=5);var n=e.l+t,a=ME(e,6);2==r.biff&&e.l++;var s=EE(e,n-e.l,r);return a.val=s,a}function vv(e,t,r,n,a){var s=!a||8==a.biff,i=Sp(+s+8+(1+s)*r.length);return DE(e,t,n,i),i.write_shift(2,r.length),s&&i.write_shift(1,1),i.write_shift((1+s)*r.length,r,s?"utf16le":"sbcs"),i}function Tv(e,t,r){var n=e.read_shift(2),a=vE(e,0,r);return[n,a]}function Sv(e,t,r,n){var a=r&&5==r.biff;n||(n=Sp(a?3+t.length:5+2*t.length)),n.write_shift(2,e),n.write_shift(a?1:2,t.length),a||n.write_shift(1,1),n.write_shift((a?1:2)*t.length,t,a?"sbcs":"utf16le");var s=n.length>n.l?n.slice(0,n.l):n;return null==s.l&&(s.l=s.length),s}var Av=vE;function Rv(e,t,r){var n=e.l+t,a=8!=r.biff&&r.biff?2:4,s=e.read_shift(a),i=e.read_shift(a),o=e.read_shift(2),c=e.read_shift(2);return e.l=n,{s:{r:s,c:o},e:{r:i,c:c}}}function yv(e,t){var r=8!=t.biff&&t.biff?2:4,n=Sp(2*r+6);return n.write_shift(r,e.s.r),n.write_shift(r,e.e.r+1),n.write_shift(2,e.s.c),n.write_shift(2,e.e.c+1),n.write_shift(2,0),n}function Nv(e){var t=e.read_shift(2),r=e.read_shift(2),n=UE(e);return{r:t,c:r,ixfe:n[0],rknum:n[1]}}function wv(e,t){var r=e.l+t-2,n=e.read_shift(2),a=e.read_shift(2),s=[];while(e.l<r)s.push(UE(e));if(e.l!==r)throw new Error("MulRK read error");var i=e.read_shift(2);if(s.length!=i-a+1)throw new Error("MulRK length mismatch");return{r:n,c:a,C:i,rkrec:s}}function bv(e,t){var r=e.l+t-2,n=e.read_shift(2),a=e.read_shift(2),s=[];while(e.l<r)s.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var i=e.read_shift(2);if(s.length!=i-a+1)throw new Error("MulBlank length mismatch");return{r:n,c:a,C:i,ixfe:s}}function Cv(e,t,r,n){var a={},s=e.read_shift(4),i=e.read_shift(4),o=e.read_shift(4),c=e.read_shift(2);return a.patternType=jm[o>>26],n.cellStyles?(a.alc=7&s,a.fWrap=s>>3&1,a.alcV=s>>4&7,a.fJustLast=s>>7&1,a.trot=s>>8&255,a.cIndent=s>>16&15,a.fShrinkToFit=s>>20&1,a.iReadOrder=s>>22&2,a.fAtrNum=s>>26&1,a.fAtrFnt=s>>27&1,a.fAtrAlc=s>>28&1,a.fAtrBdr=s>>29&1,a.fAtrPat=s>>30&1,a.fAtrProt=s>>31&1,a.dgLeft=15&i,a.dgRight=i>>4&15,a.dgTop=i>>8&15,a.dgBottom=i>>12&15,a.icvLeft=i>>16&127,a.icvRight=i>>23&127,a.grbitDiag=i>>30&3,a.icvTop=127&o,a.icvBottom=o>>7&127,a.icvDiag=o>>14&127,a.dgDiag=o>>21&15,a.icvFore=127&c,a.icvBack=c>>7&127,a.fsxButton=c>>14&1,a):a}function Ov(e,t,r){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,t-=6,n.data=Cv(e,t,n.fStyle,r),n}function Iv(e,t,r,n){var a=r&&5==r.biff;n||(n=Sp(a?16:20)),n.write_shift(2,0),e.style?(n.write_shift(2,e.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,e.numFmtId||0),n.write_shift(2,t<<4));var s=0;return e.numFmtId>0&&a&&(s|=1024),n.write_shift(4,s),n.write_shift(4,0),a||n.write_shift(4,0),n.write_shift(2,0),n}function Mv(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(0!==t[0]&&t[0]--,0!==t[1]&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function Dv(e){var t=Sp(8);return t.write_shift(4,0),t.write_shift(2,e[0]?e[0]+1:0),t.write_shift(2,e[1]?e[1]+1:0),t}function Lv(e,t,r){var n=ME(e,6);2!=r.biff&&9!=t||++e.l;var a=hE(e,2);return n.val=a,n.t=!0===a||!1===a?"b":"e",n}function kv(e,t,r,n,a,s){var i=Sp(8);return DE(e,t,n,i),fE(r,s,i),i}function _v(e,t,r){r.biffguess&&2==r.biff&&(r.biff=5);var n=ME(e,6),a=Rm(e,8);return n.val=a,n}function Uv(e,t,r,n){var a=Sp(14);return DE(e,t,n,a),ym(r,a),a}var xv=kE;function Fv(e,t,r){var n=e.l+t,a=e.read_shift(2),s=e.read_shift(2);if(r.sbcch=s,1025==s||14849==s)return[s,a];if(s<1||s>255)throw new Error("Unexpected SupBook type: "+s);var i=gE(e,s),o=[];while(n>e.l)o.push(EE(e));return[s,a,i,o]}function Pv(e,t,r){var n,a=e.read_shift(2),s={fBuiltIn:1&a,fWantAdvise:a>>>1&1,fWantPict:a>>>2&1,fOle:a>>>3&1,fOleLink:a>>>4&1,cf:a>>>5&1023,fIcon:a>>>15&1};return 14849===r.sbcch&&(n=xE(e,t-2,r)),s.body=n||e.read_shift(t-2),"string"===typeof n&&(s.Name=n),s}function Bv(e,t,r){var n=e.l+t,a=e.read_shift(2),s=e.read_shift(1),i=e.read_shift(1),o=e.read_shift(r&&2==r.biff?1:2),c=0;(!r||r.biff>=5)&&(5!=r.biff&&(e.l+=2),c=e.read_shift(2),5==r.biff&&(e.l+=2),e.l+=4);var l=gE(e,i,r);32&a&&(l=Zm[l.charCodeAt(0)]);var u=n-e.l;r&&2==r.biff&&--u;var h=n!=e.l&&0!==o&&u>0?vN(e,u,r,o):[];return{chKey:s,Name:l,itab:c,rgce:h}}function Yv(e,t,r){if(r.biff<8)return Vv(e,t,r);var n=[],a=e.l+t,s=e.read_shift(r.biff>8?4:2);while(0!==s--)n.push(_E(e,r.biff>8?12:6,r));if(e.l!=a)throw new Error("Bad ExternSheet: "+e.l+" != "+a);return n}function Vv(e,t,r){3==e[e.l+1]&&e[e.l]++;var n=dE(e,t,r);return 3==n.charCodeAt(0)?n.slice(1):n}function Wv(e,t,r){if(!(r.biff<8)){var n=e.read_shift(2),a=e.read_shift(2),s=gE(e,n,r),i=gE(e,a,r);return[s,i]}e.l+=t}function Gv(e,t,r){var n=BE(e,6);e.l++;var a=e.read_shift(1);return t-=8,[TN(e,t,r),a,n]}function Hv(e,t,r){var n=YE(e,6);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[n,gN(e,t,r,n)]}function zv(e){var t=0!==e.read_shift(4),r=0!==e.read_shift(4),n=e.read_shift(4);return[t,r,n]}function $v(e,t,r){if(!(r.biff<8)){var n=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2),i=e.read_shift(2),o=vE(e,0,r);return r.biff<8&&e.read_shift(1),[{r:n,c:a},o,i,s]}}function jv(e,t,r){return $v(e,t,r)}function Xv(e,t){var r=[],n=e.read_shift(2);while(n--)r.push(FE(e,t));return r}function Kv(e){var t=Sp(2+8*e.length);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)PE(e[r],t);return t}function qv(e,t,r){if(r&&r.biff<8)return Qv(e,t,r);var n=VE(e,22),a=$E(e,t-22,n[1]);return{cmo:n,ft:a}}var Jv={8:function(e,t){var r=e.l+t;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var a=e.read_shift(1);return e.l+=a,e.l=r,{fmt:n}}};function Qv(e,t,r){e.l+=4;var n=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var i=[];return i.push((Jv[n]||Tp)(e,t,r)),{cmo:[a,n,s],ft:i}}function Zv(e,t,r){var n=e.l,a="";try{e.l+=4;var s=(r.lastobj||{cmo:[0,0]}).cmo[1];-1==[0,5,7,11,12,14].indexOf(s)?e.l+=6:SE(e,6,r);var i=e.read_shift(2);e.read_shift(2),cE(e,2);var o=e.read_shift(2);e.l+=o;for(var c=1;c<e.lens.length-1;++c){if(e.l-n!=e.lens[c])throw new Error("TxO: bad continue record");var l=e[e.l],u=gE(e,e.lens[c+1]-e.lens[c]-1);if(a+=u,a.length>=(l?i:2*i))break}if(a.length!==i&&a.length!==2*i)throw new Error("cchText: "+i+" != "+a.length);return e.l=n+t,{t:a}}catch(h){return e.l=n+t,{t:a}}}function eT(e,t){var r=FE(e,8);e.l+=16;var n=bE(e,t-24);return[r,n]}function tT(e){var t=Sp(24),r=Fp(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),a=0;a<16;++a)t.write_shift(1,parseInt(n[a],16));return _u([t,CE(e[1])])}function rT(e,t){e.read_shift(2);var r=FE(e,8),n=e.read_shift((t-10)/2,"dbcs-cont");return n=n.replace(xu,""),[r,n]}function nT(e){var t=e[1].Tooltip,r=Sp(10+2*(t.length+1));r.write_shift(2,2048);var n=Fp(e[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var a=0;a<t.length;++a)r.write_shift(2,t.charCodeAt(a));return r.write_shift(2,0),r}function aT(e){var t,r=[0,0];return t=e.read_shift(2),r[0]=$m[t]||t,t=e.read_shift(2),r[1]=$m[t]||t,r}function sT(e){return e||(e=Sp(4)),e.write_shift(2,1),e.write_shift(2,1),e}function iT(e){var t=e.read_shift(2),r=[];while(t-- >0)r.push(IE(e,8));return r}function oT(e){var t=e.read_shift(2),r=[];while(t-- >0)r.push(IE(e,8));return r}function cT(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function lT(e,t,r){if(!r.cellStyles)return Tp(e,t);var n=r&&r.biff>=12?4:2,a=e.read_shift(n),s=e.read_shift(n),i=e.read_shift(n),o=e.read_shift(n),c=e.read_shift(2);2==n&&(e.l+=2);var l={s:a,e:s,w:i,ixfe:o,flags:c};return(r.biff>=5||!r.biff)&&(l.level=c>>8&7),l}function uT(e,t){var r=Sp(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,256*e.width),r.write_shift(2,0);var n=0;return e.hidden&&(n|=1),r.write_shift(1,n),n=e.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function hT(e,t){var r={};return t<32||(e.l+=16,r.header=Rm(e,8),r.footer=Rm(e,8),e.l+=2),r}function fT(e,t,r){var n={area:!1};if(5!=r.biff)return e.l+=t,n;var a=e.read_shift(1);return e.l+=3,16&a&&(n.area=!0),n}function dT(e){for(var t=Sp(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}var pT=ME,mT=uE,gT=EE;function ET(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),a={fmt:t,env:r,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,a}function vT(e,t,r){r.biffguess&&5==r.biff&&(r.biff=2);var n=ME(e,6);++e.l;var a=vE(e,t-7,r);return n.t="str",n.val=a,n}function TT(e){var t=ME(e,6);++e.l;var r=Rm(e,8);return t.t="n",t.val=r,t}function ST(e,t,r){var n=Sp(15);return UO(n,e,t),n.write_shift(8,r,"f"),n}function AT(e){var t=ME(e,6);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function RT(e,t,r){var n=Sp(9);return UO(n,e,t),n.write_shift(2,r),n}function yT(e){var t=e.read_shift(1);return 0===t?(e.l++,""):e.read_shift(t,"sbcs-cont")}function NT(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function wT(e,t,r){var n=e.l+t,a=ME(e,6),s=e.read_shift(2),i=gE(e,s,r);return e.l=n,a.t="str",a.val=i,a}var bT=[2,3,48,49,131,139,140,245],CT=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=lf({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(t,r){var n=[],a=Cu(1);switch(r.type){case"base64":a=Iu(yu(t));break;case"binary":a=Iu(t);break;case"buffer":case"array":a=t;break}vp(a,0);var s=a.read_shift(1),i=!!(136&s),o=!1,c=!1;switch(s){case 2:break;case 3:break;case 48:o=!0,i=!0;break;case 49:o=!0,i=!0;break;case 131:break;case 139:break;case 140:c=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+s.toString(16))}var l=0,u=521;2==s&&(l=a.read_shift(2)),a.l+=3,2!=s&&(l=a.read_shift(4)),l>1048576&&(l=1e6),2!=s&&(u=a.read_shift(2));var h=a.read_shift(2),f=r.codepage||1252;2!=s&&(a.l+=16,a.read_shift(1),0!==a[a.l]&&(f=e[a[a.l]]),a.l+=1,a.l+=2),c&&(a.l+=36);var d=[],p={},m=Math.min(a.length,2==s?521:u-10-(o?264:0)),g=c?32:11;while(a.l<m&&13!=a[a.l])switch(p={},p.name=("undefined"!==typeof ql?ql.utils.decode(f,a.slice(a.l,a.l+g)):Du(a.slice(a.l,a.l+g))).replace(/[\u0000\r\n].*$/g,""),a.l+=g,p.type=String.fromCharCode(a.read_shift(1)),2==s||c||(p.offset=a.read_shift(4)),p.len=a.read_shift(1),2==s&&(p.offset=a.read_shift(2)),p.dec=a.read_shift(1),p.name.length&&d.push(p),2!=s&&(a.l+=c?13:14),p.type){case"B":o&&8==p.len||!r.WTF||console.log("Skipping "+p.name+":"+p.type);break;case"G":case"P":r.WTF&&console.log("Skipping "+p.name+":"+p.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+p.type)}if(13!==a[a.l]&&(a.l=u-1),13!==a.read_shift(1))throw new Error("DBF Terminator not found "+a.l+" "+a[a.l]);a.l=u;var E=0,v=0;for(n[0]=[],v=0;v!=d.length;++v)n[0][v]=d[v].name;while(l-- >0)if(42!==a[a.l])for(++a.l,n[++E]=[],v=0,v=0;v!=d.length;++v){var T=a.slice(a.l,a.l+d[v].len);a.l+=d[v].len,vp(T,0);var S="undefined"!==typeof ql?ql.utils.decode(f,T):Du(T);switch(d[v].type){case"C":S.trim().length&&(n[E][v]=S.replace(/\s+$/,""));break;case"D":8===S.length?n[E][v]=new Date(+S.slice(0,4),+S.slice(4,6)-1,+S.slice(6,8)):n[E][v]=S;break;case"F":n[E][v]=parseFloat(S.trim());break;case"+":case"I":n[E][v]=c?2147483648^T.read_shift(-4,"i"):T.read_shift(4,"i");break;case"L":switch(S.trim().toUpperCase()){case"Y":case"T":n[E][v]=!0;break;case"N":case"F":n[E][v]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+S+"|")}break;case"M":if(!i)throw new Error("DBF Unexpected MEMO for type "+s.toString(16));n[E][v]="##MEMO##"+(c?parseInt(S.trim(),10):T.read_shift(4));break;case"N":S=S.replace(/\u0000/g,"").trim(),S&&"."!=S&&(n[E][v]=+S||0);break;case"@":n[E][v]=new Date(T.read_shift(-8,"f")-621356832e5);break;case"T":n[E][v]=new Date(864e5*(T.read_shift(4)-2440588)+T.read_shift(4));break;case"Y":n[E][v]=T.read_shift(4,"i")/1e4+T.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":n[E][v]=-T.read_shift(-8,"f");break;case"B":if(o&&8==d[v].len){n[E][v]=T.read_shift(8,"f");break}case"G":case"P":T.l+=d[v].len;break;case"0":if("_NullFlags"===d[v].name)break;default:throw new Error("DBF Unsupported data type "+d[v].type)}}else a.l+=h;if(2!=s&&a.l<a.length&&26!=a[a.l++])throw new Error("DBF EOF Marker missing "+(a.l-1)+" of "+a.length+" "+a[a.l-1].toString(16));return r&&r.sheetRows&&(n=n.slice(0,r.sheetRows)),r.DBF=d,n}function n(e,t){var n=t||{};n.dateNF||(n.dateNF="yyyymmdd");var a=Xp(r(e,n),n);return a["!cols"]=n.DBF.map((function(e){return{wch:e.len,DBF:e}})),delete n.DBF,a}function a(e,t){try{var r=$p(n(e,t),t);return r.bookType="dbf",r}catch(a){if(t&&t.WTF)throw a}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function i(r,n){var a=n||{},i=nu;if(+a.codepage>=0&&lu(+a.codepage),"string"==a.type)throw new Error("Cannot write DBF to JS string");var o=Rp(),c=eD(r,{header:1,raw:!0,cellDates:!0}),l=c[0],u=c.slice(1),h=r["!cols"]||[],f=0,d=0,p=0,m=1;for(f=0;f<l.length;++f)if(((h[f]||{}).DBF||{}).name)l[f]=h[f].DBF.name,++p;else if(null!=l[f]){if(++p,"number"===typeof l[f]&&(l[f]=l[f].toString(10)),"string"!==typeof l[f])throw new Error("DBF Invalid column name "+l[f]+" |"+typeof l[f]+"|");if(l.indexOf(l[f])!==f)for(d=0;d<1024;++d)if(-1==l.indexOf(l[f]+"_"+d)){l[f]+="_"+d;break}}var g=Gp(r["!ref"]),E=[],v=[],T=[];for(f=0;f<=g.e.c-g.s.c;++f){var S="",A="",R=0,y=[];for(d=0;d<u.length;++d)null!=u[d][f]&&y.push(u[d][f]);if(0!=y.length&&null!=l[f]){for(d=0;d<y.length;++d){switch(typeof y[d]){case"number":A="B";break;case"string":A="C";break;case"boolean":A="L";break;case"object":A=y[d]instanceof Date?"D":"C";break;default:A="C"}R=Math.max(R,("undefined"!==typeof ql&&"string"==typeof y[d]?ql.utils.encode(au,y[d]):String(y[d])).length),S=S&&S!=A?"C":A}R>250&&(R=250),A=((h[f]||{}).DBF||{}).type,"C"==A&&h[f].DBF.len>R&&(R=h[f].DBF.len),"B"==S&&"N"==A&&(S="N",T[f]=h[f].DBF.dec,R=h[f].DBF.len),v[f]="C"==S||"N"==A?R:s[S]||0,m+=v[f],E[f]=S}else E[f]="?"}var N=o.next(32);for(N.write_shift(4,318902576),N.write_shift(4,u.length),N.write_shift(2,296+32*p),N.write_shift(2,m),f=0;f<4;++f)N.write_shift(4,0);var w=+t[nu]||3;for(N.write_shift(4,0|w<<8),e[w]!=+a.codepage&&(a.codepage&&console.error("DBF Unsupported codepage "+nu+", using 1252"),nu=1252),f=0,d=0;f<l.length;++f)if(null!=l[f]){var b=o.next(32),C=(l[f].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);b.write_shift(1,C,"sbcs"),b.write_shift(1,"?"==E[f]?"C":E[f],"sbcs"),b.write_shift(4,d),b.write_shift(1,v[f]||s[E[f]]||0),b.write_shift(1,T[f]||0),b.write_shift(1,2),b.write_shift(4,0),b.write_shift(1,0),b.write_shift(4,0),b.write_shift(4,0),d+=v[f]||s[E[f]]||0}var O=o.next(264);for(O.write_shift(4,13),f=0;f<65;++f)O.write_shift(4,0);for(f=0;f<u.length;++f){var I=o.next(m);for(I.write_shift(1,0),d=0;d<l.length;++d)if(null!=l[d])switch(E[d]){case"L":I.write_shift(1,null==u[f][d]?63:u[f][d]?84:70);break;case"B":I.write_shift(8,u[f][d]||0,"f");break;case"N":var M="0";for("number"==typeof u[f][d]&&(M=u[f][d].toFixed(T[d]||0)),M.length>v[d]&&(M=M.slice(0,v[d])),p=0;p<v[d]-M.length;++p)I.write_shift(1,32);I.write_shift(1,M,"sbcs");break;case"D":u[f][d]?(I.write_shift(4,("0000"+u[f][d].getFullYear()).slice(-4),"sbcs"),I.write_shift(2,("00"+(u[f][d].getMonth()+1)).slice(-2),"sbcs"),I.write_shift(2,("00"+u[f][d].getDate()).slice(-2),"sbcs")):I.write_shift(8,"00000000","sbcs");break;case"C":var D=I.l,L=String(null!=u[f][d]?u[f][d]:"").slice(0,v[d]);for(I.write_shift(1,L,"cpstr"),D+=v[d]-I.l,p=0;p<D;++p)I.write_shift(1,32);break}}return nu=i,o.next(1).write_shift(1,26),o.end()}return{to_workbook:a,to_sheet:n,from_sheet:i}}(),OT=function(){var e={AA:"À",BA:"Á",CA:"Â",DA:195,HA:"Ä",JA:197,AE:"È",BE:"É",CE:"Ê",HE:"Ë",AI:"Ì",BI:"Í",CI:"Î",HI:"Ï",AO:"Ò",BO:"Ó",CO:"Ô",DO:213,HO:"Ö",AU:"Ù",BU:"Ú",CU:"Û",HU:"Ü",Aa:"à",Ba:"á",Ca:"â",Da:227,Ha:"ä",Ja:229,Ae:"è",Be:"é",Ce:"ê",He:"ë",Ai:"ì",Bi:"í",Ci:"î",Hi:"ï",Ao:"ò",Bo:"ó",Co:"ô",Do:245,Ho:"ö",Au:"ù",Bu:"ú",Cu:"û",Hu:"ü",KC:"Ç",Kc:"ç",q:"æ",z:"œ",a:"Æ",j:"Œ",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("N("+of(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(t,r){var n=e[r];return"number"==typeof n?gu(n):n},n=function(e,t,r){var n=t.charCodeAt(0)-32<<4|r.charCodeAt(0)-48;return 59==n?e:gu(n)};function a(e,t){switch(t.type){case"base64":return s(yu(e),t);case"binary":return s(e,t);case"buffer":return s(Nu&&Buffer.isBuffer(e)?e.toString("binary"):Du(e),t);case"array":return s(yf(e),t)}throw new Error("Unrecognized type "+t.type)}function s(e,a){var s,i=e.split(/[\n\r]+/),o=-1,c=-1,l=0,u=0,h=[],f=[],d=null,p={},m=[],g=[],E=[],v=0,T={Workbook:{WBProps:{},Names:[]}};for(+a.codepage>=0&&lu(+a.codepage);l!==i.length;++l){v=0;var S,A=i[l].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),R=A.replace(/;;/g,"\0").split(";").map((function(e){return e.replace(/\u0000/g,";")})),y=R[0];if(A.length>0)switch(y){case"ID":break;case"E":break;case"B":break;case"O":for(u=1;u<R.length;++u)switch(R[u].charAt(0)){case"V":var N=parseInt(R[u].slice(1),10);N>=1&&N<=4&&(T.Workbook.WBProps.date1904=!0);break}break;case"W":break;case"P":switch(R[1].charAt(0)){case"P":f.push(A.slice(3).replace(/;;/g,";"));break}break;case"NN":var w={Sheet:0};for(u=1;u<R.length;++u)switch(R[u].charAt(0)){case"N":w.Name=R[u].slice(1);break;case"E":w.Ref=(a&&a.sheet||"Sheet1")+"!"+_R(R[u].slice(1));break}T.Workbook.Names.push(w);break;case"C":var b=!1,C=!1,O=!1,I=!1,M=-1,D=-1,L="",k="z";for(u=1;u<R.length;++u)switch(R[u].charAt(0)){case"A":break;case"X":c=parseInt(R[u].slice(1),10)-1,C=!0;break;case"Y":for(o=parseInt(R[u].slice(1),10)-1,C||(c=0),s=h.length;s<=o;++s)h[s]=[];break;case"K":S=R[u].slice(1),'"'===S.charAt(0)?(S=S.slice(1,S.length-1),k="s"):"TRUE"===S||"FALSE"===S?(S="TRUE"===S,k="b"):isNaN(bf(S))?isNaN(Mf(S).getDate())||(S=Rf(S),k="d",a.cellDates||(k="n",S=df(S,T.Workbook.WBProps.date1904))):(S=bf(S),k="n",null!==d&&Fh(d)&&a.cellDates&&(S=Ef(T.Workbook.WBProps.date1904?S+1462:S),k="d")),"undefined"!==typeof ql&&"string"==typeof S&&"string"!=(a||{}).type&&(a||{}).codepage&&(S=ql.utils.decode(a.codepage,S)),b=!0;break;case"E":I=!0,L=_R(R[u].slice(1),{r:o,c:c});break;case"S":O=!0;break;case"G":break;case"R":M=parseInt(R[u].slice(1),10)-1;break;case"C":D=parseInt(R[u].slice(1),10)-1;break;default:if(a&&a.WTF)throw new Error("SYLK bad record "+A)}if(b&&(h[o][c]?(h[o][c].t=k,h[o][c].v=S):h[o][c]={t:k,v:S},d&&(h[o][c].z=d),!1!==a.cellText&&d&&(h[o][c].w=Wh(h[o][c].z,h[o][c].v,{date1904:T.Workbook.WBProps.date1904})),d=null),O){if(I)throw new Error("SYLK shared formula cannot have own formula");var _=M>-1&&h[M][D];if(!_||!_[1])throw new Error("SYLK shared formula cannot find base");L=FR(_[1],{r:o-M,c:c-D})}L&&(h[o][c]?h[o][c].f=L:h[o][c]={t:"n",f:L});break;case"F":var U=0;for(u=1;u<R.length;++u)switch(R[u].charAt(0)){case"X":c=parseInt(R[u].slice(1),10)-1,++U;break;case"Y":for(o=parseInt(R[u].slice(1),10)-1,s=h.length;s<=o;++s)h[s]=[];break;case"M":v=parseInt(R[u].slice(1),10)/20;break;case"F":break;case"G":break;case"P":d=f[parseInt(R[u].slice(1),10)];break;case"S":break;case"D":break;case"N":break;case"W":for(E=R[u].slice(1).split(" "),s=parseInt(E[0],10);s<=parseInt(E[1],10);++s)v=parseInt(E[2],10),g[s-1]=0===v?{hidden:!0}:{wch:v};break;case"C":c=parseInt(R[u].slice(1),10)-1,g[c]||(g[c]={});break;case"R":o=parseInt(R[u].slice(1),10)-1,m[o]||(m[o]={}),v>0?(m[o].hpt=v,m[o].hpx=GS(v)):0===v&&(m[o].hidden=!0);break;default:if(a&&a.WTF)throw new Error("SYLK bad record "+A)}U<1&&(d=null);break;default:if(a&&a.WTF)throw new Error("SYLK bad record "+A)}}return m.length>0&&(p["!rows"]=m),g.length>0&&(p["!cols"]=g),g.forEach((function(e){BS(e)})),a&&a.sheetRows&&(h=h.slice(0,a.sheetRows)),[h,p,T]}function i(e,t){var r=a(e,t),n=r[0],s=r[1],i=r[2],o=Nf(t);o.date1904=(((i||{}).Workbook||{}).WBProps||{}).date1904;var c=Xp(n,o);of(s).forEach((function(e){c[e]=s[e]}));var l=$p(c,t);return of(i).forEach((function(e){l[e]=i[e]})),l.bookType="sylk",l}function o(e,t,r,n){var a="C;Y"+(r+1)+";X"+(n+1)+";K";switch(e.t){case"n":a+=e.v||0,e.f&&!e.F&&(a+=";E"+xR(e.f,{r:r,c:n}));break;case"b":a+=e.v?"TRUE":"FALSE";break;case"e":a+=e.w||e.v;break;case"d":a+='"'+(e.w||e.v)+'"';break;case"s":a+='"'+(null==e.v?"":String(e.v)).replace(/"/g,"").replace(/;/g,";;")+'"';break}return a}function c(e,t){t.forEach((function(t,r){var n="F;W"+(r+1)+" "+(r+1)+" ";t.hidden?n+="0":("number"!=typeof t.width||t.wpx||(t.wpx=_S(t.width)),"number"!=typeof t.wpx||t.wch||(t.wch=US(t.wpx)),"number"==typeof t.wch&&(n+=Math.round(t.wch)))," "!=n.charAt(n.length-1)&&e.push(n)}))}function l(e,t){t.forEach((function(t,r){var n="F;";t.hidden?n+="M0;":t.hpt?n+="M"+20*t.hpt+";":t.hpx&&(n+="M"+20*WS(t.hpx)+";"),n.length>2&&e.push(n+"R"+(r+1))}))}function u(e,t,r){var n,a=["ID;PSheetJS;N;E"],s=[],i=Gp(e["!ref"]),u=null!=e["!data"],h="\r\n",f=(((r||{}).Workbook||{}).WBProps||{}).date1904;a.push("P;PGeneral"),a.push("F;P0;DG0G8;M255"),e["!cols"]&&c(a,e["!cols"]),e["!rows"]&&l(a,e["!rows"]),a.push("B;Y"+(i.e.r-i.s.r+1)+";X"+(i.e.c-i.s.c+1)+";D"+[i.s.c,i.s.r,i.e.c,i.e.r].join(" ")),a.push("O;L;D;B"+(f?";V4":"")+";K47;G100 0.001");for(var d=i.s.r;d<=i.e.r;++d)if(!u||e["!data"][d]){for(var p=[],m=i.s.c;m<=i.e.c;++m)n=u?e["!data"][d][m]:e[kp(m)+Ip(d)],n&&(null!=n.v||n.f&&!n.F)&&p.push(o(n,e,d,m,t));s.push(p.join(h))}return a.join(h)+h+s.join(h)+h+"E"+h}return e["|"]=254,{to_workbook:i,from_sheet:u}}(),IT=function(){function e(e,r){switch(r.type){case"base64":return t(yu(e),r);case"binary":return t(e,r);case"buffer":return t(Nu&&Buffer.isBuffer(e)?e.toString("binary"):Du(e),r);case"array":return t(yf(e),r)}throw new Error("Unrecognized type "+r.type)}function t(e,t){for(var r=e.split("\n"),n=-1,a=-1,s=0,i=[];s!==r.length;++s)if("BOT"!==r[s].trim()){if(!(n<0)){var o=r[s].trim().split(","),c=o[0],l=o[1];++s;var u=r[s]||"";while(1&(u.match(/["]/g)||[]).length&&s<r.length-1)u+="\n"+r[++s];switch(u=u.trim(),+c){case-1:if("BOT"===u){i[++n]=[],a=0;continue}if("EOD"!==u)throw new Error("Unrecognized DIF special command "+u);break;case 0:"TRUE"===u?i[n][a]=!0:"FALSE"===u?i[n][a]=!1:isNaN(bf(l))?isNaN(Mf(l).getDate())?i[n][a]=l:i[n][a]=Rf(l):i[n][a]=bf(l),++a;break;case 1:u=u.slice(1,u.length-1),u=u.replace(/""/g,'"'),Tu&&u&&u.match(/^=".*"$/)&&(u=u.slice(2,-1)),i[n][a++]=""!==u?u:null;break}if("EOD"===u)break}}else i[++n]=[],a=0;return t&&t.sheetRows&&(i=i.slice(0,t.sheetRows)),i}function r(t,r){return Xp(e(t,r),r)}function n(e,t){var n=$p(r(e,t),t);return n.bookType="dif",n}function a(e,t){return"0,"+String(e)+"\r\n"+t}function s(e){return'1,0\r\n"'+e.replace(/"/g,'""')+'"'}function i(e){for(var t=Tu,r=Gp(e["!ref"]),n=null!=e["!data"],i=['TABLE\r\n0,1\r\n"sheetjs"\r\n',"VECTORS\r\n0,"+(r.e.r-r.s.r+1)+'\r\n""\r\n',"TUPLES\r\n0,"+(r.e.c-r.s.c+1)+'\r\n""\r\n','DATA\r\n0,0\r\n""\r\n'],o=r.s.r;o<=r.e.r;++o){for(var c=n?e["!data"][o]:[],l="-1,0\r\nBOT\r\n",u=r.s.c;u<=r.e.c;++u){var h=n?c&&c[u]:e[Pp({r:o,c:u})];if(null!=h){switch(h.t){case"n":t?null!=h.w?l+="0,"+h.w+"\r\nV":null!=h.v?l+=a(h.v,"V"):null==h.f||h.F?l+='1,0\r\n""':l+=s("="+h.f):null==h.v?l+='1,0\r\n""':l+=a(h.v,"V");break;case"b":l+=h.v?a(1,"TRUE"):a(0,"FALSE");break;case"s":l+=s(!t||isNaN(+h.v)?h.v:'="'+h.v+'"');break;case"d":h.w||(h.w=Wh(h.z||qu[14],df(Rf(h.v)))),l+=t?a(h.w,"V"):s(h.w);break;default:l+='1,0\r\n""'}l+="\r\n"}else l+='1,0\r\n""\r\n'}i.push(l)}return i.join("")+"-1,0\r\nEOD"}return{to_workbook:n,to_sheet:r,from_sheet:i}}(),MT=function(){function e(e){return e.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,"\n")}function t(e){return e.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(t,r){for(var n=t.split("\n"),a=-1,s=-1,i=0,o=[];i!==n.length;++i){var c=n[i].trim().split(":");if("cell"===c[0]){var l=Fp(c[1]);if(o.length<=l.r)for(a=o.length;a<=l.r;++a)o[a]||(o[a]=[]);switch(a=l.r,s=l.c,c[2]){case"t":o[a][s]=e(c[3]);break;case"v":o[a][s]=+c[3];break;case"vtf":var u=c[c.length-1];case"vtc":switch(c[3]){case"nl":o[a][s]=!!+c[4];break;default:o[a][s]=+c[4];break}"vtf"==c[2]&&(o[a][s]=[o[a][s],u])}}}return r&&r.sheetRows&&(o=o.slice(0,r.sheetRows)),o}function n(e,t){return Xp(r(e,t),t)}function a(e,t){return $p(n(e,t),t)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join("\n"),i=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join("\n")+"\n",o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join("\n"),c="--SocialCalcSpreadsheetControlSave--";function l(e){if(!e||!e["!ref"])return"";for(var r,n=[],a=[],s="",i=Bp(e["!ref"]),o=null!=e["!data"],c=i.s.r;c<=i.e.r;++c)for(var l=i.s.c;l<=i.e.c;++l)if(s=Pp({r:c,c:l}),r=o?(e["!data"][c]||[])[l]:e[s],r&&null!=r.v&&"z"!==r.t){switch(a=["cell",s,"t"],r.t){case"s":case"str":a.push(t(r.v));break;case"n":r.f?(a[2]="vtf",a[3]="n",a[4]=r.v,a[5]=t(r.f)):(a[2]="v",a[3]=r.v);break;case"b":a[2]="vt"+(r.f?"f":"c"),a[3]="nl",a[4]=r.v?"1":"0",a[5]=t(r.f||(r.v?"TRUE":"FALSE"));break;case"d":var u=df(Rf(r.v));a[2]="vtc",a[3]="nd",a[4]=""+u,a[5]=r.w||Wh(r.z||qu[14],u);break;case"e":continue}n.push(a.join(":"))}return n.push("sheet:c:"+(i.e.c-i.s.c+1)+":r:"+(i.e.r-i.s.r+1)+":tvf:1"),n.push("valueformat:1:text-wiki"),n.join("\n")}function u(e){return[s,i,o,i,l(e),c].join("\n")}return{to_workbook:a,to_sheet:n,from_sheet:u}}(),DT=function(){function e(e,t,r,n,a){a.raw?t[r][n]=e:""===e||("TRUE"===e?t[r][n]=!0:"FALSE"===e?t[r][n]=!1:isNaN(bf(e))?isNaN(Mf(e).getDate())?t[r][n]=e:t[r][n]=Rf(e):t[r][n]=bf(e))}function t(t,r){var n=r||{},a=[];if(!t||0===t.length)return a;var s=t.split(/[\r\n]/),i=s.length-1;while(i>=0&&0===s[i].length)--i;for(var o=10,c=0,l=0;l<=i;++l)c=s[l].indexOf(" "),-1==c?c=s[l].length:c++,o=Math.max(o,c);for(l=0;l<=i;++l){a[l]=[];var u=0;for(e(s[l].slice(0,o).trim(),a,l,u,n),u=1;u<=(s[l].length-o)/10+1;++u)e(s[l].slice(o+10*(u-1),o+10*u).trim(),a,l,u,n)}return n.sheetRows&&(a=a.slice(0,n.sheetRows)),a}var r={44:",",9:"\t",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function a(e){for(var t={},a=!1,s=0,i=0;s<e.length;++s)34==(i=e.charCodeAt(s))?a=!a:!a&&i in r&&(t[i]=(t[i]||0)+1);for(s in i=[],t)Object.prototype.hasOwnProperty.call(t,s)&&i.push([t[s],s]);if(!i.length)for(s in t=n,t)Object.prototype.hasOwnProperty.call(t,s)&&i.push([t[s],s]);return i.sort((function(e,t){return e[0]-t[0]||n[e[1]]-n[t[1]]})),r[i.pop()[1]]||44}function s(e,t){var r=t||{},n="";null!=vu&&null==r.dense&&(r.dense=vu);var s={};r.dense&&(s["!data"]=[]);var i={s:{c:0,r:0},e:{c:0,r:0}};"sep="==e.slice(0,4)?13==e.charCodeAt(5)&&10==e.charCodeAt(6)?(n=e.charAt(4),e=e.slice(7)):13==e.charCodeAt(5)||10==e.charCodeAt(5)?(n=e.charAt(4),e=e.slice(6)):n=a(e.slice(0,1024)):n=r&&r.FS?r.FS:a(e.slice(0,1024));var o=0,c=0,l=0,u=0,h=0,f=n.charCodeAt(0),d=!1,p=0,m=e.charCodeAt(0),g=null!=r.dateNF?Kh(r.dateNF):null;function E(){var t=e.slice(u,h);"\r"==t.slice(-1)&&(t=t.slice(0,-1));var n={};if('"'==t.charAt(0)&&'"'==t.charAt(t.length-1)&&(t=t.slice(1,-1).replace(/""/g,'"')),0===t.length)n.t="z";else if(r.raw)n.t="s",n.v=t;else if(0===t.trim().length)n.t="s",n.v=t;else if(61==t.charCodeAt(0))34==t.charCodeAt(1)&&34==t.charCodeAt(t.length-1)?(n.t="s",n.v=t.slice(2,-1).replace(/""/g,'"')):BR(t)?(n.t="n",n.f=t.slice(1)):(n.t="s",n.v=t);else if("TRUE"==t)n.t="b",n.v=!0;else if("FALSE"==t)n.t="b",n.v=!1;else if(isNaN(l=bf(t)))if(!isNaN((l=Mf(t)).getDate())||g&&t.match(g)){n.z=r.dateNF||qu[14];var a=0;g&&t.match(g)&&(t=qh(t,r.dateNF,t.match(g)||[]),a=1,l=Rf(t,a)),r.cellDates?(n.t="d",n.v=l):(n.t="n",n.v=df(l)),!1!==r.cellText&&(n.w=Wh(n.z,n.v instanceof Date?df(n.v):n.v)),r.cellNF||delete n.z}else n.t="s",n.v=t;else n.t="n",!1!==r.cellText&&(n.w=t),n.v=l;if("z"==n.t||(r.dense?(s["!data"][o]||(s["!data"][o]=[]),s["!data"][o][c]=n):s[Pp({c:c,r:o})]=n),u=h+1,m=e.charCodeAt(u),i.e.c<c&&(i.e.c=c),i.e.r<o&&(i.e.r=o),p==f)++c;else if(c=0,++o,r.sheetRows&&r.sheetRows<=o)return!0}e:for(;h<e.length;++h)switch(p=e.charCodeAt(h)){case 34:34===m&&(d=!d);break;case 13:if(d)break;10==e.charCodeAt(h+1)&&++h;case f:case 10:if(!d&&E())break e;break;default:break}return h-u>0&&E(),s["!ref"]=Yp(i),s}function i(e,r){return r&&r.PRN?r.FS||"sep="==e.slice(0,4)||e.indexOf("\t")>=0||e.indexOf(",")>=0||e.indexOf(";")>=0?s(e,r):Xp(t(e,r),r):s(e,r)}function o(e,t){var r="",n="string"==t.type?[0,0,0,0]:OM(e,t);switch(t.type){case"base64":r=yu(e);break;case"binary":r=e;break;case"buffer":r=65001==t.codepage?e.toString("utf8"):t.codepage&&"undefined"!==typeof ql?ql.utils.decode(t.codepage,e):Nu&&Buffer.isBuffer(e)?e.toString("binary"):Du(e);break;case"array":r=yf(e);break;case"string":r=e;break;default:throw new Error("Unrecognized type "+t.type)}return 239==n[0]&&187==n[1]&&191==n[2]?r=Ed(r.slice(3)):"string"!=t.type&&"buffer"!=t.type&&65001==t.codepage?r=Ed(r):"binary"==t.type&&"undefined"!==typeof ql&&t.codepage&&(r=ql.utils.decode(t.codepage,ql.utils.encode(28591,r))),"socialcalc:version:"==r.slice(0,19)?MT.to_sheet("string"==t.type?r:Ed(r),t):i(r,t)}function c(e,t){return $p(o(e,t),t)}function l(e){for(var t,r=[],n=Gp(e["!ref"]),a=null!=e["!data"],s=n.s.r;s<=n.e.r;++s){for(var i=[],o=n.s.c;o<=n.e.c;++o){var c=Pp({r:s,c:o});if(t=a?(e["!data"][s]||[])[o]:e[c],t&&null!=t.v){var l=(t.w||(zp(t),t.w)||"").slice(0,10);while(l.length<10)l+=" ";i.push(l+(0===o?" ":""))}else i.push("          ")}r.push(i.join(""))}return r.join("\n")}return{to_workbook:c,to_sheet:o,from_sheet:l}}();function LT(e,t){var r=t||{},n=!!r.WTF;r.WTF=!0;try{var a=OT.to_workbook(e,r);return r.WTF=n,a}catch(s){if(r.WTF=n,!s.message.match(/SYLK bad record ID/)&&n)throw s;return DT.to_workbook(e,t)}}var kT=function(){function e(e,t,r){if(e){vp(e,e.l||0);var n=r.Enum||F;while(e.l<e.length){var a=e.read_shift(2),s=n[a]||n[65535],i=e.read_shift(2),o=e.l+i,c=s.f&&s.f(e,i,r);if(e.l=o,t(c,s,a))return}}}function t(e,t){switch(t.type){case"base64":return r(Iu(yu(e)),t);case"binary":return r(Iu(e),t);case"buffer":case"array":return r(e,t)}throw"Unsupported type "+t.type}function r(t,r){if(!t)return t;var n=r||{};null!=vu&&null==n.dense&&(n.dense=vu);var a={},s="Sheet1",i="",o=0,c={},l=[],u=[],h=[];n.dense&&(h=a["!data"]=[]);var f={s:{r:0,c:0},e:{r:0,c:0}},d=n.sheetRows||0;if(81==t[4]&&80==t[5]&&87==t[6])return B(t,r);if(0==t[2]&&(8==t[3]||9==t[3])&&t.length>=16&&5==t[14]&&108===t[15])throw new Error("Unsupported Works 3 for Mac file");if(2==t[2])n.Enum=F,e(t,(function(e,t,r){switch(r){case 0:n.vers=e,e>=4096&&(n.qpro=!0);break;case 255:n.vers=e,n.works=!0;break;case 6:f=e;break;case 204:e&&(i=e);break;case 222:i=e;break;case 15:case 51:(!n.qpro&&!n.works||51==r)&&e[1].v.charCodeAt(0)<48&&(e[1].v=e[1].v.slice(1)),(n.works||n.works2)&&(e[1].v=e[1].v.replace(/\r\n/g,"\n"));case 13:case 14:case 16:14==r&&112==(112&e[2])&&(15&e[2])>1&&(15&e[2])<15&&(e[1].z=n.dateNF||qu[14],n.cellDates&&(e[1].t="d",e[1].v=Ef(e[1].v))),n.qpro&&e[3]>o&&(a["!ref"]=Yp(f),c[s]=a,l.push(s),a={},n.dense&&(h=a["!data"]=[]),f={s:{r:0,c:0},e:{r:0,c:0}},o=e[3],s=i||"Sheet"+(o+1),i="");var u=n.dense?(h[e[0].r]||[])[e[0].c]:a[Pp(e[0])];if(u){u.t=e[1].t,u.v=e[1].v,null!=e[1].z&&(u.z=e[1].z),null!=e[1].f&&(u.f=e[1].f);break}n.dense?(h[e[0].r]||(h[e[0].r]=[]),h[e[0].r][e[0].c]=e[1]):a[Pp(e[0])]=e[1];break;case 21509:n.works2=!0;break;default:}}),n);else{if(26!=t[2]&&14!=t[2])throw new Error("Unrecognized LOTUS BOF "+t[2]);n.Enum=P,14==t[2]&&(n.qpro=!0,t.l=0),e(t,(function(e,t,r){switch(r){case 204:s=e;break;case 22:e[1].v.charCodeAt(0)<48&&(e[1].v=e[1].v.slice(1)),e[1].v=e[1].v.replace(/\x0F./g,(function(e){return String.fromCharCode(e.charCodeAt(1)-32)})).replace(/\r\n/g,"\n");case 23:case 24:case 25:case 37:case 39:case 40:if(e[3]>o&&(a["!ref"]=Yp(f),c[s]=a,l.push(s),a={},n.dense&&(h=a["!data"]=[]),f={s:{r:0,c:0},e:{r:0,c:0}},o=e[3],s="Sheet"+(o+1)),d>0&&e[0].r>=d)break;n.dense?(h[e[0].r]||(h[e[0].r]=[]),h[e[0].r][e[0].c]=e[1]):a[Pp(e[0])]=e[1],f.e.c<e[0].c&&(f.e.c=e[0].c),f.e.r<e[0].r&&(f.e.r=e[0].r);break;case 27:e[14e3]&&(u[e[14e3][0]]=e[14e3][1]);break;case 1537:u[e[0]]=e[1],e[0]==o&&(s=e[1]);break;default:break}}),n)}if(a["!ref"]=Yp(f),c[i||s]=a,l.push(i||s),!u.length)return{SheetNames:l,Sheets:c};for(var p={},m=[],g=0;g<u.length;++g)c[l[g]]?(m.push(u[g]||l[g]),p[u[g]]=c[u[g]]||c[l[g]]):(m.push(u[g]),p[u[g]]={"!ref":"A1"});return{SheetNames:m,Sheets:p}}function n(e,t){var r=t||{};if(+r.codepage>=0&&lu(+r.codepage),"string"==r.type)throw new Error("Cannot write WK1 to JS string");var n=Rp(),a=Gp(e["!ref"]),i=null!=e["!data"],o=[];kO(n,0,s(1030)),kO(n,6,c(a));for(var l=Math.min(a.e.r,8191),u=a.s.c;u<=a.e.c;++u)o[u]=kp(u);for(var f=a.s.r;f<=l;++f){var d=Ip(f);for(u=a.s.c;u<=a.e.c;++u){var m=i?(e["!data"][f]||[])[u]:e[o[u]+d];if(m&&"z"!=m.t)if("n"==m.t)(0|m.v)==m.v&&m.v>=-32768&&m.v<=32767?kO(n,13,p(f,u,m.v)):kO(n,14,g(f,u,m.v));else{var E=zp(m);kO(n,15,h(f,u,E.slice(0,239)))}}}return kO(n,1),n.end()}function a(e,t){var r=t||{};if(+r.codepage>=0&&lu(+r.codepage),"string"==r.type)throw new Error("Cannot write WK3 to JS string");var n=Rp();kO(n,0,i(e));for(var a=0,s=0;a<e.SheetNames.length;++a)(e.Sheets[e.SheetNames[a]]||{})["!ref"]&&kO(n,27,x(e.SheetNames[a],s++));var o=0;for(a=0;a<e.SheetNames.length;++a){var c=e.Sheets[e.SheetNames[a]];if(c&&c["!ref"]){for(var l=Gp(c["!ref"]),u=null!=c["!data"],h=[],f=Math.min(l.e.r,8191),d=l.s.r;d<=f;++d)for(var p=Ip(d),m=l.s.c;m<=l.e.c;++m){d===l.s.r&&(h[m]=kp(m));var g=h[m]+p,E=u?(c["!data"][d]||[])[m]:c[g];if(E&&"z"!=E.t)if("n"==E.t)kO(n,23,C(d,m,o,E.v));else{var v=zp(E);kO(n,22,N(d,m,o,v.slice(0,239)))}}++o}}return kO(n,1),n.end()}function s(e){var t=Sp(2);return t.write_shift(2,e),t}function i(e){var t=Sp(26);t.write_shift(2,4096),t.write_shift(2,4),t.write_shift(4,0);for(var r=0,n=0,a=0,s=0;s<e.SheetNames.length;++s){var i=e.SheetNames[s],o=e.Sheets[i];if(o&&o["!ref"]){++a;var c=Bp(o["!ref"]);r<c.e.r&&(r=c.e.r),n<c.e.c&&(n=c.e.c)}}return r>8191&&(r=8191),t.write_shift(2,r),t.write_shift(1,a),t.write_shift(1,n),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(1,1),t.write_shift(1,2),t.write_shift(4,0),t.write_shift(4,0),t}function o(e,t,r){var n={s:{c:0,r:0},e:{c:0,r:0}};return 8==t&&r.qpro?(n.s.c=e.read_shift(1),e.l++,n.s.r=e.read_shift(2),n.e.c=e.read_shift(1),e.l++,n.e.r=e.read_shift(2),n):(n.s.c=e.read_shift(2),n.s.r=e.read_shift(2),12==t&&r.qpro&&(e.l+=2),n.e.c=e.read_shift(2),n.e.r=e.read_shift(2),12==t&&r.qpro&&(e.l+=2),65535==n.s.c&&(n.s.c=n.e.c=n.s.r=n.e.r=0),n)}function c(e){var t=Sp(8);return t.write_shift(2,e.s.c),t.write_shift(2,e.s.r),t.write_shift(2,e.e.c),t.write_shift(2,e.e.r),t}function l(e,t,r){var n=[{c:0,r:0},{t:"n",v:0},0,0];return r.qpro&&20768!=r.vers?(n[0].c=e.read_shift(1),n[3]=e.read_shift(1),n[0].r=e.read_shift(2),e.l+=2):r.works?(n[0].c=e.read_shift(2),n[0].r=e.read_shift(2),n[2]=e.read_shift(2)):(n[2]=e.read_shift(1),n[0].c=e.read_shift(2),n[0].r=e.read_shift(2)),n}function u(e,t,r){var n=e.l+t,a=l(e,t,r);if(a[1].t="s",20768==r.vers){e.l++;var s=e.read_shift(1);return a[1].v=e.read_shift(s,"utf8"),a}return r.qpro&&e.l++,a[1].v=e.read_shift(n-e.l,"cstr"),a}function h(e,t,r){var n=Sp(7+r.length);n.write_shift(1,255),n.write_shift(2,t),n.write_shift(2,e),n.write_shift(1,39);for(var a=0;a<n.length;++a){var s=r.charCodeAt(a);n.write_shift(1,s>=128?95:s)}return n.write_shift(1,0),n}function f(e,t,r){var n=e.l+t,a=l(e,t,r);if(a[1].t="s",20768==r.vers){var s=e.read_shift(1);return a[1].v=e.read_shift(s,"utf8"),a}return a[1].v=e.read_shift(n-e.l,"cstr"),a}function d(e,t,r){var n=l(e,t,r);return n[1].v=e.read_shift(2,"i"),n}function p(e,t,r){var n=Sp(7);return n.write_shift(1,255),n.write_shift(2,t),n.write_shift(2,e),n.write_shift(2,r,"i"),n}function m(e,t,r){var n=l(e,t,r);return n[1].v=e.read_shift(8,"f"),n}function g(e,t,r){var n=Sp(13);return n.write_shift(1,255),n.write_shift(2,t),n.write_shift(2,e),n.write_shift(8,r,"f"),n}function E(e,t,r){var n=e.l+t,a=l(e,t,r);if(a[1].v=e.read_shift(8,"f"),r.qpro)e.l=n;else{var s=e.read_shift(2);A(e.slice(e.l,e.l+s),a),e.l+=s}return a}function v(e,t,r){var n=32768&t;return t&=-32769,t=(n?e:0)+(t>=8192?t-16384:t),(n?"":"$")+(r?kp(t):Ip(t))}var T={31:["NA",0],33:["ABS",1],34:["TRUNC",1],35:["SQRT",1],36:["LOG",1],37:["LN",1],38:["PI",0],39:["SIN",1],40:["COS",1],41:["TAN",1],42:["ATAN2",2],43:["ATAN",1],44:["ASIN",1],45:["ACOS",1],46:["EXP",1],47:["MOD",2],49:["ISNA",1],50:["ISERR",1],51:["FALSE",0],52:["TRUE",0],53:["RAND",0],63:["ROUND",2],68:["ISNUMBER",1],69:["ISTEXT",1],70:["LEN",1],71:["VALUE",1],73:["MID",3],74:["CHAR",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],102:["UPPER",1],103:["LOWER",1],107:["PROPER",1],109:["TRIM",1],111:["T",1]},S=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function A(e,t){vp(e,0);var r=[],n=0,a="",s="",i="",o="";while(e.l<e.length){var c=e[e.l++];switch(c){case 0:r.push(e.read_shift(8,"f"));break;case 1:s=v(t[0].c,e.read_shift(2),!0),a=v(t[0].r,e.read_shift(2),!1),r.push(s+a);break;case 2:var l=v(t[0].c,e.read_shift(2),!0),u=v(t[0].r,e.read_shift(2),!1);s=v(t[0].c,e.read_shift(2),!0),a=v(t[0].r,e.read_shift(2),!1),r.push(l+u+":"+s+a);break;case 3:if(e.l<e.length)return void console.error("WK1 premature formula end");break;case 4:r.push("("+r.pop()+")");break;case 5:r.push(e.read_shift(2));break;case 6:var h="";while(c=e[e.l++])h+=String.fromCharCode(c);r.push('"'+h.replace(/"/g,'""')+'"');break;case 8:r.push("-"+r.pop());break;case 23:r.push("+"+r.pop());break;case 22:r.push("NOT("+r.pop()+")");break;case 20:case 21:o=r.pop(),i=r.pop(),r.push(["AND","OR"][c-20]+"("+i+","+o+")");break;default:if(c<32&&S[c])o=r.pop(),i=r.pop(),r.push(i+S[c]+o);else{if(!T[c])return c<=7?console.error("WK1 invalid opcode "+c.toString(16)):c<=24?console.error("WK1 unsupported op "+c.toString(16)):c<=30?console.error("WK1 invalid opcode "+c.toString(16)):c<=115?console.error("WK1 unsupported function opcode "+c.toString(16)):console.error("WK1 unrecognized opcode "+c.toString(16));if(n=T[c][1],69==n&&(n=e[e.l++]),n>r.length)return void console.error("WK1 bad formula parse 0x"+c.toString(16)+":|"+r.join("|")+"|");var f=r.slice(-n);r.length-=n,r.push(T[c][0]+"("+f.join(",")+")")}}}1==r.length?t[1].f=""+r[0]:console.error("WK1 bad formula parse |"+r.join("|")+"|")}function R(e){var t=[{c:0,r:0},{t:"n",v:0},0];return t[0].r=e.read_shift(2),t[3]=e[e.l++],t[0].c=e[e.l++],t}function y(e,t){var r=R(e,t);return r[1].t="s",r[1].v=e.read_shift(t-4,"cstr"),r}function N(e,t,r,n){var a=Sp(6+n.length);a.write_shift(2,e),a.write_shift(1,r),a.write_shift(1,t),a.write_shift(1,39);for(var s=0;s<n.length;++s){var i=n.charCodeAt(s);a.write_shift(1,i>=128?95:i)}return a.write_shift(1,0),a}function w(e,t){var r=R(e,t);r[1].v=e.read_shift(2);var n=r[1].v>>1;if(1&r[1].v)switch(7&n){case 0:n=5e3*(n>>3);break;case 1:n=500*(n>>3);break;case 2:n=(n>>3)/20;break;case 3:n=(n>>3)/200;break;case 4:n=(n>>3)/2e3;break;case 5:n=(n>>3)/2e4;break;case 6:n=(n>>3)/16;break;case 7:n=(n>>3)/64;break}return r[1].v=n,r}function b(e,t){var r=R(e,t),n=e.read_shift(4),a=e.read_shift(4),s=e.read_shift(2);if(65535==s)return 0===n&&3221225472===a?(r[1].t="e",r[1].v=15):0===n&&3489660928===a?(r[1].t="e",r[1].v=42):r[1].v=0,r;var i=32768&s;return s=(32767&s)-16446,r[1].v=(1-2*i)*(a*Math.pow(2,s+32)+n*Math.pow(2,s)),r}function C(e,t,r,n){var a=Sp(14);if(a.write_shift(2,e),a.write_shift(1,r),a.write_shift(1,t),0==n)return a.write_shift(4,0),a.write_shift(4,0),a.write_shift(2,65535),a;var s=0,i=0,o=0,c=0;return n<0&&(s=1,n=-n),i=0|Math.log2(n),n/=Math.pow(2,i-31),c=n>>>0,0==(2147483648&c)&&(n/=2,++i,c=n>>>0),n-=c,c|=2147483648,c>>>=0,n*=Math.pow(2,32),o=n>>>0,a.write_shift(4,o),a.write_shift(4,c),i+=16383+(s?32768:0),a.write_shift(2,i),a}function O(e,t){var r=b(e,14);return e.l+=t-14,r}function I(e,t){var r=R(e,t),n=e.read_shift(4);return r[1].v=n>>6,r}function M(e,t){var r=R(e,t),n=e.read_shift(8,"f");return r[1].v=n,r}function D(e,t){var r=M(e,12);return e.l+=t-12,r}function L(e,t){return 0==e[e.l+t-1]?e.read_shift(t,"cstr"):""}function k(e,t){var r=e[e.l++];r>t-1&&(r=t-1);var n="";while(n.length<r)n+=String.fromCharCode(e[e.l++]);return n}function _(e,t,r){if(r.qpro&&!(t<21)){var n=e.read_shift(1);e.l+=17,e.l+=1,e.l+=2;var a=e.read_shift(t-21,"cstr");return[n,a]}}function U(e,t){var r={},n=e.l+t;while(e.l<n){var a=e.read_shift(2);if(14e3==a){r[a]=[0,""],r[a][0]=e.read_shift(2);while(e[e.l])r[a][1]+=String.fromCharCode(e[e.l]),e.l++;e.l++}}return r}function x(e,t){var r=Sp(5+e.length);r.write_shift(2,14e3),r.write_shift(2,t);for(var n=0;n<e.length;++n){var a=e.charCodeAt(n);r[r.l++]=a>127?95:a}return r[r.l++]=0,r}var F={0:{n:"BOF",f:cE},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:d},14:{n:"NUMBER",f:m},15:{n:"LABEL",f:u},16:{n:"FORMULA",f:E},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:f},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:L},222:{n:"SHEETNAMELP",f:k},255:{n:"BOF",f:cE},65535:{n:""}},P={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:y},23:{n:"NUMBER17",f:b},24:{n:"NUMBER18",f:w},25:{n:"FORMULA19",f:O},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:U},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:I},38:{n:"??"},39:{n:"NUMBER27",f:M},40:{n:"FORMULA28",f:D},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:L},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:_},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};function B(e,t){vp(e,0);var r=t||{};null!=vu&&null==r.dense&&(r.dense=vu);var n={};r.dense&&(n["!data"]=[]);var a=[],s="",i={s:{r:-1,c:-1},e:{r:-1,c:-1}},o=0,c=0,l=0,u=0,h={SheetNames:[],Sheets:{}};e:while(e.l<e.length){var f=e.read_shift(2),d=e.read_shift(2),p=e.slice(e.l,e.l+d);switch(vp(p,0),f){case 1:if(962023505!=p.read_shift(4))throw"Bad QPW9 BOF!";break;case 2:break e;case 1025:break;case 1026:break;case 1031:p.l+=12;while(p.l<p.length)o=p.read_shift(2),c=p.read_shift(1),a.push(p.read_shift(o,"cstr"));break;case 1032:break;case 1537:var m=p.read_shift(2);n={},r.dense&&(n["!data"]=[]),i.s.c=p.read_shift(2),i.e.c=p.read_shift(2),i.s.r=p.read_shift(4),i.e.r=p.read_shift(4),p.l+=4,p.l+2<p.length&&(o=p.read_shift(2),c=p.read_shift(1),s=0==o?"":p.read_shift(o,"cstr")),s||(s=kp(m));break;case 1538:if(i.s.c>255||i.s.r>999999)break;i.e.c<i.s.c&&(i.e.c=i.s.c),i.e.r<i.s.r&&(i.e.r=i.s.r),n["!ref"]=Yp(i),hD(h,n,s);break;case 2561:l=p.read_shift(2),i.e.c<l&&(i.e.c=l),i.s.c>l&&(i.s.c=l),u=p.read_shift(4),i.s.r>u&&(i.s.r=u),u=p.read_shift(4),i.e.r<u&&(i.e.r=u);break;case 3073:u=p.read_shift(4),o=p.read_shift(4),i.s.r>u&&(i.s.r=u),i.e.r<u+o-1&&(i.e.r=u+o-1);var g=kp(l);while(p.l<p.length){var E={t:"z"},v=p.read_shift(1);128&v&&(p.l+=2);var T=64&v?p.read_shift(2)-1:0;switch(31&v){case 1:break;case 2:E={t:"n",v:p.read_shift(2)};break;case 3:E={t:"n",v:p.read_shift(2,"i")};break;case 5:E={t:"n",v:p.read_shift(8,"f")};break;case 7:E={t:"s",v:a[c=p.read_shift(4)-1]};break;case 8:E={t:"n",v:p.read_shift(8,"f")},p.l+=2,p.l+=4;break;default:throw"Unrecognized QPW cell type "+(31&v)}var S=0;if(32&v)switch(31&v){case 2:S=p.read_shift(2);break;case 3:S=p.read_shift(2,"i");break;case 7:S=p.read_shift(2);break;default:throw"Unsupported delta for QPW cell type "+(31&v)}(r.sheetStubs||"z"!=E.t)&&(null!=n["!data"]?(n["!data"][u]||(n["!data"][u]=[]),n["!data"][u][l]=E):n[g+Ip(u)]=E),++u,--o;while(T-- >0&&o>=0){if(32&v)switch(31&v){case 2:E={t:"n",v:E.v+S&65535};break;case 3:E={t:"n",v:E.v+S&65535},E.v>32767&&(E.v-=65536);break;case 7:E={t:"s",v:a[c=c+S>>>0]};break;default:throw"Cannot apply delta for QPW cell type "+(31&v)}else switch(31&v){case 1:E={t:"z"};break;case 2:E={t:"n",v:p.read_shift(2)};break;case 7:E={t:"s",v:a[c=p.read_shift(4)-1]};break;default:throw"Cannot apply repeat for QPW cell type "+(31&v)}(r.sheetStubs||"z"!=E.t)&&(null!=n["!data"]?(n["!data"][u]||(n["!data"][u]=[]),n["!data"][u][l]=E):n[g+Ip(u)]=E),++u,--o}}break;default:break}e.l+=d}return h}return{sheet_to_wk1:n,book_to_wk3:a,to_workbook:t}}();function _T(e){var t={},r=e.match(Kf),n=0,a=!1;if(r)for(;n!=r.length;++n){var s=Qf(r[n]);switch(s[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!s.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if("1"==s.val)break;t.cp=iu[parseInt(s.val,10)];break;case"<outline":if(!s.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=s.val;break;case"<sz":t.sz=s.val;break;case"<strike":if(!s.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!s.val)break;switch(s.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if("0"==s.val)break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if("0"==s.val)break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":s.rgb&&(t.color=s.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=s.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=s.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(47!==s[0].charCodeAt(1)&&!a)throw new Error("Unrecognized rich format "+s[0])}}return t}var UT=function(){var e=Td("t"),t=Td("rPr");function r(r){var n=r.match(e);if(!n)return{t:"s",v:""};var a={t:"s",v:rd(n[1])},s=r.match(t);return s&&(a.s=_T(s[1])),a}var n=/<(?:\w+:)?r>/g,a=/<\/(?:\w+:)?r>/;return function(e){return e.replace(n,"").split(a).map(r).filter((function(e){return e.v}))}}(),xT=function(){var e=/(\r\n|\n)/g;function t(e,t,r){var n=[];e.u&&n.push("text-decoration: underline;"),e.uval&&n.push("text-underline-style:"+e.uval+";"),e.sz&&n.push("font-size:"+e.sz+"pt;"),e.outline&&n.push("text-effect: outline;"),e.shadow&&n.push("text-shadow: auto;"),t.push('<span style="'+n.join("")+'">'),e.b&&(t.push("<b>"),r.push("</b>")),e.i&&(t.push("<i>"),r.push("</i>")),e.strike&&(t.push("<s>"),r.push("</s>"));var a=e.valign||"";return"superscript"==a||"super"==a?a="sup":"subscript"==a&&(a="sub"),""!=a&&(t.push("<"+a+">"),r.push("</"+a+">")),r.push("</span>"),e}function r(r){var n=[[],r.v,[]];return r.v?(r.s&&t(r.s,n[0],n[2]),n[0].join("")+n[1].replace(e,"<br/>")+n[2].join("")):""}return function(e){return e.map(r).join("")}}(),FT=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,PT=/<(?:\w+:)?r\b[^>]*>/,BT=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function YT(e,t){var r=!t||t.cellHTML,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=rd(Ed(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||""),!0),n.r=Ed(e),r&&(n.h=cd(n.t))):e.match(PT)&&(n.r=Ed(e),n.t=rd(Ed((e.replace(BT,"").match(FT)||[]).join("").replace(Kf,"")),!0),r&&(n.h=xT(UT(n.r)))),n):{t:""}}var VT=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,WT=/<(?:\w+:)?(?:si|sstItem)>/g,GT=/<\/(?:\w+:)?(?:si|sstItem)>/;function HT(e,t){var r=[],n="";if(!e)return r;var a=e.match(VT);if(a){n=a[2].replace(WT,"").split(GT);for(var s=0;s!=n.length;++s){var i=YT(n[s].trim(),t);null!=i&&(r[r.length]=i)}a=Qf(a[1]),r.Count=a.count,r.Unique=a.uniqueCount}return r}var zT=/^\s|\s$|[\t\n\r]/;function $T(e,t){if(!t.bookSST)return"";var r=[zf];r[r.length]=Od("sst",null,{xmlns:_d[0],count:e.Count,uniqueCount:e.Unique});for(var n=0;n!=e.length;++n)if(null!=e[n]){var a=e[n],s="<si>";a.r?s+=a.r:(s+="<t",a.t||(a.t=""),"string"!==typeof a.t&&(a.t=String(a.t)),a.t.match(zT)&&(s+=' xml:space="preserve"'),s+=">"+sd(a.t)+"</t>"),s+="</si>",r[r.length]=s}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function jT(e){return[e.read_shift(4),e.read_shift(4)]}function XT(e,t){var r=[],n=!1;return Ap(e,(function(e,a,s){switch(s){case 159:r.Count=e[0],r.Unique=e[1];break;case 19:r.push(e);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(a.T,!n||t.WTF)throw new Error("Unexpected record 0x"+s.toString(16))}})),r}function KT(e,t){return t||(t=Sp(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var qT=rm;function JT(e){var t=Rp();yp(t,159,KT(e));for(var r=0;r<e.length;++r)yp(t,19,qT(e[r]));return yp(t,160),t.end()}function QT(e){if("undefined"!==typeof ql)return ql.utils.encode(au,e);for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function ZT(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function eS(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=ZT(e,4),t.U=ZT(e,4),t.W=ZT(e,4),t}function tS(e){var t=e.read_shift(4),r=e.l+t-4,n={},a=e.read_shift(4),s=[];while(a-- >0)s.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=s,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return n}function rS(e){var t=[];e.l+=4;var r=e.read_shift(4);while(r-- >0)t.push(tS(e));return t}function nS(e){var t=[];e.l+=4;var r=e.read_shift(4);while(r-- >0)t.push(e.read_shift(0,"lpp4"));return t}function aS(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=ZT(e,4),t.U=ZT(e,4),t.W=ZT(e,4),t}function sS(e){var t=aS(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),4!=e.read_shift(4))throw new Error("Bad !Primary record");return t}function iS(e,t){var r=e.l+t,n={};n.Flags=63&e.read_shift(4),e.l+=4,n.AlgID=e.read_shift(4);var a=!1;switch(n.AlgID){case 26126:case 26127:case 26128:a=36==n.Flags;break;case 26625:a=4==n.Flags;break;case 0:a=16==n.Flags||4==n.Flags||36==n.Flags;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!a)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,n}function oS(e,t){var r={},n=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,n),e.l=n,r}function cS(e){var t=ZT(e);switch(t.Minor){case 2:return[t.Minor,lS(e,t)];case 3:return[t.Minor,uS(e,t)];case 4:return[t.Minor,hS(e,t)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function lS(e){var t=e.read_shift(4);if(36!=(63&t))throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),n=iS(e,r),a=oS(e,e.length-e.l);return{t:"Std",h:n,v:a}}function uS(){throw new Error("File is password-protected: ECMA-376 Extensible")}function hS(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),n={};return r.replace(Kf,(function(e){var r=Qf(e);switch(Zf(r[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach((function(e){n[e]=r[e]}));break;case"<dataIntegrity":n.encryptedHmacKey=r.encryptedHmacKey,n.encryptedHmacValue=r.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=r.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(r);break;default:throw r[0]}})),n}function fS(e,t){var r={},n=r.EncryptionVersionInfo=ZT(e,4);if(t-=4,2!=n.Minor)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=e.read_shift(4),t-=4;var a=e.read_shift(4);return t-=4,r.EncryptionHeader=iS(e,a),t-=a,r.EncryptionVerifier=oS(e,t),r}function dS(e){var t={},r=t.EncryptionVersionInfo=ZT(e,4);if(1!=r.Major||1!=r.Minor)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function pS(e){var t,r,n,a,s,i,o=0,c=QT(e),l=c.length+1;for(t=Cu(l),t[0]=c.length,r=1;r!=l;++r)t[r]=c[r-1];for(r=l-1;r>=0;--r)n=t[r],a=0===(16384&o)?0:1,s=o<<1&32767,i=a|s,o=i^n;return 52811^o}var mS=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(e){return 255&(e/2|128*e)},a=function(e,t){return n(e^t)},s=function(e){for(var n=t[e.length-1],a=104,s=e.length-1;s>=0;--s)for(var i=e[s],o=0;7!=o;++o)64&i&&(n^=r[a]),i*=2,--a;return n};return function(t){for(var r,n,i,o=QT(t),c=s(o),l=o.length,u=Cu(16),h=0;16!=h;++h)u[h]=0;1===(1&l)&&(r=c>>8,u[l]=a(e[0],r),--l,r=255&c,n=o[o.length-1],u[l]=a(n,r));while(l>0)--l,r=c>>8,u[l]=a(o[l],r),--l,r=255&c,u[l]=a(o[l],r);l=15,i=15-o.length;while(i>0)r=c>>8,u[l]=a(e[i],r),--l,--i,r=255&c,u[l]=a(o[l],r),--l,--i;return u}}(),gS=function(e,t,r,n,a){var s,i;for(a||(a=t),n||(n=mS(e)),s=0;s!=t.length;++s)i=t[s],i^=n[r],i=255&(i>>5|i<<3),a[s]=i,++r;return[a,r,n]},ES=function(e){var t=0,r=mS(e);return function(e){var n=gS("",e,t,r);return t=n[1],n[0]}};function vS(e,t,r,n){var a={key:cE(e),verificationBytes:cE(e)};return r.password&&(a.verifier=pS(r.password)),n.valid=a.verificationBytes===a.verifier,n.valid&&(n.insitu=ES(r.password)),a}function TS(e,t,r){var n=r||{};return n.Info=e.read_shift(2),e.l-=2,1===n.Info?n.Data=dS(e,t):n.Data=fS(e,t),n}function SS(e,t,r){var n={Type:r.biff>=8?e.read_shift(2):0};return n.Type?TS(e,t-2,n):vS(e,r.biff>=8?t:t-2,r,n),n}function AS(e,t){switch(t.type){case"base64":return RS(yu(e),t);case"binary":return RS(e,t);case"buffer":return RS(Nu&&Buffer.isBuffer(e)?e.toString("binary"):Du(e),t);case"array":return RS(yf(e),t)}throw new Error("Unrecognized type "+t.type)}function RS(e,t){var r=t||{},n={},a=r.dense;a&&(n["!data"]=[]);var s=e.match(/\\trowd[\s\S]*?\\row\b/g);if(!s)throw new Error("RTF missing table");var i={s:{c:0,r:0},e:{c:0,r:s.length-1}},o=[];return s.forEach((function(e,t){a&&(o=n["!data"][t]=[]);var s,c=/\\[\w\-]+\b/g,l=0,u=-1,h=[];while(null!=(s=c.exec(e))){var f=e.slice(l,c.lastIndex-s[0].length);switch(32==f.charCodeAt(0)&&(f=f.slice(1)),f.length&&h.push(f),s[0]){case"\\cell":if(++u,h.length){var d={v:h.join(""),t:"s"};"TRUE"==d.v||"FALSE"==d.v?(d.v="TRUE"==d.v,d.t="b"):isNaN(bf(d.v))||(d.t="n",!1!==r.cellText&&(d.w=d.v),d.v=bf(d.v)),a?o[u]=d:n[Pp({r:t,c:u})]=d}h=[];break;case"\\par":h.push("\n");break}l=c.lastIndex}u>i.e.c&&(i.e.c=u)})),n["!ref"]=Yp(i),n}function yS(e,t){var r=$p(AS(e,t),t);return r.bookType="rtf",r}function NS(e,t){var r=["{\\rtf1\\ansi"];if(!e["!ref"])return r[0]+"}";for(var n,a=Gp(e["!ref"]),s=null!=e["!data"],i=[],o=a.s.r;o<=a.e.r;++o){r.push("\\trowd\\trautofit1");for(var c=a.s.c;c<=a.e.c;++c)r.push("\\cellx"+(c+1));for(r.push("\\pard\\intbl"),s&&(i=e["!data"][o]||[]),c=a.s.c;c<=a.e.c;++c){var l=Pp({r:o,c:c});n=s?i[c]:e[l],n&&(null!=n.v||n.f&&!n.F)?(r.push(" "+(n.w||(zp(n),n.w)||"").replace(/[\r\n]/g,"\\par ")),r.push("\\cell")):r.push(" \\cell")}r.push("\\pard\\intbl\\row")}return r.join("")+"}"}function wS(e){var t=e.slice("#"===e[0]?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function bS(e){for(var t=0,r=1;3!=t;++t)r=256*r+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function CS(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255,a=Math.max(t,r,n),s=Math.min(t,r,n),i=a-s;if(0===i)return[0,0,t];var o=0,c=0,l=a+s;switch(c=i/(l>1?2-l:l),a){case t:o=((r-n)/i+6)%6;break;case r:o=(n-t)/i+2;break;case n:o=(t-r)/i+4;break}return[o/6,c,l/2]}function OS(e){var t,r=e[0],n=e[1],a=e[2],s=2*n*(a<.5?a:1-a),i=a-s/2,o=[i,i,i],c=6*r;if(0!==n)switch(0|c){case 0:case 6:t=s*c,o[0]+=s,o[1]+=t;break;case 1:t=s*(2-c),o[0]+=t,o[1]+=s;break;case 2:t=s*(c-2),o[1]+=s,o[2]+=t;break;case 3:t=s*(4-c),o[1]+=t,o[2]+=s;break;case 4:t=s*(c-4),o[2]+=s,o[0]+=t;break;case 5:t=s*(6-c),o[2]+=t,o[0]+=s;break}for(var l=0;3!=l;++l)o[l]=Math.round(255*o[l]);return o}function IS(e,t){if(0===t)return e;var r=CS(wS(e));return r[2]=t<0?r[2]*(1+t):1-(1-r[2])*(1-t),bS(OS(r))}var MS=6,DS=15,LS=1,kS=MS;function _S(e){return Math.floor((e+Math.round(128/kS)/256)*kS)}function US(e){return Math.floor((e-5)/kS*100+.5)/100}function xS(e){return Math.round((e*kS+5)/kS*256)/256}function FS(e){return xS(US(_S(e)))}function PS(e){var t=Math.abs(e-FS(e)),r=kS;if(t>.005)for(kS=LS;kS<DS;++kS)Math.abs(e-FS(e))<=t&&(t=Math.abs(e-FS(e)),r=kS);kS=r}function BS(e){e.width?(e.wpx=_S(e.width),e.wch=US(e.wpx),e.MDW=kS):e.wpx?(e.wch=US(e.wpx),e.width=xS(e.wch),e.MDW=kS):"number"==typeof e.wch&&(e.width=xS(e.wch),e.wpx=_S(e.width),e.MDW=kS),e.customWidth&&delete e.customWidth}var YS=96,VS=YS;function WS(e){return 96*e/VS}function GS(e){return e*VS/96}var HS={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function zS(e,t,r,n){t.Borders=[];var a={},s=!1;(e[0].match(Kf)||[]).forEach((function(e){var r=Qf(e);switch(Zf(r[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":a={},r.diagonalUp&&(a.diagonalUp=fd(r.diagonalUp)),r.diagonalDown&&(a.diagonalDown=fd(r.diagonalDown)),t.Borders.push(a);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+r[0]+" in borders")}}))}function $S(e,t,r,n){t.Fills=[];var a={},s=!1;(e[0].match(Kf)||[]).forEach((function(e){var r=Qf(e);switch(Zf(r[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":a={},t.Fills.push(a);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(a),a={};break;case"<patternFill":case"<patternFill>":r.patternType&&(a.patternType=r.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":a.bgColor||(a.bgColor={}),r.indexed&&(a.bgColor.indexed=parseInt(r.indexed,10)),r.theme&&(a.bgColor.theme=parseInt(r.theme,10)),r.tint&&(a.bgColor.tint=parseFloat(r.tint)),r.rgb&&(a.bgColor.rgb=r.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":a.fgColor||(a.fgColor={}),r.theme&&(a.fgColor.theme=parseInt(r.theme,10)),r.tint&&(a.fgColor.tint=parseFloat(r.tint)),null!=r.rgb&&(a.fgColor.rgb=r.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+r[0]+" in fills")}}))}function jS(e,t,r,n){t.Fonts=[];var a={},s=!1;(e[0].match(Kf)||[]).forEach((function(e){var i=Qf(e);switch(Zf(i[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(a),a={};break;case"<name":i.val&&(a.name=Ed(i.val));break;case"<name/>":case"</name>":break;case"<b":a.bold=i.val?fd(i.val):1;break;case"<b/>":a.bold=1;break;case"<i":a.italic=i.val?fd(i.val):1;break;case"<i/>":a.italic=1;break;case"<u":switch(i.val){case"none":a.underline=0;break;case"single":a.underline=1;break;case"double":a.underline=2;break;case"singleAccounting":a.underline=33;break;case"doubleAccounting":a.underline=34;break}break;case"<u/>":a.underline=1;break;case"<strike":a.strike=i.val?fd(i.val):1;break;case"<strike/>":a.strike=1;break;case"<outline":a.outline=i.val?fd(i.val):1;break;case"<outline/>":a.outline=1;break;case"<shadow":a.shadow=i.val?fd(i.val):1;break;case"<shadow/>":a.shadow=1;break;case"<condense":a.condense=i.val?fd(i.val):1;break;case"<condense/>":a.condense=1;break;case"<extend":a.extend=i.val?fd(i.val):1;break;case"<extend/>":a.extend=1;break;case"<sz":i.val&&(a.sz=+i.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":i.val&&(a.vertAlign=i.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":i.val&&(a.family=parseInt(i.val,10));break;case"<family/>":case"</family>":break;case"<scheme":i.val&&(a.scheme=i.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if("1"==i.val)break;i.codepage=iu[parseInt(i.val,10)];break;case"<color":if(a.color||(a.color={}),i.auto&&(a.color.auto=fd(i.auto)),i.rgb)a.color.rgb=i.rgb.slice(-6);else if(i.indexed){a.color.index=parseInt(i.indexed,10);var o=qm[a.color.index];81==a.color.index&&(o=qm[1]),o||(o=qm[1]),a.color.rgb=o[0].toString(16)+o[1].toString(16)+o[2].toString(16)}else i.theme&&(a.color.theme=parseInt(i.theme,10),i.tint&&(a.color.tint=parseFloat(i.tint)),i.theme&&r.themeElements&&r.themeElements.clrScheme&&(a.color.rgb=IS(r.themeElements.clrScheme[a.color.theme].rgb,a.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+i[0]+" in fonts")}}))}function XS(e,t,r){t.NumberFmt=[];for(var n=of(qu),a=0;a<n.length;++a)t.NumberFmt[n[a]]=qu[n[a]];var s=e[0].match(Kf);if(s)for(a=0;a<s.length;++a){var i=Qf(s[a]);switch(Zf(i[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":var o=rd(Ed(i.formatCode)),c=parseInt(i.numFmtId,10);if(t.NumberFmt[c]=o,c>0){if(c>392){for(c=392;c>60;--c)if(null==t.NumberFmt[c])break;t.NumberFmt[c]=o}Qh(o,c)}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+i[0]+" in numFmts")}}}function KS(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach((function(r){for(var n=r[0];n<=r[1];++n)null!=e[n]&&(t[t.length]=Od("numFmt",null,{numFmtId:n,formatCode:sd(e[n])}))})),1===t.length?"":(t[t.length]="</numFmts>",t[0]=Od("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var qS=["numFmtId","fillId","fontId","borderId","xfId"],JS=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function QS(e,t,r){var n;t.CellXf=[];var a=!1;(e[0].match(Kf)||[]).forEach((function(e){var s=Qf(e),i=0;switch(Zf(s[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=s,delete n[0],i=0;i<qS.length;++i)n[qS[i]]&&(n[qS[i]]=parseInt(n[qS[i]],10));for(i=0;i<JS.length;++i)n[JS[i]]&&(n[JS[i]]=fd(n[JS[i]]));if(t.NumberFmt&&n.numFmtId>392)for(i=392;i>60;--i)if(t.NumberFmt[n.numFmtId]==t.NumberFmt[i]){n.numFmtId=i;break}t.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var o={};s.vertical&&(o.vertical=s.vertical),s.horizontal&&(o.horizontal=s.horizontal),null!=s.textRotation&&(o.textRotation=s.textRotation),s.indent&&(o.indent=s.indent),s.wrapText&&(o.wrapText=fd(s.wrapText)),n.alignment=o;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(r&&r.WTF&&!a)throw new Error("unrecognized "+s[0]+" in cellXfs")}}))}function ZS(e){var t=[];return t[t.length]=Od("cellXfs",null),e.forEach((function(e){t[t.length]=Od("xf",null,e)})),t[t.length]="</cellXfs>",2===t.length?"":(t[0]=Od("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var eA=function(){var e=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,t=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,r=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,n=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,a=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(s,i,o){var c,l={};return s?(s=s.replace(/<!--([\s\S]*?)-->/gm,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,""),(c=s.match(e))&&XS(c,l,o),(c=s.match(n))&&jS(c,l,i,o),(c=s.match(r))&&$S(c,l,i,o),(c=s.match(a))&&zS(c,l,i,o),(c=s.match(t))&&QS(c,l,o),l):l}}();function tA(e,t){var r,n=[zf,Od("styleSheet",null,{xmlns:_d[0],"xmlns:vt":kd.vt})];return e.SSF&&null!=(r=KS(e.SSF))&&(n[n.length]=r),n[n.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',n[n.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',n[n.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',n[n.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(r=ZS(t.cellXfs))&&(n[n.length]=r),n[n.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',n[n.length]='<dxfs count="0"/>',n[n.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',n.length>2&&(n[n.length]="</styleSheet>",n[1]=n[1].replace("/>",">")),n.join("")}function rA(e,t){var r=e.read_shift(2),n=Jp(e,t-2);return[r,n]}function nA(e,t,r){r||(r=Sp(6+4*t.length)),r.write_shift(2,e),Qp(t,r);var n=r.length>r.l?r.slice(0,r.l):r;return null==r.l&&(r.l=r.length),n}function aA(e,t,r){var n={};n.sz=e.read_shift(2)/20;var a=bm(e,2,r);a.fItalic&&(n.italic=1),a.fCondense&&(n.condense=1),a.fExtend&&(n.extend=1),a.fShadow&&(n.shadow=1),a.fOutline&&(n.outline=1),a.fStrikeout&&(n.strike=1);var s=e.read_shift(2);switch(700===s&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var i=e.read_shift(1);0!=i&&(n.underline=i);var o=e.read_shift(1);o>0&&(n.family=o);var c=e.read_shift(1);switch(c>0&&(n.charset=c),e.l++,n.color=Nm(e,8),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=Jp(e,t-21),n}function sA(e,t){t||(t=Sp(153)),t.write_shift(2,20*e.sz),Cm(e,t),t.write_shift(2,e.bold?700:400);var r=0;"superscript"==e.vertAlign?r=1:"subscript"==e.vertAlign&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),wm(e.color,t);var n=0;return"major"==e.scheme&&(n=1),"minor"==e.scheme&&(n=2),t.write_shift(1,n),Qp(e.name,t),t.length>t.l?t.slice(0,t.l):t}var iA,oA=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],cA=Tp;function lA(e,t){t||(t=Sp(84)),iA||(iA=lf(oA));var r=iA[e.patternType];null==r&&(r=40),t.write_shift(4,r);var n=0;if(40!=r)for(wm({auto:1},t),wm({auto:1},t);n<12;++n)t.write_shift(4,0);else{for(;n<4;++n)t.write_shift(4,0);for(;n<12;++n)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function uA(e,t){var r=e.l+t,n=e.read_shift(2),a=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:a}}function hA(e,t,r){r||(r=Sp(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function fA(e,t){return t||(t=Sp(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var dA=Tp;function pA(e,t){return t||(t=Sp(51)),t.write_shift(1,0),fA(null,t),fA(null,t),fA(null,t),fA(null,t),fA(null,t),t.length>t.l?t.slice(0,t.l):t}function mA(e,t){return t||(t=Sp(52)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,+e.builtinId),t.write_shift(1,0),fm(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function gA(e,t,r){var n=Sp(2052);return n.write_shift(4,e),fm(t,n),fm(r,n),n.length>n.l?n.slice(0,n.l):n}function EA(e,t,r){var n={NumberFmt:[]};for(var a in qu)n.NumberFmt[a]=qu[a];n.CellXf=[],n.Fonts=[];var s=[],i=!1;return Ap(e,(function(e,a,o){switch(o){case 44:n.NumberFmt[e[0]]=e[1],Qh(e[1],e[0]);break;case 43:n.Fonts.push(e),null!=e.color.theme&&t&&t.themeElements&&t.themeElements.clrScheme&&(e.color.rgb=IS(t.themeElements.clrScheme[e.color.theme].rgb,e.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:617==s[s.length-1]&&n.CellXf.push(e);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:s.push(o),i=!0;break;case 38:s.pop(),i=!1;break;default:if(a.T>0)s.push(o);else if(a.T<0)s.pop();else if(!i||r.WTF&&37!=s[s.length-1])throw new Error("Unexpected record 0x"+o.toString(16))}})),n}function vA(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach((function(e){for(var n=e[0];n<=e[1];++n)null!=t[n]&&++r})),0!=r&&(yp(e,615,qp(r)),[[5,8],[23,26],[41,44],[50,392]].forEach((function(r){for(var n=r[0];n<=r[1];++n)null!=t[n]&&yp(e,44,nA(n,t[n]))})),yp(e,616))}}function TA(e){var t=1;0!=t&&(yp(e,611,qp(t)),yp(e,43,sA({sz:12,color:{theme:1},name:"Calibri",family:2,scheme:"minor"})),yp(e,612))}function SA(e){var t=2;0!=t&&(yp(e,603,qp(t)),yp(e,45,lA({patternType:"none"})),yp(e,45,lA({patternType:"gray125"})),yp(e,604))}function AA(e){var t=1;0!=t&&(yp(e,613,qp(t)),yp(e,46,pA({})),yp(e,614))}function RA(e){var t=1;yp(e,626,qp(t)),yp(e,47,hA({numFmtId:0,fontId:0,fillId:0,borderId:0},65535)),yp(e,627)}function yA(e,t){yp(e,617,qp(t.length)),t.forEach((function(t){yp(e,47,hA(t,0))})),yp(e,618)}function NA(e){var t=1;yp(e,619,qp(t)),yp(e,48,mA({xfId:0,builtinId:0,name:"Normal"})),yp(e,620)}function wA(e){var t=0;yp(e,505,qp(t)),yp(e,506)}function bA(e){var t=0;yp(e,508,gA(t,"TableStyleMedium9","PivotStyleMedium4")),yp(e,509)}function CA(){}function OA(e,t){var r=Rp();return yp(r,278),vA(r,e.SSF),TA(r,e),SA(r,e),AA(r,e),RA(r,e),yA(r,t.cellXfs),NA(r,e),wA(r,e),bA(r,e),CA(r,e),yp(r,279),r.end()}var IA=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function MA(e,t,r){t.themeElements.clrScheme=[];var n={};(e[0].match(Kf)||[]).forEach((function(e){var a=Qf(e);switch(a[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=a.val;break;case"<a:sysClr":n.rgb=a.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":"/"===a[0].charAt(1)?(t.themeElements.clrScheme[IA.indexOf(a[0])]=n,n={}):n.name=a[0].slice(3,a[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+a[0]+" in clrScheme")}}))}function DA(){}function LA(){}var kA=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,_A=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,UA=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function xA(e,t,r){var n;t.themeElements={},[["clrScheme",kA,MA],["fontScheme",_A,DA],["fmtScheme",UA,LA]].forEach((function(a){if(!(n=e.match(a[1])))throw new Error(a[0]+" not found in themeElements");a[2](n,t,r)}))}var FA=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function PA(e,t){var r;e&&0!==e.length||(e=BA());var n={};if(!(r=e.match(FA)))throw new Error("themeElements not found in theme");return xA(r[0],n,t),n.raw=e,n}function BA(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&"string"==typeof e.raw)return e.raw;var r=[zf];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',r[r.length]='<a:font script="Hang" typeface="맑은 고딕"/>',r[r.length]='<a:font script="Hans" typeface="宋体"/>',r[r.length]='<a:font script="Hant" typeface="新細明體"/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',r[r.length]='<a:font script="Hang" typeface="맑은 고딕"/>',r[r.length]='<a:font script="Hans" typeface="宋体"/>',r[r.length]='<a:font script="Hant" typeface="新細明體"/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function YA(e,t,r){var n=e.l+t,a=e.read_shift(4);if(124226!==a)if(r.cellStyles){var s,i=e.slice(e.l);e.l=n;try{s=Gf(i,{type:"array"})}catch(c){return}var o=Pf(s,"theme/theme/theme1.xml",!0);if(o)return PA(o,r)}else e.l=n}function VA(e){return e.read_shift(4)}function WA(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=GA(e,4);break;case 2:t.xclrValue=OE(e,4);break;case 3:t.xclrValue=VA(e,4);break;case 4:e.l+=4;break}return e.l+=8,t}function GA(e,t){return Tp(e,t)}function HA(e,t){return Tp(e,t)}function zA(e){var t=e.read_shift(2),r=e.read_shift(2)-4,n=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=WA(e,r);break;case 6:n[1]=HA(e,r);break;case 14:case 15:n[1]=e.read_shift(1===r?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return n}function $A(e,t){var r=e.l+t;e.l+=2;var n=e.read_shift(2);e.l+=2;var a=e.read_shift(2),s=[];while(a-- >0)s.push(zA(e,r-e.l));return{ixfe:n,ext:s}}function jA(e,t){t.forEach((function(e){switch(e[0]){case 4:break;case 5:break;case 6:break;case 7:break;case 8:break;case 9:break;case 10:break;case 11:break;case 13:break;case 14:break;case 15:break}}))}function XA(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:Jp(e,t-8)}}function KA(e){var t=Sp(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),Qp(e.name,t),t.slice(0,t.l)}function qA(e){var t=[],r=e.read_shift(4);while(r-- >0)t.push([e.read_shift(4),e.read_shift(4)]);return t}function JA(e){var t=Sp(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function QA(e,t){var r=Sp(8+2*t.length);return r.write_shift(4,e),Qp(t,r),r.slice(0,r.l)}function ZA(e){return e.l+=4,0!=e.read_shift(4)}function eR(e,t){var r=Sp(8);return r.write_shift(4,e),r.write_shift(4,t?1:0),r}function tR(e,t,r){var n={Types:[],Cell:[],Value:[]},a=r||{},s=[],i=!1,o=2;return Ap(e,(function(e,t,r){switch(r){case 335:n.Types.push({name:e.name});break;case 51:e.forEach((function(e){1==o?n.Cell.push({type:n.Types[e[0]-1].name,index:e[1]}):0==o&&n.Value.push({type:n.Types[e[0]-1].name,index:e[1]})}));break;case 337:o=e?1:0;break;case 338:o=2;break;case 35:s.push(r),i=!0;break;case 36:s.pop(),i=!1;break;default:if(t.T);else if(!i||a.WTF&&35!=s[s.length-1])throw new Error("Unexpected record 0x"+r.toString(16))}})),n}function rR(){var e=Rp();return yp(e,332),yp(e,334,qp(1)),yp(e,335,KA({name:"XLDAPR",version:12e4,flags:3496657072})),yp(e,336),yp(e,339,QA(1,"XLDAPR")),yp(e,52),yp(e,35,qp(514)),yp(e,4096,qp(0)),yp(e,4097,lE(1)),yp(e,36),yp(e,53),yp(e,340),yp(e,337,eR(1,!0)),yp(e,51,JA([[1,0]])),yp(e,338),yp(e,333),e.end()}function nR(e,t,r){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var a,s=!1,i=2;return e.replace(Kf,(function(e){var t=Qf(e);switch(Zf(t[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:t.name});break;case"</metadataType>":break;case"<futureMetadata":for(var o=0;o<n.Types.length;++o)n.Types[o].name==t.name&&(a=n.Types[o]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":1==i?n.Cell.push({type:n.Types[t.t-1].name,index:+t.v}):0==i&&n.Value.push({type:n.Types[t.t-1].name,index:+t.v});break;case"</rc>":break;case"<cellMetadata":i=1;break;case"</cellMetadata>":i=2;break;case"<valueMetadata":i=0;break;case"</valueMetadata>":i=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;case"<rvb":if(!a)break;a.offsets||(a.offsets=[]),a.offsets.push(+t.i);break;default:if(!s&&(null==r?void 0:r.WTF))throw new Error("unrecognized "+t[0]+" in metadata")}return e})),n}function aR(){var e=[zf];return e.push('<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">\n  <metadataTypes count="1">\n    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>\n  </metadataTypes>\n  <futureMetadata name="XLDAPR" count="1">\n    <bk>\n      <extLst>\n        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">\n          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>\n        </ext>\n      </extLst>\n    </bk>\n  </futureMetadata>\n  <cellMetadata count="1">\n    <bk>\n      <rc t="1" v="0"/>\n    </bk>\n  </cellMetadata>\n</metadata>'),e.join("")}function sR(e){var t=[];if(!e)return t;var r=1;return(e.match(Kf)||[]).forEach((function(e){var n=Qf(e);switch(n[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete n[0],n.i?r=n.i:n.i=r,t.push(n);break}})),t}function iR(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=Pp(r);var n=e.read_shift(1);return 2&n&&(t.l="1"),8&n&&(t.a="1"),t}function oR(e,t,r){var n=[],a=!1;return Ap(e,(function(e,t,s){switch(s){case 63:n.push(e);break;default:if(t.T);else if(!a||r.WTF)throw new Error("Unexpected record 0x"+s.toString(16))}})),n}function cR(){}function lR(e,t,r,n){if(!e)return e;var a=n||{},s=!1,i=!1;Ap(e,(function(e,t,r){if(!i)switch(r){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:s=!0;break;case 36:s=!1;break;default:if(t.T);else if(!s||a.WTF)throw new Error("Unexpected record 0x"+r.toString(16))}}),a)}function uR(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}function hR(e,t){var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),a=[Od("xml",null,{"xmlns:v":Ud.v,"xmlns:o":Ud.o,"xmlns:x":Ud.x,"xmlns:mv":Ud.mv}).replace(/\/>/,">"),Od("o:shapelayout",Od("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"})],s=65536*e,i=t||[];return i.length>0&&a.push(Od("v:shapetype",[Od("v:stroke",null,{joinstyle:"miter"}),Od("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202",coordsize:r.join(","),"o:spt":202,path:n})),i.forEach((function(e){++s,a.push(fR(e,s))})),a.push("</xml>"),a.join("")}function fR(e,t){var r=Fp(e[0]),n={color2:"#BEFF82",type:"gradient"};"gradient"==n.type&&(n.angle="-180");var a="gradient"==n.type?Od("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,s=Od("v:fill",a,n),i={on:"t",obscured:"t"};return["<v:shape"+Cd({id:"_x0000_s"+t,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(e[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",s,Od("v:shadow",null,i),Od("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",bd("x:Anchor",[r.c+1,0,r.r+1,0,r.c+3,20,r.r+5,20].join(",")),bd("x:AutoFill","False"),bd("x:Row",String(r.r)),bd("x:Column",String(r.c)),e[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"].join("")}function dR(e,t,r,n){var a,s=null!=e["!data"];t.forEach((function(t){var i=Fp(t.ref);if(s?(e["!data"][i.r]||(e["!data"][i.r]=[]),a=e["!data"][i.r][i.c]):a=e[t.ref],!a){a={t:"z"},s?e["!data"][i.r][i.c]=a:e[t.ref]=a;var o=Gp(e["!ref"]||"BDWGO1000001:A1");o.s.r>i.r&&(o.s.r=i.r),o.e.r<i.r&&(o.e.r=i.r),o.s.c>i.c&&(o.s.c=i.c),o.e.c<i.c&&(o.e.c=i.c);var c=Yp(o);e["!ref"]=c}a.c||(a.c=[]);var l={a:t.author,t:t.t,r:t.r,T:r};t.h&&(l.h=t.h);for(var u=a.c.length-1;u>=0;--u){if(!r&&a.c[u].T)return;r&&!a.c[u].T&&a.c.splice(u,1)}if(r&&n)for(u=0;u<n.length;++u)if(l.a==n[u].id){l.a=n[u].name||l.a;break}a.c.push(l)}))}function pR(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],a=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);a&&a[1]&&a[1].split(/<\/\w*:?author>/).forEach((function(e){if(""!==e&&""!==e.trim()){var t=e.match(/<(?:\w+:)?author[^>]*>(.*)/);t&&r.push(t[1])}}));var s=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return s&&s[1]&&s[1].split(/<\/\w*:?comment>/).forEach((function(e){if(""!==e&&""!==e.trim()){var a=e.match(/<(?:\w+:)?comment[^>]*>/);if(a){var s=Qf(a[0]),i={author:s.authorId&&r[s.authorId]||"sheetjsghost",ref:s.ref,guid:s.guid},o=Fp(s.ref);if(!(t.sheetRows&&t.sheetRows<=o.r)){var c=e.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),l=!!c&&!!c[1]&&YT(c[1])||{r:"",t:"",h:""};i.r=l.r,"<t></t>"==l.r&&(l.t=l.h=""),i.t=(l.t||"").replace(/\r\n/g,"\n").replace(/\r/g,"\n"),t.cellHTML&&(i.h=l.h),n.push(i)}}}})),n}function mR(e){var t=[zf,Od("comments",null,{xmlns:_d[0]})],r=[];return t.push("<authors>"),e.forEach((function(e){e[1].forEach((function(e){var n=sd(e.a);-1==r.indexOf(n)&&(r.push(n),t.push("<author>"+n+"</author>")),e.T&&e.ID&&-1==r.indexOf("tc="+e.ID)&&(r.push("tc="+e.ID),t.push("<author>tc="+e.ID+"</author>"))}))})),0==r.length&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach((function(e){var n=0,a=[],s=0;if(e[1][0]&&e[1][0].T&&e[1][0].ID&&(n=r.indexOf("tc="+e[1][0].ID)),e[1].forEach((function(e){e.a&&(n=r.indexOf(sd(e.a))),e.T&&++s,a.push(null==e.t?"":sd(e.t))})),0===s)e[1].forEach((function(n){t.push('<comment ref="'+e[0]+'" authorId="'+r.indexOf(sd(n.a))+'"><text>'),t.push(bd("t",null==n.t?"":sd(n.t))),t.push("</text></comment>")}));else{t.push('<comment ref="'+e[0]+'" authorId="'+n+'"><text>');for(var i="Comment:\n    "+a[0]+"\n",o=1;o<a.length;++o)i+="Reply:\n    "+a[o]+"\n";t.push(bd("t",sd(i))),t.push("</text></comment>")}})),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function gR(e,t){var r=[],n=!1,a={},s=0;return e.replace(Kf,(function(i,o){var c=Qf(i);switch(Zf(c[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":a={author:c.personId,guid:c.id,ref:c.ref,T:1};break;case"</threadedComment>":null!=a.t&&r.push(a);break;case"<text>":case"<text":s=o+i.length;break;case"</text>":a.t=e.slice(s,o).replace(/\r\n/g,"\n").replace(/\r/g,"\n");break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+c[0]+" in threaded comments")}return i})),r}function ER(e,t,r){var n=[zf,Od("ThreadedComments",null,{xmlns:kd.TCMNT}).replace(/[\/]>/,">")];return e.forEach((function(e){var a="";(e[1]||[]).forEach((function(s,i){if(s.T){s.a&&-1==t.indexOf(s.a)&&t.push(s.a);var o={ref:e[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};0==i?a=o.id:o.parentId=a,s.ID=o.id,s.a&&(o.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(s.a)).slice(-12)+"}"),n.push(Od("threadedComment",bd("text",s.t||""),o))}else delete s.ID}))})),n.push("</ThreadedComments>"),n.join("")}function vR(e,t){var r=[],n=!1;return e.replace(Kf,(function(e){var a=Qf(e);switch(Zf(a[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:a.displayname,id:a.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+a[0]+" in threaded comments")}return e})),r}function TR(e){var t=[zf,Od("personList",null,{xmlns:kd.TCMNT,"xmlns:x":_d[0]}).replace(/[\/]>/,">")];return e.forEach((function(e,r){t.push(Od("person",null,{displayName:e,id:"{54EE7950-7262-4200-6969-"+("000000000000"+r).slice(-12)+"}",userId:e,providerId:"None"}))})),t.push("</personList>"),t.join("")}function SR(e){var t={};t.iauthor=e.read_shift(4);var r=Sm(e,16);return t.rfx=r.s,t.ref=Pp(r.s),e.l+=16,t}function AR(e,t){return null==t&&(t=Sp(36)),t.write_shift(4,e[1].iauthor),Am(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var RR=Jp;function yR(e){return Qp(e.slice(0,54))}function NR(e,t){var r=[],n=[],a={},s=!1;return Ap(e,(function(e,i,o){switch(o){case 632:n.push(e);break;case 635:a=e;break;case 637:a.t=e.t,a.h=e.h,a.r=e.r;break;case 636:if(a.author=n[a.iauthor],delete a.iauthor,t.sheetRows&&a.rfx&&t.sheetRows<=a.rfx.r)break;a.t||(a.t=""),delete a.rfx,r.push(a);break;case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(i.T);else if(!s||t.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}})),r}function wR(e){var t=Rp(),r=[];return yp(t,628),yp(t,630),e.forEach((function(e){e[1].forEach((function(e){r.indexOf(e.a)>-1||(r.push(e.a.slice(0,54)),yp(t,632,yR(e.a)))}))})),yp(t,631),yp(t,633),e.forEach((function(e){e[1].forEach((function(n){n.iauthor=r.indexOf(n.a);var a={s:Fp(e[0]),e:Fp(e[0])};yp(t,635,AR([a,n])),n.t&&n.t.length>0&&yp(t,637,am(n)),yp(t,636),delete n.iauthor}))})),yp(t,634),yp(t,629),t.end()}var bR="application/vnd.ms-office.vbaProject";function CR(e){var t=tf.utils.cfb_new({root:"R"});return e.FullPaths.forEach((function(r,n){if("/"!==r.slice(-1)&&r.match(/_VBA_PROJECT_CUR/)){var a=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");tf.utils.cfb_add(t,a,e.FileIndex[n].content)}})),tf.write(t)}function OR(e,t){t.FullPaths.forEach((function(r,n){if(0!=n){var a=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");"/"!==a.slice(-1)&&tf.utils.cfb_add(e,a,t.FileIndex[n].content)}}))}var IR=["xlsb","xlsm","xlam","biff8","xla"];function MR(){return{"!type":"dialog"}}function DR(){return{"!type":"dialog"}}function LR(){return{"!type":"macro"}}function kR(){return{"!type":"macro"}}var _R=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(e,r,n,a){var s=!1,i=!1;0==n.length?i=!0:"["==n.charAt(0)&&(i=!0,n=n.slice(1,-1)),0==a.length?s=!0:"["==a.charAt(0)&&(s=!0,a=a.slice(1,-1));var o=n.length>0?0|parseInt(n,10):0,c=a.length>0?0|parseInt(a,10):0;return s?c+=t.c:--c,i?o+=t.r:--o,r+(s?"":"$")+kp(c)+(i?"":"$")+Ip(o)}return function(n,a){return t=a,n.replace(e,r)}}(),UR=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,xR=function(){return function(e,t){return e.replace(UR,(function(e,r,n,a,s,i){var o=Lp(a)-(n?0:t.c),c=Op(i)-(s?0:t.r),l="$"==s?c+1:0==c?"":"["+c+"]",u="$"==n?o+1:0==o?"":"["+o+"]";return r+"R"+l+"C"+u}))}}();function FR(e,t){return e.replace(UR,(function(e,r,n,a,s,i){return r+("$"==n?n+a:kp(Lp(a)+t.c))+("$"==s?s+i:Ip(Op(i)+t.r))}))}function PR(e,t,r){var n=Bp(t),a=n.s,s=Fp(r),i={r:s.r-a.r,c:s.c-a.c};return FR(e,i)}function BR(e){return 1!=e.length}function YR(e){return e.replace(/_xlfn\./g,"")}function VR(e){e.l+=1}function WR(e,t){var r=e.read_shift(1==t?1:2);return[16383&r,r>>14&1,r>>15&1]}function GR(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return HR(e,t,r);12==r.biff&&(n=4)}var a=e.read_shift(n),s=e.read_shift(n),i=WR(e,2),o=WR(e,2);return{s:{r:a,c:i[0],cRel:i[1],rRel:i[2]},e:{r:s,c:o[0],cRel:o[1],rRel:o[2]}}}function HR(e){var t=WR(e,2),r=WR(e,2),n=e.read_shift(1),a=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:a,cRel:r[1],rRel:r[2]}}}function zR(e,t,r){if(r.biff<8)return HR(e,t,r);var n=e.read_shift(12==r.biff?4:2),a=e.read_shift(12==r.biff?4:2),s=WR(e,2),i=WR(e,2);return{s:{r:n,c:s[0],cRel:s[1],rRel:s[2]},e:{r:a,c:i[0],cRel:i[1],rRel:i[2]}}}function $R(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return jR(e,t,r);var n=e.read_shift(r&&12==r.biff?4:2),a=WR(e,2);return{r:n,c:a[0],cRel:a[1],rRel:a[2]}}function jR(e){var t=WR(e,2),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function XR(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:255&r,fQuoted:!!(16384&r),cRel:r>>15,rRel:r>>15}}function KR(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return qR(e,t,r);var a=e.read_shift(n>=12?4:2),s=e.read_shift(2),i=(16384&s)>>14,o=(32768&s)>>15;if(s&=16383,1==o)while(a>524287)a-=1048576;if(1==i)while(s>8191)s-=16384;return{r:a,c:s,cRel:i,rRel:o}}function qR(e){var t=e.read_shift(2),r=e.read_shift(1),n=(32768&t)>>15,a=(16384&t)>>14;return t&=16383,1==n&&t>=8192&&(t-=16384),1==a&&r>=128&&(r-=256),{r:t,c:r,cRel:a,rRel:n}}function JR(e,t,r){var n=(96&e[e.l++])>>5,a=GR(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,a]}function QR(e,t,r){var n=(96&e[e.l++])>>5,a=e.read_shift(2,"i"),s=8;if(r)switch(r.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}var i=GR(e,s,r);return[n,a,i]}function ZR(e,t,r){var n=(96&e[e.l++])>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function ey(e,t,r){var n=(96&e[e.l++])>>5,a=e.read_shift(2),s=8;if(r)switch(r.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}return e.l+=s,[n,a]}function ty(e,t,r){var n=(96&e[e.l++])>>5,a=zR(e,t-1,r);return[n,a]}function ry(e,t,r){var n=(96&e[e.l++])>>5;return e.l+=2==r.biff?6:12==r.biff?14:7,[n]}function ny(e){var t=1&e[e.l+1],r=1;return e.l+=4,[t,r]}function ay(e,t,r){e.l+=2;for(var n=e.read_shift(r&&2==r.biff?1:2),a=[],s=0;s<=n;++s)a.push(e.read_shift(r&&2==r.biff?1:2));return a}function sy(e,t,r){var n=255&e[e.l+1]?1:0;return e.l+=2,[n,e.read_shift(r&&2==r.biff?1:2)]}function iy(e,t,r){var n=255&e[e.l+1]?1:0;return e.l+=2,[n,e.read_shift(r&&2==r.biff?1:2)]}function oy(e){var t=255&e[e.l+1]?1:0;return e.l+=2,[t,e.read_shift(2)]}function cy(e,t,r){var n=255&e[e.l+1]?1:0;return e.l+=r&&2==r.biff?3:4,[n]}function ly(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function uy(e){return e.read_shift(2),ly(e,2)}function hy(e){return e.read_shift(2),ly(e,2)}function fy(e,t,r){var n=(96&e[e.l])>>5;e.l+=1;var a=$R(e,0,r);return[n,a]}function dy(e,t,r){var n=(96&e[e.l])>>5;e.l+=1;var a=KR(e,0,r);return[n,a]}function py(e,t,r){var n=(96&e[e.l])>>5;e.l+=1;var a=e.read_shift(2);r&&5==r.biff&&(e.l+=12);var s=$R(e,0,r);return[n,a,s]}function my(e,t,r){var n=(96&e[e.l])>>5;e.l+=1;var a=e.read_shift(r&&r.biff<=3?1:2);return[GN[a],WN[a],n]}function gy(e,t,r){var n=e[e.l++],a=e.read_shift(1),s=r&&r.biff<=3?[88==n?-1:0,e.read_shift(1)]:Ey(e);return[a,(0===s[0]?WN:VN)[s[1]]]}function Ey(e){return[e[e.l+1]>>7,32767&e.read_shift(2)]}function vy(e,t,r){e.l+=r&&2==r.biff?3:4}function Ty(e,t,r){if(e.l++,r&&12==r.biff)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),a=e.read_shift(r&&2==r.biff?1:2);return[n,a]}function Sy(e){return e.l++,Jm[e.read_shift(1)]}function Ay(e){return e.l++,e.read_shift(2)}function Ry(e){return e.l++,0!==e.read_shift(1)}function yy(e){return e.l++,Rm(e,8)}function Ny(e,t,r){return e.l++,dE(e,t-1,r)}function wy(e,t){var r=[e.read_shift(1)];if(12==t)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=iE(e,1)?"TRUE":"FALSE",12!=t&&(e.l+=7);break;case 37:case 16:r[1]=Jm[e[e.l]],e.l+=12==t?4:8;break;case 0:e.l+=8;break;case 1:r[1]=Rm(e,8);break;case 2:r[1]=vE(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function by(e,t,r){for(var n=e.read_shift(12==r.biff?4:2),a=[],s=0;s!=n;++s)a.push((12==r.biff?Sm:FE)(e,8));return a}function Cy(e,t,r){var n=0,a=0;12==r.biff?(n=e.read_shift(4),a=e.read_shift(4)):(a=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,0==--a&&(a=256));for(var s=0,i=[];s!=n&&(i[s]=[]);++s)for(var o=0;o!=a;++o)i[s][o]=wy(e,r.biff);return i}function Oy(e,t,r){var n=e.read_shift(1)>>>5&3,a=!r||r.biff>=8?4:2,s=e.read_shift(a);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,s]}function Iy(e,t,r){if(5==r.biff)return My(e,t,r);var n=e.read_shift(1)>>>5&3,a=e.read_shift(2),s=e.read_shift(4);return[n,a,s]}function My(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function Dy(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&2==r.biff?3:4;var a=e.read_shift(r&&2==r.biff?1:2);return[n,a]}function Ly(e,t,r){var n=e.read_shift(1)>>>5&3,a=e.read_shift(r&&2==r.biff?1:2);return[n,a]}function ky(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,12==r.biff&&(e.l+=2),[n]}function _y(e,t,r){var n=(96&e[e.l++])>>5,a=e.read_shift(2),s=4;if(r)switch(r.biff){case 5:s=15;break;case 12:s=6;break}return e.l+=s,[n,a]}var Uy=Tp,xy=Tp,Fy=Tp;function Py(e,t,r){return e.l+=2,[XR(e,4,r)]}function By(e){return e.l+=6,[]}var Yy=Py,Vy=By,Wy=By,Gy=Py;function Hy(e){return e.l+=2,[cE(e),1&e.read_shift(2)]}var zy=Py,$y=Hy,jy=By,Xy=Py,Ky=Py,qy=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function Jy(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),a=e.read_shift(2),s=e.read_shift(2),i=qy[r>>2&31];return{ixti:t,coltype:3&r,rt:i,idx:n,c:a,C:s}}function Qy(e){return e.l+=2,[e.read_shift(4)]}function Zy(e,t,r){return e.l+=5,e.l+=2,e.l+=2==r.biff?1:4,["PTGSHEET"]}function eN(e,t,r){return e.l+=2==r.biff?4:5,["PTGENDSHEET"]}function tN(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function rN(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function nN(e){return e.l+=4,[0,0]}var aN={1:{n:"PtgExp",f:Ty},2:{n:"PtgTbl",f:Fy},3:{n:"PtgAdd",f:VR},4:{n:"PtgSub",f:VR},5:{n:"PtgMul",f:VR},6:{n:"PtgDiv",f:VR},7:{n:"PtgPower",f:VR},8:{n:"PtgConcat",f:VR},9:{n:"PtgLt",f:VR},10:{n:"PtgLe",f:VR},11:{n:"PtgEq",f:VR},12:{n:"PtgGe",f:VR},13:{n:"PtgGt",f:VR},14:{n:"PtgNe",f:VR},15:{n:"PtgIsect",f:VR},16:{n:"PtgUnion",f:VR},17:{n:"PtgRange",f:VR},18:{n:"PtgUplus",f:VR},19:{n:"PtgUminus",f:VR},20:{n:"PtgPercent",f:VR},21:{n:"PtgParen",f:VR},22:{n:"PtgMissArg",f:VR},23:{n:"PtgStr",f:Ny},26:{n:"PtgSheet",f:Zy},27:{n:"PtgEndSheet",f:eN},28:{n:"PtgErr",f:Sy},29:{n:"PtgBool",f:Ry},30:{n:"PtgInt",f:Ay},31:{n:"PtgNum",f:yy},32:{n:"PtgArray",f:ry},33:{n:"PtgFunc",f:my},34:{n:"PtgFuncVar",f:gy},35:{n:"PtgName",f:Oy},36:{n:"PtgRef",f:fy},37:{n:"PtgArea",f:JR},38:{n:"PtgMemArea",f:Dy},39:{n:"PtgMemErr",f:Uy},40:{n:"PtgMemNoMem",f:xy},41:{n:"PtgMemFunc",f:Ly},42:{n:"PtgRefErr",f:ky},43:{n:"PtgAreaErr",f:ZR},44:{n:"PtgRefN",f:dy},45:{n:"PtgAreaN",f:ty},46:{n:"PtgMemAreaN",f:tN},47:{n:"PtgMemNoMemN",f:rN},57:{n:"PtgNameX",f:Iy},58:{n:"PtgRef3d",f:py},59:{n:"PtgArea3d",f:QR},60:{n:"PtgRefErr3d",f:_y},61:{n:"PtgAreaErr3d",f:ey},255:{}},sN={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},iN={1:{n:"PtgElfLel",f:Hy},2:{n:"PtgElfRw",f:Xy},3:{n:"PtgElfCol",f:Yy},6:{n:"PtgElfRwV",f:Ky},7:{n:"PtgElfColV",f:Gy},10:{n:"PtgElfRadical",f:zy},11:{n:"PtgElfRadicalS",f:jy},13:{n:"PtgElfColS",f:Vy},15:{n:"PtgElfColSV",f:Wy},16:{n:"PtgElfRadicalLel",f:$y},25:{n:"PtgList",f:Jy},29:{n:"PtgSxName",f:Qy},255:{}},oN={0:{n:"PtgAttrNoop",f:nN},1:{n:"PtgAttrSemi",f:cy},2:{n:"PtgAttrIf",f:iy},4:{n:"PtgAttrChoose",f:ay},8:{n:"PtgAttrGoto",f:sy},16:{n:"PtgAttrSum",f:vy},32:{n:"PtgAttrBaxcel",f:ny},33:{n:"PtgAttrBaxcel",f:ny},64:{n:"PtgAttrSpace",f:uy},65:{n:"PtgAttrSpaceSemi",f:hy},128:{n:"PtgAttrIfError",f:oy},255:{}};function cN(e,t,r,n){if(n.biff<8)return Tp(e,t);for(var a=e.l+t,s=[],i=0;i!==r.length;++i)switch(r[i][0]){case"PtgArray":r[i][1]=Cy(e,0,n),s.push(r[i][1]);break;case"PtgMemArea":r[i][2]=by(e,r[i][1],n),s.push(r[i][2]);break;case"PtgExp":n&&12==n.biff&&(r[i][1][1]=e.read_shift(4),s.push(r[i][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[i][0];default:break}return t=a-e.l,0!==t&&s.push(Tp(e,t)),s}function lN(e,t,r){var n,a,s=e.l+t,i=[];while(s!=e.l)t=s-e.l,a=e[e.l],n=aN[a]||aN[sN[a]],24!==a&&25!==a||(n=(24===a?iN:oN)[e[e.l+1]]),n&&n.f?i.push([n.n,n.f(e,t,r)]):Tp(e,t);return i}function uN(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],a=[],s=0;s<n.length;++s){var i=n[s];if(i)switch(i[0]){case 2:a.push('"'+i[1].replace(/"/g,'""')+'"');break;default:a.push(i[1])}else a.push("")}t.push(a.join(","))}return t.join(";")}var hN={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function fN(e,t){var r=e.lastIndexOf("!"),n=t.lastIndexOf("!");return-1==r&&-1==n?e+":"+t:r>0&&n>0&&e.slice(0,r).toLowerCase()==t.slice(0,n).toLowerCase()?e+":"+t.slice(n+1):(console.error("Cannot hydrate range",e,t),e+":"+t)}function dN(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),0==t?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var a="";if(r.biff>8)switch(e[n[0]][0]){case 357:return a=-1==n[1]?"#REF":e.SheetNames[n[1]],n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 358:return null!=r.SID?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return a=-1==n[1]?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map((function(e){return e.Name})).join(";;");default:return e[n[0]][0][3]?(a=-1==n[1]?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?a:a+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function pN(e,t,r){var n=dN(e,t,r);return"#REF"==n?n:Wp(n,r)}function mN(e,t,r,n,a){var s,i,o,c,l=a&&a.biff||8,u={s:{c:0,r:0},e:{c:0,r:0}},h=[],f=0,d=0,p="";if(!e[0]||!e[0][0])return"";for(var m=-1,g="",E=0,v=e[0].length;E<v;++E){var T=e[0][E];switch(T[0]){case"PtgUminus":h.push("-"+h.pop());break;case"PtgUplus":h.push("+"+h.pop());break;case"PtgPercent":h.push(h.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(s=h.pop(),i=h.pop(),m>=0){switch(e[0][m][1][0]){case 0:g=wf(" ",e[0][m][1][1]);break;case 1:g=wf("\r",e[0][m][1][1]);break;default:if(g="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][m][1][0])}i+=g,m=-1}h.push(i+hN[T[0]]+s);break;case"PtgIsect":s=h.pop(),i=h.pop(),h.push(i+" "+s);break;case"PtgUnion":s=h.pop(),i=h.pop(),h.push(i+","+s);break;case"PtgRange":s=h.pop(),i=h.pop(),h.push(fN(i,s));break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":o=Np(T[1][1],u,a),h.push(bp(o,l));break;case"PtgRefN":o=r?Np(T[1][1],r,a):T[1][1],h.push(bp(o,l));break;case"PtgRef3d":f=T[1][1],o=Np(T[1][2],u,a),p=pN(n,f,a);h.push(p+"!"+bp(o,l));break;case"PtgFunc":case"PtgFuncVar":var S=T[1][0],A=T[1][1];S||(S=0),S&=127;var R=0==S?[]:h.slice(-S);h.length-=S,"User"===A&&(A=R.shift()),h.push(A+"("+R.join(",")+")");break;case"PtgBool":h.push(T[1]?"TRUE":"FALSE");break;case"PtgInt":h.push(T[1]);break;case"PtgNum":h.push(String(T[1]));break;case"PtgStr":h.push('"'+T[1].replace(/"/g,'""')+'"');break;case"PtgErr":h.push(T[1]);break;case"PtgAreaN":c=wp(T[1][1],r?{s:r}:u,a),h.push(Cp(c,a));break;case"PtgArea":c=wp(T[1][1],u,a),h.push(Cp(c,a));break;case"PtgArea3d":f=T[1][1],c=T[1][2],p=pN(n,f,a),h.push(p+"!"+Cp(c,a));break;case"PtgAttrSum":h.push("SUM("+h.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":d=T[1][2];var y=(n.names||[])[d-1]||(n[0]||[])[d],N=y?y.Name:"SH33TJSNAME"+String(d);N&&"_xlfn."==N.slice(0,6)&&!a.xlfn&&(N=N.slice(6)),h.push(N);break;case"PtgNameX":var w,b=T[1][1];if(d=T[1][2],!(a.biff<=5)){var C="";if(14849==((n[b]||[])[0]||[])[0]||(1025==((n[b]||[])[0]||[])[0]?n[b][d]&&n[b][d].itab>0&&(C=n.SheetNames[n[b][d].itab-1]+"!"):C=n.SheetNames[d-1]+"!"),n[b]&&n[b][d])C+=n[b][d].Name;else if(n[0]&&n[0][d])C+=n[0][d].Name;else{var O=(dN(n,b,a)||"").split(";;");O[d-1]?C=O[d-1]:C+="SH33TJSERRX"}h.push(C);break}b<0&&(b=-b),n[b]&&(w=n[b][d]),w||(w={Name:"SH33TJSERRY"}),h.push(w.Name);break;case"PtgParen":var I="(",M=")";if(m>=0){switch(g="",e[0][m][1][0]){case 2:I=wf(" ",e[0][m][1][1])+I;break;case 3:I=wf("\r",e[0][m][1][1])+I;break;case 4:M=wf(" ",e[0][m][1][1])+M;break;case 5:M=wf("\r",e[0][m][1][1])+M;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][m][1][0])}m=-1}h.push(I+h.pop()+M);break;case"PtgRefErr":h.push("#REF!");break;case"PtgRefErr3d":h.push("#REF!");break;case"PtgExp":o={c:T[1][1],r:T[1][0]};var D={c:r.c,r:r.r};if(n.sharedf[Pp(o)]){var L=n.sharedf[Pp(o)];h.push(mN(L,u,D,n,a))}else{var k=!1;for(s=0;s!=n.arrayf.length;++s)if(i=n.arrayf[s],!(o.c<i[0].s.c||o.c>i[0].e.c)&&!(o.r<i[0].s.r||o.r>i[0].e.r)){h.push(mN(i[1],u,D,n,a)),k=!0;break}k||h.push(T[1])}break;case"PtgArray":h.push("{"+uN(T[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":m=E;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":h.push("");break;case"PtgAreaErr":h.push("#REF!");break;case"PtgAreaErr3d":h.push("#REF!");break;case"PtgList":h.push("Table"+T[1].idx+"[#"+T[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(T));default:throw new Error("Unrecognized Formula Token: "+String(T))}var _=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(3!=a.biff&&m>=0&&-1==_.indexOf(e[0][E][0])){T=e[0][m];var U=!0;switch(T[1][0]){case 4:U=!1;case 0:g=wf(" ",T[1][1]);break;case 5:U=!1;case 1:g=wf("\r",T[1][1]);break;default:if(g="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+T[1][0])}h.push((U?g:"")+h.pop()+(U?"":g)),m=-1}}if(h.length>1&&a.WTF)throw new Error("bad formula stack");return"TRUE"==h[0]||"FALSE"!=h[0]&&h[0]}function gN(e,t,r){var n,a=e.l+t,s=2==r.biff?1:2,i=e.read_shift(s);if(65535==i)return[[],Tp(e,t-2)];var o=lN(e,i,r);return t!==i+s&&(n=cN(e,t-i-s,o,r)),e.l=a,[o,n]}function EN(e,t,r){var n,a=e.l+t,s=2==r.biff?1:2,i=e.read_shift(s);if(65535==i)return[[],Tp(e,t-2)];var o=lN(e,i,r);return t!==i+s&&(n=cN(e,t-i-s,o,r)),e.l=a,[o,n]}function vN(e,t,r,n){var a,s=e.l+t,i=lN(e,n,r);return s!==e.l&&(a=cN(e,s-e.l,i,r)),[i,a]}function TN(e,t,r){var n,a=e.l+t,s=e.read_shift(2),i=lN(e,s,r);return 65535==s?[[],Tp(e,t-2)]:(t!==s+2&&(n=cN(e,a-s-2,i,r)),[i,n])}function SN(e){var t;if(65535!==op(e,e.l+6))return[Rm(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=1===e[e.l+2],e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function AN(e){if(null==e){var t=Sp(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}return ym("number"==typeof e?e:0)}function RN(e,t,r){var n=e.l+t,a=ME(e,6);2==r.biff&&++e.l;var s=SN(e,8),i=e.read_shift(1);2!=r.biff&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var o=EN(e,n-e.l,r);return{cell:a,val:s[0],formula:o,shared:i>>3&1,tt:s[1]}}function yN(e,t,r,n,a){var s=DE(t,r,a),i=AN(e.v),o=Sp(6),c=33;o.write_shift(2,c),o.write_shift(4,0);for(var l=Sp(e.bf.length),u=0;u<e.bf.length;++u)l[u]=e.bf[u];var h=_u([s,i,o,l]);return h}function NN(e,t,r){var n=e.read_shift(4),a=lN(e,n,r),s=e.read_shift(4),i=s>0?cN(e,s,a,r):null;return[a,i]}var wN=NN,bN=NN,CN=NN,ON=NN;function IN(e){if((0|e)==e&&e<Math.pow(2,16)&&e>=0){var t=Sp(11);return t.write_shift(4,3),t.write_shift(1,30),t.write_shift(2,e),t.write_shift(4,0),t}var r=Sp(17);return r.write_shift(4,11),r.write_shift(1,31),r.write_shift(8,e),r.write_shift(4,0),r}function MN(e){var t=Sp(10);return t.write_shift(4,2),t.write_shift(1,28),t.write_shift(1,e),t.write_shift(4,0),t}function DN(e){var t=Sp(10);return t.write_shift(4,2),t.write_shift(1,29),t.write_shift(1,e?1:0),t.write_shift(4,0),t}function LN(e){var t=Sp(7);t.write_shift(4,3+2*e.length),t.write_shift(1,23),t.write_shift(2,e.length);var r=Sp(2*e.length);r.write_shift(2*e.length,e,"utf16le");var n=Sp(4);return n.write_shift(4,0),_u([t,r,n])}function kN(e){var t=Fp(e),r=Sp(15);return r.write_shift(4,7),r.write_shift(1,36),r.write_shift(4,t.r),r.write_shift(2,t.c|("$"==e.charAt(0)?0:1)<<14|(e.match(/\$\d/)?0:1)<<15),r.write_shift(4,0),r}function _N(e,t){var r=e.lastIndexOf("!"),n=e.slice(0,r);e=e.slice(r+1);var a=Fp(e);"'"==n.charAt(0)&&(n=n.slice(1,-1).replace(/''/g,"'"));var s=Sp(17);return s.write_shift(4,9),s.write_shift(1,58),s.write_shift(2,2+t.SheetNames.map((function(e){return e.toLowerCase()})).indexOf(n.toLowerCase())),s.write_shift(4,a.r),s.write_shift(2,a.c|("$"==e.charAt(0)?0:1)<<14|(e.match(/\$\d/)?0:1)<<15),s.write_shift(4,0),s}function UN(e,t){var r=e.lastIndexOf("!"),n=e.slice(0,r);e=e.slice(r+1),"'"==n.charAt(0)&&(n=n.slice(1,-1).replace(/''/g,"'"));var a=Sp(17);return a.write_shift(4,9),a.write_shift(1,60),a.write_shift(2,2+t.SheetNames.map((function(e){return e.toLowerCase()})).indexOf(n.toLowerCase())),a.write_shift(4,0),a.write_shift(2,0),a.write_shift(4,0),a}function xN(e){var t=e.split(":"),r=t[0],n=Sp(23);n.write_shift(4,15),r=t[0];var a=Fp(r);return n.write_shift(1,36),n.write_shift(4,a.r),n.write_shift(2,a.c|("$"==r.charAt(0)?0:1)<<14|(r.match(/\$\d/)?0:1)<<15),n.write_shift(4,0),r=t[1],a=Fp(r),n.write_shift(1,36),n.write_shift(4,a.r),n.write_shift(2,a.c|("$"==r.charAt(0)?0:1)<<14|(r.match(/\$\d/)?0:1)<<15),n.write_shift(4,0),n.write_shift(1,17),n.write_shift(4,0),n}function FN(e,t){var r=e.lastIndexOf("!"),n=e.slice(0,r);e=e.slice(r+1),"'"==n.charAt(0)&&(n=n.slice(1,-1).replace(/''/g,"'"));var a=e.split(":");i=a[0];var s=Sp(27);s.write_shift(4,19);var i=a[0],o=Fp(i);return s.write_shift(1,58),s.write_shift(2,2+t.SheetNames.map((function(e){return e.toLowerCase()})).indexOf(n.toLowerCase())),s.write_shift(4,o.r),s.write_shift(2,o.c|("$"==i.charAt(0)?0:1)<<14|(i.match(/\$\d/)?0:1)<<15),i=a[1],o=Fp(i),s.write_shift(1,58),s.write_shift(2,2+t.SheetNames.map((function(e){return e.toLowerCase()})).indexOf(n.toLowerCase())),s.write_shift(4,o.r),s.write_shift(2,o.c|("$"==i.charAt(0)?0:1)<<14|(i.match(/\$\d/)?0:1)<<15),s.write_shift(1,17),s.write_shift(4,0),s}function PN(e,t){var r=e.lastIndexOf("!"),n=e.slice(0,r);e=e.slice(r+1),"'"==n.charAt(0)&&(n=n.slice(1,-1).replace(/''/g,"'"));var a=Bp(e),s=Sp(23);return s.write_shift(4,15),s.write_shift(1,59),s.write_shift(2,2+t.SheetNames.map((function(e){return e.toLowerCase()})).indexOf(n.toLowerCase())),s.write_shift(4,a.s.r),s.write_shift(4,a.e.r),s.write_shift(2,a.s.c),s.write_shift(2,a.e.c),s.write_shift(4,0),s}function BN(e,t){if("number"==typeof e)return IN(e);if("boolean"==typeof e)return DN(e);if(/^#(DIV\/0!|GETTING_DATA|N\/A|NAME\?|NULL!|NUM!|REF!|VALUE!)$/.test(e))return MN(+Qm[e]);if(e.match(/^\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})$/))return kN(e);if(e.match(/^\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5}):\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})$/))return xN(e);if(e.match(/^#REF!\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5}):\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})$/))return PN(e,t);if(e.match(/^(?:'[^\\\/?*\[\]:]*'|[^'][^\\\/?*\[\]:'`~!@#$%^()\-=+{}|;,<.>]*)!\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})$/))return _N(e,t);if(e.match(/^(?:'[^\\\/?*\[\]:]*'|[^'][^\\\/?*\[\]:'`~!@#$%^()\-=+{}|;,<.>]*)!\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5}):\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})$/))return FN(e,t);if(/^(?:'[^\\\/?*\[\]:]*'|[^'][^\\\/?*\[\]:'`~!@#$%^()\-=+{}|;,<.>]*)!#REF!$/.test(e))return UN(e,t);if(/^".*"$/.test(e))return LN(e);if(/^[+-]\d+$/.test(e))return IN(parseInt(e,10));throw"Formula |"+e+"| not supported for XLSB"}var YN=BN,VN={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},WN={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},GN={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function HN(e){return"of:"==e.slice(0,3)&&(e=e.slice(3)),61==e.charCodeAt(0)&&(e=e.slice(1),61==e.charCodeAt(0)&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,(function(e,t){return t.replace(/\./g,"")})),e=e.replace(/\$'([^']|'')+'/g,(function(e){return e.slice(1)})),e=e.replace(/\$([^\]\. #$]+)/g,(function(e,t){return t.match(/^([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])?(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})?$/)?e:t})),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function zN(e){var t="of:="+e.replace(UR,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function $N(e){e=e.replace(/\$'([^']|'')+'/g,(function(e){return e.slice(1)})),e=e.replace(/\$([^\]\. #$]+)/g,(function(e,t){return t.match(/^([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])?(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})?$/)?e:t}));var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}function jN(e){return e.replace(/!/,".")}var XN={},KN={},qN="undefined"!==typeof Map;function JN(e,t,r){var n=0,a=e.length;if(r){if(qN?r.has(t):Object.prototype.hasOwnProperty.call(r,t))for(var s=qN?r.get(t):r[t];n<s.length;++n)if(e[s[n]].t===t)return e.Count++,s[n]}else for(;n<a;++n)if(e[n].t===t)return e.Count++,n;return e[a]={t:t},e.Count++,e.Unique++,r&&(qN?(r.has(t)||r.set(t,[]),r.get(t).push(a)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(a))),a}function QN(e,t){var r={min:e+1,max:e+1},n=-1;return t.MDW&&(kS=t.MDW),null!=t.width?r.customWidth=1:null!=t.wpx?n=US(t.wpx):null!=t.wch&&(n=t.wch),n>-1?(r.width=xS(n),r.customWidth=1):null!=t.width&&(r.width=t.width),t.hidden&&(r.hidden=!0),null!=t.level&&(r.outlineLevel=r.level=t.level),r}function ZN(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];"xlml"==t&&(r=[1,1,1,1,.5,.5]),null==e.left&&(e.left=r[0]),null==e.right&&(e.right=r[1]),null==e.top&&(e.top=r[2]),null==e.bottom&&(e.bottom=r[3]),null==e.header&&(e.header=r[4]),null==e.footer&&(e.footer=r[5])}}function ew(e,t,r){var n=r.revssf[null!=t.z?t.z:"General"],a=60,s=e.length;if(null==n&&r.ssf)for(;a<392;++a)if(null==r.ssf[a]){Qh(t.z,a),r.ssf[a]=t.z,r.revssf[t.z]=n=a;break}for(a=0;a!=s;++a)if(e[a].numFmtId===n)return a;return e[s]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},s}function tw(e,t,r,n,a,s){try{n.cellNF&&(e.z=qu[t])}catch(o){if(n.WTF)throw o}if("z"!==e.t||n.cellStyles){if("d"===e.t&&"string"===typeof e.v&&(e.v=Rf(e.v)),(!n||!1!==n.cellText)&&"z"!==e.t)try{if(null==qu[t]&&Qh(jh[t]||"General",t),"e"===e.t)e.w=e.w||Jm[e.v];else if(0===t)if("n"===e.t)(0|e.v)===e.v?e.w=e.v.toString(10):e.w=lh(e.v);else if("d"===e.t){var i=df(e.v);e.w=(0|i)===i?i.toString(10):lh(i)}else{if(void 0===e.v)return"";e.w=uh(e.v,KN)}else"d"===e.t?e.w=Wh(t,df(e.v),KN):e.w=Wh(t,e.v,KN)}catch(o){if(n.WTF)throw o}if(n.cellStyles&&null!=r)try{e.s=s.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=IS(a.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=a.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=IS(a.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=a.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(o){if(n.WTF&&s.Fills)throw o}}}function rw(e,t,r){if(e&&e["!ref"]){var n=Gp(e["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function nw(e,t){var r=Gp(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=Yp(r))}var aw=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,sw=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,iw=/<(?:\w:)?hyperlink [^>]*>/gm,ow=/"(\w*:\w*)"/,cw=/<(?:\w:)?col\b[^>]*[\/]?>/g,lw=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,uw=/<(?:\w:)?pageMargins[^>]*\/>/g,hw=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,fw=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,dw=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function pw(e,t,r,n,a,s,i){if(!e)return e;n||(n={"!id":{}}),null!=vu&&null==t.dense&&(t.dense=vu);var o={};t.dense&&(o["!data"]=[]);var c={s:{r:2e6,c:2e6},e:{r:0,c:0}},l="",u="",h=e.match(sw);h?(l=e.slice(0,h.index),u=e.slice(h.index+h[0].length)):l=u=e;var f=l.match(hw);f?gw(f[0],o,a,r):(f=l.match(fw))&&Ew(f[0],f[1]||"",o,a,r,i,s);var d=(l.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(d>0){var p=l.slice(d,d+50).match(ow);!p||t&&t.nodim||nw(o,p[1])}var m=l.match(dw);m&&m[1]&&Mw(m[1],a);var g=[];if(t.cellStyles){var E=l.match(cw);E&&ww(g,E)}h&&kw(h[1],o,t,c,s,i);var v=u.match(lw);v&&(o["!autofilter"]=Cw(v[0]));var T=[],S=u.match(aw);if(S)for(d=0;d!=S.length;++d)T[d]=Gp(S[d].slice(S[d].indexOf('"')+1));var A=u.match(iw);A&&Rw(o,A,n);var R=u.match(uw);if(R&&(o["!margins"]=yw(Qf(R[0]))),t&&t.nodim&&(c.s.c=c.s.r=0),!o["!ref"]&&c.e.c>=c.s.c&&c.e.r>=c.s.r&&(o["!ref"]=Yp(c)),t.sheetRows>0&&o["!ref"]){var y=Gp(o["!ref"]);t.sheetRows<=+y.e.r&&(y.e.r=t.sheetRows-1,y.e.r>c.e.r&&(y.e.r=c.e.r),y.e.r<y.s.r&&(y.s.r=y.e.r),y.e.c>c.e.c&&(y.e.c=c.e.c),y.e.c<y.s.c&&(y.s.c=y.e.c),o["!fullref"]=o["!ref"],o["!ref"]=Yp(y))}return g.length>0&&(o["!cols"]=g),T.length>0&&(o["!merges"]=T),o}function mw(e){if(0===e.length)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+Yp(e[r])+'"/>';return t+"</mergeCells>"}function gw(e,t,r,n){var a=Qf(e);r.Sheets[n]||(r.Sheets[n]={}),a.codeName&&(r.Sheets[n].CodeName=rd(Ed(a.codeName)))}function Ew(e,t,r,n,a){gw(e.slice(0,e.indexOf(">")),r,n,a)}function vw(e,t,r,n,a){var s=!1,i={},o=null;if("xlsx"!==n.bookType&&t.vbaraw){var c=t.SheetNames[r];try{t.Workbook&&(c=t.Workbook.Sheets[r].CodeName||c)}catch(u){}s=!0,i.codeName=vd(sd(c))}if(e&&e["!outline"]){var l={summaryBelow:1,summaryRight:1};e["!outline"].above&&(l.summaryBelow=0),e["!outline"].left&&(l.summaryRight=0),o=(o||"")+Od("outlinePr",null,l)}(s||o)&&(a[a.length]=Od("sheetPr",o,i))}var Tw=["objects","scenarios","selectLockedCells","selectUnlockedCells"],Sw=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function Aw(e){var t={sheet:1};return Tw.forEach((function(r){null!=e[r]&&e[r]&&(t[r]="1")})),Sw.forEach((function(r){null==e[r]||e[r]||(t[r]="0")})),e.password&&(t.password=pS(e.password).toString(16).toUpperCase()),Od("sheetProtection",null,t)}function Rw(e,t,r){for(var n=null!=e["!data"],a=0;a!=t.length;++a){var s=Qf(Ed(t[a]),!0);if(!s.ref)return;var i=((r||{})["!id"]||[])[s.id];i?(s.Target=i.Target,s.location&&(s.Target+="#"+rd(s.location))):(s.Target="#"+rd(s.location),i={Target:s.Target,TargetMode:"Internal"}),s.Rel=i,s.tooltip&&(s.Tooltip=s.tooltip,delete s.tooltip);for(var o=Gp(s.ref),c=o.s.r;c<=o.e.r;++c)for(var l=o.s.c;l<=o.e.c;++l){var u=kp(l)+Ip(c);n?(e["!data"][c]||(e["!data"][c]=[]),e["!data"][c][l]||(e["!data"][c][l]={t:"z",v:void 0}),e["!data"][c][l].l=s):(e[u]||(e[u]={t:"z",v:void 0}),e[u].l=s)}}}function yw(e){var t={};return["left","right","top","bottom","header","footer"].forEach((function(r){e[r]&&(t[r]=parseFloat(e[r]))})),t}function Nw(e){return ZN(e),Od("pageMargins",null,e)}function ww(e,t){for(var r=!1,n=0;n!=t.length;++n){var a=Qf(t[n],!0);a.hidden&&(a.hidden=fd(a.hidden));var s=parseInt(a.min,10)-1,i=parseInt(a.max,10)-1;a.outlineLevel&&(a.level=+a.outlineLevel||0),delete a.min,delete a.max,a.width=+a.width,!r&&a.width&&(r=!0,PS(a.width)),BS(a);while(s<=i)e[s++]=Nf(a)}}function bw(e,t){for(var r,n=["<cols>"],a=0;a!=t.length;++a)(r=t[a])&&(n[n.length]=Od("col",null,QN(a,r)));return n[n.length]="</cols>",n.join("")}function Cw(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}function Ow(e,t,r,n){var a="string"==typeof e.ref?e.ref:Yp(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var s=r.Workbook.Names,i=Bp(a);i.s.r==i.e.r&&(i.e.r=Bp(t["!ref"]).e.r,a=Yp(i));for(var o=0;o<s.length;++o){var c=s[o];if("_xlnm._FilterDatabase"==c.Name&&c.Sheet==n){c.Ref=Wp(r.SheetNames[n])+"!"+Vp(a);break}}return o==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+a}),Od("autoFilter",null,{ref:a})}var Iw=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/g;function Mw(e,t){t.Views||(t.Views=[{}]),(e.match(Iw)||[]).forEach((function(e,r){var n=Qf(e);t.Views[r]||(t.Views[r]={}),+n.zoomScale&&(t.Views[r].zoom=+n.zoomScale),n.rightToLeft&&fd(n.rightToLeft)&&(t.Views[r].RTL=!0)}))}function Dw(e,t,r,n){var a={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(a.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),Od("sheetViews",Od("sheetView",null,a),{})}function Lw(e,t,r,n){if(e.c&&r["!comments"].push([t,e.c]),(void 0===e.v||"z"===e.t&&!(n||{}).sheetStubs)&&"string"!==typeof e.f&&"undefined"==typeof e.z)return"";var a="",s=e.t,i=e.v;if("z"!==e.t)switch(e.t){case"b":a=e.v?"1":"0";break;case"n":a=""+e.v;break;case"e":a=Jm[e.v];break;case"d":n&&n.cellDates?a=Rf(e.v,-1).toISOString():(e=Nf(e),e.t="n",a=""+(e.v=df(Rf(e.v)))),"undefined"===typeof e.z&&(e.z=qu[14]);break;default:a=e.v;break}var o="z"==e.t||null==e.v?"":bd("v",sd(a)),c={r:t},l=ew(n.cellXfs,e,n);switch(0!==l&&(c.s=l),e.t){case"n":break;case"d":c.t="d";break;case"b":c.t="b";break;case"e":c.t="e";break;case"z":break;default:if(null==e.v){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){o=bd("v",""+JN(n.Strings,e.v,n.revStrings)),c.t="s";break}c.t="str";break}if(e.t!=s&&(e.t=s,e.v=i),"string"==typeof e.f&&e.f){var u=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;o=Od("f",sd(e.f),u)+(null!=e.v?o:"")}return e.l&&(e.l.display=sd(a),r["!links"].push([t,e.l])),e.D&&(c.cm=1),Od("c",o,c)}var kw=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,a=/ref=["']([^"']*)["']/,s=Td("v"),i=Td("f");return function(o,c,l,u,h,f){for(var d,p,m,g,E,v=0,T="",S=[],A=[],R=0,y=0,N=0,w="",b=0,C=0,O=0,I=0,M=Array.isArray(f.CellXf),D=[],L=[],k=null!=c["!data"],_=[],U={},x=!1,F=!!l.sheetStubs,P=o.split(t),B=0,Y=P.length;B!=Y;++B){T=P[B].trim();var V=T.length;if(0!==V){var W=0;e:for(v=0;v<V;++v)switch(T[v]){case">":if("/"!=T[v-1]){++v;break e}if(l&&l.cellStyles){if(p=Qf(T.slice(W,v),!0),b=null!=p.r?parseInt(p.r,10):b+1,C=-1,l.sheetRows&&l.sheetRows<b)continue;U={},x=!1,p.ht&&(x=!0,U.hpt=parseFloat(p.ht),U.hpx=GS(U.hpt)),p.hidden&&fd(p.hidden)&&(x=!0,U.hidden=!0),null!=p.outlineLevel&&(x=!0,U.level=+p.outlineLevel),x&&(_[b-1]=U)}break;case"<":W=v;break}if(W>=v)break;if(p=Qf(T.slice(W,v),!0),b=null!=p.r?parseInt(p.r,10):b+1,C=-1,!(l.sheetRows&&l.sheetRows<b)){l.nodim||(u.s.r>b-1&&(u.s.r=b-1),u.e.r<b-1&&(u.e.r=b-1)),l&&l.cellStyles&&(U={},x=!1,p.ht&&(x=!0,U.hpt=parseFloat(p.ht),U.hpx=GS(U.hpt)),p.hidden&&fd(p.hidden)&&(x=!0,U.hidden=!0),null!=p.outlineLevel&&(x=!0,U.level=+p.outlineLevel),x&&(_[b-1]=U)),S=T.slice(v).split(e);for(var G=0;G!=S.length;++G)if("<"!=S[G].trim().charAt(0))break;for(S=S.slice(G),v=0;v!=S.length;++v)if(T=S[v].trim(),0!==T.length){if(A=T.match(r),R=v,y=0,N=0,T="<c "+("<"==T.slice(0,1)?">":"")+T,null!=A&&2===A.length){for(R=0,w=A[1],y=0;y!=w.length;++y){if((N=w.charCodeAt(y)-64)<1||N>26)break;R=26*R+N}--R,C=R}else++C;for(y=0;y!=T.length;++y)if(62===T.charCodeAt(y))break;if(++y,p=Qf(T.slice(0,y),!0),p.r||(p.r=Pp({r:b-1,c:C})),w=T.slice(y),d={t:""},null!=(A=w.match(s))&&""!==A[1]&&(d.v=rd(A[1])),l.cellFormula){if(null!=(A=w.match(i))&&""!==A[1]){if(d.f=rd(Ed(A[1]),!0),l.xlfn||(d.f=YR(d.f)),A[0].indexOf('t="array"')>-1)d.F=(w.match(a)||[])[1],d.F.indexOf(":")>-1&&D.push([Gp(d.F),d.F]);else if(A[0].indexOf('t="shared"')>-1){g=Qf(A[0]);var H=rd(Ed(A[1]));l.xlfn||(H=YR(H)),L[parseInt(g.si,10)]=[g,H,p.r]}}else(A=w.match(/<f[^>]*\/>/))&&(g=Qf(A[0]),L[g.si]&&(d.f=PR(L[g.si][1],L[g.si][2],p.r)));var z=Fp(p.r);for(y=0;y<D.length;++y)z.r>=D[y][0].s.r&&z.r<=D[y][0].e.r&&z.c>=D[y][0].s.c&&z.c<=D[y][0].e.c&&(d.F=D[y][1])}if(null==p.t&&void 0===d.v)if(d.f||d.F)d.v=0,d.t="n";else{if(!F)continue;d.t="z"}else d.t=p.t||"n";switch(u.s.c>C&&(u.s.c=C),u.e.c<C&&(u.e.c=C),d.t){case"n":if(""==d.v||null==d.v){if(!F)continue;d.t="z"}else d.v=parseFloat(d.v);break;case"s":if("undefined"==typeof d.v){if(!F)continue;d.t="z"}else m=XN[parseInt(d.v,10)],d.v=m.t,d.r=m.r,l.cellHTML&&(d.h=m.h);break;case"str":d.t="s",d.v=null!=d.v?rd(Ed(d.v),!0):"",l.cellHTML&&(d.h=cd(d.v));break;case"inlineStr":A=w.match(n),d.t="s",null!=A&&(m=YT(A[1]))?(d.v=m.t,l.cellHTML&&(d.h=m.h)):d.v="";break;case"b":d.v=fd(d.v);break;case"d":l.cellDates?d.v=Rf(d.v,1):(d.v=df(Rf(d.v,1)),d.t="n");break;case"e":l&&!1===l.cellText||(d.w=d.v),d.v=Qm[d.v];break}if(O=I=0,E=null,M&&void 0!==p.s&&(E=f.CellXf[p.s],null!=E&&(null!=E.numFmtId&&(O=E.numFmtId),l.cellStyles&&null!=E.fillId&&(I=E.fillId))),tw(d,O,I,l,h,f),l.cellDates&&M&&"n"==d.t&&Fh(qu[O])&&(d.t="d",d.v=Ef(d.v)),p.cm&&l.xlmeta){var $=(l.xlmeta.Cell||[])[+p.cm-1];$&&"XLDAPR"==$.type&&(d.D=!0)}var j;l.nodim&&(j=Fp(p.r),u.s.r>j.r&&(u.s.r=j.r),u.e.r<j.r&&(u.e.r=j.r)),k?(j=Fp(p.r),c["!data"][j.r]||(c["!data"][j.r]=[]),c["!data"][j.r][j.c]=d):c[p.r]=d}}}}_.length>0&&(c["!rows"]=_)}}();function _w(e,t,r,n){var a,s,i=[],o=[],c=Gp(e["!ref"]),l="",u="",h=[],f=0,d=0,p=e["!rows"],m=null!=e["!data"],g={r:u},E=-1;for(d=c.s.c;d<=c.e.c;++d)h[d]=kp(d);for(f=c.s.r;f<=c.e.r;++f){for(o=[],u=Ip(f),d=c.s.c;d<=c.e.c;++d){a=h[d]+u;var v=m?(e["!data"][f]||[])[d]:e[a];void 0!==v&&(null!=(l=Lw(v,a,e,t,r,n))&&o.push(l))}(o.length>0||p&&p[f])&&(g={r:u},p&&p[f]&&(s=p[f],s.hidden&&(g.hidden=1),E=-1,s.hpx?E=WS(s.hpx):s.hpt&&(E=s.hpt),E>-1&&(g.ht=E,g.customHeight=1),s.level&&(g.outlineLevel=s.level)),i[i.length]=Od("row",o.join(""),g))}if(p)for(;f<p.length;++f)p&&p[f]&&(g={r:f+1},s=p[f],s.hidden&&(g.hidden=1),E=-1,s.hpx?E=WS(s.hpx):s.hpt&&(E=s.hpt),E>-1&&(g.ht=E,g.customHeight=1),s.level&&(g.outlineLevel=s.level),i[i.length]=Od("row","",g));return i.join("")}function Uw(e,t,r,n){var a=[zf,Od("worksheet",null,{xmlns:_d[0],"xmlns:r":kd.r})],s=r.SheetNames[e],i=0,o="",c=r.Sheets[s];null==c&&(c={});var l=c["!ref"]||"A1",u=Gp(l);if(u.e.c>16383||u.e.r>1048575){if(t.WTF)throw new Error("Range "+l+" exceeds format limit A1:XFD1048576");u.e.c=Math.min(u.e.c,16383),u.e.r=Math.min(u.e.c,1048575),l=Yp(u)}n||(n={}),c["!comments"]=[];var h=[];vw(c,r,e,t,a),a[a.length]=Od("dimension",null,{ref:l}),a[a.length]=Dw(c,t,e,r),t.sheetFormat&&(a[a.length]=Od("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),null!=c["!cols"]&&c["!cols"].length>0&&(a[a.length]=bw(c,c["!cols"])),a[i=a.length]="<sheetData/>",c["!links"]=[],null!=c["!ref"]&&(o=_w(c,t,e,r,n),o.length>0&&(a[a.length]=o)),a.length>i+1&&(a[a.length]="</sheetData>",a[i]=a[i].replace("/>",">")),c["!protect"]&&(a[a.length]=Aw(c["!protect"])),null!=c["!autofilter"]&&(a[a.length]=Ow(c["!autofilter"],c,r,e)),null!=c["!merges"]&&c["!merges"].length>0&&(a[a.length]=mw(c["!merges"]));var f,d=-1,p=-1;return c["!links"].length>0&&(a[a.length]="<hyperlinks>",c["!links"].forEach((function(e){e[1].Target&&(f={ref:e[0]},"#"!=e[1].Target.charAt(0)&&(p=lg(n,-1,sd(e[1].Target).replace(/#.*$/,""),sg.HLINK),f["r:id"]="rId"+p),(d=e[1].Target.indexOf("#"))>-1&&(f.location=sd(e[1].Target.slice(d+1))),e[1].Tooltip&&(f.tooltip=sd(e[1].Tooltip)),f.display=e[1].display,a[a.length]=Od("hyperlink",null,f))})),a[a.length]="</hyperlinks>"),delete c["!links"],null!=c["!margins"]&&(a[a.length]=Nw(c["!margins"])),t&&!t.ignoreEC&&void 0!=t.ignoreEC||(a[a.length]=bd("ignoredErrors",Od("ignoredError",null,{numberStoredAsText:1,sqref:l}))),h.length>0&&(p=lg(n,-1,"../drawings/drawing"+(e+1)+".xml",sg.DRAW),a[a.length]=Od("drawing",null,{"r:id":"rId"+p}),c["!drawing"]=h),c["!comments"].length>0&&(p=lg(n,-1,"../drawings/vmlDrawing"+(e+1)+".vml",sg.VML),a[a.length]=Od("legacyDrawing",null,{"r:id":"rId"+p}),c["!legacy"]=p),a.length>1&&(a[a.length]="</worksheet>",a[1]=a[1].replace("/>",">")),a.join("")}function xw(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var a=e.read_shift(2);e.l+=1;var s=e.read_shift(1);return e.l=n,7&s&&(r.level=7&s),16&s&&(r.hidden=!0),32&s&&(r.hpt=a/20),r}function Fw(e,t,r){var n=Sp(145),a=(r["!rows"]||[])[e]||{};n.write_shift(4,e),n.write_shift(4,0);var s=320;a.hpx?s=20*WS(a.hpx):a.hpt&&(s=20*a.hpt),n.write_shift(2,s),n.write_shift(1,0);var i=0;a.level&&(i|=a.level),a.hidden&&(i|=16),(a.hpx||a.hpt)&&(i|=32),n.write_shift(1,i),n.write_shift(1,0);var o=0,c=n.l;n.l+=4;for(var l={r:e,c:0},u=null!=r["!data"],h=0;h<16;++h)if(!(t.s.c>h+1<<10||t.e.c<h<<10)){for(var f=-1,d=-1,p=h<<10;p<h+1<<10;++p){l.c=p;var m=u?(r["!data"][l.r]||[])[l.c]:r[Pp(l)];m&&(f<0&&(f=p),d=p)}f<0||(++o,n.write_shift(4,f),n.write_shift(4,d))}var g=n.l;return n.l=c,n.write_shift(4,o),n.l=g,n.length>n.l?n.slice(0,n.l):n}function Pw(e,t,r,n){var a=Fw(n,r,t);(a.length>17||(t["!rows"]||[])[n])&&yp(e,0,a)}var Bw=Sm,Yw=Am;function Vw(){}function Ww(e,t){var r={},n=e[e.l];return++e.l,r.above=!(64&n),r.left=!(128&n),e.l+=18,r.name=lm(e,t-19),r}function Gw(e,t,r){null==r&&(r=Sp(84+4*e.length));var n=192;t&&(t.above&&(n&=-65),t.left&&(n&=-129)),r.write_shift(1,n);for(var a=1;a<3;++a)r.write_shift(1,0);return wm({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),um(e,r),r.slice(0,r.l)}function Hw(e){var t=sm(e);return[t]}function zw(e,t,r){return null==r&&(r=Sp(8)),im(t,r)}function $w(e){var t=om(e);return[t]}function jw(e,t,r){return null==r&&(r=Sp(4)),cm(t,r)}function Xw(e){var t=sm(e),r=e.read_shift(1);return[t,r,"b"]}function Kw(e,t,r){return null==r&&(r=Sp(9)),im(t,r),r.write_shift(1,e.v?1:0),r}function qw(e){var t=om(e),r=e.read_shift(1);return[t,r,"b"]}function Jw(e,t,r){return null==r&&(r=Sp(5)),cm(t,r),r.write_shift(1,e.v?1:0),r}function Qw(e){var t=sm(e),r=e.read_shift(1);return[t,r,"e"]}function Zw(e,t,r){return null==r&&(r=Sp(9)),im(t,r),r.write_shift(1,e.v),r}function eb(e){var t=om(e),r=e.read_shift(1);return[t,r,"e"]}function tb(e,t,r){return null==r&&(r=Sp(8)),cm(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function rb(e){var t=sm(e),r=e.read_shift(4);return[t,r,"s"]}function nb(e,t,r){return null==r&&(r=Sp(12)),im(t,r),r.write_shift(4,t.v),r}function ab(e){var t=om(e),r=e.read_shift(4);return[t,r,"s"]}function sb(e,t,r){return null==r&&(r=Sp(8)),cm(t,r),r.write_shift(4,t.v),r}function ib(e){var t=sm(e),r=Rm(e);return[t,r,"n"]}function ob(e,t,r){return null==r&&(r=Sp(16)),im(t,r),ym(e.v,r),r}function cb(e){var t=om(e),r=Rm(e);return[t,r,"n"]}function lb(e,t,r){return null==r&&(r=Sp(12)),cm(t,r),ym(e.v,r),r}function ub(e){var t=sm(e),r=gm(e);return[t,r,"n"]}function hb(e,t,r){return null==r&&(r=Sp(12)),im(t,r),Em(e.v,r),r}function fb(e){var t=om(e),r=gm(e);return[t,r,"n"]}function db(e,t,r){return null==r&&(r=Sp(8)),cm(t,r),Em(e.v,r),r}function pb(e){var t=sm(e),r=tm(e);return[t,r,"is"]}function mb(e){var t=sm(e),r=Jp(e);return[t,r,"str"]}function gb(e,t,r){var n=null==e.v?"":String(e.v);return null==r&&(r=Sp(12+4*e.v.length)),im(t,r),Qp(n,r),r.length>r.l?r.slice(0,r.l):r}function Eb(e){var t=om(e),r=Jp(e);return[t,r,"str"]}function vb(e,t,r){var n=null==e.v?"":String(e.v);return null==r&&(r=Sp(8+4*n.length)),cm(t,r),Qp(n,r),r.length>r.l?r.slice(0,r.l):r}function Tb(e,t,r){var n=e.l+t,a=sm(e);a.r=r["!row"];var s=e.read_shift(1),i=[a,s,"b"];if(r.cellFormula){e.l+=2;var o=bN(e,n-e.l,r);i[3]=mN(o,null,a,r.supbooks,r)}else e.l=n;return i}function Sb(e,t,r){var n=e.l+t,a=sm(e);a.r=r["!row"];var s=e.read_shift(1),i=[a,s,"e"];if(r.cellFormula){e.l+=2;var o=bN(e,n-e.l,r);i[3]=mN(o,null,a,r.supbooks,r)}else e.l=n;return i}function Ab(e,t,r){var n=e.l+t,a=sm(e);a.r=r["!row"];var s=Rm(e),i=[a,s,"n"];if(r.cellFormula){e.l+=2;var o=bN(e,n-e.l,r);i[3]=mN(o,null,a,r.supbooks,r)}else e.l=n;return i}function Rb(e,t,r){var n=e.l+t,a=sm(e);a.r=r["!row"];var s=Jp(e),i=[a,s,"str"];if(r.cellFormula){e.l+=2;var o=bN(e,n-e.l,r);i[3]=mN(o,null,a,r.supbooks,r)}else e.l=n;return i}var yb=Sm,Nb=Am;function wb(e,t){return null==t&&(t=Sp(4)),t.write_shift(4,e),t}function bb(e,t){var r=e.l+t,n=Sm(e,16),a=hm(e),s=Jp(e),i=Jp(e),o=Jp(e);e.l=r;var c={rfx:n,relId:a,loc:s,display:o};return i&&(c.Tooltip=i),c}function Cb(e,t){var r=Sp(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));Am({s:Fp(e[0]),e:Fp(e[0])},r),mm("rId"+t,r);var n=e[1].Target.indexOf("#"),a=-1==n?"":e[1].Target.slice(n+1);return Qp(a||"",r),Qp(e[1].Tooltip||"",r),Qp("",r),r.slice(0,r.l)}function Ob(){}function Ib(e,t,r){var n=e.l+t,a=vm(e,16),s=e.read_shift(1),i=[a];if(i[2]=s,r.cellFormula){var o=wN(e,n-e.l,r);i[1]=o}else e.l=n;return i}function Mb(e,t,r){var n=e.l+t,a=Sm(e,16),s=[a];if(r.cellFormula){var i=ON(e,n-e.l,r);s[1]=i,e.l=n}else e.l=n;return s}function Db(e,t,r){null==r&&(r=Sp(18));var n=QN(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,256*(n.width||10)),r.write_shift(4,0);var a=0;return t.hidden&&(a|=1),"number"==typeof n.width&&(a|=2),t.level&&(a|=t.level<<8),r.write_shift(2,a),r}var Lb=["left","right","top","bottom","header","footer"];function kb(e){var t={};return Lb.forEach((function(r){t[r]=Rm(e,8)})),t}function _b(e,t){return null==t&&(t=Sp(48)),ZN(e),Lb.forEach((function(r){ym(e[r],t)})),t}function Ub(e){var t=e.read_shift(2);return e.l+=28,{RTL:32&t}}function xb(e,t,r){null==r&&(r=Sp(30));var n=924;return(((t||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function Fb(e){var t=Sp(24);return t.write_shift(4,4),t.write_shift(4,1),Am(e,t),t}function Pb(e,t){return null==t&&(t=Sp(66)),t.write_shift(2,e.password?pS(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach((function(r){r[1]?t.write_shift(4,null==e[r[0]]||e[r[0]]?0:1):t.write_shift(4,null!=e[r[0]]&&e[r[0]]?0:1)})),t}function Bb(){}function Yb(){}function Vb(e,t,r,n,a,s,i){if(!e)return e;var o=t||{};n||(n={"!id":{}}),null!=vu&&null==o.dense&&(o.dense=vu);var c,l={};o.dense&&(l["!data"]=[]);var u,h,f,d,p,m,g,E,v,T={s:{r:2e6,c:2e6},e:{r:0,c:0}},S=[],A=!1,R=!1,y=[];o.biff=12,o["!row"]=0;var N=0,w=!1,b=[],C={},O=o.supbooks||a.supbooks||[[]];if(O.sharedf=C,O.arrayf=b,O.SheetNames=a.SheetNames||a.Sheets.map((function(e){return e.name})),!o.supbooks&&(o.supbooks=O,a.Names))for(var I=0;I<a.Names.length;++I)O[0][I+1]=a.Names[I];var M,D,L=[],k=[],_=!1;if(DO[16]={n:"BrtShortReal",f:cb},Ap(e,(function(e,t,I){if(!R)switch(I){case 148:c=e;break;case 0:u=e,o.sheetRows&&o.sheetRows<=u.r&&(R=!0),E=Ip(d=u.r),o["!row"]=u.r,(e.hidden||e.hpt||null!=e.level)&&(e.hpt&&(e.hpx=GS(e.hpt)),k[e.r]=e);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(h={t:e[2]},e[2]){case"n":h.v=e[1];break;case"s":g=XN[e[1]],h.v=g.t,h.r=g.r;break;case"b":h.v=!!e[1];break;case"e":h.v=e[1],!1!==o.cellText&&(h.w=Jm[h.v]);break;case"str":h.t="s",h.v=e[1];break;case"is":h.t="s",h.v=e[1].t;break}if((f=i.CellXf[e[0].iStyleRef])&&tw(h,f.numFmtId,null,o,s,i),p=-1==e[0].c?p+1:e[0].c,o.dense?(l["!data"][d]||(l["!data"][d]=[]),l["!data"][d][p]=h):l[kp(p)+E]=h,o.cellFormula){for(w=!1,N=0;N<b.length;++N){var U=b[N];u.r>=U[0].s.r&&u.r<=U[0].e.r&&p>=U[0].s.c&&p<=U[0].e.c&&(h.F=Yp(U[0]),w=!0)}!w&&e.length>3&&(h.f=e[3])}if(T.s.r>u.r&&(T.s.r=u.r),T.s.c>p&&(T.s.c=p),T.e.r<u.r&&(T.e.r=u.r),T.e.c<p&&(T.e.c=p),o.cellDates&&f&&"n"==h.t&&Fh(qu[f.numFmtId])){var x=eh(h.v);x&&(h.t="d",h.v=new Date(x.y,x.m-1,x.d,x.H,x.M,x.S,x.u))}M&&("XLDAPR"==M.type&&(h.D=!0),M=void 0),D&&(D=void 0);break;case 1:case 12:if(!o.sheetStubs||A)break;h={t:"z",v:void 0},p=-1==e[0].c?p+1:e[0].c,o.dense?(l["!data"][d]||(l["!data"][d]=[]),l["!data"][d][p]=h):l[kp(p)+E]=h,T.s.r>u.r&&(T.s.r=u.r),T.s.c>p&&(T.s.c=p),T.e.r<u.r&&(T.e.r=u.r),T.e.c<p&&(T.e.c=p),M&&("XLDAPR"==M.type&&(h.D=!0),M=void 0),D&&(D=void 0);break;case 176:y.push(e);break;case 49:M=((o.xlmeta||{}).Cell||[])[e-1];break;case 494:var F=n["!id"][e.relId];for(F?(e.Target=F.Target,e.loc&&(e.Target+="#"+e.loc),e.Rel=F):""==e.relId&&(e.Target="#"+e.loc),d=e.rfx.s.r;d<=e.rfx.e.r;++d)for(p=e.rfx.s.c;p<=e.rfx.e.c;++p)o.dense?(l["!data"][d]||(l["!data"][d]=[]),l["!data"][d][p]||(l["!data"][d][p]={t:"z",v:void 0}),l["!data"][d][p].l=e):(m=kp(p)+Ip(d),l[m]||(l[m]={t:"z",v:void 0}),l[m].l=e);break;case 426:if(!o.cellFormula)break;b.push(e),v=o.dense?l["!data"][d][p]:l[kp(p)+E],v.f=mN(e[1],T,{r:u.r,c:p},O,o),v.F=Yp(e[0]);break;case 427:if(!o.cellFormula)break;C[Pp(e[0].s)]=e[1],v=o.dense?l["!data"][d][p]:l[kp(p)+E],v.f=mN(e[1],T,{r:u.r,c:p},O,o);break;case 60:if(!o.cellStyles)break;while(e.e>=e.s)L[e.e--]={width:e.w/256,hidden:!!(1&e.flags),level:e.level},_||(_=!0,PS(e.w/256)),BS(L[e.e+1]);break;case 161:l["!autofilter"]={ref:Yp(e)};break;case 476:l["!margins"]=e;break;case 147:a.Sheets[r]||(a.Sheets[r]={}),e.name&&(a.Sheets[r].CodeName=e.name),(e.above||e.left)&&(l["!outline"]={above:e.above,left:e.left});break;case 137:a.Views||(a.Views=[{}]),a.Views[0]||(a.Views[0]={}),e.RTL&&(a.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:A=!0;break;case 36:A=!1;break;case 37:S.push(I),A=!0;break;case 38:S.pop(),A=!1;break;default:if(t.T);else if(!A||o.WTF)throw new Error("Unexpected record 0x"+I.toString(16))}}),o),delete o.supbooks,delete o["!row"],!l["!ref"]&&(T.s.r<2e6||c&&(c.e.r>0||c.e.c>0||c.s.r>0||c.s.c>0))&&(l["!ref"]=Yp(c||T)),o.sheetRows&&l["!ref"]){var U=Gp(l["!ref"]);o.sheetRows<=+U.e.r&&(U.e.r=o.sheetRows-1,U.e.r>T.e.r&&(U.e.r=T.e.r),U.e.r<U.s.r&&(U.s.r=U.e.r),U.e.c>T.e.c&&(U.e.c=T.e.c),U.e.c<U.s.c&&(U.s.c=U.e.c),l["!fullref"]=l["!ref"],l["!ref"]=Yp(U))}return y.length>0&&(l["!merges"]=y),L.length>0&&(l["!cols"]=L),k.length>0&&(l["!rows"]=k),l}function Wb(e,t,r,n,a,s,i){var o={r:r,c:n};if(t.c&&s["!comments"].push([Pp(o),t.c]),void 0===t.v)return!1;var c="";switch(t.t){case"b":c=t.v?"1":"0";break;case"d":t=Nf(t),t.z=t.z||qu[14],t.v=df(Rf(t.v)),t.t="n";break;case"n":case"e":c=""+t.v;break;default:c=t.v;break}switch(o.s=ew(a.cellXfs,t,a),t.l&&s["!links"].push([Pp(o),t.l]),t.t){case"s":case"str":return a.bookSST?(c=JN(a.Strings,null==t.v?"":String(t.v),a.revStrings),o.t="s",o.v=c,i?yp(e,18,sb(t,o)):yp(e,7,nb(t,o))):(o.t="str",i?yp(e,17,vb(t,o)):yp(e,6,gb(t,o))),!0;case"n":return t.v==(0|t.v)&&t.v>-1e3&&t.v<1e3?i?yp(e,13,db(t,o)):yp(e,2,hb(t,o)):i?yp(e,16,lb(t,o)):yp(e,5,ob(t,o)),!0;case"b":return o.t="b",i?yp(e,15,Jw(t,o)):yp(e,4,Kw(t,o)),!0;case"e":return o.t="e",i?yp(e,14,tb(t,o)):yp(e,3,Zw(t,o)),!0}return i?yp(e,12,jw(t,o)):yp(e,1,zw(t,o)),!0}function Gb(e,t,r,n){var a,s=Gp(t["!ref"]||"A1"),i="",o=[];yp(e,145);var c=null!=t["!data"],l=s.e.r;t["!rows"]&&(l=Math.max(s.e.r,t["!rows"].length-1));for(var u=s.s.r;u<=l;++u){i=Ip(u),Pw(e,t,s,u);var h=!1;if(u<=s.e.r)for(var f=s.s.c;f<=s.e.c;++f){u===s.s.r&&(o[f]=kp(f)),a=o[f]+i;var d=c?(t["!data"][u]||[])[f]:t[a];d?h=Wb(e,d,u,f,n,t,h):h=!1}}yp(e,146)}function Hb(e,t){t&&t["!merges"]&&(yp(e,177,wb(t["!merges"].length)),t["!merges"].forEach((function(t){yp(e,176,Nb(t))})),yp(e,178))}function zb(e,t){t&&t["!cols"]&&(yp(e,390),t["!cols"].forEach((function(t,r){t&&yp(e,60,Db(r,t))})),yp(e,391))}function $b(e,t){t&&t["!ref"]&&(yp(e,648),yp(e,649,Fb(Gp(t["!ref"]))),yp(e,650))}function jb(e,t,r){t["!links"].forEach((function(t){if(t[1].Target){var n=lg(r,-1,t[1].Target.replace(/#.*$/,""),sg.HLINK);yp(e,494,Cb(t,n))}})),delete t["!links"]}function Xb(e,t,r,n){if(t["!comments"].length>0){var a=lg(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",sg.VML);yp(e,551,mm("rId"+a)),t["!legacy"]=a}}function Kb(e,t,r,n){if(t["!autofilter"]){var a=t["!autofilter"],s="string"===typeof a.ref?a.ref:Yp(a.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var i=r.Workbook.Names,o=Bp(s);o.s.r==o.e.r&&(o.e.r=Bp(t["!ref"]).e.r,s=Yp(o));for(var c=0;c<i.length;++c){var l=i[c];if("_xlnm._FilterDatabase"==l.Name&&l.Sheet==n){l.Ref=Wp(r.SheetNames[n])+"!"+Vp(s);break}}c==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:Wp(r.SheetNames[n])+"!"+Vp(s)}),yp(e,161,Am(Gp(s))),yp(e,162)}}function qb(e,t,r){yp(e,133),yp(e,137,xb(t,r)),yp(e,138),yp(e,134)}function Jb(){}function Qb(e,t){t["!protect"]&&yp(e,535,Pb(t["!protect"]))}function Zb(e,t,r,n){var a=Rp(),s=r.SheetNames[e],i=r.Sheets[s]||{},o=s;try{r&&r.Workbook&&(o=r.Workbook.Sheets[e].CodeName||o)}catch(l){}var c=Gp(i["!ref"]||"A1");if(c.e.c>16383||c.e.r>1048575){if(t.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");c.e.c=Math.min(c.e.c,16383),c.e.r=Math.min(c.e.c,1048575)}return i["!links"]=[],i["!comments"]=[],yp(a,129),(r.vbaraw||i["!outline"])&&yp(a,147,Gw(o,i["!outline"])),yp(a,148,Yw(c)),qb(a,i,r.Workbook),Jb(a,i),zb(a,i,e,t,r),Gb(a,i,e,t,r),Qb(a,i),Kb(a,i,r,e),Hb(a,i),jb(a,i,n),i["!margins"]&&yp(a,476,_b(i["!margins"])),t&&!t.ignoreEC&&void 0!=t.ignoreEC||$b(a,i),Xb(a,i,e,n),yp(a,130),a.end()}function eC(e){var t,r=[],n=e.match(/^<c:numCache>/);(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/gm)||[]).forEach((function(e){var t=e.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);t&&(r[+t[1]]=n?+t[2]:t[2])}));var a=rd((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/gm)||[]).forEach((function(e){t=e.replace(/<.*?>/g,"")})),[r,a,t]}function tC(e,t,r,n,a,s){var i=s||{"!type":"chart"};if(!e)return s;var o=0,c=0,l="A",u={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach((function(e){var t=eC(e);u.s.r=u.s.c=0,u.e.c=o,l=kp(o),t[0].forEach((function(e,r){i["!data"]?(i["!data"][r]||(i["!data"][r]=[]),i["!data"][r][o]={t:"n",v:e,z:t[1]}):i[l+Ip(r)]={t:"n",v:e,z:t[1]},c=r})),u.e.r<c&&(u.e.r=c),++o})),o>0&&(i["!ref"]=Yp(u)),i}function rC(e,t,r,n,a){if(!e)return e;n||(n={"!id":{}});var s,i={"!type":"chart","!drawel":null,"!rel":""},o=e.match(hw);return o&&gw(o[0],i,a,r),(s=e.match(/drawing r:id="(.*?)"/))&&(i["!rel"]=s[1]),n["!id"][i["!rel"]]&&(i["!drawel"]=n["!id"][i["!rel"]]),i}function nC(e,t){e.l+=10;var r=Jp(e,t-10);return{name:r}}function aC(e,t,r,n,a){if(!e)return e;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},i=[],o=!1;return Ap(e,(function(e,n,c){switch(c){case 550:s["!rel"]=e;break;case 651:a.Sheets[r]||(a.Sheets[r]={}),e.name&&(a.Sheets[r].CodeName=e.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:i.push(c);break;case 38:i.pop();break;default:if(n.T>0)i.push(c);else if(n.T<0)i.pop();else if(!o||t.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}),t),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}var sC=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],iC=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],oC=[],cC=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function lC(e,t){for(var r=0;r!=e.length;++r)for(var n=e[r],a=0;a!=t.length;++a){var s=t[a];if(null==n[s[0]])n[s[0]]=s[1];else switch(s[2]){case"bool":"string"==typeof n[s[0]]&&(n[s[0]]=fd(n[s[0]]));break;case"int":"string"==typeof n[s[0]]&&(n[s[0]]=parseInt(n[s[0]],10));break}}}function uC(e,t){for(var r=0;r!=t.length;++r){var n=t[r];if(null==e[n[0]])e[n[0]]=n[1];else switch(n[2]){case"bool":"string"==typeof e[n[0]]&&(e[n[0]]=fd(e[n[0]]));break;case"int":"string"==typeof e[n[0]]&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function hC(e){uC(e.WBProps,sC),uC(e.CalcPr,cC),lC(e.WBView,iC),lC(e.Sheets,oC),KN.date1904=fd(e.WBProps.date1904)}function fC(e){return e.Workbook&&e.Workbook.WBProps&&fd(e.Workbook.WBProps.date1904)?"true":"false"}var dC=":][*?/\\".split("");function pC(e,t){if(e.length>31){if(t)return!1;throw new Error("Sheet names cannot exceed 31 chars")}var r=!0;return dC.forEach((function(n){if(-1!=e.indexOf(n)){if(!t)throw new Error("Sheet name cannot contain : \\ / ? * [ ]");r=!1}})),r}function mC(e,t,r){e.forEach((function(n,a){pC(n);for(var s=0;s<a;++s)if(n==e[s])throw new Error("Duplicate Sheet Name: "+n);if(r){var i=t&&t[a]&&t[a].CodeName||n;if(95==i.charCodeAt(0)&&i.length>22)throw new Error("Bad Code Name: Worksheet"+i)}}))}function gC(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];mC(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)rw(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r);e.SheetNames.forEach((function(t,r){var n=e.Sheets[t];if(n&&n["!autofilter"]){var a;e.Workbook||(e.Workbook={}),e.Workbook.Names||(e.Workbook.Names=[]),e.Workbook.Names.forEach((function(e){"_xlnm._FilterDatabase"==e.Name&&e.Sheet==r&&(a=e)}));var s=Wp(t)+"!"+Vp(n["!autofilter"].ref);a?a.Ref=s:e.Workbook.Names.push({Name:"_xlnm._FilterDatabase",Sheet:r,Ref:s})}}))}var EC=/<\w+:workbook/;function vC(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,a="xmlns",s={},i=0;if(e.replace(Kf,(function(o,c){var l=Qf(o);switch(Zf(l[0])){case"<?xml":break;case"<workbook":o.match(EC)&&(a="xmlns"+o.match(/<(\w+):/)[1]),r.xmlns=l[a];break;case"</workbook>":break;case"<fileVersion":delete l[0],r.AppVersion=l;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":sC.forEach((function(e){if(null!=l[e[0]])switch(e[2]){case"bool":r.WBProps[e[0]]=fd(l[e[0]]);break;case"int":r.WBProps[e[0]]=parseInt(l[e[0]],10);break;default:r.WBProps[e[0]]=l[e[0]]}})),l.codeName&&(r.WBProps.CodeName=Ed(l.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete l[0],r.WBView.push(l);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(l.state){case"hidden":l.Hidden=1;break;case"veryHidden":l.Hidden=2;break;default:l.Hidden=0}delete l.state,l.name=rd(Ed(l.name)),delete l[0],r.Sheets.push(l);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":s={},s.Name=Ed(l.name),l.comment&&(s.Comment=l.comment),l.localSheetId&&(s.Sheet=+l.localSheetId),fd(l.hidden||"0")&&(s.Hidden=!0),i=c+o.length;break;case"</definedName>":s.Ref=rd(Ed(e.slice(i,c))),r.Names.push(s);break;case"<definedName/>":break;case"<calcPr":delete l[0],r.CalcPr=l;break;case"<calcPr/>":delete l[0],r.CalcPr=l;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&t.WTF)throw new Error("unrecognized "+l[0]+" in workbook")}return o})),-1===_d.indexOf(r.xmlns))throw new Error("Unknown Namespace: "+r.xmlns);return hC(r),r}function TC(e){var t=[zf];t[t.length]=Od("workbook",null,{xmlns:_d[0],"xmlns:r":kd.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(sC.forEach((function(t){null!=e.Workbook.WBProps[t[0]]&&e.Workbook.WBProps[t[0]]!=t[1]&&(n[t[0]]=e.Workbook.WBProps[t[0]])})),e.Workbook.WBProps.CodeName&&(n.codeName=e.Workbook.WBProps.CodeName,delete n.CodeName)),t[t.length]=Od("workbookPr",null,n);var a=e.Workbook&&e.Workbook.Sheets||[],s=0;if(a&&a[0]&&a[0].Hidden){for(t[t.length]="<bookViews>",s=0;s!=e.SheetNames.length;++s){if(!a[s])break;if(!a[s].Hidden)break}s==e.SheetNames.length&&(s=0),t[t.length]='<workbookView firstSheet="'+s+'" activeTab="'+s+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",s=0;s!=e.SheetNames.length;++s){var i={name:sd(e.SheetNames[s].slice(0,31))};if(i.sheetId=""+(s+1),i["r:id"]="rId"+(s+1),a[s])switch(a[s].Hidden){case 1:i.state="hidden";break;case 2:i.state="veryHidden";break}t[t.length]=Od("sheet",null,i)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach((function(e){var r={name:e.Name};e.Comment&&(r.comment=e.Comment),null!=e.Sheet&&(r.localSheetId=""+e.Sheet),e.Hidden&&(r.hidden="1"),e.Ref&&(t[t.length]=Od("definedName",sd(e.Ref),r))})),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function SC(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=pm(e,t-8),r.name=Jp(e),r}function AC(e,t){return t||(t=Sp(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),mm(e.strRelID,t),Qp(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function RC(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var a=t>8?Jp(e):"";return a.length>0&&(r.CodeName=a),r.autoCompressPictures=!!(65536&n),r.backupFile=!!(64&n),r.checkCompatibility=!!(4096&n),r.date1904=!!(1&n),r.filterPrivacy=!!(8&n),r.hidePivotFieldList=!!(1024&n),r.promptedSolutions=!!(16&n),r.publishItems=!!(2048&n),r.refreshAllConnections=!!(262144&n),r.saveExternalLinkValues=!!(128&n),r.showBorderUnselectedTables=!!(4&n),r.showInkAnnotation=!!(32&n),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(32768&n),r.updateLinks=["userSet","never","always"][n>>8&3],r}function yC(e,t){t||(t=Sp(72));var r=0;return e&&(e.date1904&&(r|=1),e.filterPrivacy&&(r|=8)),t.write_shift(4,r),t.write_shift(4,0),um(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function NC(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function wC(e,t,r){var n=e.l+t,a=e.read_shift(4);e.l+=1;var s=e.read_shift(4),i=dm(e),o=CN(e,0,r),c=hm(e);32&a&&(i="_xlnm."+i),e.l=n;var l={Name:i,Ptg:o,Flags:a};return s<268435455&&(l.Sheet=s),c&&(l.Comment=c),l}function bC(e,t){var r=Sp(9),n=0,a=e.Name;Zm.indexOf(a)>-1&&(n|=32,a=a.slice(6)),r.write_shift(4,n),r.write_shift(1,0),r.write_shift(4,null==e.Sheet?4294967295:e.Sheet);var s=[r,Qp(a),YN(e.Ref,t)];if(e.Comment)s.push(fm(e.Comment));else{var i=Sp(4);i.write_shift(4,4294967295),s.push(i)}return _u(s)}function CC(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],a=!1;t||(t={}),t.biff=12;var s=[],i=[[]];return i.SheetNames=[],i.XTI=[],DO[16]={n:"BrtFRTArchID$",f:NC},Ap(e,(function(e,o,c){switch(c){case 156:i.SheetNames.push(e.name),r.Sheets.push(e);break;case 153:r.WBProps=e;break;case 39:null!=e.Sheet&&(t.SID=e.Sheet),e.Ref=mN(e.Ptg,null,null,i,t),delete t.SID,delete e.Ptg,s.push(e);break;case 1036:break;case 357:case 358:case 355:case 667:i[0].length?i.push([c,e]):i[0]=[c,e],i[i.length-1].XTI=[];break;case 362:0===i.length&&(i[0]=[],i[0].XTI=[]),i[i.length-1].XTI=i[i.length-1].XTI.concat(e),i.XTI=i.XTI.concat(e);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(c),a=!0;break;case 36:n.pop(),a=!1;break;case 37:n.push(c),a=!0;break;case 38:n.pop(),a=!1;break;case 16:break;default:if(o.T);else if(!a||t.WTF&&37!=n[n.length-1]&&35!=n[n.length-1])throw new Error("Unexpected record 0x"+c.toString(16))}}),t),hC(r),r.Names=s,r.supbooks=i,r}function OC(e,t){yp(e,143);for(var r=0;r!=t.SheetNames.length;++r){var n=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,a={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};yp(e,156,AC(a))}yp(e,144)}function IC(e,t){t||(t=Sp(127));for(var r=0;4!=r;++r)t.write_shift(4,0);return Qp("SheetJS",t),Qp(ru.version,t),Qp(ru.version,t),Qp("7262",t),t.length>t.l?t.slice(0,t.l):t}function MC(e,t){t||(t=Sp(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function DC(e,t){if(t.Workbook&&t.Workbook.Sheets){for(var r=t.Workbook.Sheets,n=0,a=-1,s=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&-1==a?a=n:1==r[n].Hidden&&-1==s&&(s=n);s>a||(yp(e,135),yp(e,158,MC(a)),yp(e,136))}}function LC(e,t){t.Workbook&&t.Workbook.Names&&t.Workbook.Names.forEach((function(r){try{if(14&r.Flags)return;yp(e,39,bC(r,t))}catch(n){console.error("Could not serialize defined name "+JSON.stringify(r))}}))}function kC(e){var t=e.SheetNames.length,r=Sp(12*t+28);r.write_shift(4,t+2),r.write_shift(4,0),r.write_shift(4,-2),r.write_shift(4,-2),r.write_shift(4,0),r.write_shift(4,-1),r.write_shift(4,-1);for(var n=0;n<t;++n)r.write_shift(4,0),r.write_shift(4,n),r.write_shift(4,n);return r}function _C(e,t){yp(e,353),yp(e,357),yp(e,362,kC(t,0)),yp(e,354)}function UC(e,t){var r=Rp();return yp(r,131),yp(r,128,IC()),yp(r,153,yC(e.Workbook&&e.Workbook.WBProps||null)),DC(r,e,t),OC(r,e,t),_C(r,e),(e.Workbook||{}).Names&&LC(r,e),yp(r,132),r.end()}function xC(e,t,r){return".bin"===t.slice(-4)?CC(e,r):vC(e,r)}function FC(e,t,r,n,a,s,i,o){return".bin"===t.slice(-4)?Vb(e,n,r,a,s,i,o):pw(e,n,r,a,s,i,o)}function PC(e,t,r,n,a,s,i,o){return".bin"===t.slice(-4)?aC(e,n,r,a,s,i,o):rC(e,n,r,a,s,i,o)}function BC(e,t,r,n,a,s,i,o){return".bin"===t.slice(-4)?LR(e,n,r,a,s,i,o):kR(e,n,r,a,s,i,o)}function YC(e,t,r,n,a,s,i,o){return".bin"===t.slice(-4)?MR(e,n,r,a,s,i,o):DR(e,n,r,a,s,i,o)}function VC(e,t,r,n){return".bin"===t.slice(-4)?EA(e,r,n):eA(e,r,n)}function WC(e,t,r){return".bin"===t.slice(-4)?XT(e,r):HT(e,r)}function GC(e,t,r){return".bin"===t.slice(-4)?NR(e,r):pR(e,r)}function HC(e,t,r){return".bin"===t.slice(-4)?oR(e,t,r):sR(e,t,r)}function zC(e,t,r,n){return".bin"===r.slice(-4)?lR(e,t,r,n):cR(e,t,r,n)}function $C(e,t,r){return".bin"===t.slice(-4)?tR(e,t,r):nR(e,t,r)}var jC,XC=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,KC=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function qC(e,t){var r=e.split(/\s+/),n=[];if(t||(n[0]=r[0]),1===r.length)return n;var a,s,i,o,c=e.match(XC);if(c)for(o=0;o!=c.length;++o)a=c[o].match(KC),-1===(s=a[1].indexOf(":"))?n[a[1]]=a[2].slice(1,a[2].length-1):(i="xmlns:"===a[1].slice(0,6)?"xmlns"+a[1].slice(6):a[1].slice(s+1),n[i]=a[2].slice(1,a[2].length-1));return n}function JC(e){var t=e.split(/\s+/),r={};if(1===t.length)return r;var n,a,s,i,o=e.match(XC);if(o)for(i=0;i!=o.length;++i)n=o[i].match(KC),-1===(a=n[1].indexOf(":"))?r[n[1]]=n[2].slice(1,n[2].length-1):(s="xmlns:"===n[1].slice(0,6)?"xmlns"+n[1].slice(6):n[1].slice(a+1),r[s]=n[2].slice(1,n[2].length-1));return r}function QC(e,t){var r=jC[e]||rd(e);return"General"===r?uh(t):Wh(r,t)}function ZC(e,t,r,n){var a=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":a=fd(n);break;case"i2":case"int":a=parseInt(n,10);break;case"r4":case"float":a=parseFloat(n);break;case"date":case"dateTime.tz":a=Rf(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[rd(t)]=a}function eO(e,t,r){if("z"!==e.t){if(!r||!1!==r.cellText)try{"e"===e.t?e.w=e.w||Jm[e.v]:"General"===t?"n"===e.t?(0|e.v)===e.v?e.w=e.v.toString(10):e.w=lh(e.v):e.w=uh(e.v):e.w=QC(t||"General",e.v)}catch(s){if(r.WTF)throw s}try{var n=jC[t]||t||"General";if(r.cellNF&&(e.z=n),r.cellDates&&"n"==e.t&&Fh(n)){var a=eh(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}catch(s){if(r.WTF)throw s}}}function tO(e,t,r){if(r.cellStyles&&t.Interior){var n=t.Interior;n.Pattern&&(n.patternType=HS[n.Pattern]||n.Pattern)}e[t.ID]=t}function rO(e,t,r,n,a,s,i,o,c,l){var u="General",h=n.StyleID,f={};l=l||{};var d=[],p=0;void 0===h&&o&&(h=o.StyleID),void 0===h&&i&&(h=i.StyleID);while(void 0!==s[h]){if(s[h].nf&&(u=s[h].nf),s[h].Interior&&d.push(s[h].Interior),!s[h].Parent)break;h=s[h].Parent}switch(r.Type){case"Boolean":n.t="b",n.v=fd(e);break;case"String":n.t="s",n.r=ud(rd(e)),n.v=e.indexOf("<")>-1?rd(t||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":"Z"!=e.slice(-1)&&(e+="Z"),n.v=(Rf(e)-new Date(Date.UTC(1899,11,30)))/864e5,n.v!==n.v?n.v=rd(e):n.v<60&&(n.v=n.v-1),u&&"General"!=u||(u="yyyy-mm-dd");case"Number":void 0===n.v&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=Qm[e],!1!==l.cellText&&(n.w=e);break;default:""==e&&""==t?n.t="z":(n.t="s",n.v=ud(t||e));break}if(eO(n,u,l),!1!==l.cellFormula)if(n.Formula){var m=rd(n.Formula);61==m.charCodeAt(0)&&(m=m.slice(1)),n.f=_R(m,a),delete n.Formula,"RC"==n.ArrayRange?n.F=_R("RC:RC",a):n.ArrayRange&&(n.F=_R(n.ArrayRange,a),c.push([Gp(n.F),n.F]))}else for(p=0;p<c.length;++p)a.r>=c[p][0].s.r&&a.r<=c[p][0].e.r&&a.c>=c[p][0].s.c&&a.c<=c[p][0].e.c&&(n.F=c[p][1]);l.cellStyles&&(d.forEach((function(e){!f.patternType&&e.patternType&&(f.patternType=e.patternType)})),n.s=f),void 0!==n.StyleID&&(n.ixfe=n.StyleID)}function nO(e){return Zm.indexOf("_xlnm."+e)>-1?"_xlnm."+e:e}function aO(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,"\n").replace(/\r/g,"\n"),e.v=e.w=e.ixfe=void 0}function sO(e,t){var r=t||{};zh();var n=pu(Dd(e));"binary"!=r.type&&"array"!=r.type&&"base64"!=r.type||(n="undefined"!==typeof ql?ql.utils.decode(65001,hu(n)):Ed(n));var a,s=n.slice(0,1024).toLowerCase(),i=!1;if(s=s.replace(/".*?"/g,""),(1023&s.indexOf(">"))>Math.min(1023&s.indexOf(","),1023&s.indexOf(";"))){var o=Nf(r);return o.type="string",DT.to_workbook(n,o)}if(-1==s.indexOf("<?xml")&&["html","table","head","meta","script","style","div"].forEach((function(e){s.indexOf("<"+e)>=0&&(i=!0)})),i)return rI(n,r);jC={"General Number":"General","General Date":qu[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":qu[15],"Short Date":qu[14],"Long Time":qu[19],"Medium Time":qu[18],"Short Time":qu[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:qu[2],Standard:qu[4],Percent:qu[10],Scientific:qu[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var c,l=[];null!=vu&&null==r.dense&&(r.dense=vu);var u={},h=[],f={},d="";r.dense&&(f["!data"]=[]);var p,m={},g={},E=qC('<Data ss:Type="String">'),v=0,T=0,S=0,A={s:{r:2e6,c:2e6},e:{r:0,c:0}},R={},y={},N="",w=0,b=[],C={},O={},I=0,M=[],D=[],L={},k=[],_=!1,U=[],x=[],F={},P=0,B=0,Y={Sheets:[],WBProps:{date1904:!1}},V={};Ld.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/gm,"");var W="";while(a=Ld.exec(n))switch(a[3]=(W=a[3]).toLowerCase()){case"data":if("data"==W){if("/"===a[1]){if((c=l.pop())[0]!==a[3])throw new Error("Bad state: "+c.join("|"))}else"/"!==a[0].charAt(a[0].length-2)&&l.push([a[3],!0]);break}if(l[l.length-1][1])break;"/"===a[1]?rO(n.slice(v,a.index),N,E,"comment"==l[l.length-1][0]?L:m,{c:T,r:S},R,k[T],g,U,r):(N="",E=qC(a[0]),v=a.index+a[0].length);break;case"cell":if("/"===a[1])if(D.length>0&&(m.c=D),(!r.sheetRows||r.sheetRows>S)&&void 0!==m.v&&(r.dense?(f["!data"][S]||(f["!data"][S]=[]),f["!data"][S][T]=m):f[kp(T)+Ip(S)]=m),m.HRef&&(m.l={Target:rd(m.HRef)},m.HRefScreenTip&&(m.l.Tooltip=m.HRefScreenTip),delete m.HRef,delete m.HRefScreenTip),(m.MergeAcross||m.MergeDown)&&(P=T+(0|parseInt(m.MergeAcross,10)),B=S+(0|parseInt(m.MergeDown,10)),(P>T||B>S)&&b.push({s:{c:T,r:S},e:{c:P,r:B}})),r.sheetStubs)if(m.MergeAcross||m.MergeDown){for(var G=T;G<=P;++G)for(var H=S;H<=B;++H)(G>T||H>S)&&(r.dense?(f["!data"][H]||(f["!data"][H]=[]),f["!data"][H][G]={t:"z"}):f[kp(G)+Ip(H)]={t:"z"});T=P+1}else++T;else m.MergeAcross?T=P+1:++T;else m=JC(a[0]),m.Index&&(T=+m.Index-1),T<A.s.c&&(A.s.c=T),T>A.e.c&&(A.e.c=T),"/>"===a[0].slice(-2)&&++T,D=[];break;case"row":"/"===a[1]||"/>"===a[0].slice(-2)?(S<A.s.r&&(A.s.r=S),S>A.e.r&&(A.e.r=S),"/>"===a[0].slice(-2)&&(g=qC(a[0]),g.Index&&(S=+g.Index-1)),T=0,++S):(g=qC(a[0]),g.Index&&(S=+g.Index-1),F={},("0"==g.AutoFitHeight||g.Height)&&(F.hpx=parseInt(g.Height,10),F.hpt=WS(F.hpx),x[S]=F),"1"==g.Hidden&&(F.hidden=!0,x[S]=F));break;case"worksheet":if("/"===a[1]){if((c=l.pop())[0]!==a[3])throw new Error("Bad state: "+c.join("|"));h.push(d),A.s.r<=A.e.r&&A.s.c<=A.e.c&&(f["!ref"]=Yp(A),r.sheetRows&&r.sheetRows<=A.e.r&&(f["!fullref"]=f["!ref"],A.e.r=r.sheetRows-1,f["!ref"]=Yp(A))),b.length&&(f["!merges"]=b),k.length>0&&(f["!cols"]=k),x.length>0&&(f["!rows"]=x),u[d]=f}else A={s:{r:2e6,c:2e6},e:{r:0,c:0}},S=T=0,l.push([a[3],!1]),c=qC(a[0]),d=rd(c.Name),f={},r.dense&&(f["!data"]=[]),b=[],U=[],x=[],V={name:d,Hidden:0},Y.Sheets.push(V);break;case"table":if("/"===a[1]){if((c=l.pop())[0]!==a[3])throw new Error("Bad state: "+c.join("|"))}else{if("/>"==a[0].slice(-2))break;l.push([a[3],!1]),k=[],_=!1}break;case"style":"/"===a[1]?tO(R,y,r):y=qC(a[0]);break;case"numberformat":y.nf=rd(qC(a[0]).Format||"General"),jC[y.nf]&&(y.nf=jC[y.nf]);for(var z=0;392!=z;++z)if(qu[z]==y.nf)break;if(392==z)for(z=57;392!=z;++z)if(null==qu[z]){Qh(y.nf,z);break}break;case"column":if("table"!==l[l.length-1][0])break;if("/"===a[1])break;if(p=qC(a[0]),p.Hidden&&(p.hidden=!0,delete p.Hidden),p.Width&&(p.wpx=parseInt(p.Width,10)),!_&&p.wpx>10){_=!0,kS=MS;for(var $=0;$<k.length;++$)k[$]&&BS(k[$])}_&&BS(p),k[p.Index-1||k.length]=p;for(var j=0;j<+p.Span;++j)k[k.length]=Nf(p);break;case"namedrange":if("/"===a[1])break;Y.Names||(Y.Names=[]);var X=Qf(a[0]),K={Name:nO(X.Name),Ref:_R(X.RefersTo.slice(1),{r:0,c:0})};Y.Sheets.length>0&&(K.Sheet=Y.Sheets.length-1),Y.Names.push(K);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if("/>"===a[0].slice(-2))break;"/"===a[1]?N+=n.slice(w,a.index):w=a.index+a[0].length;break;case"interior":if(!r.cellStyles)break;y.Interior=qC(a[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if("/>"===a[0].slice(-2))break;"/"===a[1]?Lg(C,W,n.slice(I,a.index)):I=a.index+a[0].length;break;case"paragraphs":break;case"styles":case"workbook":if("/"===a[1]){if((c=l.pop())[0]!==a[3])throw new Error("Bad state: "+c.join("|"))}else l.push([a[3],!1]);break;case"comment":if("/"===a[1]){if((c=l.pop())[0]!==a[3])throw new Error("Bad state: "+c.join("|"));aO(L),D.push(L)}else l.push([a[3],!1]),c=qC(a[0]),L={a:c.Author};break;case"autofilter":if("/"===a[1]){if((c=l.pop())[0]!==a[3])throw new Error("Bad state: "+c.join("|"))}else if("/"!==a[0].charAt(a[0].length-2)){var q=qC(a[0]);f["!autofilter"]={ref:_R(q.Range).replace(/\$/g,"")},l.push([a[3],!0])}break;case"name":break;case"datavalidation":if("/"===a[1]){if((c=l.pop())[0]!==a[3])throw new Error("Bad state: "+c.join("|"))}else"/"!==a[0].charAt(a[0].length-2)&&l.push([a[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if("/"===a[1]){if((c=l.pop())[0]!==a[3])throw new Error("Bad state: "+c.join("|"))}else"/"!==a[0].charAt(a[0].length-2)&&l.push([a[3],!0]);break;case"null":break;default:if(0==l.length&&"document"==a[3])return pI(n,r);if(0==l.length&&"uof"==a[3])return pI(n,r);var J=!0;switch(l[l.length-1][0]){case"officedocumentsettings":switch(a[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:J=!1}break;case"componentoptions":switch(a[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:J=!1}break;case"excelworkbook":switch(a[3]){case"date1904":Y.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:J=!1}break;case"workbookoptions":switch(a[3]){case"owcversion":break;case"height":break;case"width":break;default:J=!1}break;case"worksheetoptions":switch(a[3]){case"visible":if("/>"===a[0].slice(-2));else if("/"===a[1])switch(n.slice(I,a.index)){case"SheetHidden":V.Hidden=1;break;case"SheetVeryHidden":V.Hidden=2;break}else I=a.index+a[0].length;break;case"header":f["!margins"]||ZN(f["!margins"]={},"xlml"),isNaN(+Qf(a[0]).Margin)||(f["!margins"].header=+Qf(a[0]).Margin);break;case"footer":f["!margins"]||ZN(f["!margins"]={},"xlml"),isNaN(+Qf(a[0]).Margin)||(f["!margins"].footer=+Qf(a[0]).Margin);break;case"pagemargins":var Q=Qf(a[0]);f["!margins"]||ZN(f["!margins"]={},"xlml"),isNaN(+Q.Top)||(f["!margins"].top=+Q.Top),isNaN(+Q.Left)||(f["!margins"].left=+Q.Left),isNaN(+Q.Right)||(f["!margins"].right=+Q.Right),isNaN(+Q.Bottom)||(f["!margins"].bottom=+Q.Bottom);break;case"displayrighttoleft":Y.Views||(Y.Views=[]),Y.Views[0]||(Y.Views[0]={}),Y.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":f["!outline"]||(f["!outline"]={}),f["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":f["!outline"]||(f["!outline"]={}),f["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:J=!1}break;case"pivottable":case"pivotcache":switch(a[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:J=!1}break;case"pagebreaks":switch(a[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:J=!1}break;case"autofilter":switch(a[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:J=!1}break;case"querytable":switch(a[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:J=!1}break;case"datavalidation":switch(a[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:J=!1}break;case"sorting":case"conditionalformatting":switch(a[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:J=!1}break;case"mapinfo":case"schema":case"data":switch(a[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:J=!1}break;case"smarttags":break;default:J=!1;break}if(J)break;if(a[3].match(/!\[CDATA/))break;if(!l[l.length-1][1])throw"Unrecognized tag: "+a[3]+"|"+l.join("|");if("customdocumentproperties"===l[l.length-1][0]){if("/>"===a[0].slice(-2))break;"/"===a[1]?ZC(O,W,M,n.slice(I,a.index)):(M=a,I=a.index+a[0].length);break}if(r.WTF)throw"Unrecognized tag: "+a[3]+"|"+l.join("|")}var Z={};return r.bookSheets||r.bookProps||(Z.Sheets=u),Z.SheetNames=h,Z.Workbook=Y,Z.SSF=Nf(qu),Z.Props=C,Z.Custprops=O,Z.bookType="xlml",Z}function iO(e,t){switch(vM(t=t||{}),t.type||"base64"){case"base64":return sO(yu(e),t);case"binary":case"buffer":case"file":return sO(e,t);case"array":return sO(Du(e),t)}}function oO(e,t){var r=[];return e.Props&&r.push(kg(e.Props,t)),e.Custprops&&r.push(_g(e.Props,e.Custprops,t)),r.join("")}function cO(e){return(((e||{}).Workbook||{}).WBProps||{}).date1904?'<ExcelWorkbook xmlns="urn:schemas-microsoft-com:office:excel"><Date1904/></ExcelWorkbook>':""}function lO(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach((function(e,t){var n=[];n.push(Od("NumberFormat",null,{"ss:Format":sd(qu[e.numFmtId])}));var a={"ss:ID":"s"+(21+t)};r.push(Od("Style",n.join(""),a))})),Od("Styles",r.join(""))}function uO(e){return Od("NamedRange",null,{"ss:Name":"_xlnm."==e.Name.slice(0,6)?e.Name.slice(6):e.Name,"ss:RefersTo":"="+xR(e.Ref,{r:0,c:0})})}function hO(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],n=0;n<t.length;++n){var a=t[n];null==a.Sheet&&(a.Name.match(/^_xlfn\./)||r.push(uO(a)))}return Od("Names",r.join(""))}function fO(e,t,r,n){if(!e)return"";if(!((n||{}).Workbook||{}).Names)return"";for(var a=n.Workbook.Names,s=[],i=0;i<a.length;++i){var o=a[i];o.Sheet==r&&(o.Name.match(/^_xlfn\./)||s.push(uO(o)))}return s.join("")}function dO(e,t,r,n){if(!e)return"";var a=[];if(e["!margins"]&&(a.push("<PageSetup>"),e["!margins"].header&&a.push(Od("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&a.push(Od("Footer",null,{"x:Margin":e["!margins"].footer})),a.push(Od("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),a.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)a.push(Od("Visible",1==n.Workbook.Sheets[r].Hidden?"SheetHidden":"SheetVeryHidden",{}));else{for(var s=0;s<r;++s)if(n.Workbook.Sheets[s]&&!n.Workbook.Sheets[s].Hidden)break;s==r&&a.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&a.push("<DisplayRightToLeft/>"),e["!protect"]&&(a.push(bd("ProtectContents","True")),e["!protect"].objects&&a.push(bd("ProtectObjects","True")),e["!protect"].scenarios&&a.push(bd("ProtectScenarios","True")),null==e["!protect"].selectLockedCells||e["!protect"].selectLockedCells?null==e["!protect"].selectUnlockedCells||e["!protect"].selectUnlockedCells||a.push(bd("EnableSelection","UnlockedCells")):a.push(bd("EnableSelection","NoSelection")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach((function(t){e["!protect"][t[0]]&&a.push("<"+t[1]+"/>")}))),0==a.length?"":Od("WorksheetOptions",a.join(""),{xmlns:Ud.x})}function pO(e){return e.map((function(e){var t=hd(e.t||""),r=Od("ss:Data",t,{xmlns:"http://www.w3.org/TR/REC-html40"});return Od("Comment",r,{"ss:Author":e.a})})).join("")}function mO(e,t,r,n,a,s,i){if(!e||void 0==e.v&&void 0==e.f)return"";var o={};if(e.f&&(o["ss:Formula"]="="+sd(xR(e.f,i))),e.F&&e.F.slice(0,t.length)==t){var c=Fp(e.F.slice(t.length+1));o["ss:ArrayRange"]="RC:R"+(c.r==i.r?"":"["+(c.r-i.r)+"]")+"C"+(c.c==i.c?"":"["+(c.c-i.c)+"]")}if(e.l&&e.l.Target&&(o["ss:HRef"]=sd(e.l.Target),e.l.Tooltip&&(o["x:HRefScreenTip"]=sd(e.l.Tooltip))),r["!merges"])for(var l=r["!merges"],u=0;u!=l.length;++u)l[u].s.c==i.c&&l[u].s.r==i.r&&(l[u].e.c>l[u].s.c&&(o["ss:MergeAcross"]=l[u].e.c-l[u].s.c),l[u].e.r>l[u].s.r&&(o["ss:MergeDown"]=l[u].e.r-l[u].s.r));var h="",f="";switch(e.t){case"z":if(!n.sheetStubs)return"";break;case"n":h="Number",f=String(e.v);break;case"b":h="Boolean",f=e.v?"1":"0";break;case"e":h="Error",f=Jm[e.v];break;case"d":h="DateTime",f=new Date(e.v).toISOString(),null==e.z&&(e.z=e.z||qu[14]);break;case"s":h="String",f=ld(e.v||"");break}var d=ew(n.cellXfs,e,n);o["ss:StyleID"]="s"+(21+d),o["ss:Index"]=i.c+1;var p=null!=e.v?f:"",m="z"==e.t?"":'<Data ss:Type="'+h+'">'+p+"</Data>";return(e.c||[]).length>0&&(m+=pO(e.c)),Od("Cell",m,o)}function gO(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=GS(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function EO(e,t,r,n){if(!e["!ref"])return"";var a=Gp(e["!ref"]),s=e["!merges"]||[],i=0,o=[];e["!cols"]&&e["!cols"].forEach((function(e,t){BS(e);var r=!!e.width,n=QN(t,e),a={"ss:Index":t+1};r&&(a["ss:Width"]=_S(n.width)),e.hidden&&(a["ss:Hidden"]="1"),o.push(Od("Column",null,a))}));for(var c=null!=e["!data"],l=a.s.r;l<=a.e.r;++l){for(var u=[gO(l,(e["!rows"]||[])[l])],h=a.s.c;h<=a.e.c;++h){var f=!1;for(i=0;i!=s.length;++i)if(!(s[i].s.c>h)&&!(s[i].s.r>l)&&!(s[i].e.c<h)&&!(s[i].e.r<l)){s[i].s.c==h&&s[i].s.r==l||(f=!0);break}if(!f){var d={r:l,c:h},p=kp(h)+Ip(l),m=c?(e["!data"][l]||[])[h]:e[p];u.push(mO(m,p,e,t,r,n,d))}}u.push("</Row>"),u.length>2&&o.push(u.join(""))}return o.join("")}function vO(e,t,r){var n=[],a=r.SheetNames[e],s=r.Sheets[a],i=s?fO(s,t,e,r):"";return i.length>0&&n.push("<Names>"+i+"</Names>"),i=s?EO(s,t,e,r):"",i.length>0&&n.push("<Table>"+i+"</Table>"),n.push(dO(s,t,e,r)),s["!autofilter"]&&n.push('<AutoFilter x:Range="'+xR(Vp(s["!autofilter"].ref),{r:0,c:0})+'" xmlns="urn:schemas-microsoft-com:office:excel"></AutoFilter>'),n.join("")}function TO(e,t){t||(t={}),e.SSF||(e.SSF=Nf(qu)),e.SSF&&(zh(),Hh(e.SSF),t.revssf=uf(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],ew(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(oO(e,t)),r.push(cO(e,t)),r.push(""),r.push("");for(var n=0;n<e.SheetNames.length;++n)r.push(Od("Worksheet",vO(n,t,e),{"ss:Name":sd(e.SheetNames[n])}));return r[2]=lO(e,t),r[3]=hO(e,t),zf+Od("Workbook",r.join(""),{xmlns:Ud.ss,"xmlns:o":Ud.o,"xmlns:x":Ud.x,"xmlns:ss":Ud.ss,"xmlns:dt":Ud.dt,"xmlns:html":Ud.html})}function SO(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=Im(r),r.length-r.l<=4)return t;var n=r.read_shift(4);return 0==n||n>40?t:(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4?t:(n=r.read_shift(4),1907505652!==n?t:(t.UnicodeClipboardFormat=Mm(r),n=r.read_shift(4),0==n||n>40?t:(r.l-=4,void(t.Reserved2=r.read_shift(0,"lpwstr"))))))}var AO=[60,1084,2066,2165,2175];function RO(e,t,r,n,a){var s=n,i=[],o=r.slice(r.l,r.l+s);if(a&&a.enc&&a.enc.insitu&&o.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:a.enc.insitu(o)}i.push(o),r.l+=s;var c=op(r,r.l),l=LO[c],u=0;while(null!=l&&AO.indexOf(c)>-1)s=op(r,r.l+2),u=r.l+4,2066==c?u+=4:2165!=c&&2175!=c||(u+=12),o=r.slice(u,r.l+4+s),i.push(o),r.l+=4+s,l=LO[c=op(r,r.l)];var h=_u(i);vp(h,0);var f=0;h.lens=[];for(var d=0;d<i.length;++d)h.lens.push(f),f+=i[d].length;if(h.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+h.length+" < "+n;return t.f(h,h.length,a)}function yO(e,t,r){if("z"!==e.t&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=qu[n])}catch(s){if(t.WTF)throw s}if(!t||!1!==t.cellText)try{"e"===e.t?e.w=e.w||Jm[e.v]:0===n||"General"==n?"n"===e.t?(0|e.v)===e.v?e.w=e.v.toString(10):e.w=lh(e.v):e.w=uh(e.v):e.w=Wh(n,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(s){if(t.WTF)throw s}if(t.cellDates&&n&&"n"==e.t&&Fh(qu[n]||String(n))){var a=eh(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}}function NO(e,t,r){return{v:e,ixfe:t,t:r}}function wO(e,t){var r={opts:{}},n={};null!=vu&&null==t.dense&&(t.dense=vu);var a={};t.dense&&(a["!data"]=[]);var s,i,o,c,l,u,h,f,d={},p={},m=null,g=[],E="",v={},T="",S={},A=[],R=[],y=[],N={Sheets:[],WBProps:{date1904:!1},Views:[{}]},w={},b=function(e){return e<8?qm[e]:e<64&&y[e-8]||qm[e]},C=function(e,t,r){var n,a=t.XF.data;a&&a.patternType&&r&&r.cellStyles&&(t.s={},t.s.patternType=a.patternType,(n=bS(b(a.icvFore)))&&(t.s.fgColor={rgb:n}),(n=bS(b(a.icvBack)))&&(t.s.bgColor={rgb:n}))},O=function(e,t,r){if(!(P>1)&&!(r.sheetRows&&e.r>=r.sheetRows)){if(r.cellStyles&&t.XF&&t.XF.data&&C(e,t,r),delete t.ixfe,delete t.XF,s=e,T=Pp(e),p&&p.s&&p.e||(p={s:{r:0,c:0},e:{r:0,c:0}}),e.r<p.s.r&&(p.s.r=e.r),e.c<p.s.c&&(p.s.c=e.c),e.r+1>p.e.r&&(p.e.r=e.r+1),e.c+1>p.e.c&&(p.e.c=e.c+1),r.cellFormula&&t.f)for(var n=0;n<A.length;++n)if(!(A[n][0].s.c>e.c||A[n][0].s.r>e.r)&&!(A[n][0].e.c<e.c||A[n][0].e.r<e.r)){t.F=Yp(A[n][0]),A[n][0].s.c==e.c&&A[n][0].s.r==e.r||delete t.f,t.f&&(t.f=""+mN(A[n][1],p,e,U,I));break}r.dense?(a["!data"][e.r]||(a["!data"][e.r]=[]),a["!data"][e.r][e.c]=t):a[T]=t}},I={enc:!1,sbcch:0,snames:[],sharedf:S,arrayf:A,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(I.password=t.password);var M=[],D=[],L=[],k=[],_=!1,U=[];U.SheetNames=I.snames,U.sharedf=I.sharedf,U.arrayf=I.arrayf,U.names=[],U.XTI=[];var x,F=0,P=0,B=0,Y=[],V=[];I.codepage=1200,lu(1200);var W=!1;while(e.l<e.length-1){var G=e.l,H=e.read_shift(2);if(0===H&&10===F)break;var z=e.l===e.length?0:e.read_shift(2),$=LO[H];if(0==P&&-1==[9,521,1033,2057].indexOf(H))break;if($&&$.f){if(t.bookSheets&&133===F&&133!==H)break;if(F=H,2===$.r||12==$.r){var j=e.read_shift(2);if(z-=2,!I.enc&&j!==H&&((255&j)<<8|j>>8)!==H)throw new Error("rt mismatch: "+j+"!="+H);12==$.r&&(e.l+=10,z-=10)}var X={};if(X=10===H?$.f(e,z,I):RO(H,$,e,z,I),0==P&&-1===[9,521,1033,2057].indexOf(F))continue;switch(H){case 34:r.opts.Date1904=N.WBProps.date1904=X;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(I.enc||(e.l=0),I.enc=X,!t.password)throw new Error("File is password-protected");if(null==X.valid)throw new Error("Encryption scheme unsupported");if(!X.valid)throw new Error("Password is incorrect");break;case 92:I.lastuser=X;break;case 66:var K=Number(X);switch(K){case 21010:K=1200;break;case 32768:K=1e4;break;case 32769:K=1252;break}lu(I.codepage=K),W=!0;break;case 317:I.rrtabid=X;break;case 25:I.winlocked=X;break;case 439:r.opts["RefreshAll"]=X;break;case 12:r.opts["CalcCount"]=X;break;case 16:r.opts["CalcDelta"]=X;break;case 17:r.opts["CalcIter"]=X;break;case 13:r.opts["CalcMode"]=X;break;case 14:r.opts["CalcPrecision"]=X;break;case 95:r.opts["CalcSaveRecalc"]=X;break;case 15:I.CalcRefMode=X;break;case 2211:r.opts.FullCalc=X;break;case 129:X.fDialog&&(a["!type"]="dialog"),X.fBelow||((a["!outline"]||(a["!outline"]={})).above=!0),X.fRight||((a["!outline"]||(a["!outline"]={})).left=!0);break;case 224:R.push(X);break;case 430:U.push([X]),U[U.length-1].XTI=[];break;case 35:case 547:U[U.length-1].push(X);break;case 24:case 536:x={Name:X.Name,Ref:mN(X.rgce,p,null,U,I)},X.itab>0&&(x.Sheet=X.itab-1),U.names.push(x),U[0]||(U[0]=[],U[0].XTI=[]),U[U.length-1].push(X),"_xlnm._FilterDatabase"==X.Name&&X.itab>0&&X.rgce&&X.rgce[0]&&X.rgce[0][0]&&"PtgArea3d"==X.rgce[0][0][0]&&(V[X.itab-1]={ref:Yp(X.rgce[0][0][1][2])});break;case 22:I.ExternCount=X;break;case 23:0==U.length&&(U[0]=[],U[0].XTI=[]),U[U.length-1].XTI=U[U.length-1].XTI.concat(X),U.XTI=U.XTI.concat(X);break;case 2196:if(I.biff<8)break;null!=x&&(x.Comment=X[1]);break;case 18:a["!protect"]=X;break;case 19:0!==X&&I.WTF&&console.error("Password verifier: "+X);break;case 133:d[X.pos]=X,I.snames.push(X.name);break;case 10:if(--P)break;if(p.e){if(p.e.r>0&&p.e.c>0){if(p.e.r--,p.e.c--,a["!ref"]=Yp(p),t.sheetRows&&t.sheetRows<=p.e.r){var q=p.e.r;p.e.r=t.sheetRows-1,a["!fullref"]=a["!ref"],a["!ref"]=Yp(p),p.e.r=q}p.e.r++,p.e.c++}M.length>0&&(a["!merges"]=M),D.length>0&&(a["!objects"]=D),L.length>0&&(a["!cols"]=L),k.length>0&&(a["!rows"]=k),N.Sheets.push(w)}""===E?v=a:n[E]=a,a={},t.dense&&(a["!data"]=[]);break;case 9:case 521:case 1033:case 2057:if(8===I.biff&&(I.biff={9:2,521:3,1033:4}[H]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[X.BIFFVer]||8),I.biffguess=0==X.BIFFVer,0==X.BIFFVer&&4096==X.dt&&(I.biff=5,W=!0,lu(I.codepage=28591)),8==I.biff&&0==X.BIFFVer&&16==X.dt&&(I.biff=2),P++)break;if(a={},t.dense&&(a["!data"]=[]),I.biff<8&&!W&&(W=!0,lu(I.codepage=t.codepage||1252)),I.biff<5||0==X.BIFFVer&&4096==X.dt){""===E&&(E="Sheet1"),p={s:{r:0,c:0},e:{r:0,c:0}};var J={pos:e.l-z,name:E};d[J.pos]=J,I.snames.push(E)}else E=(d[G]||{name:""}).name;32==X.dt&&(a["!type"]="chart"),64==X.dt&&(a["!type"]="macro"),M=[],D=[],I.arrayf=A=[],L=[],k=[],_=!1,w={Hidden:(d[G]||{hs:0}).hs,name:E};break;case 515:case 3:case 2:"chart"==a["!type"]&&(t.dense?(a["!data"][X.r]||[])[X.c]:a[kp(X.c)+Ip(X.r)])&&++X.c,u={ixfe:X.ixfe,XF:R[X.ixfe]||{},v:X.val,t:"n"},B>0&&(u.z=Y[u.ixfe>>8&63]),yO(u,t,r.opts.Date1904),O({c:X.c,r:X.r},u,t);break;case 5:case 517:u={ixfe:X.ixfe,XF:R[X.ixfe],v:X.val,t:X.t},B>0&&(u.z=Y[u.ixfe>>8&63]),yO(u,t,r.opts.Date1904),O({c:X.c,r:X.r},u,t);break;case 638:u={ixfe:X.ixfe,XF:R[X.ixfe],v:X.rknum,t:"n"},B>0&&(u.z=Y[u.ixfe>>8&63]),yO(u,t,r.opts.Date1904),O({c:X.c,r:X.r},u,t);break;case 189:for(var Q=X.c;Q<=X.C;++Q){var Z=X.rkrec[Q-X.c][0];u={ixfe:Z,XF:R[Z],v:X.rkrec[Q-X.c][1],t:"n"},B>0&&(u.z=Y[u.ixfe>>8&63]),yO(u,t,r.opts.Date1904),O({c:Q,r:X.r},u,t)}break;case 6:case 518:case 1030:if("String"==X.val){m=X;break}if(u=NO(X.val,X.cell.ixfe,X.tt),u.XF=R[u.ixfe],t.cellFormula){var ee=X.formula;if(ee&&ee[0]&&ee[0][0]&&"PtgExp"==ee[0][0][0]){var te=ee[0][0][1][0],re=ee[0][0][1][1],ne=Pp({r:te,c:re});S[ne]?u.f=""+mN(X.formula,p,X.cell,U,I):u.F=((t.dense?(a["!data"][te]||[])[re]:a[ne])||{}).F}else u.f=""+mN(X.formula,p,X.cell,U,I)}B>0&&(u.z=Y[u.ixfe>>8&63]),yO(u,t,r.opts.Date1904),O(X.cell,u,t),m=X;break;case 7:case 519:if(!m)throw new Error("String record expects Formula");m.val=X,u=NO(X,m.cell.ixfe,"s"),u.XF=R[u.ixfe],t.cellFormula&&(u.f=""+mN(m.formula,p,m.cell,U,I)),B>0&&(u.z=Y[u.ixfe>>8&63]),yO(u,t,r.opts.Date1904),O(m.cell,u,t),m=null;break;case 33:case 545:A.push(X);var ae=Pp(X[0].s);if(i=t.dense?(a["!data"][X[0].s.r]||[])[X[0].s.c]:a[ae],t.cellFormula&&i){if(!m)break;if(!ae||!i)break;i.f=""+mN(X[1],p,X[0],U,I),i.F=Yp(X[0])}break;case 1212:if(!t.cellFormula)break;if(T){if(!m)break;S[Pp(m.cell)]=X[0],i=t.dense?(a["!data"][m.cell.r]||[])[m.cell.c]:a[Pp(m.cell)],(i||{}).f=""+mN(X[0],p,s,U,I)}break;case 253:u=NO(g[X.isst].t,X.ixfe,"s"),g[X.isst].h&&(u.h=g[X.isst].h),u.XF=R[u.ixfe],B>0&&(u.z=Y[u.ixfe>>8&63]),yO(u,t,r.opts.Date1904),O({c:X.c,r:X.r},u,t);break;case 513:t.sheetStubs&&(u={ixfe:X.ixfe,XF:R[X.ixfe],t:"z"},B>0&&(u.z=Y[u.ixfe>>8&63]),yO(u,t,r.opts.Date1904),O({c:X.c,r:X.r},u,t));break;case 190:if(t.sheetStubs)for(var se=X.c;se<=X.C;++se){var ie=X.ixfe[se-X.c];u={ixfe:ie,XF:R[ie],t:"z"},B>0&&(u.z=Y[u.ixfe>>8&63]),yO(u,t,r.opts.Date1904),O({c:se,r:X.r},u,t)}break;case 214:case 516:case 4:u=NO(X.val,X.ixfe,"s"),u.XF=R[u.ixfe],B>0&&(u.z=Y[u.ixfe>>8&63]),yO(u,t,r.opts.Date1904),O({c:X.c,r:X.r},u,t);break;case 0:case 512:1===P&&(p=X);break;case 252:g=X;break;case 1054:if(4==I.biff){Y[B++]=X[1];for(var oe=0;oe<B+163;++oe)if(qu[oe]==X[1])break;oe>=163&&Qh(X[1],B+163)}else Qh(X[1],X[0]);break;case 30:Y[B++]=X;for(var ce=0;ce<B+163;++ce)if(qu[ce]==X)break;ce>=163&&Qh(X,B+163);break;case 229:M=M.concat(X);break;case 93:D[X.cmo[0]]=I.lastobj=X;break;case 438:I.lastobj.TxO=X;break;case 127:I.lastobj.ImData=X;break;case 440:for(l=X[0].s.r;l<=X[0].e.r;++l)for(c=X[0].s.c;c<=X[0].e.c;++c)i=t.dense?(a["!data"][l]||[])[c]:a[Pp({c:c,r:l})],i&&(i.l=X[1]);break;case 2048:for(l=X[0].s.r;l<=X[0].e.r;++l)for(c=X[0].s.c;c<=X[0].e.c;++c)i=t.dense?(a["!data"][l]||[])[c]:a[Pp({c:c,r:l})],i&&i.l&&(i.l.Tooltip=X[1]);break;case 28:if(I.biff<=5&&I.biff>=2)break;i=t.dense?(a["!data"][X[0].r]||[])[X[0].c]:a[Pp(X[0])];var le=D[X[2]];i||(t.dense?(a["!data"][X[0].r]||(a["!data"][X[0].r]=[]),i=a["!data"][X[0].r][X[0].c]={t:"z"}):i=a[Pp(X[0])]={t:"z"},p.e.r=Math.max(p.e.r,X[0].r),p.s.r=Math.min(p.s.r,X[0].r),p.e.c=Math.max(p.e.c,X[0].c),p.s.c=Math.min(p.s.c,X[0].c)),i.c||(i.c=[]),o={a:X[1],t:le.TxO.t},i.c.push(o);break;case 2173:jA(R[X.ixfe],X.ext);break;case 125:if(!I.cellStyles)break;while(X.e>=X.s)L[X.e--]={width:X.w/256,level:X.level||0,hidden:!!(1&X.flags)},_||(_=!0,PS(X.w/256)),BS(L[X.e+1]);break;case 520:var ue={};null!=X.level&&(k[X.r]=ue,ue.level=X.level),X.hidden&&(k[X.r]=ue,ue.hidden=!0),X.hpt&&(k[X.r]=ue,ue.hpt=X.hpt,ue.hpx=GS(X.hpt));break;case 38:case 39:case 40:case 41:a["!margins"]||ZN(a["!margins"]={}),a["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[H]]=X;break;case 161:a["!margins"]||ZN(a["!margins"]={}),a["!margins"].header=X.header,a["!margins"].footer=X.footer;break;case 574:X.RTL&&(N.Views[0].RTL=!0);break;case 146:y=X;break;case 2198:f=X;break;case 140:h=X;break;case 442:E?w.CodeName=X||w.name:N.WBProps.CodeName=X||"ThisWorkbook";break}}else $||console.error("Missing Info for XLS Record 0x"+H.toString(16)),e.l+=z}return r.SheetNames=of(d).sort((function(e,t){return Number(e)-Number(t)})).map((function(e){return d[e].name})),t.bookSheets||(r.Sheets=n),!r.SheetNames.length&&v["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets["Sheet1"]=v)):r.Preamble=v,r.Sheets&&V.forEach((function(e,t){r.Sheets[r.SheetNames[t]]["!autofilter"]=e})),r.Strings=g,r.SSF=Nf(qu),I.enc&&(r.Encryption=I.enc),f&&(r.Themes=f),r.Metadata={},void 0!==h&&(r.Metadata.Country=h),U.names.length>0&&(N.Names=U.names),r.Workbook=N,r}var bO={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function CO(e,t,r){var n=tf.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var a=tE(n,Hm,bO.DSI);for(var s in a)t[s]=a[s]}catch(l){if(r.WTF)throw l}var i=tf.find(e,"/!SummaryInformation");if(i&&i.size>0)try{var o=tE(i,zm,bO.SI);for(var c in o)null==t[c]&&(t[c]=o[c])}catch(l){if(r.WTF)throw l}t.HeadingPairs&&t.TitlesOfParts&&(Ng(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function OO(e,t){var r,n=[],a=[],s=[],i=0,o=cf(Hm,"n"),c=cf(zm,"n");if(e.Props)for(r=of(e.Props),i=0;i<r.length;++i)(Object.prototype.hasOwnProperty.call(o,r[i])?n:Object.prototype.hasOwnProperty.call(c,r[i])?a:s).push([r[i],e.Props[r[i]]]);if(e.Custprops)for(r=of(e.Custprops),i=0;i<r.length;++i)Object.prototype.hasOwnProperty.call(e.Props||{},r[i])||(Object.prototype.hasOwnProperty.call(o,r[i])?n:Object.prototype.hasOwnProperty.call(c,r[i])?a:s).push([r[i],e.Custprops[r[i]]]);var l=[];for(i=0;i<s.length;++i)Qg.indexOf(s[i][0])>-1||yg.indexOf(s[i][0])>-1||null!=s[i][1]&&l.push(s[i]);a.length&&tf.utils.cfb_add(t,"/SummaryInformation",rE(a,bO.SI,c,zm)),(n.length||l.length)&&tf.utils.cfb_add(t,"/DocumentSummaryInformation",rE(n,bO.DSI,o,Hm,l.length?l:null,bO.UDI))}function IO(e,t){var r,n,a,s;if(t||(t={}),vM(t),uu(),t.codepage&&ou(t.codepage),e.FullPaths){if(tf.find(e,"/encryption"))throw new Error("File is password-protected");r=tf.find(e,"!CompObj"),n=tf.find(e,"/Workbook")||tf.find(e,"/Book")}else{switch(t.type){case"base64":e=Iu(yu(e));break;case"binary":e=Iu(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}vp(e,0),n={content:e}}if(r&&SO(r),t.bookProps&&!t.bookSheets)a={};else{var i=Nu?"buffer":"array";if(n&&n.content)a=wO(n.content,t);else if((s=tf.find(e,"PerfectOffice_MAIN"))&&s.content)a=kT.to_workbook(s.content,(t.type=i,t));else{if(!(s=tf.find(e,"NativeContent_MAIN"))||!s.content)throw(s=tf.find(e,"MN0"))&&s.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");a=kT.to_workbook(s.content,(t.type=i,t))}t.bookVBA&&e.FullPaths&&tf.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(a.vbaraw=CR(e))}var o={};return e.FullPaths&&CO(e,o,t),a.Props=a.Custprops=o,t.bookFiles&&(a.cfb=e),a}function MO(e,t){var r=t||{},n=tf.utils.cfb_new({root:"R"}),a="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":a="/Workbook",r.biff=8;break;case"biff5":a="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return tf.utils.cfb_add(n,a,JO(e,r)),8==r.biff&&(e.Props||e.Custprops)&&OO(e,n),8==r.biff&&e.vbaraw&&OR(n,tf.read(e.vbaraw,{type:"string"==typeof e.vbaraw?"binary":"buffer"})),n}var DO={0:{f:xw},1:{f:Hw},2:{f:ub},3:{f:Qw},4:{f:Xw},5:{f:ib},6:{f:mb},7:{f:rb},8:{f:Rb},9:{f:Ab},10:{f:Tb},11:{f:Sb},12:{f:$w},13:{f:fb},14:{f:eb},15:{f:qw},16:{f:cb},17:{f:Eb},18:{f:ab},19:{f:tm},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:wC},40:{},42:{},43:{f:aA},44:{f:rA},45:{f:cA},46:{f:dA},47:{f:uA},48:{},49:{f:Kp},50:{},51:{f:qA},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:lT},62:{f:pb},63:{f:iR},64:{f:Bb},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Tp,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:Ub},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:Ww},148:{f:Bw,p:16},151:{f:Ob},152:{},153:{f:RC},154:{},155:{},156:{f:SC},157:{},158:{},159:{T:1,f:jT},160:{T:-1},161:{T:1,f:Sm},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:yb},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:XA},336:{T:-1},337:{f:ZA,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:pm},357:{},358:{},359:{},360:{T:1},361:{},362:{f:Yv},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:Ib},427:{f:Mb},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:kb},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:Vw},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:bb},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:pm},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:RR},633:{T:1},634:{T:-1},635:{T:1,f:SR},636:{T:-1},637:{f:nm},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:nC},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:Yb},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},LO={6:{f:RN},10:{f:nE},12:{f:cE},13:{f:cE},14:{f:iE},15:{f:iE},16:{f:Rm},17:{f:iE},18:{f:iE},19:{f:cE},20:{f:xv},21:{f:xv},23:{f:Yv},24:{f:Bv},25:{f:iE},26:{},27:{},28:{f:jv},29:{},34:{f:iE},35:{f:Pv},38:{f:Rm},39:{f:Rm},40:{f:Rm},41:{f:Rm},42:{f:iE},43:{f:iE},47:{f:SS},49:{f:dv},51:{f:cE},60:{},61:{f:cv},64:{f:iE},65:{f:fv},66:{f:cE},77:{},80:{},81:{},82:{},85:{f:cE},89:{},90:{},91:{},92:{f:qE},93:{f:qv},94:{},95:{f:iE},96:{},97:{},99:{f:iE},125:{f:lT},128:{f:Mv},129:{f:QE},130:{f:cE},131:{f:iE},132:{f:iE},133:{f:ZE},134:{},140:{f:aT},141:{f:cE},144:{},146:{f:oT},151:{},152:{},153:{},154:{},155:{},156:{f:cE},157:{},158:{},160:{f:mT},161:{f:hT},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:wv},190:{f:bv},193:{f:nE},197:{},198:{},199:{},200:{},201:{},202:{f:iE},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:cE},220:{},221:{f:iE},222:{},224:{f:Ov},225:{f:KE},226:{f:nE},227:{},229:{f:Xv},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:tv},253:{f:mv},255:{f:nv},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:uE},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:iE},353:{f:nE},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:Fv},431:{f:iE},432:{},433:{},434:{},437:{},438:{f:Zv},439:{f:iE},440:{f:eT},441:{},442:{f:EE},443:{},444:{f:cE},445:{},446:{},448:{f:nE},449:{f:iv,r:2},450:{f:nE},512:{f:Rv},513:{f:pT},515:{f:_v},516:{f:Ev},517:{f:Lv},519:{f:gT},520:{f:av},523:{},545:{f:Hv},549:{f:ov},566:{},574:{f:uv},638:{f:Nv},659:{},1048:{},1054:{f:Tv},1084:{},1212:{f:Gv},2048:{f:rT},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:jE},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:nE},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:cT,r:12},2173:{f:$A,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:iE,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:Wv,r:12},2197:{},2198:{f:YA,r:12},2199:{},2200:{},2201:{},2202:{f:zv,r:12},2203:{f:nE},2204:{},2205:{},2206:{},2207:{},2211:{f:sv},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:cE},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:fT},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:iT},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:Rv},1:{},2:{f:AT},3:{f:TT},4:{f:vT},5:{f:Lv},7:{f:yT},8:{},9:{f:jE},11:{},22:{f:cE},30:{f:Av},31:{},32:{},33:{f:Hv},36:{},37:{f:ov},50:{f:NT},62:{},52:{},67:{},68:{f:cE},69:{},86:{},126:{},127:{f:ET},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:wT},223:{},234:{},354:{},421:{},518:{f:RN},521:{f:jE},536:{f:Bv},547:{f:Pv},561:{},579:{},1030:{f:RN},1033:{f:jE},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},101:{},102:{},105:{},106:{},107:{},109:{},112:{},114:{},29282:{}};function kO(e,t,r,n){var a=t;if(!isNaN(a)){var s=n||(r||[]).length||0,i=e.next(4);i.write_shift(2,a),i.write_shift(2,s),s>0&&ap(r)&&e.push(r)}}function _O(e,t,r,n){var a=n||(r||[]).length||0;if(a<=8224)return kO(e,t,r,a);var s=t;if(!isNaN(s)){var i=r.parts||[],o=0,c=0,l=0;while(l+(i[o]||8224)<=8224)l+=i[o]||8224,o++;var u=e.next(4);u.write_shift(2,s),u.write_shift(2,l),e.push(r.slice(c,c+l)),c+=l;while(c<a){u=e.next(4),u.write_shift(2,60),l=0;while(l+(i[o]||8224)<=8224)l+=i[o]||8224,o++;u.write_shift(2,l),e.push(r.slice(c,c+l)),c+=l}}}function UO(e,t,r){return e||(e=Sp(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function xO(e,t,r,n){var a=Sp(9);return UO(a,e,t),fE(r,n||"b",a),a}function FO(e,t,r){var n=Sp(8+2*r.length);return UO(n,e,t),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function PO(e,t,r,n){if(null!=t.v)switch(t.t){case"d":case"n":var a="d"==t.t?df(Rf(t.v)):t.v;return void(a==(0|a)&&a>=0&&a<65536?kO(e,2,RT(r,n,a)):kO(e,3,ST(r,n,a)));case"b":case"e":return void kO(e,5,xO(r,n,t.v,t.t));case"s":case"str":return void kO(e,4,FO(r,n,null==t.v?"":String(t.v).slice(0,255)))}kO(e,1,UO(null,r,n))}function BO(e,t,r,n){var a=null!=t["!data"],s=Gp(t["!ref"]||"A1"),i="",o=[];if(s.e.c>255||s.e.r>16383){if(n.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");s.e.c=Math.min(s.e.c,255),s.e.r=Math.min(s.e.c,16383)}for(var c=[],l=s.s.c;l<=s.e.c;++l)o[l]=kp(l);for(var u=s.s.r;u<=s.e.r;++u)for(a&&(c=t["!data"][u]||[]),i=Ip(u),l=s.s.c;l<=s.e.c;++l){var h=a?c[l]:t[o[l]+i];h&&PO(e,h,u,l,n)}}function YO(e,t){for(var r=t||{},n=Rp(),a=0,s=0;s<e.SheetNames.length;++s)e.SheetNames[s]==r.sheet&&(a=s);if(0==a&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return kO(n,4==r.biff?1033:3==r.biff?521:9,XE(e,16,r)),BO(n,e.Sheets[e.SheetNames[a]],a,r,e),kO(n,10),n.end()}function VO(e,t,r){kO(e,49,pv({sz:12,color:{theme:1},name:"Arial",family:2,scheme:"minor"},r))}function WO(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach((function(n){for(var a=n[0];a<=n[1];++a)null!=t[a]&&kO(e,1054,Sv(a,t[a],r))}))}function GO(e,t){var r=Sp(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),kO(e,2151,r),r=Sp(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),PE(Gp(t["!ref"]||"A1"),r),r.write_shift(4,4),kO(e,2152,r)}function HO(e,t){for(var r=0;r<16;++r)kO(e,224,Iv({numFmtId:0,style:!0},0,t));t.cellXfs.forEach((function(r){kO(e,224,Iv(r,0,t))}))}function zO(e,t){for(var r=0;r<t["!links"].length;++r){var n=t["!links"][r];kO(e,440,tT(n)),n[1].Tooltip&&kO(e,2048,nT(n))}delete t["!links"]}function $O(e,t){if(t){var r=0;t.forEach((function(t,n){++r<=256&&t&&kO(e,125,uT(QN(n,t),n))}))}}function jO(e,t,r,n,a){var s=16+ew(a.cellXfs,t,a);if(null!=t.v||t.bf)if(t.bf)kO(e,6,yN(t,r,n,a,s));else switch(t.t){case"d":case"n":var i="d"==t.t?df(Rf(t.v)):t.v;kO(e,515,Uv(r,n,i,s,a));break;case"b":case"e":kO(e,517,kv(r,n,t.v,s,a,t.t));break;case"s":case"str":if(a.bookSST){var o=JN(a.Strings,null==t.v?"":String(t.v),a.revStrings);kO(e,253,gv(r,n,o,s,a))}else kO(e,516,vv(r,n,(null==t.v?"":String(t.v)).slice(0,255),s,a));break;default:kO(e,513,DE(r,n,s))}else kO(e,513,DE(r,n,s))}function XO(e,t,r){var n,a=Rp(),s=r.SheetNames[e],i=r.Sheets[s]||{},o=(r||{}).Workbook||{},c=(o.Sheets||[])[e]||{},l=null!=i["!data"],u=8==t.biff,h="",f=[],d=Gp(i["!ref"]||"A1"),p=u?65536:16384;if(d.e.c>255||d.e.r>=p){if(t.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:IV16384");d.e.c=Math.min(d.e.c,255),d.e.r=Math.min(d.e.c,p-1)}kO(a,2057,XE(r,16,t)),kO(a,13,lE(1)),kO(a,12,lE(100)),kO(a,15,oE(!0)),kO(a,17,oE(!1)),kO(a,16,ym(.001)),kO(a,95,oE(!0)),kO(a,42,oE(!1)),kO(a,43,oE(!1)),kO(a,130,lE(1)),kO(a,128,Dv([0,0])),kO(a,131,oE(!1)),kO(a,132,oE(!1)),u&&$O(a,i["!cols"]),kO(a,512,yv(d,t)),u&&(i["!links"]=[]);for(var m=[],g=[],E=d.s.c;E<=d.e.c;++E)f[E]=kp(E);for(var v=d.s.r;v<=d.e.r;++v)for(l&&(g=i["!data"][v]||[]),h=Ip(v),E=d.s.c;E<=d.e.c;++E){n=f[E]+h;var T=l?g[E]:i[n];T&&(jO(a,T,v,E,t),u&&T.l&&i["!links"].push([n,T.l]),u&&T.c&&m.push([n,T.c]))}var S=c.CodeName||c.name||s;return u&&kO(a,574,hv((o.Views||[])[0])),u&&(i["!merges"]||[]).length&&kO(a,229,Kv(i["!merges"])),u&&zO(a,i),kO(a,442,TE(S,t)),u&&GO(a,i),kO(a,10),a.end()}function KO(e,t,r){var n=Rp(),a=(e||{}).Workbook||{},s=a.Sheets||[],i=a.WBProps||{},o=8==r.biff,c=5==r.biff;if(kO(n,2057,XE(e,5,r)),"xla"==r.bookType&&kO(n,135),kO(n,225,o?lE(1200):null),kO(n,193,aE(2)),c&&kO(n,191),c&&kO(n,192),kO(n,226),kO(n,92,JE("SheetJS",r)),kO(n,66,lE(o?1200:1252)),o&&kO(n,353,lE(0)),o&&kO(n,448),kO(n,317,dT(e.SheetNames.length)),o&&e.vbaraw&&kO(n,211),o&&e.vbaraw){var l=i.CodeName||"ThisWorkbook";kO(n,442,TE(l,r))}kO(n,156,lE(17)),kO(n,25,oE(!1)),kO(n,18,oE(!1)),kO(n,19,lE(0)),o&&kO(n,431,oE(!1)),o&&kO(n,444,lE(0)),kO(n,61,lv(r)),kO(n,64,oE(!1)),kO(n,141,lE(0)),kO(n,34,oE("true"==fC(e))),kO(n,14,oE(!0)),o&&kO(n,439,oE(!1)),kO(n,218,lE(0)),VO(n,e,r),WO(n,e.SSF,r),HO(n,r),o&&kO(n,352,oE(!1));var u=n.end(),h=Rp();o&&kO(h,140,sT()),o&&r.Strings&&_O(h,252,rv(r.Strings,r)),kO(h,10);var f=h.end(),d=Rp(),p=0,m=0;for(m=0;m<e.SheetNames.length;++m)p+=(o?12:11)+(o?2:1)*e.SheetNames[m].length;var g=u.length+p+f.length;for(m=0;m<e.SheetNames.length;++m){var E=s[m]||{};kO(d,133,ev({pos:g,hs:E.Hidden||0,dt:0,name:e.SheetNames[m]},r)),g+=t[m].length}var v=d.end();if(p!=v.length)throw new Error("BS8 "+p+" != "+v.length);var T=[];return u.length&&T.push(u),v.length&&T.push(v),f.length&&T.push(f),_u(T)}function qO(e,t){var r=t||{},n=[];e&&!e.SSF&&(e.SSF=Nf(qu)),e&&e.SSF&&(zh(),Hh(e.SSF),r.revssf=uf(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,TM(r),r.cellXfs=[],ew(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var a=0;a<e.SheetNames.length;++a)n[n.length]=XO(a,r,e);return n.unshift(KO(e,n,r)),_u(n)}function JO(e,t){for(var r=0;r<=e.SheetNames.length;++r){var n=e.Sheets[e.SheetNames[r]];if(n&&n["!ref"]){var a=Bp(n["!ref"]);a.e.c>255&&"undefined"!=typeof console&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var s=t||{};switch(s.biff||2){case 8:case 5:return qO(e,t);case 4:case 3:case 2:return YO(e,t)}throw new Error("invalid type "+s.bookType+" for BIFF")}function QO(e,t){var r=t||{},n=null!=r.dense?r.dense:vu,a={};n&&(a["!data"]=[]),e=e.replace(/<!--.*?-->/g,"");var s=e.match(/<table/i);if(!s)throw new Error("Invalid HTML: could not find <table>");var i=e.match(/<\/table/i),o=s.index,c=i&&i.index||e.length,l=Df(e.slice(o,c),/(:?<tr[^>]*>)/i,"<tr>"),u=-1,h=0,f=0,d=0,p={s:{r:1e7,c:1e7},e:{r:0,c:0}},m=[];for(o=0;o<l.length;++o){var g=l[o].trim(),E=g.slice(0,3).toLowerCase();if("<tr"!=E){if("<td"==E||"<th"==E){var v=g.split(/<\/t[dh]>/i);for(c=0;c<v.length;++c){var T=v[c].trim();if(T.match(/<t[dh]/i)){var S=T,A=0;while("<"==S.charAt(0)&&(A=S.indexOf(">"))>-1)S=S.slice(A+1);for(var R=0;R<m.length;++R){var y=m[R];y.s.c==h&&y.s.r<u&&u<=y.e.r&&(h=y.e.c+1,R=-1)}var N=Qf(T.slice(0,T.indexOf(">")));d=N.colspan?+N.colspan:1,((f=+N.rowspan)>1||d>1)&&m.push({s:{r:u,c:h},e:{r:u+(f||1)-1,c:h+d-1}});var w=N.t||N["data-t"]||"";if(S.length)if(S=Sd(S),p.s.r>u&&(p.s.r=u),p.e.r<u&&(p.e.r=u),p.s.c>h&&(p.s.c=h),p.e.c<h&&(p.e.c=h),S.length){var b={t:"s",v:S};r.raw||!S.trim().length||"s"==w||("TRUE"===S?b={t:"b",v:!0}:"FALSE"===S?b={t:"b",v:!1}:isNaN(bf(S))?isNaN(Mf(S).getDate())||(b={t:"d",v:Rf(S)},r.cellDates||(b={t:"n",v:df(b.v)}),b.z=r.dateNF||qu[14]):b={t:"n",v:bf(S)}),n?(a["!data"][u]||(a["!data"][u]=[]),a["!data"][u][h]=b):a[Pp({r:u,c:h})]=b,h+=d}else h+=d;else h+=d}}}}else{if(++u,r.sheetRows&&r.sheetRows<=u){--u;break}h=0}}return a["!ref"]=Yp(p),m.length&&(a["!merges"]=m),a}function ZO(e,t,r,n){for(var a=e["!merges"]||[],s=[],i={},o=null!=e["!data"],c=t.s.c;c<=t.e.c;++c){for(var l=0,u=0,h=0;h<a.length;++h)if(!(a[h].s.r>r||a[h].s.c>c)&&!(a[h].e.r<r||a[h].e.c<c)){if(a[h].s.r<r||a[h].s.c<c){l=-1;break}l=a[h].e.r-a[h].s.r+1,u=a[h].e.c-a[h].s.c+1;break}if(!(l<0)){var f=kp(c)+Ip(r),d=o?(e["!data"][r]||[])[c]:e[f],p=d&&null!=d.v&&(d.h||cd(d.w||(zp(d),d.w)||""))||"";i={},l>1&&(i.rowspan=l),u>1&&(i.colspan=u),n.editable?p='<span contenteditable="true">'+p+"</span>":d&&(i["data-t"]=d&&d.t||"z",null!=d.v&&(i["data-v"]=d.v),null!=d.z&&(i["data-z"]=d.z),d.l&&"#"!=(d.l.Target||"#").charAt(0)&&(p='<a href="'+d.l.Target+'">'+p+"</a>")),i.id=(n.id||"sjs")+"-"+f,s.push(Od("td",p,i))}}var m="<tr>";return m+s.join("")+"</tr>"}var eI='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',tI="</body></html>";function rI(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||0==r.length)throw new Error("Invalid HTML: could not find <table>");if(1==r.length){var n=$p(QO(r[0],t),t);return n.bookType="html",n}var a=uD();return r.forEach((function(e,r){hD(a,QO(e,t),"Sheet"+(r+1))})),a.bookType="html",a}function nI(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function aI(e,t){var r=t||{},n=null!=r.header?r.header:eI,a=null!=r.footer?r.footer:tI,s=[n],i=Bp(e["!ref"]);s.push(nI(e,i,r));for(var o=i.s.r;o<=i.e.r;++o)s.push(ZO(e,i,o,r));return s.push("</table>"+a),s.join("")}function sI(e,t,r){var n=t.rows;if(!n)throw"Unsupported origin when "+t.tagName+" is not a TABLE";var a=r||{},s=null!=e["!data"],i=0,o=0;if(null!=a.origin)if("number"==typeof a.origin)i=a.origin;else{var c="string"==typeof a.origin?Fp(a.origin):a.origin;i=c.r,o=c.c}var l=Math.min(a.sheetRows||1e7,n.length),u={s:{r:0,c:0},e:{r:i,c:o}};if(e["!ref"]){var h=Bp(e["!ref"]);u.s.r=Math.min(u.s.r,h.s.r),u.s.c=Math.min(u.s.c,h.s.c),u.e.r=Math.max(u.e.r,h.e.r),u.e.c=Math.max(u.e.c,h.e.c),-1==i&&(u.e.r=i=h.e.r+1)}var f=[],d=0,p=e["!rows"]||(e["!rows"]=[]),m=0,g=0,E=0,v=0,T=0,S=0;for(e["!cols"]||(e["!cols"]=[]);m<n.length&&g<l;++m){var A=n[m];if(cI(A)){if(a.display)continue;p[g]={hidden:!0}}var R=A.cells;for(E=v=0;E<R.length;++E){var y=R[E];if(!a.display||!cI(y)){var N=y.hasAttribute("data-v")?y.getAttribute("data-v"):y.hasAttribute("v")?y.getAttribute("v"):Sd(y.innerHTML),w=y.getAttribute("data-z")||y.getAttribute("z");for(d=0;d<f.length;++d){var b=f[d];b.s.c==v+o&&b.s.r<g+i&&g+i<=b.e.r&&(v=b.e.c+1-o,d=-1)}S=+y.getAttribute("colspan")||1,((T=+y.getAttribute("rowspan")||1)>1||S>1)&&f.push({s:{r:g+i,c:v+o},e:{r:g+i+(T||1)-1,c:v+o+(S||1)-1}});var C={t:"s",v:N},O=y.getAttribute("data-t")||y.getAttribute("t")||"";null!=N&&(0==N.length?C.t=O||"z":a.raw||0==N.trim().length||"s"==O||("TRUE"===N?C={t:"b",v:!0}:"FALSE"===N?C={t:"b",v:!1}:isNaN(bf(N))?isNaN(Mf(N).getDate())||(C={t:"d",v:Rf(N)},a.cellDates||(C={t:"n",v:df(C.v)}),C.z=a.dateNF||qu[14]):C={t:"n",v:bf(N)})),void 0===C.z&&null!=w&&(C.z=w);var I="",M=y.getElementsByTagName("A");if(M&&M.length)for(var D=0;D<M.length;++D)if(M[D].hasAttribute("href")&&(I=M[D].getAttribute("href"),"#"!=I.charAt(0)))break;I&&"#"!=I.charAt(0)&&"javascript:"!=I.slice(0,11).toLowerCase()&&(C.l={Target:I}),s?(e["!data"][g+i]||(e["!data"][g+i]=[]),e["!data"][g+i][v+o]=C):e[Pp({c:v+o,r:g+i})]=C,u.e.c<v+o&&(u.e.c=v+o),v+=S}}++g}return f.length&&(e["!merges"]=(e["!merges"]||[]).concat(f)),u.e.r=Math.max(u.e.r,g-1+i),e["!ref"]=Yp(u),g>=l&&(e["!fullref"]=Yp((u.e.r=n.length-m+g-1+i,u))),e}function iI(e,t){var r=t||{},n={};return r.dense&&(n["!data"]=[]),sI(n,e,t)}function oI(e,t){var r=$p(iI(e,t),t);return r}function cI(e){var t="",r=lI(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),"none"===t}function lI(e){return e.ownerDocument.defaultView&&"function"===typeof e.ownerDocument.defaultView.getComputedStyle?e.ownerDocument.defaultView.getComputedStyle:"function"===typeof getComputedStyle?getComputedStyle:null}function uI(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,(function(e,t){return Array(parseInt(t,10)+1).join(" ")})).replace(/<text:tab[^>]*\/>/g,"\t").replace(/<text:line-break\/>/g,"\n"),r=rd(t.replace(/<[^>]*>/g,""));return[r]}function hI(e,t,r){var n=r||{},a=Dd(e);Ld.lastIndex=0,a=a.replace(/<!--([\s\S]*?)-->/gm,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var s,i,o,c="",l="",u=0,h=-1,f="";while(s=Ld.exec(a))switch(s[3]=s[3].replace(/_.*$/,"")){case"number-style":case"currency-style":case"percentage-style":case"date-style":case"time-style":case"text-style":"/"===s[1]?(!1,"false"==i["truncate-on-overflow"]&&(c.match(/h/)?c=c.replace(/h+/,"[$&]"):c.match(/m/)?c=c.replace(/m+/,"[$&]"):c.match(/s/)&&(c=c.replace(/s+/,"[$&]"))),n[i.name]=c,c=""):"/"!==s[0].charAt(s[0].length-2)&&(!0,c="",i=Qf(s[0],!1));break;case"boolean-style":"/"===s[1]?(!1,n[i.name]="General",c=""):"/"!==s[0].charAt(s[0].length-2)&&(!0,c="",i=Qf(s[0],!1));break;case"boolean":c+="General";break;case"text":"/"===s[1]?(f=a.slice(h,Ld.lastIndex-s[0].length),"%"==f&&"<number:percentage-style"==i[0]?c+="%":c+='"'+f.replace(/"/g,'""')+'"'):"/"!==s[0].charAt(s[0].length-2)&&(h=Ld.lastIndex);break;case"day":switch(o=Qf(s[0],!1),o["style"]){case"short":c+="d";break;case"long":c+="dd";break;default:c+="dd";break}break;case"day-of-week":switch(o=Qf(s[0],!1),o["style"]){case"short":c+="ddd";break;case"long":c+="dddd";break;default:c+="ddd";break}break;case"era":switch(o=Qf(s[0],!1),o["style"]){case"short":c+="ee";break;case"long":c+="eeee";break;default:c+="eeee";break}break;case"hours":switch(o=Qf(s[0],!1),o["style"]){case"short":c+="h";break;case"long":c+="hh";break;default:c+="hh";break}break;case"minutes":switch(o=Qf(s[0],!1),o["style"]){case"short":c+="m";break;case"long":c+="mm";break;default:c+="mm";break}break;case"month":switch(o=Qf(s[0],!1),o["textual"]&&(c+="mm"),o["style"]){case"short":c+="m";break;case"long":c+="mm";break;default:c+="m";break}break;case"seconds":switch(o=Qf(s[0],!1),o["style"]){case"short":c+="s";break;case"long":c+="ss";break;default:c+="ss";break}o["decimal-places"]&&(c+="."+wf("0",+o["decimal-places"]));break;case"year":switch(o=Qf(s[0],!1),o["style"]){case"short":c+="yy";break;case"long":c+="yyyy";break;default:c+="yy";break}break;case"am-pm":c+="AM/PM";break;case"week-of-year":case"quarter":console.error("Excel does not support ODS format token "+s[3]);break;case"fill-character":"/"===s[1]?(f=a.slice(h,Ld.lastIndex-s[0].length),c+='"'+f.replace(/"/g,'""')+'"*'):"/"!==s[0].charAt(s[0].length-2)&&(h=Ld.lastIndex);break;case"scientific-number":o=Qf(s[0],!1),c+="0."+wf("0",+o["min-decimal-places"]||+o["decimal-places"]||2)+wf("?",+o["decimal-places"]-+o["min-decimal-places"]||0)+"E"+(fd(o["forced-exponent-sign"])?"+":"")+wf("0",+o["min-exponent-digits"]||2);break;case"fraction":o=Qf(s[0],!1),+o["min-integer-digits"]?c+=wf("0",+o["min-integer-digits"]):c+="#",c+=" ",c+=wf("?",+o["min-numerator-digits"]||1),c+="/",+o["denominator-value"]?c+=o["denominator-value"]:c+=wf("?",+o["min-denominator-digits"]||1);break;case"currency-symbol":"/"===s[1]?c+='"'+a.slice(h,Ld.lastIndex-s[0].length).replace(/"/g,'""')+'"':"/"!==s[0].charAt(s[0].length-2)?h=Ld.lastIndex:c+="$";break;case"text-properties":switch(o=Qf(s[0],!1),(o["color"]||"").toLowerCase().replace("#","")){case"ff0000":case"red":c="[Red]"+c;break}break;case"text-content":c+="@";break;case"map":o=Qf(s[0],!1),"value()>=0"==rd(o["condition"])?c=n[o["apply-style-name"]]+";"+c:console.error("ODS number format may be incorrect: "+o["condition"]);break;case"number":if("/"===s[1])break;o=Qf(s[0],!1),l="",l+=wf("0",+o["min-integer-digits"]||1),fd(o["grouping"])&&(l=dh(wf("#",Math.max(0,4-l.length))+l)),(+o["min-decimal-places"]||+o["decimal-places"])&&(l+="."),+o["min-decimal-places"]&&(l+=wf("0",+o["min-decimal-places"]||1)),+o["decimal-places"]-(+o["min-decimal-places"]||0)&&(l+=wf("0",+o["decimal-places"]-(+o["min-decimal-places"]||0))),c+=l;break;case"embedded-text":"/"===s[1]?0==u?c+='"'+a.slice(h,Ld.lastIndex-s[0].length).replace(/"/g,'""')+'"':c=c.slice(0,u)+'"'+a.slice(h,Ld.lastIndex-s[0].length).replace(/"/g,'""')+'"'+c.slice(u):"/"!==s[0].charAt(s[0].length-2)&&(h=Ld.lastIndex,u=-+Qf(s[0],!1)["position"]||0);break}return n}function fI(e,t,r){var n=t||{};null!=vu&&null==n.dense&&(n.dense=vu);var a,s,i,o,c,l,u,h=Dd(e),f=[],d=0,p={},m=[],g={};n.dense&&(g["!data"]=[]);var E,v={value:""},T="",S=0,A=[],R=-1,y=-1,N={s:{r:1e6,c:1e7},e:{r:0,c:0}},w=0,b=r||{},C={},O=[],I={},M=0,D=0,L=[],k=1,_=1,U=[],x={Names:[],WBProps:{}},F={},P=["",""],B=[],Y={},V="",W=0,G=!1,H=!1,z=0,$=0;Ld.lastIndex=0,h=h.replace(/<!--([\s\S]*?)-->/gm,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");while(l=Ld.exec(h))switch(l[3]=l[3].replace(/_.*$/,"")){case"table":case"工作表":"/"===l[1]?(N.e.c>=N.s.c&&N.e.r>=N.s.r?g["!ref"]=Yp(N):g["!ref"]="A1:A1",n.sheetRows>0&&n.sheetRows<=N.e.r&&(g["!fullref"]=g["!ref"],N.e.r=n.sheetRows-1,g["!ref"]=Yp(N)),O.length&&(g["!merges"]=O),L.length&&(g["!rows"]=L),o.name=o["名称"]||o.name,"undefined"!==typeof JSON&&JSON.stringify(o),m.push(o.name),p[o.name]=g,H=!1):"/"!==l[0].charAt(l[0].length-2)&&(o=Qf(l[0],!1),R=y=-1,N.s.r=N.s.c=1e7,N.e.r=N.e.c=0,g={},n.dense&&(g["!data"]=[]),O=[],L=[],H=!0);break;case"table-row-group":"/"===l[1]?--w:++w;break;case"table-row":case"行":if("/"===l[1]){R+=k,k=1;break}if(c=Qf(l[0],!1),c["行号"]?R=c["行号"]-1:-1==R&&(R=0),k=+c["number-rows-repeated"]||1,k<10)for(z=0;z<k;++z)w>0&&(L[R+z]={level:w});y=-1;break;case"covered-table-cell":"/"!==l[1]&&++y,n.sheetStubs&&(n.dense?(g["!data"][R]||(g["!data"][R]=[]),g["!data"][R][y]={t:"z"}):g[Pp({r:R,c:y})]={t:"z"}),T="",A=[];break;case"table-cell":case"数据":if("/"===l[0].charAt(l[0].length-2))++y,v=Qf(l[0],!1),_=parseInt(v["number-columns-repeated"]||"1",10),u={t:"z",v:null},v.formula&&0!=n.cellFormula&&(u.f=HN(rd(v.formula))),v["style-name"]&&C[v["style-name"]]&&(u.z=C[v["style-name"]]),"string"==(v["数据类型"]||v["value-type"])&&(u.t="s",u.v=rd(v["string-value"]||""),n.dense?(g["!data"][R]||(g["!data"][R]=[]),g["!data"][R][y]=u):g[kp(y)+Ip(R)]=u),y+=_-1;else if("/"!==l[1]){++y,T="",S=0,A=[],_=1;var j=k?R+k-1:R;if(y>N.e.c&&(N.e.c=y),y<N.s.c&&(N.s.c=y),R<N.s.r&&(N.s.r=R),j>N.e.r&&(N.e.r=j),v=Qf(l[0],!1),B=[],Y={},u={t:v["数据类型"]||v["value-type"],v:null},v["style-name"]&&C[v["style-name"]]&&(u.z=C[v["style-name"]]),n.cellFormula)if(v.formula&&(v.formula=rd(v.formula)),v["number-matrix-columns-spanned"]&&v["number-matrix-rows-spanned"]&&(M=parseInt(v["number-matrix-rows-spanned"],10)||0,D=parseInt(v["number-matrix-columns-spanned"],10)||0,I={s:{r:R,c:y},e:{r:R+M-1,c:y+D-1}},u.F=Yp(I),U.push([I,u.F])),v.formula)u.f=HN(v.formula);else for(z=0;z<U.length;++z)R>=U[z][0].s.r&&R<=U[z][0].e.r&&y>=U[z][0].s.c&&y<=U[z][0].e.c&&(u.F=U[z][1]);switch((v["number-columns-spanned"]||v["number-rows-spanned"])&&(M=parseInt(v["number-rows-spanned"],10)||0,D=parseInt(v["number-columns-spanned"],10)||0,I={s:{r:R,c:y},e:{r:R+M-1,c:y+D-1}},O.push(I)),v["number-columns-repeated"]&&(_=parseInt(v["number-columns-repeated"],10)),u.t){case"boolean":u.t="b",u.v=fd(v["boolean-value"])||+v["boolean-value"]>=1;break;case"float":u.t="n",u.v=parseFloat(v.value);break;case"percentage":u.t="n",u.v=parseFloat(v.value);break;case"currency":u.t="n",u.v=parseFloat(v.value);break;case"date":u.t="d",u.v=Rf(v["date-value"]),n.cellDates||(u.t="n",u.v=df(u.v,x.WBProps.date1904)-$),u.z||(u.z="m/d/yy");break;case"time":u.t="n",u.v=vf(v["time-value"])/86400,n.cellDates&&(u.t="d",u.v=Ef(u.v)),u.z||(u.z="HH:MM:SS");break;case"number":u.t="n",u.v=parseFloat(v["数据数值"]);break;default:if("string"!==u.t&&"text"!==u.t&&u.t)throw new Error("Unsupported value type "+u.t);u.t="s",null!=v["string-value"]&&(T=rd(v["string-value"]),A=[])}}else{if(G=!1,"s"===u.t&&(u.v=T||"",A.length&&(u.R=A),G=0==S),F.Target&&(u.l=F),B.length>0&&(u.c=B,B=[]),T&&!1!==n.cellText&&(u.w=T),G&&(u.t="z",delete u.v),(!G||n.sheetStubs)&&!(n.sheetRows&&n.sheetRows<=R))for(var X=0;X<k;++X){if(_=parseInt(v["number-columns-repeated"]||"1",10),n.dense){g["!data"][R+X]||(g["!data"][R+X]=[]),g["!data"][R+X][y]=0==X?u:Nf(u);while(--_>0)g["!data"][R+X][y+_]=Nf(u)}else{g[Pp({r:R+X,c:y})]=u;while(--_>0)g[Pp({r:R+X,c:y+_})]=Nf(u)}N.e.c<=y&&(N.e.c=y)}_=parseInt(v["number-columns-repeated"]||"1",10),y+=_-1,_=0,u={},T="",A=[]}F={};break;case"document":case"document-content":case"电子表格文档":case"spreadsheet":case"主体":case"scripts":case"styles":case"font-face-decls":case"master-styles":if("/"===l[1]){if((a=f.pop())[0]!==l[3])throw"Bad state: "+a}else"/"!==l[0].charAt(l[0].length-2)&&f.push([l[3],!0]);break;case"annotation":if("/"===l[1]){if((a=f.pop())[0]!==l[3])throw"Bad state: "+a;Y.t=T,A.length&&(Y.R=A),Y.a=V,B.push(Y)}else"/"!==l[0].charAt(l[0].length-2)&&f.push([l[3],!1]);V="",W=0,T="",S=0,A=[];break;case"creator":"/"===l[1]?V=h.slice(W,l.index):W=l.index+l[0].length;break;case"meta":case"元数据":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if("/"===l[1]){if((a=f.pop())[0]!==l[3])throw"Bad state: "+a}else"/"!==l[0].charAt(l[0].length-2)&&f.push([l[3],!1]);T="",S=0,A=[];break;case"scientific-number":case"currency-symbol":case"fill-character":break;case"text-style":case"boolean-style":case"number-style":case"currency-style":case"percentage-style":case"date-style":case"time-style":if("/"===l[1]){var K=Ld.lastIndex;hI(h.slice(i,Ld.lastIndex),t,b),Ld.lastIndex=K}else"/"!==l[0].charAt(l[0].length-2)&&(i=Ld.lastIndex-l[0].length);break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":var q=Qf(l[0],!1);"table-cell"==q["family"]&&b[q["data-style-name"]]&&(C[q["name"]]=b[q["data-style-name"]]);break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":break;case"boolean":break;case"text":if("/>"===l[0].slice(-2))break;if("/"===l[1])switch(f[f.length-1][0]){case"number-style":case"date-style":case"time-style":h.slice(d,l.index);break}else d=l.index+l[0].length;break;case"named-range":s=Qf(l[0],!1),P=$N(s["cell-range-address"]);var J={Name:s.name,Ref:P[0]+"!"+P[1]};H&&(J.Sheet=m.length),x.Names.push(J);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"电子表格":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":switch(s=Qf(l[0],!1),s["date-value"]){case"1904-01-01":x.WBProps.date1904=!0;case"1900-01-01":$=0}break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"文本串":if(["master-styles"].indexOf(f[f.length-1][0])>-1)break;if("/"!==l[1]||v&&v["string-value"])E=Qf(l[0],!1),S=l.index+l[0].length;else{var Q=uI(h.slice(S,l.index),E);T=(T.length>0?T+"\n":"")+Q[0]}break;case"s":break;case"database-range":if("/"===l[1])break;try{P=$N(Qf(l[0])["target-range-address"]),p[P[0]]["!autofilter"]={ref:P[1]}}catch(ee){}break;case"date":break;case"object":break;case"title":case"标题":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if("/"!==l[1]){if(F=Qf(l[0],!1),!F.href)break;F.Target=rd(F.href),delete F.href,"#"==F.Target.charAt(0)&&F.Target.indexOf(".")>-1?(P=$N(F.Target.slice(1)),F.Target="#"+P[0]+"!"+P[1]):F.Target.match(/^\.\.[\\\/]/)&&(F.Target=F.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(l[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case"表:":case"字:":break;default:if(n.WTF)throw new Error(l)}}var Z={Sheets:p,SheetNames:m,Workbook:x};return n.bookSheets&&delete Z.Sheets,Z}function dI(e,t){t=t||{},Uf(e,"META-INF/manifest.xml")&&hg(Ff(e,"META-INF/manifest.xml"),t);var r=Pf(e,"styles.xml"),n=r&&hI(Ed(r),t),a=Pf(e,"content.xml");if(!a)throw new Error("Missing content.xml in ODS / UOF file");var s=fI(Ed(a),t,n);return Uf(e,"meta.xml")&&(s.Props=Tg(Ff(e,"meta.xml"))),s.bookType="ods",s}function pI(e,t){var r=fI(e,t);return r.bookType="fods",r}var mI=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+Cd({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return zf+t}}();function gI(e,t){var r="number",n="",a={"style:name":t},s="",i=0;e=e.replace(/"[$]"/g,"$");e:if(e.indexOf(";")>-1&&(console.error("Unsupported ODS Style Map exported.  Using first branch of "+e),e=e.slice(0,e.indexOf(";"))),"@"!=e){if(e.indexOf(/\$/)>-1&&(r="currency"),'"'==e[i]){s="";while('"'!=e[++i]||'"'==e[++i])s+=e[i];--i,"*"==e[i+1]?(i++,n+="<number:fill-character>"+sd(s.replace(/""/g,'"'))+"</number:fill-character>"):n+="<number:text>"+sd(s.replace(/""/g,'"'))+"</number:text>",e=e.slice(i+1),i=0}var o=e.match(/# (\?+)\/(\?+)/);if(o)n+=Od("number:fraction",null,{"number:min-integer-digits":0,"number:min-numerator-digits":o[1].length,"number:max-denominator-value":Math.max(+o[1].replace(/./g,"9"),+o[2].replace(/./g,"9"))});else if(o=e.match(/# (\?+)\/(\d+)/))n+=Od("number:fraction",null,{"number:min-integer-digits":0,"number:min-numerator-digits":o[1].length,"number:denominator-value":+o[2]});else if(o=e.match(/(\d+)(|\.\d+)%/))r="percentage",n+=Od("number:number",null,{"number:decimal-places":o[2]&&o.length-1||0,"number:min-decimal-places":o[2]&&o.length-1||0,"number:min-integer-digits":o[1].length})+"<number:text>%</number:text>";else{var c=!1;if(["y","m","d"].indexOf(e[0])>-1){r="date";t:for(;i<e.length;++i)switch(s=e[i].toLowerCase()){case"h":case"s":c=!0,--i;break t;case"m":r:for(var l=i+1;l<e.length;++l)switch(e[l]){case"y":case"d":break r;case"h":case"s":c=!0,--i;break t}case"y":case"d":while((e[++i]||"").toLowerCase()==s[0])s+=s[0];switch(--i,s){case"y":case"yy":n+="<number:year/>";break;case"yyy":case"yyyy":n+='<number:year number:style="long"/>';break;case"mmmmm":console.error("ODS has no equivalent of format |mmmmm|");case"m":case"mm":case"mmm":case"mmmm":n+='<number:month number:style="'+(s.length%2?"short":"long")+'" number:textual="'+(s.length>=3?"true":"false")+'"/>';break;case"d":case"dd":n+='<number:day number:style="'+(s.length%2?"short":"long")+'"/>';break;case"ddd":case"dddd":n+='<number:day-of-week number:style="'+(s.length%2?"short":"long")+'"/>';break}break;case'"':while('"'!=e[++i]||'"'==e[++i])s+=e[i];--i,n+="<number:text>"+sd(s.slice(1).replace(/""/g,'"'))+"</number:text>";break;case"/":n+="<number:text>"+sd(s)+"</number:text>";break;default:console.error("unrecognized character "+s+" in ODF format "+e)}if(!c)break e;e=e.slice(i+1),i=0}if(e.match(/^\[?[hms]/))for("number"==r&&(r="time"),e.match(/\[/)&&(e=e.replace(/[\[\]]/g,""),a["number:truncate-on-overflow"]="false");i<e.length;++i)switch(s=e[i].toLowerCase()){case"h":case"m":case"s":while((e[++i]||"").toLowerCase()==s[0])s+=s[0];switch(--i,s){case"h":case"hh":n+='<number:hours number:style="'+(s.length%2?"short":"long")+'"/>';break;case"m":case"mm":n+='<number:minutes number:style="'+(s.length%2?"short":"long")+'"/>';break;case"s":case"ss":if("."==e[i+1])do{s+=e[i+1],++i}while("0"==e[i+1]);n+='<number:seconds number:style="'+(s.match("ss")?"long":"short")+'"'+(s.match(/\./)?' number:decimal-places="'+(s.match(/0+/)||[""])[0].length+'"':"")+"/>";break}break;case'"':while('"'!=e[++i]||'"'==e[++i])s+=e[i];--i,n+="<number:text>"+sd(s.slice(1).replace(/""/g,'"'))+"</number:text>";break;case"/":n+="<number:text>"+sd(s)+"</number:text>";break;case"a":if("a/p"==e.slice(i,i+3).toLowerCase()){n+="<number:am-pm/>",i+=2;break}if("am/pm"==e.slice(i,i+5).toLowerCase()){n+="<number:am-pm/>",i+=4;break}default:console.error("unrecognized character "+s+" in ODF format "+e)}else{if(e.indexOf(/\$/)>-1&&(r="currency"),"$"==e[0]&&(n+='<number:currency-symbol number:language="en" number:country="US">$</number:currency-symbol>',e=e.slice(1),i=0),i=0,'"'==e[i]){while('"'!=e[++i]||'"'==e[++i])s+=e[i];--i,"*"==e[i+1]?(i++,n+="<number:fill-character>"+sd(s.replace(/""/g,'"'))+"</number:fill-character>"):n+="<number:text>"+sd(s.replace(/""/g,'"'))+"</number:text>",e=e.slice(i+1),i=0}var u=e.match(/([#0][0#,]*)(\.[0#]*|)(E[+]?0*|)/i);if(u&&u[0]){var h=u[1].replace(/,/g,"");n+="<number:"+(u[3]?"scientific-":"")+'number number:min-integer-digits="'+(-1==h.indexOf("0")?"0":h.length-h.indexOf("0"))+'"'+(u[0].indexOf(",")>-1?' number:grouping="true"':"")+(u[2]&&' number:decimal-places="'+(u[2].length-1)+'"'||' number:decimal-places="0"')+(u[3]&&u[3].indexOf("+")>-1?' number:forced-exponent-sign="true"':"")+(u[3]?' number:min-exponent-digits="'+u[3].match(/0+/)[0].length+'"':"")+"></number:"+(u[3]?"scientific-":"")+"number>",i=u.index+u[0].length}else console.error("Could not find numeric part of "+e);if('"'==e[i]){s="";while('"'!=e[++i]||'"'==e[++i])s+=e[i];--i,n+="<number:text>"+sd(s.replace(/""/g,'"'))+"</number:text>"}}}}else r="text",n="<number:text-content/>";return n?Od("number:"+r+"-style",n,a):(console.error("Could not generate ODS number format for |"+e+"|"),"")}function EI(e,t,r){var n=e.filter((function(e){return e.Sheet==(-1==r?null:r)}));return n.length?"      <table:named-expressions>\n"+n.map((function(e){var t=jN(e.Ref);return"        "+Od("table:named-range",null,{"table:name":e.Name,"table:cell-range-address":t,"table:base-cell-address":t.replace(/[\.]?[^\.]*$/,".$A$1")})})).join("\n")+"\n      </table:named-expressions>\n":""}var vI=function(){var e=function(e){return sd(e).replace(/  +/g,(function(e){return'<text:s text:c="'+e.length+'"/>'})).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t="          <table:table-cell />\n",r="          <table:covered-table-cell/>\n",n=function(n,a,s,i,o){var c=[];c.push('      <table:table table:name="'+sd(a.SheetNames[s])+'" table:style-name="ta1">\n');var l=0,u=0,h=Bp(n["!ref"]||"A1"),f=n["!merges"]||[],d=0,p=null!=n["!data"];if(n["!cols"])for(u=0;u<=h.e.c;++u)c.push("        <table:table-column"+(n["!cols"][u]?' table:style-name="co'+n["!cols"][u].ods+'"':"")+"></table:table-column>\n");var m="",g=n["!rows"]||[];for(l=0;l<h.s.r;++l)m=g[l]?' table:style-name="ro'+g[l].ods+'"':"",c.push("        <table:table-row"+m+"></table:table-row>\n");for(;l<=h.e.r;++l){for(m=g[l]?' table:style-name="ro'+g[l].ods+'"':"",c.push("        <table:table-row"+m+">\n"),u=0;u<h.s.c;++u)c.push(t);for(;u<=h.e.c;++u){var E=!1,v={},T="";for(d=0;d!=f.length;++d)if(!(f[d].s.c>u)&&!(f[d].s.r>l)&&!(f[d].e.c<u)&&!(f[d].e.r<l)){f[d].s.c==u&&f[d].s.r==l||(E=!0),v["table:number-columns-spanned"]=f[d].e.c-f[d].s.c+1,v["table:number-rows-spanned"]=f[d].e.r-f[d].s.r+1;break}if(E)c.push(r);else{var S=Pp({r:l,c:u}),A=p?(n["!data"][l]||[])[u]:n[S];if(A&&A.f&&(v["table:formula"]=sd(zN(A.f)),A.F&&A.F.slice(0,S.length)==S)){var R=Bp(A.F);v["table:number-matrix-columns-spanned"]=R.e.c-R.s.c+1,v["table:number-matrix-rows-spanned"]=R.e.r-R.s.r+1}if(A){switch(A.t){case"b":T=A.v?"TRUE":"FALSE",v["office:value-type"]="boolean",v["office:boolean-value"]=A.v?"true":"false";break;case"n":T=A.w||String(A.v||0),v["office:value-type"]="float",v["office:value"]=A.v||0;break;case"s":case"str":T=null==A.v?"":A.v,v["office:value-type"]="string";break;case"d":T=A.w||Rf(A.v).toISOString(),v["office:value-type"]="date",v["office:date-value"]=Rf(A.v).toISOString(),v["table:style-name"]="ce1";break;default:c.push(t);continue}var y=e(T);if(A.l&&A.l.Target){var N=A.l.Target;N="#"==N.charAt(0)?"#"+jN(N.slice(1)):N,"#"==N.charAt(0)||N.match(/^\w+:/)||(N="../"+N),y=Od("text:a",y,{"xlink:href":N.replace(/&/g,"&amp;")})}o[A.z]&&(v["table:style-name"]="ce"+o[A.z].slice(1)),c.push("          "+Od("table:table-cell",Od("text:p",y,{}),v)+"\n")}else c.push(t)}}c.push("        </table:table-row>\n")}return(a.Workbook||{}).Names&&c.push(EI(a.Workbook.Names,a.SheetNames,s)),c.push("      </table:table>\n"),c.join("")},a=function(e,t){e.push(" <office:automatic-styles>\n");var r=0;t.SheetNames.map((function(e){return t.Sheets[e]})).forEach((function(t){if(t&&t["!cols"])for(var n=0;n<t["!cols"].length;++n)if(t["!cols"][n]){var a=t["!cols"][n];if(null==a.width&&null==a.wpx&&null==a.wch)continue;BS(a),a.ods=r;var s=t["!cols"][n].wpx+"px";e.push('  <style:style style:name="co'+r+'" style:family="table-column">\n'),e.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+s+'"/>\n'),e.push("  </style:style>\n"),++r}}));var n=0;t.SheetNames.map((function(e){return t.Sheets[e]})).forEach((function(t){if(t&&t["!rows"])for(var r=0;r<t["!rows"].length;++r)if(t["!rows"][r]){t["!rows"][r].ods=n;var a=t["!rows"][r].hpx+"px";e.push('  <style:style style:name="ro'+n+'" style:family="table-row">\n'),e.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+a+'"/>\n'),e.push("  </style:style>\n"),++n}})),e.push('  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">\n'),e.push('   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>\n'),e.push("  </style:style>\n"),e.push('  <number:date-style style:name="N37" number:automatic-order="true">\n'),e.push('   <number:month number:style="long"/>\n'),e.push("   <number:text>/</number:text>\n"),e.push('   <number:day number:style="long"/>\n'),e.push("   <number:text>/</number:text>\n"),e.push("   <number:year/>\n"),e.push("  </number:date-style>\n");var a={},s=69;return t.SheetNames.map((function(e){return t.Sheets[e]})).forEach((function(t){if(t)for(var r=null!=t["!data"],n=Bp(t["!ref"]),i=0;i<=n.e.r;++i)for(var o=0;o<=n.e.c;++o){var c=r?(t["!data"][i]||[])[o]:t[Pp({r:i,c:o})];if(c&&c.z&&"general"!=c.z.toLowerCase()&&!a[c.z]){var l=gI(c.z,"N"+s);l&&(a[c.z]="N"+s,++s,e.push(l+"\n"))}}})),e.push('  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>\n'),of(a).forEach((function(t){e.push('<style:style style:name="ce'+a[t].slice(1)+'" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="'+a[t]+'"/>\n')})),e.push(" </office:automatic-styles>\n"),a};return function(e,t){var r=[zf],s=Cd({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),i=Cd({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});"fods"==t.bookType?(r.push("<office:document"+s+i+">\n"),r.push(gg().replace(/<office:document-meta.*?>/,"").replace(/<\/office:document-meta>/,"")+"\n")):r.push("<office:document-content"+s+">\n");var o=a(r,e);r.push("  <office:body>\n"),r.push("    <office:spreadsheet>\n"),((e.Workbook||{}).WBProps||{}).date1904&&r.push('      <table:calculation-settings table:case-sensitive="false" table:search-criteria-must-apply-to-whole-cell="true" table:use-wildcards="true" table:use-regular-expressions="false" table:automatic-find-labels="false">\n        <table:null-date table:date-value="1904-01-01"/>\n      </table:calculation-settings>\n');for(var c=0;c!=e.SheetNames.length;++c)r.push(n(e.Sheets[e.SheetNames[c]],e,c,t,o));return(e.Workbook||{}).Names&&r.push(EI(e.Workbook.Names,e.SheetNames,-1)),r.push("    </office:spreadsheet>\n"),r.push("  </office:body>\n"),"fods"==t.bookType?r.push("</office:document>"):r.push("</office:document-content>"),r.join("")}}();function TI(e,t){if("fods"==t.bookType)return vI(e,t);var r=Wf(),n="",a=[],s=[];return n="mimetype",Vf(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",Vf(r,n,vI(e,t)),a.push([n,"text/xml"]),s.push([n,"ContentFile"]),n="styles.xml",Vf(r,n,mI(e,t)),a.push([n,"text/xml"]),s.push([n,"StylesFile"]),n="meta.xml",Vf(r,n,zf+gg()),a.push([n,"text/xml"]),s.push([n,"MetadataFile"]),n="manifest.rdf",Vf(r,n,mg(s)),a.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",Vf(r,n,fg(a)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */var SI=function(){try{return"undefined"==typeof Uint8Array||"undefined"==typeof Uint8Array.prototype.subarray?"slice":"undefined"!==typeof Buffer?"undefined"==typeof Buffer.prototype.subarray?"slice":("function"==typeof Buffer.from?Buffer.from([72,62]):new Buffer([72,62]))instanceof Uint8Array?"subarray":"slice":"subarray"}catch(e){return"slice"}}();function AI(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function RI(e){return"undefined"!=typeof TextDecoder?(new TextDecoder).decode(e):Ed(Du(e))}function yI(e){return"undefined"!=typeof TextEncoder?(new TextEncoder).encode(e):Iu(vd(e))}function NI(e){for(var t=0,r=0;r<e.length;++r)t+=e[r].length;var n=new Uint8Array(t),a=0;for(r=0;r<e.length;++r){var s=e[r],i=s.length;if(i<250)for(var o=0;o<i;++o)n[a++]=s[o];else n.set(s,a),a+=i}return n}function wI(e){return e-=e>>1&1431655765,e=(858993459&e)+(e>>2&858993459),16843009*(e+(e>>4)&252645135)>>>24}function bI(e,t){for(var r=(127&e[t+15])<<7|e[t+14]>>1,n=1&e[t+14],a=t+13;a>=t;--a)n=256*n+e[a];return(128&e[t+15]?-n:n)*Math.pow(10,r-6176)}function CI(e,t,r){var n=Math.floor(0==r?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-16,a=r/Math.pow(10,n-6176);e[t+15]|=n>>7,e[t+14]|=(127&n)<<1;for(var s=0;a>=1;++s,a/=256)e[t+s]=255&a;e[t+15]|=r>=0?0:128}function OI(e,t){var r=t.l,n=127&e[r];e:if(e[r++]>=128){if(n|=(127&e[r])<<7,e[r++]<128)break e;if(n|=(127&e[r])<<14,e[r++]<128)break e;if(n|=(127&e[r])<<21,e[r++]<128)break e;if(n+=(127&e[r])*Math.pow(2,28),++r,e[r++]<128)break e;if(n+=(127&e[r])*Math.pow(2,35),++r,e[r++]<128)break e;if(n+=(127&e[r])*Math.pow(2,42),++r,e[r++]<128)break e}return t.l=r,n}function II(e){var t=new Uint8Array(7);t[0]=127&e;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383)break e;if(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)break e;if(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)break e;if(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)break e;if(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103)break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t[SI](0,r)}function MI(e){var t={l:0},r=[];while(t.l<e.length)r.push(OI(e,t));return r}function DI(e){return NI(e.map((function(e){return II(e)})))}function LI(e){var t=0,r=127&e[t];e:if(e[t++]>=128){if(r|=(127&e[t])<<7,e[t++]<128)break e;if(r|=(127&e[t])<<14,e[t++]<128)break e;if(r|=(127&e[t])<<21,e[t++]<128)break e;r|=(127&e[t])<<28}return r}function kI(e){var t=[],r={l:0};while(r.l<e.length){var n,a=r.l,s=OI(e,r),i=7&s;s=s/8|0;var o=r.l;switch(i){case 0:while(e[o++]>=128);n=e[SI](r.l,o),r.l=o;break;case 1:n=e[SI](o,o+8),r.l=o+8;break;case 2:var c=OI(e,r);n=e[SI](r.l,r.l+c),r.l+=c;break;case 5:n=e[SI](o,o+4),r.l=o+4;break;default:throw new Error("PB Type ".concat(i," for Field ").concat(s," at offset ").concat(a))}var l={data:n,type:i};null==t[s]&&(t[s]=[]),t[s].push(l)}return t}function _I(e){var t=[];return e.forEach((function(e,r){0!=r&&e.forEach((function(e){e.data&&(t.push(II(8*r+e.type)),2==e.type&&t.push(II(e.data.length)),t.push(e.data))}))})),NI(t)}function UI(e,t){return(null==e?void 0:e.map((function(e){return t(e.data)})))||[]}function xI(e){var t,r=[],n={l:0};while(n.l<e.length){var a=OI(e,n),s=kI(e[SI](n.l,n.l+a));n.l+=a;var i={id:LI(s[1][0].data),messages:[]};s[2].forEach((function(t){var r=kI(t.data),a=LI(r[3][0].data);i.messages.push({meta:r,data:e[SI](n.l,n.l+a)}),n.l+=a})),(null==(t=s[3])?void 0:t[0])&&(i.merge=LI(s[3][0].data)>>>0>0),r.push(i)}return r}function FI(e){var t=[];return e.forEach((function(e){var r=[[],[{data:II(e.id),type:0}],[]];null!=e.merge&&(r[3]=[{data:II(+!!e.merge),type:0}]);var n=[];e.messages.forEach((function(e){n.push(e.data),e.meta[3]=[{type:0,data:II(e.data.length)}],r[2].push({data:_I(e.meta),type:2})}));var a=_I(r);t.push(II(a.length)),t.push(a),n.forEach((function(e){return t.push(e)}))})),NI(t)}function PI(e,t){if(0!=e)throw new Error("Unexpected Snappy chunk type ".concat(e));var r={l:0},n=OI(t,r),a=[],s=r.l;while(s<t.length){var i=3&t[s];if(0!=i){var o=0,c=0;if(1==i?(c=4+(t[s]>>2&7),o=(224&t[s++])<<3,o|=t[s++]):(c=1+(t[s++]>>2),2==i?(o=t[s]|t[s+1]<<8,s+=2):(o=(t[s]|t[s+1]<<8|t[s+2]<<16|t[s+3]<<24)>>>0,s+=4)),0==o)throw new Error("Invalid offset 0");var l=a.length-1,u=o;while(l>=0&&u>=a[l].length)u-=a[l].length,--l;if(l<0){if(0!=u)throw new Error("Invalid offset beyond length");u=a[l=0].length}if(c<u)a.push(a[l][SI](a[l].length-u,a[l].length-u+c));else{u>0&&(a.push(a[l][SI](a[l].length-u)),c-=u),++l;while(c>=a[l].length)a.push(a[l]),c-=a[l].length,++l;c&&a.push(a[l][SI](0,c))}a.length>25&&(a=[NI(a)])}else{var h=t[s++]>>2;if(h<60)++h;else{var f=h-59;h=t[s],f>1&&(h|=t[s+1]<<8),f>2&&(h|=t[s+2]<<16),f>3&&(h|=t[s+3]<<24),h>>>=0,h++,s+=f}a.push(t[SI](s,s+h)),s+=h}}for(var d=0,p=0;p<a.length;++p)d+=a[p].length;if(d!=n)throw new Error("Unexpected length: ".concat(d," != ").concat(n));return a}function BI(e){Array.isArray(e)&&(e=new Uint8Array(e));var t=[],r=0;while(r<e.length){var n=e[r++],a=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push.apply(t,PI(n,e[SI](r,r+a))),r+=a}if(r!==e.length)throw new Error("data is not a valid framed stream!");return 1==t.length?t[0]:NI(t)}function YI(e){var t=[],r=0;while(r<e.length){var n=Math.min(e.length-r,268435455),a=new Uint8Array(4);t.push(a);var s=II(n),i=s.length;t.push(s),n<=60?(i++,t.push(new Uint8Array([n-1<<2]))):n<=256?(i+=2,t.push(new Uint8Array([240,n-1&255]))):n<=65536?(i+=3,t.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(i+=4,t.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(i+=5,t.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),t.push(e[SI](r,r+n)),i+=n,a[0]=0,a[1]=255&i,a[2]=i>>8&255,a[3]=i>>16&255,r+=n}return NI(t)}var VI=function(){return{sst:[],rsst:[],ofmt:[],nfmt:[]}};function WI(e,t,r,n,a){var s,i,o,c,l=255&t,u=t>>8,h=u>=5?a:n;e:if(r&(u>4?8:4)&&"n"==e.t&&7==l){var f=(null==(s=h[7])?void 0:s[0])?LI(h[7][0].data):-1;if(-1==f)break e;var d=(null==(i=h[15])?void 0:i[0])?LI(h[15][0].data):-1,p=(null==(o=h[16])?void 0:o[0])?LI(h[16][0].data):-1,m=(null==(c=h[40])?void 0:c[0])?LI(h[40][0].data):-1,g=e.v,E=g;t:if(m){if(0==g){d=p=2;break t}d=g>=604800?1:g>=86400?2:g>=3600?4:g>=60?8:g>=1?16:32,Math.floor(g)!=g?p=32:g%60?p=16:g%3600?p=8:g%86400?p=4:g%604800&&(p=2),p<d&&(p=d)}if(-1==d||-1==p)break e;var v=[],T=[];1==d&&(E=g/604800,1==p?T.push('d"d"'):(E|=0,g-=604800*E),v.push(E+(2==f?" week"+(1==E?"":"s"):1==f?"w":""))),d<=2&&p>=2&&(E=g/86400,p>2&&(E|=0,g-=86400*E),T.push('d"d"'),v.push(E+(2==f?" day"+(1==E?"":"s"):1==f?"d":""))),d<=4&&p>=4&&(E=g/3600,p>4&&(E|=0,g-=3600*E),T.push((d>=4?"[h]":"h")+'"h"'),v.push(E+(2==f?" hour"+(1==E?"":"s"):1==f?"h":""))),d<=8&&p>=8&&(E=g/60,p>8&&(E|=0,g-=60*E),T.push((d>=8?"[m]":"m")+'"m"'),0==f?v.push((8==d&&8==p||E>=10?"":"0")+E):v.push(E+(2==f?" minute"+(1==E?"":"s"):1==f?"m":""))),d<=16&&p>=16&&(E=g,p>16&&(E|=0,g-=E),T.push((d>=16?"[s]":"s")+'"s"'),0==f?v.push((16==p&&16==d||E>=10?"":"0")+E):v.push(E+(2==f?" second"+(1==E?"":"s"):1==f?"s":""))),p>=32&&(E=Math.round(1e3*g),d<32&&T.push('.000"ms"'),0==f?v.push((E>=100?"":E>=10?"0":"00")+E):v.push(E+(2==f?" millisecond"+(1==E?"":"s"):1==f?"ms":""))),e.w=v.join(0==f?":":" "),e.z=T.join(0==f?'":"':" "),0==f&&(e.w=e.w.replace(/:(\d\d\d)$/,".$1"))}}function GI(e,t,r){var n,a=AI(e),s=a.getUint32(4,!0),i=-1,o=-1,c=-1,l=NaN,u=new Date(2001,0,1),h=r>1?12:8;2&s&&(c=a.getUint32(h,!0),h+=4),h+=4*wI(s&(r>1?3468:396)),512&s&&(i=a.getUint32(h,!0),h+=4),h+=4*wI(s&(r>1?12288:4096)),16&s&&(o=a.getUint32(h,!0),h+=4),32&s&&(l=a.getFloat64(h,!0),h+=8),64&s&&(u.setTime(u.getTime()+1e3*a.getFloat64(h,!0)),h+=8),r>1&&(s=a.getUint32(8,!0)>>>16,255&s&&(-1==c&&(c=a.getUint32(h,!0)),h+=4));var f=e[r>=4?1:2];switch(f){case 0:return;case 2:n={t:"n",v:l};break;case 3:n={t:"s",v:t.sst[o]};break;case 5:n={t:"d",v:u};break;case 6:n={t:"b",v:l>0};break;case 7:n={t:"n",v:l};break;case 8:n={t:"e",v:0};break;case 9:if(!(i>-1))throw new Error("Unsupported cell type ".concat(e[SI](0,4)));n={t:"s",v:t.rsst[i]};break;default:throw new Error("Unsupported cell type ".concat(e[SI](0,4)))}return c>-1&&WI(n,f|r<<8,s,t.ofmt[c],t.nfmt[c]),7==f&&(n.v/=86400),n}function HI(e,t){var r,n=AI(e),a=(n.getUint32(4,!0),n.getUint32(8,!0)),s=12,i=-1,o=-1,c=-1,l=NaN,u=NaN,h=new Date(2001,0,1);1&a&&(l=bI(e,s),s+=16),2&a&&(u=n.getFloat64(s,!0),s+=8),4&a&&(h.setTime(h.getTime()+1e3*n.getFloat64(s,!0)),s+=8),8&a&&(o=n.getUint32(s,!0),s+=4),16&a&&(i=n.getUint32(s,!0),s+=4);var f=e[1];switch(f){case 0:return;case 2:r={t:"n",v:l};break;case 3:r={t:"s",v:t.sst[o]};break;case 5:r={t:"d",v:h};break;case 6:r={t:"b",v:u>0};break;case 7:r={t:"n",v:u};break;case 8:r={t:"e",v:0};break;case 9:r={t:"s",v:t.rsst[i]};break;case 10:r={t:"n",v:l};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(31&a," : ").concat(e[SI](0,4)))}return s+=4*wI(8160&a),516096&a&&(-1==c&&(c=n.getUint32(s,!0)),s+=4),c>-1&&WI(r,1280|f,a>>13,t.ofmt[c],t.nfmt[c]),7==f&&(r.v/=86400),r}function zI(e,t){var r=new Uint8Array(32),n=AI(r),a=12,s=0;switch(r[0]=5,e.t){case"n":r[1]=2,CI(r,a,e.v),s|=1,a+=16;break;case"b":r[1]=6,n.setFloat64(a,e.v?1:0,!0),s|=2,a+=8;break;case"s":var i=null==e.v?"":String(e.v),o=t.indexOf(i);-1==o&&(t[o=t.length]=i),r[1]=3,n.setUint32(a,o,!0),s|=8,a+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(8,s,!0),r[SI](0,a)}function $I(e,t){var r=new Uint8Array(32),n=AI(r),a=12,s=0;switch(r[0]=4,e.t){case"n":r[2]=2,n.setFloat64(a,e.v,!0),s|=32,a+=8;break;case"b":r[2]=6,n.setFloat64(a,e.v?1:0,!0),s|=32,a+=8;break;case"s":var i=null==e.v?"":String(e.v),o=t.indexOf(i);-1==o&&(t[o=t.length]=i),r[2]=3,n.setUint32(a,o,!0),s|=16,a+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(8,s,!0),r[SI](0,a)}function jI(e,t){switch(e[0]){case 0:case 1:case 2:case 3:case 4:return GI(e,t,e[0]);case 5:return HI(e,t);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function XI(e){var t=kI(e);return LI(t[1][0].data)}function KI(e){return _I([[],[{type:0,data:II(e)}]])}function qI(e,t){var r,n=(null==(r=e.messages[0].meta[5])?void 0:r[0])?MI(e.messages[0].meta[5][0].data):[],a=n.indexOf(t);-1==a&&(n.push(t),e.messages[0].meta[5]=[{type:2,data:DI(n)}])}function JI(e,t){var r,n=(null==(r=e.messages[0].meta[5])?void 0:r[0])?MI(e.messages[0].meta[5][0].data):[];e.messages[0].meta[5]=[{type:2,data:DI(n.filter((function(e){return e!=t})))}]}function QI(e,t){var r=kI(t.data),n=LI(r[1][0].data),a=r[3],s=[];return(a||[]).forEach((function(t){var r=kI(t.data);if(r[1]){var a=LI(r[1][0].data)>>>0;switch(n){case 1:s[a]=RI(r[3][0].data);break;case 8:var i=e[XI(r[9][0].data)][0],o=kI(i.data),c=e[XI(o[1][0].data)][0],l=LI(c.meta[1][0].data);if(2001!=l)throw new Error("2000 unexpected reference to ".concat(l));var u=kI(c.data);s[a]=u[3].map((function(e){return RI(e.data)})).join("");break;case 2:s[a]=kI(r[6][0].data);break;default:throw n}}})),s}function ZI(e,t){var r,n,a,s,i,o,c,l,u,h,f,d,p,m,g,E,v=kI(e),T=LI(v[1][0].data)>>>0,S=LI(v[2][0].data)>>>0,A=(null==(n=null==(r=v[8])?void 0:r[0])?void 0:n.data)&&LI(v[8][0].data)>0||!1;if((null==(s=null==(a=v[7])?void 0:a[0])?void 0:s.data)&&0!=t)g=null==(o=null==(i=v[7])?void 0:i[0])?void 0:o.data,E=null==(l=null==(c=v[6])?void 0:c[0])?void 0:l.data;else{if(!(null==(h=null==(u=v[4])?void 0:u[0])?void 0:h.data)||1==t)throw"NUMBERS Tile missing ".concat(t," cell storage");g=null==(d=null==(f=v[4])?void 0:f[0])?void 0:d.data,E=null==(m=null==(p=v[3])?void 0:p[0])?void 0:m.data}for(var R=A?4:1,y=AI(g),N=[],w=0;w<g.length/2;++w){var b=y.getUint16(2*w,!0);b<65535&&N.push([w,b])}if(N.length!=S)throw"Expected ".concat(S," cells, found ").concat(N.length);var C=[];for(w=0;w<N.length-1;++w)C[N[w][0]]=E[SI](N[w][1]*R,N[w+1][1]*R);return N.length>=1&&(C[N[N.length-1][0]]=E[SI](N[N.length-1][1]*R)),{R:T,cells:C}}function eM(e,t){var r,n=kI(t.data),a=-1;(null==(r=null==n?void 0:n[7])?void 0:r[0])&&(a=LI(n[7][0].data)>>>0?1:0);var s=UI(n[5],(function(e){return ZI(e,a)}));return{nrows:LI(n[4][0].data)>>>0,data:s.reduce((function(e,t){return e[t.R]||(e[t.R]=[]),t.cells.forEach((function(r,n){if(e[t.R][n])throw new Error("Duplicate cell r=".concat(t.R," c=").concat(n));e[t.R][n]=r})),e}),[])}}function tM(e,t,r){var n,a,s,i,o,c,l=kI(t.data),u={s:{r:0,c:0},e:{r:0,c:0}};if(u.e.r=(LI(l[6][0].data)>>>0)-1,u.e.r<0)throw new Error("Invalid row varint ".concat(l[6][0].data));if(u.e.c=(LI(l[7][0].data)>>>0)-1,u.e.c<0)throw new Error("Invalid col varint ".concat(l[7][0].data));r["!ref"]=Yp(u);var h=null!=r["!data"],f=r,d=kI(l[4][0].data),p=VI();(null==(n=d[4])?void 0:n[0])&&(p.sst=QI(e,e[XI(d[4][0].data)][0])),(null==(a=d[11])?void 0:a[0])&&(p.ofmt=QI(e,e[XI(d[11][0].data)][0])),(null==(s=d[17])?void 0:s[0])&&(p.rsst=QI(e,e[XI(d[17][0].data)][0])),(null==(i=d[22])?void 0:i[0])&&(p.nfmt=QI(e,e[XI(d[22][0].data)][0]));var m=kI(d[3][0].data),g=0;if(m[1].forEach((function(t){var n=kI(t.data),a=e[XI(n[2][0].data)][0],s=LI(a.meta[1][0].data);if(6002!=s)throw new Error("6001 unexpected reference to ".concat(s));var i=eM(e,a);i.data.forEach((function(e,t){e.forEach((function(e,n){var a=jI(e,p);a&&(h?(f["!data"][g+t]||(f["!data"][g+t]=[]),f["!data"][g+t][n]=a):r[kp(n)+Ip(g+t)]=a)}))})),g+=i.nrows})),null==(o=d[13])?void 0:o[0]){var E=e[XI(d[13][0].data)][0],v=LI(E.meta[1][0].data);if(6144!=v)throw new Error("Expected merge type 6144, found ".concat(v));r["!merges"]=null==(c=kI(E.data))?void 0:c[1].map((function(e){var t=kI(e.data),r=AI(kI(t[1][0].data)[1][0].data),n=AI(kI(t[2][0].data)[1][0].data);return{s:{r:r.getUint16(0,!0),c:r.getUint16(2,!0)},e:{r:r.getUint16(0,!0)+n.getUint16(0,!0)-1,c:r.getUint16(2,!0)+n.getUint16(2,!0)-1}}}))}}function rM(e,t,r){var n=kI(t.data),a={"!ref":"A1"};(null==r?void 0:r.dense)&&(a["!data"]=[]);var s=e[XI(n[2][0].data)],i=LI(s[0].meta[1][0].data);if(6001!=i)throw new Error("6000 unexpected reference to ".concat(i));return tM(e,s[0],a),a}function nM(e,t,r){var n,a=kI(t.data),s={name:(null==(n=a[1])?void 0:n[0])?RI(a[1][0].data):"",sheets:[]},i=UI(a[2],XI);return i.forEach((function(t){e[t].forEach((function(t){var n=LI(t.meta[1][0].data);6e3==n&&s.sheets.push(rM(e,t,r))}))})),s}function aM(e,t,r){var n,a=uD(),s=kI(t.data);if(null==(n=s[2])?void 0:n[0])throw new Error("Keynote presentations are not supported");var i=UI(s[1],XI);if(i.forEach((function(t){e[t].forEach((function(t){var n=LI(t.meta[1][0].data);if(2==n){var s=nM(e,t,r);s.sheets.forEach((function(e,t){hD(a,e,0==t?s.name:s.name+"_"+t,!0)}))}}))})),0==a.SheetNames.length)throw new Error("Empty NUMBERS file");return a.bookType="numbers",a}function sM(e,t){var r,n,a,s,i,o,c,l={},u=[];if(e.FullPaths.forEach((function(e){if(e.match(/\.iwpv2/))throw new Error("Unsupported password protection")})),e.FileIndex.forEach((function(e){if(e.name.match(/\.iwa$/)&&0==e.content[0]){var t,r;try{t=BI(e.content)}catch(n){return console.log("?? "+e.content.length+" "+(n.message||n))}try{r=xI(t)}catch(n){return console.log("## "+(n.message||n))}r.forEach((function(e){l[e.id]=e.messages,u.push(e.id)}))}})),!u.length)throw new Error("File has no messages");if((null==(a=null==(n=null==(r=null==l?void 0:l[1])?void 0:r[0].meta)?void 0:n[1])?void 0:a[0].data)&&1e4==LI(l[1][0].meta[1][0].data))throw new Error("Pages documents are not supported");var h=(null==(c=null==(o=null==(i=null==(s=null==l?void 0:l[1])?void 0:s[0])?void 0:i.meta)?void 0:o[1])?void 0:c[0].data)&&1==LI(l[1][0].meta[1][0].data)&&l[1][0];if(h||u.forEach((function(e){l[e].forEach((function(e){var t=LI(e.meta[1][0].data)>>>0;if(1==t){if(h)throw new Error("Document has multiple roots");h=e}}))})),!h)throw new Error("Cannot find Document root");return aM(l,h,t)}function iM(e,t,r){var n,a,s=[[],[{type:0,data:II(0)}],[{type:0,data:II(0)}],[{type:2,data:new Uint8Array([])}],[{type:2,data:new Uint8Array(Array.from({length:510},(function(){return 255})))}],[{type:0,data:II(5)}],[{type:2,data:new Uint8Array([])}],[{type:2,data:new Uint8Array(Array.from({length:510},(function(){return 255})))}],[{type:0,data:II(1)}]];if(!(null==(n=s[6])?void 0:n[0])||!(null==(a=s[7])?void 0:a[0]))throw"Mutation only works on post-BNC storages!";var i=0;if(s[7][0].data.length<2*e.length){var o=new Uint8Array(2*e.length);o.set(s[7][0].data),s[7][0].data=o}if(s[4][0].data.length<2*e.length){var c=new Uint8Array(2*e.length);c.set(s[4][0].data),s[4][0].data=c}for(var l=AI(s[7][0].data),u=0,h=[],f=AI(s[4][0].data),d=0,p=[],m=r?4:1,g=0;g<e.length;++g)if(null!=e[g]){var E,v;switch(l.setUint16(2*g,u/m,!0),f.setUint16(2*g,d/m,!0),typeof e[g]){case"string":E=zI({t:"s",v:e[g]},t),v=$I({t:"s",v:e[g]},t);break;case"number":E=zI({t:"n",v:e[g]},t),v=$I({t:"n",v:e[g]},t);break;case"boolean":E=zI({t:"b",v:e[g]},t),v=$I({t:"b",v:e[g]},t);break;default:if(e[g]instanceof Date){E=zI({t:"s",v:e[g].toISOString()},t),v=$I({t:"s",v:e[g].toISOString()},t);break}throw new Error("Unsupported value "+e[g])}h.push(E),u+=E.length,p.push(v),d+=v.length,++i}else l.setUint16(2*g,65535,!0),f.setUint16(2*g,65535);for(s[2][0].data=II(i),s[5][0].data=II(5);g<s[7][0].data.length/2;++g)l.setUint16(2*g,65535,!0),f.setUint16(2*g,65535,!0);return s[6][0].data=NI(h),s[3][0].data=NI(p),s[8]=[{type:0,data:II(r?1:0)}],s}function oM(e,t){return{meta:[[],[{type:0,data:II(e)}]],data:t}}function cM(e,t){t.last||(t.last=927262);for(var r=t.last;r<2e6;++r)if(!t[r])return t[t.last=r]=e,r;throw new Error("Too many messages")}function lM(e){var t={},r=[];return e.FileIndex.map((function(t,r){return[t,e.FullPaths[r]]})).forEach((function(e){var n=e[0],a=e[1];2==n.type&&n.name.match(/\.iwa/)&&0==n.content[0]&&xI(BI(n.content)).forEach((function(e){r.push(e.id),t[e.id]={deps:[],location:a,type:LI(e.messages[0].meta[1][0].data)}}))})),e.FileIndex.forEach((function(e){e.name.match(/\.iwa/)&&0==e.content[0]&&xI(BI(e.content)).forEach((function(e){e.messages.forEach((function(r){[5,6].forEach((function(n){r.meta[n]&&r.meta[n].forEach((function(r){t[e.id].deps.push(LI(r.data))}))}))}))}))})),t}function uM(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=tf.read(t.numbers,{type:"base64"}),n=lM(r),a=fM(r,n,1);if(null==a)throw"Could not find message ".concat(1," in Numbers template");var s=UI(kI(a.messages[0].data)[1],XI);if(s.length>1)throw new Error("Template NUMBERS file must have exactly one sheet");return e.SheetNames.forEach((function(t,i){i>=1&&(dM(r,n,i+1),a=fM(r,n,1),s=UI(kI(a.messages[0].data)[1],XI)),pM(r,n,e.Sheets[t],t,i,s[i])})),r}function hM(e,t,r,n){var a=tf.find(e,t[r].location);if(!a)throw"Could not find ".concat(t[r].location," in Numbers template");var s=xI(BI(a.content)),i=s.find((function(e){return e.id==r}));n(i,s),a.content=YI(FI(s)),a.size=a.content.length}function fM(e,t,r){var n=tf.find(e,t[r].location);if(!n)throw"Could not find ".concat(t[r].location," in Numbers template");var a=xI(BI(n.content)),s=a.find((function(e){return e.id==r}));return s}function dM(e,t,r){var n=-1,a=-1,s={};hM(e,t,1,(function(r,i){var o=kI(r.messages[0].data);n=XI(kI(r.messages[0].data)[1][0].data),a=cM({deps:[1],location:t[n].location,type:2},t),s[n]=a,qI(r,a),o[1].push({type:2,data:KI(a)});var c=fM(e,t,n);c.id=a,t[1].location==t[a].location?i.push(c):hM(e,t,a,(function(e,t){return t.push(c)})),r.messages[0].data=_I(o)}));var i=-1;hM(e,t,a,(function(r,n){for(var o=kI(r.messages[0].data),c=3;c<=69;++c)delete o[c];var l=UI(o[2],XI);l.forEach((function(e){return JI(r,e)})),i=cM({deps:[a],location:t[l[0]].location,type:t[l[0]].type},t),qI(r,i),s[l[0]]=i,o[2]=[{type:2,data:KI(i)}];var u=fM(e,t,l[0]);if(u.id=i,t[l[0]].location==t[a].location)n.push(u);else{var h=t[a].location;h=h.replace(/^Root Entry\//,""),h=h.replace(/^Index\//,"").replace(/\.iwa$/,""),hM(e,t,2,(function(e){var t=kI(e.messages[0].data),r=t[3].findIndex((function(e){var t,r,n=kI(e.data);return(null==(t=n[3])?void 0:t[0])?RI(n[3][0].data)==h:!(!(null==(r=n[2])?void 0:r[0])||RI(n[2][0].data)!=h)})),n=kI(t[3][r].data);n[6]||(n[6]=[]),n[6].push({type:2,data:_I([[],[{type:0,data:II(i)}]])}),t[3][r].data=_I(n),e.messages[0].data=_I(t)})),hM(e,t,i,(function(e,t){return t.push(u)}))}r.messages[0].data=_I(o)}));var o=-1;hM(e,t,i,(function(r,n){for(var a=kI(r.messages[0].data),c=kI(a[1][0].data),l=3;l<=69;++l)delete c[l];var u=XI(c[2][0].data);c[2][0].data=KI(s[u]),a[1][0].data=_I(c);var h=XI(a[2][0].data);JI(r,h),o=cM({deps:[i],location:t[h].location,type:t[h].type},t),qI(r,o),s[h]=o,a[2][0].data=KI(o);var f=fM(e,t,h);f.id=o,t[i].location==t[o].location?n.push(f):hM(e,t,o,(function(e,t){return t.push(f)})),r.messages[0].data=_I(a)}));var c=t[o].location;c=c.replace(/^Root Entry\//,""),c=c.replace(/^Index\//,"").replace(/\.iwa$/,""),hM(e,t,o,(function(n,a){var i,l,u=kI(n.messages[0].data),h=RI(u[1][0].data),f=h.replace(/-[A-Z0-9]*/,"-".concat(r.toString(16).padStart(4,"0")));if(u[1][0].data=yI(f),[12,13,29,31,32,33,39,44,47,81,82,84].forEach((function(e){return delete u[e]})),u[45]){var d=kI(u[45][0].data),p=XI(d[1][0].data);JI(n,p),delete u[45]}if(u[70]){var m=kI(u[70][0].data);null==(i=m[2])||i.forEach((function(e){var t=kI(e.data);[2,3].map((function(e){return t[e][0]})).forEach((function(e){var t=kI(e.data);if(t[8]){var r=XI(t[8][0].data);JI(n,r)}}))})),delete u[70]}[46,30,34,35,36,38,48,49,60,61,62,63,64,71,72,73,74,75,85,86,87,88,89].forEach((function(e){if(u[e]){var t=XI(u[e][0].data);delete u[e],JI(n,t)}}));var g=kI(u[4][0].data);[2,4,5,6,11,12,13,15,16,17,18,19,20,21,22].forEach((function(r){var i;if(null==(i=g[r])?void 0:i[0]){var l=XI(g[r][0].data),u=cM({deps:[o],location:t[l].location,type:t[l].type},t);JI(n,l),qI(n,u),s[l]=u;var h=fM(e,t,l);if(h.id=u,t[l].location==t[o].location)a.push(h);else{t[u].location=t[l].location.replace(l.toString(),u.toString()),t[u].location==t[l].location&&(t[u].location=t[u].location.replace(/\.iwa/,"-".concat(u,".iwa"))),tf.utils.cfb_add(e,t[u].location,YI(FI([h])));var f=t[u].location;f=f.replace(/^Root Entry\//,""),f=f.replace(/^Index\//,"").replace(/\.iwa$/,""),hM(e,t,2,(function(e){var t=kI(e.messages[0].data);t[3].push({type:2,data:_I([[],[{type:0,data:II(u)}],[{type:2,data:yI(f.replace(/-.*$/,""))}],[{type:2,data:yI(f)}],[{type:2,data:new Uint8Array([2,0,0])}],[{type:2,data:new Uint8Array([2,0,0])}],[],[],[],[],[{type:0,data:II(0)}],[],[{type:0,data:II(0)}]])}),t[1]=[{type:0,data:II(Math.max(u+1,LI(t[1][0].data)))}];var r=t[3].findIndex((function(e){var t,r,n=kI(e.data);return(null==(t=n[3])?void 0:t[0])?RI(n[3][0].data)==c:!(!(null==(r=n[2])?void 0:r[0])||RI(n[2][0].data)!=c)})),n=kI(t[3][r].data);n[6]||(n[6]=[]),n[6].push({type:2,data:_I([[],[{type:0,data:II(u)}]])}),t[3][r].data=_I(n),e.messages[0].data=_I(t)}))}g[r][0].data=KI(u)}}));var E=kI(g[1][0].data);null==(l=E[2])||l.forEach((function(r){var i=XI(r.data),l=cM({deps:[o],location:t[i].location,type:t[i].type},t);JI(n,i),qI(n,l),s[i]=l;var u=fM(e,t,i);if(u.id=l,t[i].location==t[o].location)a.push(u);else{t[l].location=t[i].location.replace(i.toString(),l.toString()),t[l].location==t[i].location&&(t[l].location=t[l].location.replace(/\.iwa/,"-".concat(l,".iwa"))),tf.utils.cfb_add(e,t[l].location,YI(FI([u])));var h=t[l].location;h=h.replace(/^Root Entry\//,""),h=h.replace(/^Index\//,"").replace(/\.iwa$/,""),hM(e,t,2,(function(e){var t=kI(e.messages[0].data);t[3].push({type:2,data:_I([[],[{type:0,data:II(l)}],[{type:2,data:yI(h.replace(/-.*$/,""))}],[{type:2,data:yI(h)}],[{type:2,data:new Uint8Array([2,0,0])}],[{type:2,data:new Uint8Array([2,0,0])}],[],[],[],[],[{type:0,data:II(0)}],[],[{type:0,data:II(0)}]])}),t[1]=[{type:0,data:II(Math.max(l+1,LI(t[1][0].data)))}];var r=t[3].findIndex((function(e){var t,r,n=kI(e.data);return(null==(t=n[3])?void 0:t[0])?RI(n[3][0].data)==c:!(!(null==(r=n[2])?void 0:r[0])||RI(n[2][0].data)!=c)})),n=kI(t[3][r].data);n[6]||(n[6]=[]),n[6].push({type:2,data:_I([[],[{type:0,data:II(l)}]])}),t[3][r].data=_I(n),e.messages[0].data=_I(t)}))}r.data=KI(l)})),g[1][0].data=_I(E);var v=kI(g[3][0].data);v[1].forEach((function(r){var a=kI(r.data),i=XI(a[2][0].data),l=s[i];if(!s[i]){l=cM({deps:[o],location:"",type:t[i].type},t),t[l].location="Root Entry/Index/Tables/Tile-".concat(l,".iwa"),s[i]=l;var u=fM(e,t,i);u.id=l,JI(n,i),qI(n,l),tf.utils.cfb_add(e,"/Index/Tables/Tile-".concat(l,".iwa"),YI(FI([u]))),hM(e,t,2,(function(e){var t=kI(e.messages[0].data);t[3].push({type:2,data:_I([[],[{type:0,data:II(l)}],[{type:2,data:yI("Tables/Tile")}],[{type:2,data:yI("Tables/Tile-".concat(l))}],[{type:2,data:new Uint8Array([2,0,0])}],[{type:2,data:new Uint8Array([2,0,0])}],[],[],[],[],[{type:0,data:II(0)}],[],[{type:0,data:II(0)}]])}),t[1]=[{type:0,data:II(Math.max(l+1,LI(t[1][0].data)))}];var r=t[3].findIndex((function(e){var t,r,n=kI(e.data);return(null==(t=n[3])?void 0:t[0])?RI(n[3][0].data)==c:!(!(null==(r=n[2])?void 0:r[0])||RI(n[2][0].data)!=c)})),n=kI(t[3][r].data);n[6]||(n[6]=[]),n[6].push({type:2,data:_I([[],[{type:0,data:II(l)}]])}),t[3][r].data=_I(n),e.messages[0].data=_I(t)}))}a[2][0].data=KI(l),r.data=_I(a)})),g[3][0].data=_I(v),u[4][0].data=_I(g),n.messages[0].data=_I(u)}))}function pM(e,t,r,n,a,s){var i=[];hM(e,t,s,(function(e){var t=kI(e.messages[0].data);t[1]=[{type:2,data:yI(n)}],i=UI(t[2],XI),e.messages[0].data=_I(t)}));var o=fM(e,t,i[0]),c=XI(kI(o.messages[0].data)[2][0].data);hM(e,t,c,(function(n,a){return gM(e,t,r,n,a,c)}))}var mM=!0;function gM(e,t,r,n,a,s){var i=Bp(r["!ref"]);i.s.r=i.s.c=0;var o=!1;i.e.c>999&&(o=!0,i.e.c=999),i.e.r>999999&&(o=!0,i.e.r=999999),o&&console.error("Truncating to ".concat(Yp(i)));var c=eD(r,{range:i,header:1}),l=["~Sh33tJ5~"],u=t[s].location;u=u.replace(/^Root Entry\//,""),u=u.replace(/^Index\//,"").replace(/\.iwa$/,"");var h=kI(n.messages[0].data);h[6][0].data=II(i.e.r+1),h[7][0].data=II(i.e.c+1),delete h[46];var f=kI(h[4][0].data),d=XI(kI(f[1][0].data)[2][0].data);hM(e,t,d,(function(e,t){var r,n=kI(e.messages[0].data);if(null==(r=null==n?void 0:n[2])?void 0:r[0])for(var a=0;a<c.length;++a){var s=kI(n[2][0].data);s[1][0].data=II(a),s[4][0].data=II(c[a].length),n[2][a]={type:n[2][0].type,data:_I(s)}}e.messages[0].data=_I(n)}));var p=XI(f[2][0].data);hM(e,t,p,(function(e,t){for(var r=kI(e.messages[0].data),n=0;n<=i.e.c;++n){var a=kI(r[2][0].data);a[1][0].data=II(n),a[4][0].data=II(i.e.r+1),r[2][n]={type:r[2][0].type,data:_I(a)}}e.messages[0].data=_I(r)}));var m=kI(f[9][0].data);m[1]=[];var g=kI(f[3][0].data),E=256;g[2]=[{type:0,data:II(E)}];var v=XI(kI(g[1][0].data)[2][0].data),T=function(){var r=fM(e,t,2),n=kI(r.messages[0].data),a=n[3].filter((function(e){return LI(kI(e.data)[1][0].data)==v}));return(null==a?void 0:a.length)?LI(kI(a[0].data)[12][0].data):0}();tf.utils.cfb_del(e,t[v].location),hM(e,t,2,(function(e){var t=kI(e.messages[0].data);t[3]=t[3].filter((function(e){return LI(kI(e.data)[1][0].data)!=v}));var r=t[3].findIndex((function(e){var t,r,n=kI(e.data);return(null==(t=n[3])?void 0:t[0])?RI(n[3][0].data)==u:!(!(null==(r=n[2])?void 0:r[0])||RI(n[2][0].data)!=u)})),n=kI(t[3][r].data);n[6]||(n[6]=[]),n[6]=n[6].filter((function(e){return LI(kI(e.data)[1][0].data)!=v})),t[3][r].data=_I(n),e.messages[0].data=_I(t)})),JI(n,v),g[1]=[];for(var S=Math.ceil((i.e.r+1)/E),A=0;A<S;++A){var R=cM({deps:[],location:"",type:6002},t);t[R].location="Root Entry/Index/Tables/Tile-".concat(R,".iwa");for(var y=[[],[{type:0,data:II(0)}],[{type:0,data:II(Math.min(i.e.r+1,(A+1)*E))}],[{type:0,data:II(0)}],[{type:0,data:II(Math.min((A+1)*E,i.e.r+1)-A*E)}],[],[{type:0,data:II(5)}],[{type:0,data:II(1)}],[{type:0,data:II(mM?1:0)}]],N=A*E;N<=Math.min(i.e.r,(A+1)*E-1);++N){var w=iM(c[N],l,mM);w[1][0].data=II(N-A*E),y[5].push({data:_I(w),type:2})}g[1].push({type:2,data:_I([[],[{type:0,data:II(A)}],[{type:2,data:KI(R)}]])});var b={id:R,messages:[oM(6002,_I(y))]},C=YI(FI([b]));tf.utils.cfb_add(e,"/Index/Tables/Tile-".concat(R,".iwa"),C),hM(e,t,2,(function(e){var t=kI(e.messages[0].data);t[3].push({type:2,data:_I([[],[{type:0,data:II(R)}],[{type:2,data:yI("Tables/Tile")}],[{type:2,data:yI("Tables/Tile-".concat(R))}],[{type:2,data:new Uint8Array([2,0,0])}],[{type:2,data:new Uint8Array([2,0,0])}],[],[],[],[],[{type:0,data:II(0)}],[],[{type:0,data:II(T)}]])}),t[1]=[{type:0,data:II(Math.max(R+1,LI(t[1][0].data)))}];var r=t[3].findIndex((function(e){var t,r,n=kI(e.data);return(null==(t=n[3])?void 0:t[0])?RI(n[3][0].data)==u:!(!(null==(r=n[2])?void 0:r[0])||RI(n[2][0].data)!=u)})),n=kI(t[3][r].data);n[6]||(n[6]=[]),n[6].push({type:2,data:_I([[],[{type:0,data:II(R)}]])}),t[3][r].data=_I(n),e.messages[0].data=_I(t)})),qI(n,R),m[1].push({type:2,data:_I([[],[{type:0,data:II(A*E)}],[{type:0,data:II(A)}]])})}if(f[3][0].data=_I(g),f[9][0].data=_I(m),f[10]=[{type:2,data:new Uint8Array([])}],r["!merges"]){var O=cM({type:6144,deps:[s],location:t[s].location},t);a.push({id:O,messages:[oM(6144,_I([[],r["!merges"].map((function(e){return{type:2,data:_I([[],[{type:2,data:_I([[],[{type:5,data:new Uint8Array(new Uint16Array([e.s.r,e.s.c]).buffer)}]])}],[{type:2,data:_I([[],[{type:5,data:new Uint8Array(new Uint16Array([e.e.r-e.s.r+1,e.e.c-e.s.c+1]).buffer)}]])}]])}}))]))]}),f[13]=[{type:2,data:KI(O)}],hM(e,t,2,(function(e){var t=kI(e.messages[0].data),r=t[3].findIndex((function(e){var t,r,n=kI(e.data);return(null==(t=n[3])?void 0:t[0])?RI(n[3][0].data)==u:!(!(null==(r=n[2])?void 0:r[0])||RI(n[2][0].data)!=u)})),n=kI(t[3][r].data);n[6]||(n[6]=[]),n[6].push({type:2,data:_I([[],[{type:0,data:II(O)}]])}),t[3][r].data=_I(n),e.messages[0].data=_I(t)})),qI(n,O)}else delete f[13];var I=XI(f[4][0].data);hM(e,t,I,(function(e){var t=kI(e.messages[0].data);t[3]=[],l.forEach((function(e,r){0!=r&&t[3].push({type:2,data:_I([[],[{type:0,data:II(r)}],[{type:0,data:II(1)}],[{type:2,data:yI(e)}]])})})),e.messages[0].data=_I(t)})),h[4][0].data=_I(f),n.messages[0].data=_I(h)}function EM(e){return function(t){for(var r=0;r!=e.length;++r){var n=e[r];void 0===t[n[0]]&&(t[n[0]]=n[1]),"n"===n[2]&&(t[n[0]]=Number(t[n[0]]))}}}function vM(e){EM([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function TM(e){EM([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function SM(e){return sg.WS.indexOf(e)>-1?"sheet":sg.CS&&e==sg.CS?"chart":sg.DS&&e==sg.DS?"dialog":sg.MS&&e==sg.MS?"macro":e&&e.length?e:"sheet"}function AM(e,t){if(!e)return 0;try{e=t.map((function(t){return t.id||(t.id=t.strRelID),[t.name,e["!id"][t.id].Target,SM(e["!id"][t.id].Type)]}))}catch(r){return null}return e&&0!==e.length?e:null}function RM(e,t,r,n,a,s,i,o,c,l,u,h){try{s[n]=og(Pf(e,r,!0),t);var f,d=Ff(e,t);switch(o){case"sheet":f=FC(d,t,a,c,s[n],l,u,h);break;case"chart":if(f=PC(d,t,a,c,s[n],l,u,h),!f||!f["!drawel"])break;var p=Hf(f["!drawel"].Target,t),m=ig(p),g=uR(Pf(e,p,!0),og(Pf(e,m,!0),p)),E=Hf(g,p),v=ig(E);f=tC(Pf(e,E,!0),E,c,og(Pf(e,v,!0),E),l,f);break;case"macro":f=BC(d,t,a,c,s[n],l,u,h);break;case"dialog":f=YC(d,t,a,c,s[n],l,u,h);break;default:throw new Error("Unrecognized sheet type "+o)}i[n]=f;var T=[],S=[];s&&s[n]&&of(s[n]).forEach((function(r){var a="";if(s[n][r].Type==sg.CMNT){if(a=Hf(s[n][r].Target,t),T=GC(Ff(e,a,!0),a,c),!T||!T.length)return;dR(f,T,!1)}s[n][r].Type==sg.TCMNT&&(a=Hf(s[n][r].Target,t),S=S.concat(gR(Ff(e,a,!0),c)))})),S&&S.length&&dR(f,S,!0,c.people||[])}catch(A){if(c.WTF)throw A}}function yM(e){return"/"==e.charAt(0)?e.slice(1):e}function NM(e,t){if(zh(),t=t||{},vM(t),Uf(e,"META-INF/manifest.xml"))return dI(e,t);if(Uf(e,"objectdata.xml"))return dI(e,t);if(Uf(e,"Index/Document.iwa")){if("undefined"==typeof Uint8Array)throw new Error("NUMBERS file parsing requires Uint8Array support");if("undefined"!=typeof sM){if(e.FileIndex)return sM(e,t);var r=tf.utils.cfb_new();return Yf(e).forEach((function(t){Vf(r,t,Bf(e,t))})),sM(r,t)}throw new Error("Unsupported NUMBERS file")}if(!Uf(e,"[Content_Types].xml")){if(Uf(e,"index.xml.gz"))throw new Error("Unsupported NUMBERS 08 file");if(Uf(e,"index.xml"))throw new Error("Unsupported NUMBERS 09 file");var n=tf.find(e,"Index.zip");if(n)return t=Nf(t),delete t.type,"string"==typeof n.content&&(t.type="binary"),"undefined"!==typeof Bun&&Buffer.isBuffer(n.content)?xM(new Uint8Array(n.content),t):xM(n.content,t);throw new Error("Unsupported ZIP file")}var a,s,i=Yf(e),o=ng(Pf(e,"[Content_Types].xml")),c=!1;if(0===o.workbooks.length&&(s="xl/workbook.xml",Ff(e,s,!0)&&o.workbooks.push(s)),0===o.workbooks.length){if(s="xl/workbook.bin",!Ff(e,s,!0))throw new Error("Could not find workbook");o.workbooks.push(s),c=!0}"bin"==o.workbooks[0].slice(-3)&&(c=!0);var l={},u={};if(!t.bookSheets&&!t.bookProps){if(XN=[],o.sst)try{XN=WC(Ff(e,yM(o.sst)),o.sst,t)}catch(D){if(t.WTF)throw D}t.cellStyles&&o.themes.length&&(l=PA(Pf(e,o.themes[0].replace(/^\//,""),!0)||"",t)),o.style&&(u=VC(Ff(e,yM(o.style)),o.style,l,t))}o.links.map((function(r){try{var n=og(Pf(e,ig(yM(r))),r);return zC(Ff(e,yM(r)),n,r,t)}catch(D){}}));var h=xC(Ff(e,yM(o.workbooks[0])),o.workbooks[0],t),f={},d="";o.coreprops.length&&(d=Ff(e,yM(o.coreprops[0]),!0),d&&(f=Tg(d)),0!==o.extprops.length&&(d=Ff(e,yM(o.extprops[0]),!0),d&&wg(d,f,t)));var p={};t.bookSheets&&!t.bookProps||0!==o.custprops.length&&(d=Pf(e,yM(o.custprops[0]),!0),d&&(p=Og(d,t)));var m={};if((t.bookSheets||t.bookProps)&&(h.Sheets?a=h.Sheets.map((function(e){return e.name})):f.Worksheets&&f.SheetNames.length>0&&(a=f.SheetNames),t.bookProps&&(m.Props=f,m.Custprops=p),t.bookSheets&&"undefined"!==typeof a&&(m.SheetNames=a),t.bookSheets?m.SheetNames:t.bookProps))return m;a={};var g={};t.bookDeps&&o.calcchain&&(g=HC(Ff(e,yM(o.calcchain)),o.calcchain,t));var E,v,T=0,S={},A=h.Sheets;f.Worksheets=A.length,f.SheetNames=[];for(var R=0;R!=A.length;++R)f.SheetNames[R]=A[R].name;var y=c?"bin":"xml",N=o.workbooks[0].lastIndexOf("/"),w=(o.workbooks[0].slice(0,N+1)+"_rels/"+o.workbooks[0].slice(N+1)+".rels").replace(/^\//,"");Uf(e,w)||(w="xl/_rels/workbook."+y+".rels");var b=og(Pf(e,w,!0),w.replace(/_rels.*/,"s5s"));(o.metadata||[]).length>=1&&(t.xlmeta=$C(Ff(e,yM(o.metadata[0])),o.metadata[0],t)),(o.people||[]).length>=1&&(t.people=vR(Ff(e,yM(o.people[0])),t)),b&&(b=AM(b,h.Sheets));var C=Ff(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(T=0;T!=f.Worksheets;++T){var O="sheet";if(b&&b[T]?(E="xl/"+b[T][1].replace(/[\/]?xl\//,""),Uf(e,E)||(E=b[T][1]),Uf(e,E)||(E=w.replace(/_rels\/.*$/,"")+b[T][1]),O=b[T][2]):(E="xl/worksheets/sheet"+(T+1-C)+"."+y,E=E.replace(/sheet0\./,"sheet.")),v=E.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&null!=t.sheets)switch(typeof t.sheets){case"number":if(T!=t.sheets)continue e;break;case"string":if(f.SheetNames[T].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var I=!1,M=0;M!=t.sheets.length;++M)"number"==typeof t.sheets[M]&&t.sheets[M]==T&&(I=1),"string"==typeof t.sheets[M]&&t.sheets[M].toLowerCase()==f.SheetNames[T].toLowerCase()&&(I=1);if(!I)continue e}}RM(e,E,v,f.SheetNames[T],T,S,a,O,t,h,l,u)}return m={Directory:o,Workbook:h,Props:f,Custprops:p,Deps:g,Sheets:a,SheetNames:f.SheetNames,Strings:XN,Styles:u,Themes:l,SSF:Nf(qu)},t&&t.bookFiles&&(e.files?(m.keys=i,m.files=e.files):(m.keys=[],m.files={},e.FullPaths.forEach((function(t,r){t=t.replace(/^Root Entry[\/]/,""),m.keys.push(t),m.files[t]=e.FileIndex[r]})))),t&&t.bookVBA&&(o.vba.length>0?m.vbaraw=Ff(e,yM(o.vba[0]),!0):o.defaults&&o.defaults.bin===bR&&(m.vbaraw=Ff(e,"xl/vbaProject.bin",!0))),m.bookType=c?"xlsb":"xlsx",m}function wM(e,t){var r=t||{},n="Workbook",a=tf.find(e,n);try{if(n="/!DataSpaces/Version",a=tf.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(eS(a.content),n="/!DataSpaces/DataSpaceMap",a=tf.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=rS(a.content);if(1!==s.length||1!==s[0].comps.length||0!==s[0].comps[0].t||"StrongEncryptionDataSpace"!==s[0].name||"EncryptedPackage"!==s[0].comps[0].v)throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",a=tf.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var i=nS(a.content);if(1!=i.length||"StrongEncryptionTransform"!=i[0])throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",a=tf.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);sS(a.content)}catch(c){}if(n="/EncryptionInfo",a=tf.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=cS(a.content);if(n="/EncryptedPackage",a=tf.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(4==o[0]&&"undefined"!==typeof decrypt_agile)return decrypt_agile(o[1],a.content,r.password||"",r);if(2==o[0]&&"undefined"!==typeof decrypt_std76)return decrypt_std76(o[1],a.content,r.password||"",r);throw new Error("File is password-protected")}function bM(e,t){e&&!e.SSF&&(e.SSF=Nf(qu)),e&&e.SSF&&(zh(),Hh(e.SSF),t.revssf=uf(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,qN?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="bin",n=!0,a=rg();TM(t=t||{});var s=Wf(),i="",o=0;if(t.cellXfs=[],ew(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),i="docProps/core.xml",Vf(s,i,Ag(e.Props,t)),a.coreprops.push(i),lg(t.rels,2,i,sg.CORE_PROPS),i="docProps/app.xml",e.Props&&e.Props.SheetNames);else if(e.Workbook&&e.Workbook.Sheets){for(var c=[],l=0;l<e.SheetNames.length;++l)2!=(e.Workbook.Sheets[l]||{}).Hidden&&c.push(e.SheetNames[l]);e.Props.SheetNames=c}else e.Props.SheetNames=e.SheetNames;for(e.Props.Worksheets=e.Props.SheetNames.length,Vf(s,i,bg(e.Props,t)),a.extprops.push(i),lg(t.rels,3,i,sg.EXT_PROPS),e.Custprops!==e.Props&&of(e.Custprops||{}).length>0&&(i="docProps/custom.xml",Vf(s,i,Ig(e.Custprops,t)),a.custprops.push(i),lg(t.rels,4,i,sg.CUST_PROPS)),o=1;o<=e.SheetNames.length;++o){var u={"!id":{}},h=e.Sheets[e.SheetNames[o-1]],f=(h||{})["!type"]||"sheet";switch(f){case"chart":default:i="xl/worksheets/sheet"+o+"."+r,Vf(s,i,Zb(o-1,t,e,u)),a.sheets.push(i),lg(t.wbrels,-1,"worksheets/sheet"+o+"."+r,sg.WS[0])}if(h){var d=h["!comments"],p=!1,m="";d&&d.length>0&&(m="xl/comments"+o+"."+r,Vf(s,m,wR(d,t)),a.comments.push(m),lg(u,-1,"../comments"+o+"."+r,sg.CMNT),p=!0),h["!legacy"]&&p&&Vf(s,"xl/drawings/vmlDrawing"+o+".vml",hR(o,h["!comments"])),delete h["!comments"],delete h["!legacy"]}u["!id"].rId1&&Vf(s,ig(i),cg(u))}null!=t.Strings&&t.Strings.length>0&&(i="xl/sharedStrings."+r,Vf(s,i,JT(t.Strings,t)),a.strs.push(i),lg(t.wbrels,-1,"sharedStrings."+r,sg.SST)),i="xl/workbook."+r,Vf(s,i,UC(e,t)),a.workbooks.push(i),lg(t.rels,1,i,sg.WB),i="xl/theme/theme1.xml";var g=BA(e.Themes,t);return Vf(s,i,g),a.themes.push(i),lg(t.wbrels,-1,"theme/theme1.xml",sg.THEME),i="xl/styles."+r,Vf(s,i,OA(e,t)),a.styles.push(i),lg(t.wbrels,-1,"styles."+r,sg.STY),e.vbaraw&&n&&(i="xl/vbaProject.bin",Vf(s,i,e.vbaraw),a.vba.push(i),lg(t.wbrels,-1,"vbaProject.bin",sg.VBA)),i="xl/metadata."+r,Vf(s,i,rR()),a.metadata.push(i),lg(t.wbrels,-1,"metadata."+r,sg.XLMETA),Vf(s,"[Content_Types].xml",ag(a,t)),Vf(s,"_rels/.rels",cg(t.rels)),Vf(s,"xl/_rels/workbook."+r+".rels",cg(t.wbrels)),delete t.revssf,delete t.ssf,s}function CM(e,t){e&&!e.SSF&&(e.SSF=Nf(qu)),e&&e.SSF&&(zh(),Hh(e.SSF),t.revssf=uf(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,qN?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",n=IR.indexOf(t.bookType)>-1,a=rg();TM(t=t||{});var s=Wf(),i="",o=0;if(t.cellXfs=[],ew(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),i="docProps/core.xml",Vf(s,i,Ag(e.Props,t)),a.coreprops.push(i),lg(t.rels,2,i,sg.CORE_PROPS),i="docProps/app.xml",e.Props&&e.Props.SheetNames);else if(e.Workbook&&e.Workbook.Sheets){for(var c=[],l=0;l<e.SheetNames.length;++l)2!=(e.Workbook.Sheets[l]||{}).Hidden&&c.push(e.SheetNames[l]);e.Props.SheetNames=c}else e.Props.SheetNames=e.SheetNames;e.Props.Worksheets=e.Props.SheetNames.length,Vf(s,i,bg(e.Props,t)),a.extprops.push(i),lg(t.rels,3,i,sg.EXT_PROPS),e.Custprops!==e.Props&&of(e.Custprops||{}).length>0&&(i="docProps/custom.xml",Vf(s,i,Ig(e.Custprops,t)),a.custprops.push(i),lg(t.rels,4,i,sg.CUST_PROPS));var u=["SheetJ5"];for(t.tcid=0,o=1;o<=e.SheetNames.length;++o){var h={"!id":{}},f=e.Sheets[e.SheetNames[o-1]],d=(f||{})["!type"]||"sheet";switch(d){case"chart":default:i="xl/worksheets/sheet"+o+"."+r,Vf(s,i,Uw(o-1,t,e,h)),a.sheets.push(i),lg(t.wbrels,-1,"worksheets/sheet"+o+"."+r,sg.WS[0])}if(f){var p=f["!comments"],m=!1,g="";if(p&&p.length>0){var E=!1;p.forEach((function(e){e[1].forEach((function(e){1==e.T&&(E=!0)}))})),E&&(g="xl/threadedComments/threadedComment"+o+".xml",Vf(s,g,ER(p,u,t)),a.threadedcomments.push(g),lg(h,-1,"../threadedComments/threadedComment"+o+".xml",sg.TCMNT)),g="xl/comments"+o+"."+r,Vf(s,g,mR(p,t)),a.comments.push(g),lg(h,-1,"../comments"+o+"."+r,sg.CMNT),m=!0}f["!legacy"]&&m&&Vf(s,"xl/drawings/vmlDrawing"+o+".vml",hR(o,f["!comments"])),delete f["!comments"],delete f["!legacy"]}h["!id"].rId1&&Vf(s,ig(i),cg(h))}return null!=t.Strings&&t.Strings.length>0&&(i="xl/sharedStrings."+r,Vf(s,i,$T(t.Strings,t)),a.strs.push(i),lg(t.wbrels,-1,"sharedStrings."+r,sg.SST)),i="xl/workbook."+r,Vf(s,i,TC(e,t)),a.workbooks.push(i),lg(t.rels,1,i,sg.WB),i="xl/theme/theme1.xml",Vf(s,i,BA(e.Themes,t)),a.themes.push(i),lg(t.wbrels,-1,"theme/theme1.xml",sg.THEME),i="xl/styles."+r,Vf(s,i,tA(e,t)),a.styles.push(i),lg(t.wbrels,-1,"styles."+r,sg.STY),e.vbaraw&&n&&(i="xl/vbaProject.bin",Vf(s,i,e.vbaraw),a.vba.push(i),lg(t.wbrels,-1,"vbaProject.bin",sg.VBA)),i="xl/metadata."+r,Vf(s,i,aR()),a.metadata.push(i),lg(t.wbrels,-1,"metadata."+r,sg.XLMETA),u.length>1&&(i="xl/persons/person.xml",Vf(s,i,TR(u,t)),a.people.push(i),lg(t.wbrels,-1,"persons/person.xml",sg.PEOPLE)),Vf(s,"[Content_Types].xml",ag(a,t)),Vf(s,"_rels/.rels",cg(t.rels)),Vf(s,"xl/_rels/workbook."+r+".rels",cg(t.wbrels)),delete t.revssf,delete t.ssf,s}function OM(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=yu(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function IM(e,t){return tf.find(e,"EncryptedPackage")?wM(e,t):IO(e,t)}function MM(e,t){var r,n=e,a=t||{};return a.type||(a.type=Nu&&Buffer.isBuffer(e)?"buffer":"base64"),r=Gf(n,a),NM(r,a)}function DM(e,t){var r=0;e:while(r<e.length)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return iO(e.slice(r),t);default:break e}return DT.to_workbook(e,t)}function LM(e,t){var r="",n=OM(e,t);switch(t.type){case"base64":r=yu(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=yf(e);break;default:throw new Error("Unrecognized type "+t.type)}return 239==n[0]&&187==n[1]&&191==n[2]&&(r=Ed(r)),t.type="binary",DM(r,t)}function kM(e,t){var r=e;return"base64"==t.type&&(r=yu(r)),r="undefined"!==typeof ql?ql.utils.decode(1200,r.slice(2),"str"):fu(r.slice(2)),t.type="binary",DM(r,t)}function _M(e){return e.match(/[^\x00-\x7F]/)?vd(e):e}function UM(e,t,r,n){return n?(r.type="string",DT.to_workbook(e,r)):DT.to_workbook(t,r)}function xM(e,t){uu();var r=t||{};if(r.codepage&&"undefined"===typeof ql&&console.error("Codepage tables are not loaded.  Non-ASCII characters may not give expected results"),"undefined"!==typeof ArrayBuffer&&e instanceof ArrayBuffer)return xM(new Uint8Array(e),(r=Nf(r),r.type="array",r));"undefined"!==typeof Uint8Array&&e instanceof Uint8Array&&!r.type&&(r.type="undefined"!==typeof Deno?"buffer":"array");var n=e,a=[0,0,0,0],s=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),KN={},r.dateNF&&(KN.dateNF=r.dateNF),r.type||(r.type=Nu&&Buffer.isBuffer(e)?"buffer":"base64"),"file"==r.type&&(r.type=Nu?"buffer":"binary",n=sf(e),"undefined"===typeof Uint8Array||Nu||(r.type="array")),"string"==r.type&&(s=!0,r.type="binary",r.codepage=65001,n=_M(e)),"array"==r.type&&"undefined"!==typeof Uint8Array&&e instanceof Uint8Array&&"undefined"!==typeof ArrayBuffer){var i=new ArrayBuffer(3),o=new Uint8Array(i);if(o.foo="bar",!o.foo)return r=Nf(r),r.type="array",xM(ku(n),r)}switch((a=OM(n,r))[0]){case 208:if(207===a[1]&&17===a[2]&&224===a[3]&&161===a[4]&&177===a[5]&&26===a[6]&&225===a[7])return IM(tf.read(n,r),r);break;case 9:if(a[1]<=8)return IO(n,r);break;case 60:return iO(n,r);case 73:if(73===a[1]&&42===a[2]&&0===a[3])throw new Error("TIFF Image File is not a spreadsheet");if(68===a[1])return LT(n,r);break;case 84:if(65===a[1]&&66===a[2]&&76===a[3])return IT.to_workbook(n,r);break;case 80:return 75===a[1]&&a[2]<9&&a[3]<9?MM(n,r):UM(e,n,r,s);case 239:return 60===a[3]?iO(n,r):UM(e,n,r,s);case 255:if(254===a[1])return kM(n,r);if(0===a[1]&&2===a[2]&&0===a[3])return kT.to_workbook(n,r);break;case 0:if(0===a[1]){if(a[2]>=2&&0===a[3])return kT.to_workbook(n,r);if(0===a[2]&&(8===a[3]||9===a[3]))return kT.to_workbook(n,r)}break;case 3:case 131:case 139:case 140:return CT.to_workbook(n,r);case 123:if(92===a[1]&&114===a[2]&&116===a[3])return yS(n,r);break;case 10:case 13:case 32:return LM(n,r);case 137:if(80===a[1]&&78===a[2]&&71===a[3])throw new Error("PNG Image File is not a spreadsheet");break;case 8:if(231===a[1])throw new Error("Unsupported Multiplan 1.x file!");break;case 12:if(236===a[1])throw new Error("Unsupported Multiplan 2.x file!");if(237===a[1])throw new Error("Unsupported Multiplan 3.x file!");break}return bT.indexOf(a[0])>-1&&a[2]<=12&&a[3]<=31?CT.to_workbook(n,r):UM(e,n,r,s)}function FM(e,t){var r=t||{};return r.type="file",xM(e,r)}function PM(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return af(t.file,tf.write(e,{type:Nu?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return tf.write(e,t)}function BM(e,t){switch(t.bookType){case"ods":return TI(e,t);case"numbers":return uM(e,t);case"xlsb":return bM(e,t);default:return CM(e,t)}}function YM(e,t){var r=Nf(t||{}),n=BM(e,r);return WM(n,r)}function VM(e,t){var r=Nf(t||{}),n=CM(e,r);return WM(n,r)}function WM(e,t){var r={},n=Nu?"nodebuffer":"undefined"!==typeof Uint8Array?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=n;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+t.type)}var a=e.FullPaths?tf.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if("undefined"!==typeof Deno&&"string"==typeof a){if("binary"==t.type||"base64"==t.type)return a;a=new Uint8Array(Mu(a))}return t.password&&"undefined"!==typeof encrypt_agile?PM(encrypt_agile(a,t.password),t):"file"===t.type?af(t.file,a):"string"==t.type?Ed(a):a}function GM(e,t){var r=t||{},n=MO(e,r);return PM(n,r)}function HM(e,t,r){r||(r="");var n=r+e;switch(t.type){case"base64":return Au(vd(n));case"binary":return vd(n);case"string":return e;case"file":return af(t.file,n,"utf8");case"buffer":return Nu?wu(n,"utf8"):"undefined"!==typeof TextEncoder?(new TextEncoder).encode(n):HM(n,{type:"binary"}).split("").map((function(e){return e.charCodeAt(0)}))}throw new Error("Unrecognized type "+t.type)}function zM(e,t){switch(t.type){case"base64":return Ru(e);case"binary":return e;case"string":return e;case"file":return af(t.file,e,"binary");case"buffer":return Nu?wu(e,"binary"):e.split("").map((function(e){return e.charCodeAt(0)}))}throw new Error("Unrecognized type "+t.type)}function $M(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",n=0;n<e.length;++n)r+=String.fromCharCode(e[n]);return"base64"==t.type?Au(r):"string"==t.type?Ed(r):r;case"file":return af(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function jM(e,t){uu(),gC(e);var r=Nf(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),"array"==r.type){r.type="binary";var n=jM(e,r);return r.type="array",Mu(n)}return VM(e,r)}function XM(e,t){uu(),gC(e);var r=Nf(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),"array"==r.type){r.type="binary";var n=XM(e,r);return r.type="array",Mu(n)}var a=0;if(r.sheet&&(a="number"==typeof r.sheet?r.sheet:e.SheetNames.indexOf(r.sheet),!e.SheetNames[a]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return HM(TO(e,r),r);case"slk":case"sylk":return HM(OT.from_sheet(e.Sheets[e.SheetNames[a]],r,e),r);case"htm":case"html":return HM(aI(e.Sheets[e.SheetNames[a]],r),r);case"txt":return zM(aD(e.Sheets[e.SheetNames[a]],r),r);case"csv":return HM(nD(e.Sheets[e.SheetNames[a]],r),r,"\ufeff");case"dif":return HM(IT.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"dbf":return $M(CT.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"prn":return HM(DT.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"rtf":return HM(NS(e.Sheets[e.SheetNames[a]],r),r);case"eth":return HM(MT.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"fods":return HM(TI(e,r),r);case"wk1":return $M(kT.sheet_to_wk1(e.Sheets[e.SheetNames[a]],r),r);case"wk3":return $M(kT.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),$M(JO(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),GM(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return YM(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function KM(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(e.bookType=r.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function qM(e,t,r){var n=r||{};return n.type="file",n.file=t,KM(n),XM(e,n)}function JM(e,t,r){var n=r||{};return n.type="file",n.file=t,KM(n),jM(e,n)}function QM(e,t,r,n){var a=r||{};a.type="file",a.file=e,KM(a),a.type="buffer";var s=n;return s instanceof Function||(s=r),Zh.writeFile(e,XM(t,a),s)}function ZM(e,t,r,n,a,s,i){var o=Ip(r),c=i.defval,l=i.raw||!Object.prototype.hasOwnProperty.call(i,"raw"),u=!0,h=null!=e["!data"],f=1===a?[]:{};if(1!==a)if(Object.defineProperty)try{Object.defineProperty(f,"__rowNum__",{value:r,enumerable:!1})}catch(g){f.__rowNum__=r}else f.__rowNum__=r;if(!h||e["!data"][r])for(var d=t.s.c;d<=t.e.c;++d){var p=h?(e["!data"][r]||[])[d]:e[n[d]+o];if(void 0!==p&&void 0!==p.t){var m=p.v;switch(p.t){case"z":if(null==m)break;continue;case"e":m=0==m?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+p.t)}if(null!=s[d]){if(null==m)if("e"==p.t&&null===m)f[s[d]]=null;else if(void 0!==c)f[s[d]]=c;else{if(!l||null!==m)continue;f[s[d]]=null}else f[s[d]]=l&&("n"!==p.t||"n"===p.t&&!1!==i.rawNumbers)?m:zp(p,m,i);null!=m&&(u=!1)}}else{if(void 0===c)continue;null!=s[d]&&(f[s[d]]=c)}}return{row:f,isempty:u}}function eD(e,t){if(null==e||null==e["!ref"])return[];var r={t:"n",v:0},n=0,a=1,s=[],i=0,o="",c={s:{r:0,c:0},e:{r:0,c:0}},l=t||{},u=null!=l.range?l.range:e["!ref"];switch(1===l.header?n=1:"A"===l.header?n=2:Array.isArray(l.header)?n=3:null==l.header&&(n=0),typeof u){case"string":c=Gp(u);break;case"number":c=Gp(e["!ref"]),c.s.r=u;break;default:c=u}n>0&&(a=0);var h=Ip(c.s.r),f=[],d=[],p=0,m=0,g=null!=e["!data"],E=c.s.r,v=0,T={};g&&!e["!data"][E]&&(e["!data"][E]=[]);var S=l.skipHidden&&e["!cols"]||[],A=l.skipHidden&&e["!rows"]||[];for(v=c.s.c;v<=c.e.c;++v)if(!(S[v]||{}).hidden)switch(f[v]=kp(v),r=g?e["!data"][E][v]:e[f[v]+h],n){case 1:s[v]=v-c.s.c;break;case 2:s[v]=f[v];break;case 3:s[v]=l.header[v-c.s.c];break;default:if(null==r&&(r={w:"__EMPTY",t:"s"}),o=i=zp(r,null,l),m=T[i]||0,m){do{o=i+"_"+m++}while(T[o]);T[i]=m,T[o]=1}else T[i]=1;s[v]=o}for(E=c.s.r+a;E<=c.e.r;++E)if(!(A[E]||{}).hidden){var R=ZM(e,c,E,f,n,s,l);(!1===R.isempty||(1===n?!1!==l.blankrows:l.blankrows))&&(d[p++]=R.row)}return d.length=p,d}var tD=/"/g;function rD(e,t,r,n,a,s,i,o){for(var c=!0,l=[],u="",h=Ip(r),f=null!=e["!data"],d=f&&e["!data"][r]||[],p=t.s.c;p<=t.e.c;++p)if(n[p]){var m=f?d[p]:e[n[p]+h];if(null==m)u="";else if(null!=m.v){c=!1,u=""+(o.rawNumbers&&"n"==m.t?m.v:zp(m,null,o));for(var g=0,E=0;g!==u.length;++g)if((E=u.charCodeAt(g))===a||E===s||34===E||o.forceQuotes){u='"'+u.replace(tD,'""')+'"';break}"ID"==u&&(u='"ID"')}else null==m.f||m.F?u="":(c=!1,u="="+m.f,u.indexOf(",")>=0&&(u='"'+u.replace(tD,'""')+'"'));l.push(u)}return!1===o.blankrows&&c?null:l.join(i)}function nD(e,t){var r=[],n=null==t?{}:t;if(null==e||null==e["!ref"])return"";for(var a=Gp(e["!ref"]),s=void 0!==n.FS?n.FS:",",i=s.charCodeAt(0),o=void 0!==n.RS?n.RS:"\n",c=o.charCodeAt(0),l=new RegExp(("|"==s?"\\|":s)+"+$"),u="",h=[],f=n.skipHidden&&e["!cols"]||[],d=n.skipHidden&&e["!rows"]||[],p=a.s.c;p<=a.e.c;++p)(f[p]||{}).hidden||(h[p]=kp(p));for(var m=0,g=a.s.r;g<=a.e.r;++g)(d[g]||{}).hidden||(u=rD(e,a,g,h,i,c,s,n),null!=u&&(n.strip&&(u=u.replace(l,"")),(u||!1!==n.blankrows)&&r.push((m++?o:"")+u)));return r.join("")}function aD(e,t){t||(t={}),t.FS="\t",t.RS="\n";var r=nD(e,t);if("undefined"==typeof ql||"string"==t.type)return r;var n=ql.utils.encode(1200,r,"str");return String.fromCharCode(255)+String.fromCharCode(254)+n}function sD(e){var t,r="",n="";if(null==e||null==e["!ref"])return[];var a,s=Gp(e["!ref"]),i="",o=[],c=[],l=null!=e["!data"];for(a=s.s.c;a<=s.e.c;++a)o[a]=kp(a);for(var u=s.s.r;u<=s.e.r;++u)for(i=Ip(u),a=s.s.c;a<=s.e.c;++a)if(r=o[a]+i,t=l?(e["!data"][u]||[])[a]:e[r],n="",void 0!==t){if(null!=t.F){if(r=t.F,!t.f)continue;n=t.f,-1==r.indexOf(":")&&(r=r+":"+r)}if(null!=t.f)n=t.f;else{if("z"==t.t)continue;if("n"==t.t&&null!=t.v)n=""+t.v;else if("b"==t.t)n=t.v?"TRUE":"FALSE";else if(void 0!==t.w)n="'"+t.w;else{if(void 0===t.v)continue;n="s"==t.t?"'"+t.v:""+t.v}}c[c.length]=r+"="+n}return c}function iD(e,t,r){var n=r||{},a=e?null!=e["!data"]:n.dense;null!=vu&&null==a&&(a=vu);var s=+!n.skipHeader,i=e||{};!e&&a&&(i["!data"]=[]);var o=0,c=0;if(i&&null!=n.origin)if("number"==typeof n.origin)o=n.origin;else{var l="string"==typeof n.origin?Fp(n.origin):n.origin;o=l.r,c=l.c}var u={s:{c:0,r:0},e:{c:c,r:o+t.length-1+s}};if(i["!ref"]){var h=Gp(i["!ref"]);u.e.c=Math.max(u.e.c,h.e.c),u.e.r=Math.max(u.e.r,h.e.r),-1==o&&(o=h.e.r+1,u.e.r=o+t.length-1+s)}else-1==o&&(o=0,u.e.r=t.length-1+s);var f=n.header||[],d=0,p=[];t.forEach((function(e,t){a&&!i["!data"][o+t+s]&&(i["!data"][o+t+s]=[]),a&&(p=i["!data"][o+t+s]),of(e).forEach((function(r){-1==(d=f.indexOf(r))&&(f[d=f.length]=r);var l=e[r],u="z",h="",m=a?"":kp(c+d)+Ip(o+t+s),g=a?p[c+d]:i[m];!l||"object"!==typeof l||l instanceof Date?("number"==typeof l?u="n":"boolean"==typeof l?u="b":"string"==typeof l?u="s":l instanceof Date?(u="d",n.cellDates||(u="n",l=df(l)),h=null!=g&&g.z&&Fh(g.z)?g.z:n.dateNF||qu[14]):null===l&&n.nullError&&(u="e",l=0),g?(g.t=u,g.v=l,delete g.w,delete g.R,h&&(g.z=h)):a?p[c+d]=g={t:u,v:l}:i[m]=g={t:u,v:l},h&&(g.z=h)):a?p[c+d]=l:i[m]=l}))})),u.e.c=Math.max(u.e.c,c+f.length-1);var m=Ip(o);if(a&&!i["!data"][o]&&(i["!data"][o]=[]),s)for(d=0;d<f.length;++d)a?i["!data"][o][d+c]={t:"s",v:f[d]}:i[kp(d+c)+m]={t:"s",v:f[d]};return i["!ref"]=Yp(u),i}function oD(e,t){return iD(null,e,t)}function cD(e,t,r){if("string"==typeof t){if(null!=e["!data"]){var n=Fp(t);return e["!data"][n.r]||(e["!data"][n.r]=[]),e["!data"][n.r][n.c]||(e["!data"][n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return cD(e,"number"!=typeof t?Pp(t):kp(r||0)+Ip(t))}function lD(e,t){if("number"==typeof t){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}if("string"==typeof t){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}throw new Error("Cannot find sheet |"+t+"|")}function uD(){return{SheetNames:[],Sheets:{}}}function hD(e,t,r,n){var a=1;if(!r)for(;a<=65535;++a,r=void 0)if(-1==e.SheetNames.indexOf(r="Sheet"+a))break;if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var s=r.match(/(^.*?)(\d+)$/);a=s&&+s[2]||0;var i=s&&s[1]||r;for(++a;a<=65535;++a)if(-1==e.SheetNames.indexOf(r=i+a))break}if(pC(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function fD(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=lD(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function dD(e,t){return e.z=t,e}function pD(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function mD(e,t,r){return pD(e,"#"+t,r)}function gD(e,t,r){e.c||(e.c=[]),e.c.push({t:t,a:r||"SheetJS"})}function ED(e,t,r,n){for(var a="string"!=typeof t?t:Gp(t),s="string"==typeof t?t:Yp(t),i=a.s.r;i<=a.e.r;++i)for(var o=a.s.c;o<=a.e.c;++o){var c=cD(e,i,o);c.t="n",c.F=s,delete c.v,i==a.s.r&&o==a.s.c&&(c.f=r,n&&(c.D=!0))}var l=Bp(e["!ref"]);return l.s.r>a.s.r&&(l.s.r=a.s.r),l.s.c>a.s.c&&(l.s.c=a.s.c),l.e.r<a.e.r&&(l.e.r=a.e.r),l.e.c<a.e.c&&(l.e.c=a.e.c),e["!ref"]=Yp(l),e}var vD,TD={encode_col:kp,encode_row:Ip,encode_cell:Pp,encode_range:Yp,decode_col:Lp,decode_row:Op,split_cell:xp,decode_cell:Fp,decode_range:Bp,format_cell:zp,sheet_add_aoa:jp,sheet_add_json:iD,sheet_add_dom:sI,aoa_to_sheet:Xp,json_to_sheet:oD,table_to_sheet:iI,table_to_book:oI,sheet_to_csv:nD,sheet_to_txt:aD,sheet_to_json:eD,sheet_to_html:aI,sheet_to_formulae:sD,sheet_to_row_object_array:eD,sheet_get_cell:cD,book_new:uD,book_append_sheet:hD,book_set_sheet_visibility:fD,cell_set_number_format:dD,cell_set_hyperlink:pD,cell_set_internal_link:mD,cell_add_comment:gD,sheet_set_array_formula:ED,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};function SD(e){vD=e}function AD(e,t){var r=vD(),n=null==t?{}:t;if(null==e||null==e["!ref"])return r.push(null),r;for(var a=Gp(e["!ref"]),s=void 0!==n.FS?n.FS:",",i=s.charCodeAt(0),o=void 0!==n.RS?n.RS:"\n",c=o.charCodeAt(0),l=new RegExp(("|"==s?"\\|":s)+"+$"),u="",h=[],f=n.skipHidden&&e["!cols"]||[],d=n.skipHidden&&e["!rows"]||[],p=a.s.c;p<=a.e.c;++p)(f[p]||{}).hidden||(h[p]=kp(p));var m=a.s.r,g=!1,E=0;return r._read=function(){if(!g)return g=!0,r.push("\ufeff");while(m<=a.e.r)if(++m,!(d[m-1]||{}).hidden&&(u=rD(e,a,m-1,h,i,c,s,n),null!=u&&(n.strip&&(u=u.replace(l,"")),u||!1!==n.blankrows)))return r.push((E++?o:"")+u);return r.push(null)},r}function RD(e,t){var r=vD(),n=t||{},a=null!=n.header?n.header:eI,s=null!=n.footer?n.footer:tI;r.push(a);var i=Bp(e["!ref"]);r.push(nI(e,i,n));var o=i.s.r,c=!1;return r._read=function(){if(o>i.e.r)return c||(c=!0,r.push("</table>"+s)),r.push(null);while(o<=i.e.r){r.push(ZO(e,i,o,n)),++o;break}},r}function yD(e,t){var r=vD({objectMode:!0});if(null==e||null==e["!ref"])return r.push(null),r;var n={t:"n",v:0},a=0,s=1,i=[],o=0,c="",l={s:{r:0,c:0},e:{r:0,c:0}},u=t||{},h=null!=u.range?u.range:e["!ref"];switch(1===u.header?a=1:"A"===u.header?a=2:Array.isArray(u.header)&&(a=3),typeof h){case"string":l=Gp(h);break;case"number":l=Gp(e["!ref"]),l.s.r=h;break;default:l=h}a>0&&(s=0);var f=Ip(l.s.r),d=[],p=0,m=null!=e["!data"],g=l.s.r,E=0,v={};m&&!e["!data"][g]&&(e["!data"][g]=[]);var T=u.skipHidden&&e["!cols"]||[],S=u.skipHidden&&e["!rows"]||[];for(E=l.s.c;E<=l.e.c;++E)if(!(T[E]||{}).hidden)switch(d[E]=kp(E),n=m?e["!data"][g][E]:e[d[E]+f],a){case 1:i[E]=E-l.s.c;break;case 2:i[E]=d[E];break;case 3:i[E]=u.header[E-l.s.c];break;default:if(null==n&&(n={w:"__EMPTY",t:"s"}),c=o=zp(n,null,u),p=v[o]||0,p){do{c=o+"_"+p++}while(v[c]);v[o]=p,v[c]=1}else v[o]=1;i[E]=c}return g=l.s.r+s,r._read=function(){while(g<=l.e.r)if(!(S[g-1]||{}).hidden){var t=ZM(e,l,g,d,a,i,u);if(++g,!1===t.isempty||(1===a?!1!==u.blankrows:u.blankrows))return void r.push(t.row)}return r.push(null)},r}var ND={to_json:yD,to_html:RD,to_csv:AD,set_readable:SD};ru.version;var wD={parse_xlscfb:IO,parse_zip:NM,read:xM,readFile:FM,readFileSync:FM,write:XM,writeFile:qM,writeFileSync:qM,writeFileAsync:QM,writeXLSX:jM,writeFileXLSX:JM,utils:TD,set_fs:rf,set_cptable:Eu,stream:ND,SSF:$h,CFB:tf};const bD={_origin:"https://api.emailjs.com"},CD=(e,t="https://api.emailjs.com")=>{bD._userID=e,bD._origin=t},OD=(e,t,r)=>{if(!e)throw"The user ID is required. Visit https://dashboard.emailjs.com/admin/integration";if(!t)throw"The service ID is required. Visit https://dashboard.emailjs.com/admin";if(!r)throw"The template ID is required. Visit https://dashboard.emailjs.com/admin/templates";return!0};class ID{constructor(e){this.status=e.status,this.text=e.responseText}}const MD=(e,t,r={})=>new Promise(((n,a)=>{const s=new XMLHttpRequest;s.addEventListener("load",(({target:e})=>{const t=new ID(e);200===t.status||"OK"===t.text?n(t):a(t)})),s.addEventListener("error",(({target:e})=>{a(new ID(e))})),s.open("POST",bD._origin+e,!0),Object.keys(r).forEach((e=>{s.setRequestHeader(e,r[e])})),s.send(t)})),DD=(e,t,r,n)=>{const a=n||bD._userID;OD(a,e,t);const s={lib_version:"3.2.0",user_id:a,service_id:e,template_id:t,template_params:r};return MD("/api/v1.0/email/send",JSON.stringify(s),{"Content-type":"application/json"})},LD=e=>{let t;if(t="string"===typeof e?document.querySelector(e):e,!t||"FORM"!==t.nodeName)throw"The 3rd parameter is expected to be the HTML form element or the style selector of form";return t},kD=(e,t,r,n)=>{const a=n||bD._userID,s=LD(r);OD(a,e,t);const i=new FormData(s);return i.append("lib_version","3.2.0"),i.append("service_id",e),i.append("template_id",t),i.append("user_id",a),MD("/api/v1.0/email/send-form",i)};var _D={init:CD,send:DD,sendForm:kD};function UD(e,t,r,n,a,s){const i=[["","WBS","","Mobilization and Support","","","","","","","","",""],["","S","","Mobilization","","","","","","","","",""],["","Y","","Contract Award ","","1","","","","","","",""],["","Y","","Project Setup / Team Mobilization","","5","=A"+(r+3),"","","","","10",""],["","Y","","Schedule Baseline","","5","=A"+(r+3),"","","","","4",""],["","Y","","Internal Project Kickoff Meeting "," - assume x people yh each","1","=A"+(r+4),"","","","","6",""],["","Y","","External Project Kickoff Meeting "," - assume x people yh each","1","=A"+(r+6),"","","","","6",""],["","S","","Project Support Tasks","","","","","","","","",""],["","Y","",'="Project Management ("&F1&" wk x 4h/w)"',"- assume 4h per week","","=A"+(r+4),"","","","","=F1*4",""],["","Y","",'="Technical Oversight ("&F1&" wk 1h/w)"',"- assume 1h per week","","=A"+(r+5),"","","","","=F1*1",""],["","Y","",'="Project Meetings ("&F1&" wk 1.5h/w)"',"- assume 3 ppl at 0.30 min per week ","","=A"+(r+7),"","","","","=F1*1.5",""],["","Y","",'="Project Scheduling ("&F1&" wk 1h/w)"',"- assume 1h per week","","=A"+(r+5),"","","","","=F1*1",""],["","Y","",'="Commercial Management (x months x 0.5h/m)"',"- assume 30min per month","","=A"+(r+4),"","","","","=ROUND(F1*0.5/4.35,2)",""],["","Y","",'="Financial Reporting ("&F1&" wk x 0.25h/w)"',"- assume 15min per week","","=A"+(r+4),"","","","","=F1*0.25",""],["","Y","",'="Program Management ("&F1&" wk x 0.25h/w)"',"- assume 15min per week","","=A"+(r+4),"","","","","=F1*0.25",""],["","Y","",'="Management Oversight ("&F1&" wk 0.5 h/w)"',"- assume 30min per week","","=A"+(r+4),"","","","","=F1*0.5",""]];var o=1,c=e,l=JSON.parse(JSON.stringify(i)),u=0,h=0,f=0,d=0;l[0][3]=t,l[0][2]=c;for(var p=0;p<l.length;p++)"Y"==l[p][1]?(l[p][0]=c+"."+o+++",",l[p][2]="WBS"+c,u+=1,""!==s&&(l[p][10]=s)):"S"==l[p][1]&&(f=p+r,h=p-u+r+1,d>0&&(l[d][11]="=SUMIF(B"+h+":B"+f+',"Y",L'+h+":L"+f+")",l[d][12]="=SUMIF(B"+h+":B"+f+',"Y",M'+h+":M"+f+")",u=0),d=p),"blank"===a&&(l[p][11]="");return f=p+r,h=p-u+r+1,l[d][11]="=SUMIF(B"+h+":B"+f+',"Y",L'+h+":L"+f+")",l[d][12]="=SUMIF(B"+h+":B"+f+',"Y",M'+h+":M"+f+")",l[0][11]="=SUMIF(B"+(r+2)+":B"+f+',"Y",L'+(r+2)+":L"+f+")",l[0][12]="=SUMIF(B"+(r+2)+":B"+f+',"Y",M'+(r+2)+":M"+f+")",l}function xD(e,t,r,n,a,s){const i=[["","WBS","","Internal Work Plan","","","","","","","","",""],["","S","","Internal Work Plan","","","","","","","","",""],["","Y","",'="Prepare "&D'+(r+1),"","=ROUND(L"+(r+3)+"/(E1*8),1)","","","","","","14",""],["","Y","",'="Verify/Review "&D'+(r+1),"","=ROUND(L"+(r+4)+"/(E1*8),1)","=A"+(r+3),"","","","","=ROUNDUP(SUM(L"+(r+3)+")*0.15,0)",""],["","Y","","Incorporate Internal Comments","","=ROUND(L"+(r+5)+"/(E1*8),1)","=A"+(r+4),"","","","","=ROUNDUP(SUM(L"+(r+3)+")*0.1,0)",""],["","Y","",'="Approve "&D'+(r+1),"","1","=A"+(r+5),"","","","","1",""]];var o=1,c=e,l=JSON.parse(JSON.stringify(i)),u=0,h=0,f=0,d=0;l[0][3]=t,l[0][2]=c;for(var p=0;p<l.length;p++)"Y"==l[p][1]?(l[p][0]=c+"."+o+++",",l[p][2]="WBS"+c,u+=1,""!==s&&(l[p][10]=s)):"S"==l[p][1]&&(f=p+r,h=p-u+r+1,d>0&&(l[d][11]="=SUMIF(B"+h+":B"+f+',"Y",L'+h+":L"+f+")",l[d][12]="=SUMIF(B"+h+":B"+f+',"Y",M'+h+":M"+f+")",u=0),d=p),"blank"===a&&(l[p][11]="");return f=p+r,h=p-u+r+1,l[d][11]="=SUMIF(B"+h+":B"+f+',"Y",L'+h+":L"+f+")",l[d][12]="=SUMIF(B"+h+":B"+f+',"Y",M'+h+":M"+f+")",l[0][11]="=SUMIF(B"+(r+2)+":B"+f+',"Y",L'+(r+2)+":L"+f+")",l[0][12]="=SUMIF(B"+(r+2)+":B"+f+',"Y",M'+(r+2)+":M"+f+")",l}function FD(e,t,r,n,a,s){const i=[["","WBS","","Engineering Plan","","","","","","","","",""],["","S","",'="50% "&D'+(r+1),"","","","","","","","",""],["","Y","","Task Pre-Job Brief","","1","","","","","","2",""],["","Y","","Gather Documentation","","=ROUND(L"+(r+4)+"/(E1*8),1)","=A"+(r+3),"","","","","4",""],["","Y","",'= "Prepare 50% "&D'+(r+1),"","=ROUND(L"+(r+5)+"/(E1*8),1)","=A"+(r+4),"","","","","23",""],["","Y","",'="Review 50% "&D'+(r+1),"","=ROUND(L"+(r+6)+"/(E1*8),1)","=A"+(r+5),"","","","","=ROUNDUP(SUM(L"+(r+3)+":L"+(r+5)+")*0.15,0)",""],["","Y","","Incorporate Internal Comments","","=ROUND(L"+(r+7)+"/(E1*8),1)","=A"+(r+6),"","","","","=ROUNDUP(SUM(L"+(r+3)+":L"+(r+5)+")*0.1,0)",""],["","Y","",'= "Approve 50% "&D'+(r+1),"","1","=A"+(r+7),"","","","","1",""],["","Y","",'="Submit 50% "&D'+(r+1)+'&" for Client Review"',"","1","=A"+(r+8),"","","","","1",""],["","S","","=D"+(r+1)+'&" Comment&Disposition"',"","","","","","","","",""],["","Y","",'="Client Stakeholder Review "&D'+(r+1),"","10","=A"+(r+9),"","","","","0",""],["","Y","","Disposition Stakeholder Comments","","=ROUND(L"+(r+12)+"/(E1*8),1)+2","=A"+(r+11),"","","","","=ROUNDUP(SUM(L"+(r+3)+":L"+(r+9)+")*0.1,0)",""],["","Y","","Client Accept Comment Dispositions","","5","=A"+(r+12),"","","","","0",""],["","S","",'="90% "&D'+(r+1),"","","","","","","","",""],["","Y","","Incorporate Accepted Comments","","=ROUND(L"+(r+15)+"/(E1*8),1)","=A"+(r+13),"","","","","=ROUNDUP(L"+(r+12)+"/2,0)",""],["","Y","",'="Final Verification for 90% "&D'+(r+1),"","=ROUND(L"+(r+16)+"/(E1*8),1)","=A"+(r+15),"","","","","=L"+(r+15)+"/2",""],["","Y","",'="Approve 90% "&D'+(r+1),"","1","=A"+(r+16),"","","","","1",""],["","Y","",'="Submit 90% "&D'+(r+1)+'&" for Client Acceptance"',"","1","=A"+(r+17),"","","","","1",""],["","Y","",'="Client Accepts 100% "&D'+(r+1),"","5","=A"+(r+18),"","","","","0",""],["","Y","",'="Client Authorizes 100% "&D'+(r+1),"","5","=A"+(r+19),"","","","","0",""]];var o=1,c=e,l=JSON.parse(JSON.stringify(i)),u=0,h=0,f=0,d=0;l[0][3]=t,l[0][2]=c;for(var p=0;p<l.length;p++)"Y"==l[p][1]?(l[p][0]=c+"."+o+++",",l[p][2]="WBS"+c,u+=1,""!==s&&(l[p][10]=s)):"S"==l[p][1]&&(f=p+r,h=p-u+r+1,d>0&&(l[d][11]="=SUMIF(B"+h+":B"+f+',"Y",L'+h+":L"+f+")",l[d][12]="=SUMIF(B"+h+":B"+f+',"Y",M'+h+":M"+f+")",u=0),d=p),"blank"===a&&(l[p][11]="");return f=p+r,h=p-u+r+1,l[d][11]="=SUMIF(B"+h+":B"+f+',"Y",L'+h+":L"+f+")",l[d][12]="=SUMIF(B"+h+":B"+f+',"Y",M'+h+":M"+f+")",l[0][11]="=SUMIF(B"+(r+2)+":B"+f+',"Y",L'+(r+2)+":L"+f+")",l[0][12]="=SUMIF(B"+(r+2)+":B"+f+',"Y",M'+(r+2)+":M"+f+")",l}function PD(e,t,r,n,a,s){const i=[["","WBS","",t,"","","","","","",""],["","S","",'="50% "&D'+(r+1),"","","","","","",""],["","Y","","Task Pre-Job Brief","","1","","","","","","2"],["","Y","","Perform OPEX Review","","=ROUNDUP(L"+(r+4)+"/(8),1)","=A"+(r+3),"","","","","5"],["","Y","",'="Prepare 50% "&D'+(r+1),"","=ROUNDUP(L"+(r+5)+"/(8),1)","=A"+(r+4),"","","","","16"],["","Y","",'="Review 50% "&D'+(r+1),"","=ROUNDUP(L"+(r+6)+"/(8),1)","=A"+(r+5),"","","","","=ROUNDUP(SUM(L"+(r+3)+":L"+(r+5)+")*0.15,0)"],["","Y","","Incorporate Internal Comments","","=ROUNDUP(L"+(r+7)+"/(8),1)","=A"+(r+6),"","","","","=ROUNDUP(SUM(L"+(r+3)+":L"+(r+5)+")*0.1,0)"],["","Y","",'="Approve 50% "&D'+(r+1),"","1","=A"+(r+7),"","","","","1"],["","Y","",'="Submit 50% "&D'+(r+1)+'&" for Client Review"',"","1","=A"+(r+8),"","","","","1"],["","S","","=D"+(r+1)+'&" Comment & Disposition"',"","","","","","",""],["","Y","",'="Client Stakeholder Review of "&D'+(r+1),"","10","=A"+(r+9),"","","","","0"],["","Y","","Disposition Stakeholder Comments","","=ROUNDUP(L"+(r+12)+"/(8),0)+1","=A"+(r+11),"","","","","=ROUNDUP(SUM(L"+(r+3)+":L"+(r+9)+")*0.1,0)"],["","Y","","Client Accept Comment Dispositions","","5","=A"+(r+12),"","","","","0"],["","S","",'="90% "&D'+(r+1),"","","","","","",""],["","Y","","Incorporate Accepted Comments","","=ROUNDUP(L"+(r+15)+"/(8),1)","=A"+(r+13),"","","","","=ROUNDUP(L"+(r+12)+"/2,0)"],["","Y","",'="Final Verification of 90% " &D'+(r+1),"","=ROUNDUP(L"+(r+16)+"/(8),1)","=A"+(r+15),"","","","","=L"+(r+15)+"/2"],["","Y","",'="Approve 90% "&D'+(r+1),"","1","=A"+(r+16),"","","","","1"],["","Y","",'="Submit 90% " &D'+(r+1)+'&" for Client Acceptance"',"","1","=A"+(r+17),"","","","","1"],["","Y","",'="Client Accepts 100% "&D'+(r+1),"","5","=A"+(r+18),"","","","","0"]];var o=1,c=e,l=JSON.parse(JSON.stringify(i)),u=0,h=0,f=0,d=0;l[0][3]=t,l[0][2]=c;for(var p=0;p<l.length;p++)"Y"==l[p][1]?(l[p][0]=c+"."+o+++",",l[p][2]="WBS"+c,u+=1,""!==s&&(l[p][10]=s)):"S"==l[p][1]&&(f=p+r,h=p-u+r+1,d>0&&(l[d][11]="=SUMIF(B"+h+":B"+f+',"Y",L'+h+":L"+f+")",l[d][12]="=SUMIF(B"+h+":B"+f+',"Y",M'+h+":M"+f+")",u=0),d=p),"blank"===a&&(l[p][11]="");return f=p+r,h=p-u+r+1,l[d][11]="=SUMIF(B"+h+":B"+f+',"Y",L'+h+":L"+f+")",l[d][12]="=SUMIF(B"+h+":B"+f+',"Y",M'+h+":M"+f+")",l[0][11]="=SUMIF(B"+(r+2)+":B"+f+',"Y",L'+(r+2)+":L"+f+")",l[0][12]="=SUMIF(B"+(r+2)+":B"+f+',"Y",M'+(r+2)+":M"+f+")",l}function BD(e,t,r,n,a,s){const i=[["","WBS","","Walkdown Planning & Report","","","","","","","","",""],["","S","","Walkdown","","","","","","","","",""],["","Y","","Task Pre-Job Brief","","1","","","","","","2",""],["","Y","","Gather Walkdown Documentation","","=ROUND(L"+(r+4)+"/(8*E1),1)","=A"+(r+3),"","","","","2",""],["","Y","","Fill out Visitor's Forms If Required (FORM-110190)","","=ROUND(L"+(r+5)+"/(8*E1),1)","=A"+(r+4),"","","","","7",""],["","Y","","Send Visitor's Forms to RP and Obtain NEW Status from Client (if required)","","10","=A"+(r+5),"","","","","3",""],["","Y","","Prepare Walkdown Checklists (FORM-14052)","","=ROUND(L"+(r+7)+"/(8*E1),1)","=A"+(r+4),"","","","","10",""],["","Y","","Verify Walkdown Checklists","","=ROUND(L"+(r+8)+"/(8*E1),1)","=A"+(r+7),"","","","","=ROUNDUP(SUM(L"+(r+7)+")*0.15,0)",""],["","Y","","Prepare Walkdown Plan, if required","","=ROUND(L"+(r+9)+"/(8*E1),1)","=A"+(r+8),"","","","","10",""],["","Y","","Verify Walkdown Plan, if required","","=ROUND(L"+(r+10)+"/(8*E1),1)","=A"+(r+9),"","","","","=ROUNDUP(SUM(L"+(r+9)+")*0.15,0)",""],["","Y","","Submit Walkdown Chklst and/or Plan for Client Review","","1","=A"+(r+8)+"&A"+(r+10),"","","","","1",""],["","Y","","Stakeholders to Review Walkdown Checklists and/or Plan","","5","=A"+(r+11),"","","","","0",""],["","Y","","Incorporate Comments into Walkdown Checklists and/or Plan","","=ROUND(L"+(r+13)+"/(8*E1),1)","=A"+(r+12),"","","","","5",""],["","Y","","Walkdown with Stakeholders","-include 6h travel time for 2 people","5","=A"+(r+13)+"&A"+(r+6),"","","","","=2*8",""],["","S","","50% Walkdown Report ","","","","","","","","",""],["","Y","","Prepare 50% Walkdown Report ","","=ROUND(L"+(r+16)+"/(8*E1),1)","=A"+(r+14),"","","","","16",""],["","Y","","Verify 50% Walkdown Report ","","=ROUND(L"+(r+17)+"/(8*E1),1)","=A"+(r+16),"","","","","=ROUNDUP(SUM(L"+(r+16)+")*0.15,0)",""],["","Y","","Incorporate Internal Comments","","=ROUND(L"+(r+18)+"/(8*E1),1)","=A"+(r+17),"","","","","=ROUNDUP(SUM(L"+(r+16)+")*0.1,0)",""],["","Y","","Approve 50% Walkdown Report ","","1","=A"+(r+18),"","","","","1",""],["","Y","","Submit 50% Walkdown Report for Client Review","","1","=A"+(r+19),"","","","","1",""],["","S","","Walkdown Report Comment and Disposition","","","","","","","","",""],["","Y","","Client Stakeholder to Review of Walkdown Report","","10","=A"+(r+20),"","","","","0",""],["","Y","","Disposition Stakeholder Comments","","=ROUND(L"+(r+23)+"/(8*E1),1)+2","=A"+(r+22),"","","","","=ROUNDUP(SUM(L"+(r+16)+":L"+(r+20)+")*0.1,0)",""],["","Y","","Client Accept Comment Dispositions","","5","=A"+(r+23),"","","","","0",""],["","S","","90% Walkdown Report ","","","","","","","","",""],["","Y","","Incorporate Accepted Comments","","=ROUND(L"+(r+26)+"/(8*E1),1)+2","=A"+(r+24),"","","","","=ROUNDUP(L"+(r+23)+"/2,0)",""],["","Y","","Final Verification of Walkdown Report","","=ROUND(L"+(r+27)+"/(8*E1),1)","=A"+(r+26),"","","","","=L"+(r+26)+"/2",""],["","Y","","Approve Walkdown Report","","1","=A"+(r+27),"","","","","1",""],["","Y","","Submit 90% Walkdown Report for Client Acceptance","","1","=A"+(r+28),"","","","","1",""],["","Y","","Client Accept 100% Walkdown Report ","","5","=A"+(r+29),"","","","","0",""]];var o=1,c=e,l=JSON.parse(JSON.stringify(i)),u=0,h=0,f=0,d=0;l[0][3]=t,l[0][2]=c;for(var p=0;p<l.length;p++)"Y"==l[p][1]?(l[p][0]=c+"."+o+++",",l[p][2]="WBS"+c,u+=1,""!==s&&(l[p][10]=s)):"S"==l[p][1]&&(f=p+r,h=p-u+r+1,d>0&&(l[d][11]="=SUMIF(B"+h+":B"+f+',"Y",L'+h+":L"+f+")",l[d][12]="=SUMIF(B"+h+":B"+f+',"Y",M'+h+":M"+f+")",u=0),d=p),"blank"===a&&(l[p][11]="");return f=p+r,h=p-u+r+1,l[d][11]="=SUMIF(B"+h+":B"+f+',"Y",L'+h+":L"+f+")",l[d][12]="=SUMIF(B"+h+":B"+f+',"Y",M'+h+":M"+f+")",l[0][11]="=SUMIF(B"+(r+2)+":B"+f+',"Y",L'+(r+2)+":L"+f+")",l[0][12]="=SUMIF(B"+(r+2)+":B"+f+',"Y",M'+(r+2)+":M"+f+")",l}function YD(e,t,r,n,a,s){const i=[["","WBS","","Design Requirements","","",,"","","","","",""],["","S","",'="50% "&D'+(r+1),"","",,"","","","","",""],["","Y","","Task Pre-Job Brief","","1",,"","","","","2",""],["","Y","","Gather Documentation","","=ROUND(L"+(r+4)+"/(8*E1),1)","=A"+(r+3),"","","","","8",""],["","Y","","Complete DR Design Product Board Checklist","","=ROUND(L"+(r+5)+"/(8*E1),1)","=A"+(r+3),"","","","","4",""],["","Y","",'="Prepare 50% "&D'+(r+1),"","=ROUND(L"+(r+6)+"/(8*E1),1)","=A"+(r+5),"","","","","60",""],["","Y","",'="Verify 50% "&D'+(r+1),"","=ROUND(L"+(r+7)+"/(8*E1),1)","=A"+(r+6),"","","","","=ROUNDUP(SUM(L"+(r+3)+":L"+(r+6)+")*0.15,0)",""],["","Y","","Incorporate Internal Comments","","=ROUND(L"+(r+8)+"/(8*E1),1)","=A"+(r+5),"","","","","=ROUNDUP(SUM(L"+(r+3)+":L"+(r+7)+")*0.1,0)",""],["","Y","",'="Approve 50% "&D'+(r+1),"","1","=A"+(r+8),"","","","","2.5",""],["","Y","","Submit 50% DR for Client Review","","1","=A"+(r+9),"","","","","1",""],["","S","","=D"+(r+1)+'&" Comment and Disposition"',"","",,"","","","","",""],["","Y","",'="Stakeholder Review of "&D'+(r+1),"","10","=A"+(r+10),"","","","","0",""],["","Y","","Disposition Stakeholder Comments","","=ROUND(L"+(r+13)+"/(8*E1),1)+2","=A"+(r+12),"","","","","=ROUNDUP(SUM(L"+(r+3)+":L"+(r+10)+")*0.1,0)",""],["","Y","","Client Accept Comment Dispositions","","5","=A"+(r+13),"","","","","0",""],["","S","",'="90% "&D'+(r+1),"","",,"","","","","",""],["","Y","","Incorporate Accepted Comments","","=ROUND(L"+(r+16)+"/(8*E1),1)","=A"+(r+14),"","","","","=L"+(r+13)+"/2",""],["","Y","","Submit Interim Draft DR for DPCB Meeting","","=ROUND(L"+(r+17)+"/(8*E1),1)","=A"+(r+16),"","","","","1",""],["","Y","","Schedule Design Product Challenge Board","","=ROUND(L"+(r+18)+"/(8*E1),1)","=A"+(r+17),"","","","","1",""],["","Y","","Prepare for DPCB Meeting","","=ROUND(L"+(r+19)+"/(8*E1),1)","=A"+(r+18),"","","","","6",""],["","Y","","Attend Design Products Challenge Board Meeting","assume remote telecon","=ROUND(L"+(r+20)+"/(8*E1),1)","=A"+(r+18)+"&A"+(r+19),"5","","","","2",""],["","Y","","Incorporate Comments from DPCB Meeting","","=ROUND(L"+(r+21)+"/(8*E1),1)","=A"+(r+20),"","","","","8",""],["","Y","","Final Verification of Design Requirements","","=ROUND(L"+(r+22)+"/(8*E1),1)","=A"+(r+21),"","","","","=ROUNDUP(SUM(L"+(r+16)+":L"+(r+21)+")*0.2,0)",""],["","Y","",'="Approve 90% "&D'+(r+1),"","=ROUND(L"+(r+23)+"/(8*E1),1)","=A"+(r+22),"","","","","1.5",""],["","Y","",'="Submit "&D16&" for Client Acceptance"',"","=ROUND(L"+(r+24)+"/(8*E1),1)","=A"+(r+23),"","","","","1",""],["","Y","",'="Client Accepts 100% "&D'+(r+1),"","=ROUND(L"+(r+25)+"/(8*E1),1)","=A"+(r+24),"","","","","0",""],["","Y","","DIVM Authorize Design Requirements ","","5","=A"+(r+25),"","","","","0",""],["","Y","","Issue Design Requirements in Content Server","","2","=A"+(r+26),"","","","","1",""]];var o=1,c=e,l=JSON.parse(JSON.stringify(i)),u=0,h=0,f=0,d=0;l[0][3]=t,l[0][2]=c;for(var p=0;p<l.length;p++)"Y"==l[p][1]?(l[p][0]=c+"."+o+++",",l[p][2]="WBS"+c,u+=1,""!==s&&(l[p][10]=s)):"S"==l[p][1]&&(f=p+r,h=p-u+r+1,d>0&&(l[d][11]="=SUMIF(B"+h+":B"+f+',"Y",L'+h+":L"+f+")",l[d][12]="=SUMIF(B"+h+":B"+f+',"Y",M'+h+":M"+f+")",u=0),d=p),"blank"===a&&(l[p][11]="");return f=p+r,h=p-u+r+1,l[d][11]="=SUMIF(B"+h+":B"+f+',"Y",L'+h+":L"+f+")",l[d][12]="=SUMIF(B"+h+":B"+f+',"Y",M'+h+":M"+f+")",l[0][11]="=SUMIF(B"+(r+2)+":B"+f+',"Y",L'+(r+2)+":L"+f+")",l[0][12]="=SUMIF(B"+(r+2)+":B"+f+',"Y",M'+(r+2)+":M"+f+")",l}function VD(e,t,r,n,a,s){const i=[["","WBS","","Conceptual Engineering Report","","","","","","","","",""],["","S","","Problem Definition","","","","","","","","",""],["","Y","","Task Pre-Job Brief","","1","","","","","","2",""],["","Y","","Define Problem to be Solved","","=ROUND(L"+(r+4)+"/(E1*8),1)","=A"+(r+3),"","","","","8",""],["","Y","","Prepare Evaluation Criteria","","=ROUND(L"+(r+5)+"/(E1*8),1)","=A"+(r+4),"","","","","14",""],["","Y","","Gather Documentation / Discussions with Equipment Vendors","","=ROUND(L"+(r+6)+"/(E1*8),1)","=A"+(r+5),"","","","","21",""],["","Y","","Estimate Loss Prevention/Benefit Gained","","=ROUND(L"+(r+7)+"/(E1*8),1)","=A"+(r+6),"","","","","4",""],["","S","","Alternatives Analysis","","","","","","","","",""],["","Y","","Option 1 Analysis","","=ROUND(SUM(L"+(r+9)+":L"+(r+12)+")/(E1*8),1)","=A"+(r+6),"","","","","15",""],["","Y","","Option 2 Analysis","","=ROUND(SUM(L"+(r+9)+":L"+(r+12)+")/(E1*8),1)","=A"+(r+6),"","","","","15",""],["","Y","","Option 3 Analysis","","=ROUND(SUM(L"+(r+9)+":L"+(r+12)+")/(E1*8),1)","=A"+(r+6),"","","","","15",""],["","Y","","Option 4 Analysis","","=ROUND(SUM(L"+(r+9)+":L"+(r+12)+")/(E1*8),1)","=A"+(r+6),"","","","","15",""],["","Y","","Finalize Options","","=ROUND(L"+(r+13)+"/(E1*8),1)","=A"+(r+9)+"&A"+(r+10)+"&A"+(r+11)+"&A"+(r+12),"","","","","8",""],["","Y","","Provide information to Client for Class 5 Estimate","","3","=A"+(r+7),"","","","","5",""],["","Y","","Class 5 Estimate from PMC","","20","=A"+(r+14),"","","","","0",""],["","Y","","Establish Cost Benefit Analysis/ROI Analysis","","=ROUND(L"+(r+16)+"/(E1*8),1)","=A"+(r+13)+"&A"+(r+15),"","","","","21",""],["","S","",'="50% "&D'+(r+1),"","","","","","","","",""],["","Y","",'="Prepare 50% "&D'+(r+1),"","=ROUND(L"+(r+18)+"/(E1*8),1)","=A"+(r+16),"","","","","24",""],["","Y","",'="Verify 50% "&D'+(r+1),"","=ROUND(L"+(r+19)+"/(E1*8),1)","=A"+(r+18),"","","","","=ROUNDUP(SUM(L"+(r+9)+":L"+(r+16)+",L"+(r+18)+")*0.15,0)",""],["","Y","","Incorporate Internal Comments","","=ROUND(L"+(r+20)+"/(E1*8),1)","=A"+(r+19),"","","","","=ROUNDUP(SUM(L"+(r+9)+":L"+(r+16)+",L"+(r+18)+")*0.1,0)",""],["","Y","",'="Approve 50% "&D'+(r+1),"","1","=A"+(r+20),"","","","","2",""],["","Y","",'="Submit 50% "&D'+(r+1)+'&" for Client Review"',"","1","=A"+(r+21),"","","","","1",""],["","S","","Stakeholder Review&Challenge Board Meeting","","","","","","","","",""],["","Y","","Stakeholder Review Meeting for CER","- assume 2 people via teleconference ","10","=A"+(r+22),"","","","","4",""],["","Y","","Select Alternative Based on Recommendations","","=ROUND(L"+(r+25)+"/(E1*8),1)","=A"+(r+24),"","","","","4",""],["","Y","","Refine the Estimate to Class 4 for Selected Alternative","","=ROUND(L"+(r+26)+"/(E1*8),1)","=A"+(r+25),"","","","","4",""],["","Y","","Update the Conceptual Engineering Report","","=ROUND(L"+(r+27)+"/(E1*8),1)","=A"+(r+26),"","","","","12",""],["","Y","","Submit Draft 90% CER for DPCB Meeting","","=ROUND(L"+(r+28)+"/(E1*8),1)","=A"+(r+27),"","","","","1",""],["","Y","","Schedule Design Product Challenge Board","","=ROUND(L"+(r+29)+"/(E1*8),1)","=A"+(r+28),"","","","","1",""],["","Y","","Prepare for and Attend DPCB Meeting","- assume 2 people via teleconference ","5","=A"+(r+29),"","","","","8",""],["","S","",'="100% "&D'+(r+1),"","","","","","","","",""],["","Y","",'="Update 100% "&D'+(r+1),"","=ROUND(L"+(r+32)+"/(E1*8),1)","=A"+(r+30),"","","","","12",""],["","Y","",'="Verify 100% "&D'+(r+1),"","=ROUND(L"+(r+33)+"/(E1*8),1)","=A"+(r+32),"","","","","4",""],["","Y","",'="Approve 100% "&D'+(r+1),"","1","=A"+(r+33),"","","","","2",""],["","Y","","Submit for Client Acceptance","","1","=A"+(r+34),"","","","","1",""],["","Y","",'="Client Accept/Approve 100% "&D'+(r+1),"","5","=A"+(r+35),"","","","","0",""]];var o=1,c=e,l=JSON.parse(JSON.stringify(i)),u=0,h=0,f=0,d=0;l[0][3]=t,l[0][2]=c;for(var p=0;p<l.length;p++)"Y"==l[p][1]?(l[p][0]=c+"."+o+++",",l[p][2]="WBS"+c,u+=1,""!==s&&(l[p][10]=s)):"S"==l[p][1]&&(f=p+r,h=p-u+r+1,d>0&&(l[d][11]="=SUMIF(B"+h+":B"+f+',"Y",L'+h+":L"+f+")",l[d][12]="=SUMIF(B"+h+":B"+f+',"Y",M'+h+":M"+f+")",u=0),d=p),"blank"===a&&(l[p][11]="");return f=p+r,h=p-u+r+1,l[d][11]="=SUMIF(B"+h+":B"+f+',"Y",L'+h+":L"+f+")",l[d][12]="=SUMIF(B"+h+":B"+f+',"Y",M'+h+":M"+f+")",l[0][11]="=SUMIF(B"+(r+2)+":B"+f+',"Y",L'+(r+2)+":L"+f+")",l[0][12]="=SUMIF(B"+(r+2)+":B"+f+',"Y",M'+(r+2)+":M"+f+")",l}function WD(e,t,r,n,a,s){const i=[["","WBS","","FMEA Report","","","","","","","","",""],["","S","",'="50% "&D'+(r+1),"","","","","","","","",""],["","Y","","Task Pre-Job Brief","","1","","","","","","2",""],["","Y","","Gather Documentation","","=ROUND(L"+(r+4)+"/(8*E1),1)","=A"+(r+3),"","","","","16",""],["","Y","",'="Prepare 50% "&D'+(r+1),"","=ROUND(L"+(r+5)+"/(8*E1),1)","=A"+(r+3),"","","","","60",""],["","Y","",'="Verify/Review 50% "&D'+(r+1),"","=ROUND(L"+(r+6)+"/(8*E1),1)","=A"+(r+5),"","","","","=ROUNDUP(SUM(L"+(r+3)+":L"+(r+5)+")*0.15,0)",""],["","Y","","Incorporate Internal Comments","","=ROUND(L"+(r+7)+"/(8*E1),1)","=A"+(r+6),"","","","","=ROUNDUP(SUM(L"+(r+3)+":L"+(r+6)+")*0.1,0)",""],["","Y","",'="Approve 50% "&D'+(r+1),"","1","=A"+(r+5),"","","","","2.5",""],["","Y","",'="Submit 50% "&D'+(r+1)+'&" for Client Review"',"","1","=A"+(r+8),"","","","","1",""],["","S","","=D"+(r+1)+'&" Comment and Disposition"',"","",,"","","","","",""],["","Y","",'="Stakeholder Review of "&D'+(r+1),"","10","=A"+(r+9),"","","","","0",""],["","Y","","Disposition Stakeholder Comments","","=ROUND(L"+(r+12)+"/(8*E1),1)+2","=A"+(r+11),"","","","","=ROUNDUP(SUM(L"+(r+3)+":L"+(r+9)+")*0.1,0)",""],["","Y","","Client Accept Comment Dispositions","","5","=A"+(r+12),"","","","","0",""],["","S","","90% FMEA Report","","","","","","","","",""],["","Y","","Incorporate Accepted Comment","","=ROUND(L"+(r+15)+"/(8*E1),1)","=A"+(r+13),"","","","","=ROUNDUP(L"+(r+12)+"/2,0)",""],["","Y","",'="Final Verification of 90% "&D'+(r+1),"","=ROUND(L"+(r+16)+"/(8*E1),1)","=A"+(r+15),"","","","","=L"+(r+15)+"/2",""],["","Y","",'="Approve 90% "&D'+(r+1),"","=ROUND(L"+(r+17)+"/(8*E1),1)","=A"+(r+16),"","","","","2",""],["","Y","",'="Submit 90% "&D'+(r+1),"","=ROUND(L"+(r+18)+"/(8*E1),1)","=A"+(r+17),"","","","","1",""],["","Y","",'="Client Accept 100% "&D'+(r+1),"","5","=A"+(r+18),"","","","","0",""]];var o=1,c=e,l=JSON.parse(JSON.stringify(i)),u=0,h=0,f=0,d=0;l[0][3]=t,l[0][2]=c;for(var p=0;p<l.length;p++)"Y"==l[p][1]?(l[p][0]=c+"."+o+++",",l[p][2]="WBS"+c,u+=1,""!==s&&(l[p][10]=s)):"S"==l[p][1]&&(f=p+r,h=p-u+r+1,d>0&&(l[d][11]="=SUMIF(B"+h+":B"+f+',"Y",L'+h+":L"+f+")",l[d][12]="=SUMIF(B"+h+":B"+f+',"Y",M'+h+":M"+f+")",u=0),d=p),"blank"===a&&(l[p][11]="");return f=p+r,h=p-u+r+1,l[d][11]="=SUMIF(B"+h+":B"+f+',"Y",L'+h+":L"+f+")",l[d][12]="=SUMIF(B"+h+":B"+f+',"Y",M'+h+":M"+f+")",l[0][11]="=SUMIF(B"+(r+2)+":B"+f+',"Y",L'+(r+2)+":L"+f+")",l[0][12]="=SUMIF(B"+(r+2)+":B"+f+',"Y",M'+(r+2)+":M"+f+")",l}function GD(e,t,r,n,a,s){const i=[["","WBS","","DCP xxxxx","","","","","","","","",""],["","S","",'="50% "&D'+(r+1),"","","","","","","","",""],["","Y","","Task Pre-Job Brief","","1","","","","","","3",""],["","Y","","Determine EC Type&Subtype","","=ROUND(L"+(r+4)+"/(8*E1),1)","=A"+(r+3),"","","","","4",""],["","Y","","Prepare Design Scoping Checklist","","=ROUND(L"+(r+5)+"/(8*E1),1)","=A"+(r+3),"","","","","8",""],["","Y","","Enter Attributes Based on Design Scoping Checklist","","=ROUNDUP(SUM(L"+(r+6)+":L"+(r+18)+")/(8*E1),1)","=A"+(r+5),"","","","","4",""],["","Y","","Prepare FORM-14452","","=ROUNDUP(SUM(L"+(r+6)+":L"+(r+18)+")/(8*E1),1)","=A"+(r+5),"","","","","4",""],["","Y","","Prepare Licensing Screen","","=ROUNDUP(SUM(L"+(r+6)+":L"+(r+18)+")/(8*E1),1)","=A"+(r+5),"","","","","4",""],["","Y","","Prepare Seismic Assessment","","=ROUNDUP(SUM(L"+(r+6)+":L"+(r+18)+")/(8*E1),1)","=A"+(r+5),"","","","","6",""],["","Y","","Prepare Documentation Scoping Checklist","","=ROUNDUP(SUM(L"+(r+6)+":L"+(r+18)+")/(8*E1),1)","=A"+(r+5),"","","","","12",""],["","Y","","Prepare Software QA Checklist","","=ROUNDUP(SUM(L"+(r+6)+":L"+(r+18)+")/(8*E1),1)","=A"+(r+5),"","","","","6",""],["","Y","","Prepare Software Categorization Report","","=ROUNDUP(SUM(L"+(r+6)+":L"+(r+18)+")/(8*E1),1)","=A"+(r+5),"","","","","8",""],["","Y","","Prepare Software Development Plan","","=ROUNDUP(SUM(L"+(r+6)+":L"+(r+18)+")/(8*E1),1)","=A"+(r+5),"","","","","12",""],["","Y","","Prepare Computer System Requirements","","=ROUNDUP(SUM(L"+(r+6)+":L"+(r+18)+")/(8*E1),1)","=A"+(r+5),"","","","","12",""],["","Y","","Prepare Reactor Safety Designers Checklist","","=ROUNDUP(SUM(L"+(r+6)+":L"+(r+18)+")/(8*E1),1)","=A"+(r+5),"","","","","12",""],["","Y","","Prepare Pre-Start Health & Safety Review","","=ROUNDUP(SUM(L"+(r+6)+":L"+(r+18)+")/(8*E1),1)","=A"+(r+5),"","","","","4",""],["","Y","","Prepare Fire Protection Engineering Review ","","=ROUNDUP(SUM(L"+(r+6)+":L"+(r+18)+")/(8*E1),1)","=A"+(r+5),"","","","","4",""],["","Y","","Prepare Environmental Impact Worksheet Form","","=ROUNDUP(SUM(L"+(r+6)+":L"+(r+18)+")/(8*E1),1)","=A"+(r+5),"","","","","6",""],["","Y","","Complete Risk Classification Assessment ","","=ROUND(L"+(r+19)+"/(8*E1),1)","=A"+(r+6)+"&A"+(r+7)+"&A"+(r+8)+"&A"+(r+9)+"&A"+(r+10)+"&A"+(r+11)+"&A"+(r+12)+"&A"+(r+13)+"&A"+(r+14)+"&A"+(r+15)+"&A"+(r+16)+"&A"+(r+17)+"&A"+(r+18),"","","","","6",""],["","Y","","Add Maximo Tasks Based on Risk and Required Approvals","","=ROUND(L"+(r+20)+"/(8*E1),1)","=A"+(r+19),"","","","","4",""],["","Y","","Populate Attributes","","=ROUND(L"+(r+21)+"/(8*E1),1)","=A"+(r+20),"","","","","4",""],["","Y","","Identify Ops and Maintenance Documents that Require Updates","","=ROUNDUP(SUM(L"+(r+22)+":L"+(r+26)+")/(8*E1),1)","=A"+(r+21),"","","","","4",""],["","Y","","Initiate Training Change Request (TCR)","","=ROUNDUP(SUM(L"+(r+22)+":L"+(r+26)+")/(8*E1),1)","=A"+(r+21),"","","","","2",""],["","Y","","Initiate CRs for PMIDs, O&M Documents, BOM Group, RS, etc","","=ROUNDUP(SUM(L"+(r+22)+":L"+(r+26)+")/(8*E1),1)","=A"+(r+21),"","","","","2",""],["","Y","","If CGD is required, Initiate Process as per Client PROC","","=ROUNDUP(SUM(L"+(r+22)+":L"+(r+26)+")/(8*E1),1)","=A"+(r+21),"","","","","4",""],["","Y","","Identify and set up DCNs in Maximo (xref to DCP)","","=ROUNDUP(SUM(L"+(r+22)+":L"+(r+26)+")/(8*E1),1)","=A"+(r+21),"","","","","2",""],["","Y","","Prepare Modification Outline","","=ROUND(L"+(r+27)+"/(8*E1),1)","=A"+(r+22)+"&A"+(r+23)+"&A"+(r+24)+"&A"+(r+25)+"&A"+(r+26),"","","","","8",""],["","Y","","Update Affected Document List&Reference Document List","","=ROUND(L"+(r+28)+"/(8*E1),1)","=A"+(r+27),"","","","","4",""],["","Y","","Prepare COMS Screening","","=ROUND(L"+(r+29)+"/(8*E1),1)","=A"+(r+28),"","","","","4",""],["","Y","","Prepare COMS Package","","1","=A"+(r+29),"","","","","4",""],["","Y","",'="Internal Verification of 50% "&D'+(r+1),"","5","=A"+(r+29),"","","","","=ROUNDUP(SUM(L"+(r+3)+":L"+(r+30)+")*0.15,0)",""],["","Y","",'="Submit  50% "&D'+(r+1)+'&" for Client Review"',"","1","=A"+(r+30),"","","","","1",""],["","S","","=D"+(r+1)+'&" Comment and Disposition"',"","","","","","","","",""],["","Y","","Route DCP for Stakeholders Review / Coordinate Stakeholder Review","","10","=A"+(r+32),"","","","","8",""],["","Y","","COMS Review Meeting","assume 2 people for 2h","1","=A"+(r+32),"4","","","","4",""],["","Y","",'="Stakeholder Review of "&D'+(r+1),"","5","=A"+(r+32),"","","","","0",""],["","Y","","Disposition Stakeholder Comments","","5","=A"+(r+34)+"&A"+(r+35)+"&A"+(r+36),"","","","","=ROUNDUP(SUM(L"+(r+3)+":L"+(r+32)+")*0.1,0)",""],["","Y","","Obtain Stakeholder Acceptance on Comments","","5","=A"+(r+37),"","","","","0",""],["","S","",'="100% "&D'+(r+1),"","","","","","","","",""],["","Y","","Incorporate Stakeholders Comments and Complete Maximo Tasks","","=ROUND(L"+(r+40)+"/(8*E1),1)","=A"+(r+38),"","","","","=ROUNDUP(L"+(r+37)+"/2,0)",""],["","Y","",'="Verify 90% "&D'+(r+1),"","=ROUND(L"+(r+41)+"/(8*E1),1)","=A"+(r+40),"","","","","=L"+(r+40)+"/2",""],["","Y","","Route Maximo Tasks for Approval ","","=ROUND(L"+(r+42)+"/(8*E1),1)","=A"+(r+41),"","","","","2",""],["","Y","",'="Approve 90% "&D'+(r+1),"","1","=A"+(r+42),"","","","","3",""],["","Y","","OE sign off Task XXX","","2","=A"+(r+43),"","","","","0",""],["","Y","","SM sign off Task XXX","","2","=A"+(r+44),"","","","","0",""],["","Y","","Schedule Challenge Board Meeting","","=ROUND(L"+(r+46)+"/(8*E1),1)","=A"+(r+38),"","","","","1",""],["","Y","","Prepare for Challenge Board Meeting","","=ROUND(L"+(r+47)+"/(8*E1),1)","=A"+(r+43),"","","","","4",""],["","Y","","Attend Challenge Board Meeting","","5","=A"+(r+45)+"&A"+(r+46)+"&A"+(r+47),"","","","","4",""],["","Y","","Resolve Comments from Challenge Board Meeting","","3","=A"+(r+48),"","","","","8",""],["","Y","",'="Incorporate Changes into %100 "&D'+(r+1)+'&" (if required)"',"","=ROUND(L"+(r+50)+"/(8*E1),1)","=A"+(r+49),"","","","","4",""],["","Y","",'="Approve 100% "&D'+(r+1),"","1","=A"+(r+50),"","","","","1",""]];var o=1,c=e,l=JSON.parse(JSON.stringify(i)),u=0,h=0,f=0,d=0;l[0][3]=t,l[0][2]=c;for(var p=0;p<l.length;p++)"Y"==l[p][1]?(l[p][0]=c+"."+o+++",",l[p][2]="WBS"+c,u+=1,""!==s&&(l[p][10]=s)):"S"==l[p][1]&&(f=p+r,h=p-u+r+1,d>0&&(l[d][11]="=SUMIF(B"+h+":B"+f+',"Y",L'+h+":L"+f+")",l[d][12]="=SUMIF(B"+h+":B"+f+',"Y",M'+h+":M"+f+")",u=0),d=p),"blank"===a&&(l[p][11]="");return f=p+r,h=p-u+r+1,l[d][11]="=SUMIF(B"+h+":B"+f+',"Y",L'+h+":L"+f+")",l[d][12]="=SUMIF(B"+h+":B"+f+',"Y",M'+h+":M"+f+")",l[0][11]="=SUMIF(B"+(r+2)+":B"+f+',"Y",L'+(r+2)+":L"+f+")",l[0][12]="=SUMIF(B"+(r+2)+":B"+f+',"Y",M'+(r+2)+":M"+f+")",l}function HD(e,t,r,n,a,s){const i=[["","S","",'="50% "&D'+(r+1),"","","","","","","","",""],["","Y","","Pre-Job Brief","","1","","","","","","2",""],["","Y","","Gather&Review Documentation","","=ROUND(L"+(r+4)+"/(8*E1),1)","=A"+(r+3),"","","","","8",""],["","Y","",'="Prepare 50% "&D'+(r+1),"","=ROUND(L"+(r+5)+"/(8*E1),1)","=A"+(r+4),"","","","","32",""],["","Y","",'="Verify 50% "&D'+(r+1),"","=ROUND(L"+(r+6)+"/(8*E1),1)","=A"+(r+5),"","","","","=ROUNDUP(SUM(L"+(r+3)+":L"+(r+5)+")*0.15,0)",""],["","Y","","Incorporate Internal Comments","","=ROUND(L"+(r+7)+"/(8*E1),1)","=A"+(r+6),"","","","","=ROUNDUP(SUM(L"+(r+3)+":L"+(r+6)+")*0.1,0)",""],["","Y","",'="Approve 50% "&D'+(r+1),"","1","=A"+(r+5),"","","","","1",""],["","Y","",'="Submit 50% "&D'+(r+1)+'&" for Client Review"',"","1","=A"+(r+8),"","","","","1",""],["","S","","=D"+(r+1)+'&" Comment & Disposition"',"","","","","","","","",""],["","Y","",'="Stakeholder Review of "&D'+(r+1),"","10","=A"+(r+9),"","","","","0",""],["","Y","","Disposition Stakeholder Comments","","=ROUND(L"+(r+12)+"/(8*E1),1)+2","=A"+(r+11),"","","","","=ROUNDUP(SUM(L"+(r+3)+":L"+(r+9)+")*0.1,0)",""],["","Y","","Client Accept Comment Dispositions","","5","=A"+(r+12),"","","","","0",""],["","S","",'="90% "&D'+(r+1),"","","","","","","","",""],["","Y","","Incorporate Accepted Comments","","=ROUND(L"+(r+15)+"/(8*E1),1)","=A"+(r+13),"","","","","=ROUNDUP(L"+(r+12)+"/2,0)",""],["","Y","",'="Verify 90% "&D'+(r+1),"","=ROUND(L"+(r+16)+"/(8*E1),1)","=A"+(r+15),"","","","","=L"+(r+15)+"/2",""],["","Y","",'="Approve 90% "&D'+(r+1),"","=ROUND(L"+(r+17)+"/(8*E1),1)","=A"+(r+16),"","","","","1",""],["","Y","",'="Submit 90% "&D'+(r+1)+'&" for Client Acceptance"',"","1","=A"+(r+17),"","","","","1",""],["","Y","",'="Client Accept 100% "&D'+(r+1),"","5","=A"+(r+18),"","","","","0",""]];var o=1,c=e,l=JSON.parse(JSON.stringify(i)),u=0,h=0,f=0,d=0;l[0][3]=t,l[0][2]=c;for(var p=0;p<l.length;p++)"Y"==l[p][1]?(l[p][0]=c+"."+o+++",",l[p][2]="WBS"+c,u+=1,""!==s&&(l[p][10]=s)):"S"==l[p][1]&&(f=p+r,h=p-u+r+1,d>0&&(l[d][11]="=SUMIF(B"+h+":B"+f+',"Y",L'+h+":L"+f+")",l[d][12]="=SUMIF(B"+h+":B"+f+',"Y",M'+h+":M"+f+")",u=0),d=p),"blank"===a&&(l[p][11]="");return f=p+r,h=p-u+r+1,l[d][11]="=SUMIF(B"+h+":B"+f+',"Y",L'+h+":L"+f+")",l[d][12]="=SUMIF(B"+h+":B"+f+',"Y",M'+h+":M"+f+")",l[0][11]="=SUMIF(B"+(r+2)+":B"+f+',"Y",L'+(r+2)+":L"+f+")",l[0][12]="=SUMIF(B"+(r+2)+":B"+f+',"Y",M'+(r+2)+":M"+f+")",l}function zD(e,t,r,n,a,s){const i=[["","WBS","","Instrument Device Specification (IDS) or Instrument Calibration Specification (ICS)","","","","","","","","",""],["","S","",'="50% "&D'+(r+1),"","","","","","","","",""],["","Y","","Pre-Job Brief","","1","","","","","","2",""],["","Y","","Gather & Review Documentation","","=ROUND(L"+(r+4)+"/(8*E1),1)","=A"+(r+3),"","","","","8",""],["","Y","",'="Prepare 50% "&D'+(r+1),"","=ROUND(L"+(r+5)+"/(8*E1),1)","=A"+(r+4),"","","","","25",""],["","Y","",'="Verify 50% "&D'+(r+1),"","=ROUND(L"+(r+6)+"/(8*E1),1)","=A"+(r+5),"","","","","=ROUNDUP(SUM(L"+(r+3)+":L"+(r+5)+")*0.15,0)",""],["","Y","","Incorporate Internal Comments","","=ROUND(L"+(r+7)+"/(8*E1),1)","=A"+(r+6),"","","","","=ROUNDUP(SUM(L"+(r+3)+":L"+(r+6)+")*0.1,0)",""],["","Y","",'="Approve 50% "&D'+(r+1),"","1","=A"+(r+5),"","","","","1",""],["","Y","",'="Submit 50% "&D'+(r+1)+'&" for Client Review"',"","1","=A"+(r+8),"","","","","1",""],["","S","","=D"+(r+1)+'&" Comment & Disposition"',"","","","","","","","",""],["","Y","",'="Stakeholder Review of "&D'+(r+1),"","10","=A"+(r+9),"","","","","0",""],["","Y","","Disposition Stakeholder Comments","","=ROUND(L"+(r+12)+"/(8*E1),1)+2","=A"+(r+11),"","","","","=ROUNDUP(SUM(L"+(r+3)+":L"+(r+9)+")*0.1,0)",""],["","Y","","Client Accept Comment Dispositions","","5","=A"+(r+12),"","","","","0",""],["","S","",'="90% "&D'+(r+1),"","","","","","","","",""],["","Y","","Incorporates Accepted Comments","","=ROUND(L"+(r+15)+"/(8*E1),1)","=A"+(r+13),"","","","","=ROUNDUP(L"+(r+12)+"/2,0)",""],["","Y","",'="Verify 90% "&D'+(r+1),"","=ROUND(L"+(r+16)+"/(8*E1),1)","=A"+(r+15),"","","","","=L"+(r+15)+"/2",""],["","Y","",'="Approve 90% "&D'+(r+1),"","=ROUND(L"+(r+17)+"/(8*E1),1)","=A"+(r+16),"","","","","1",""],["","Y","",'="Submit 90% "&D'+(r+1)+'&" for Client Acceptance"',"","1","=A"+(r+17),"","","","","1",""],["","Y","",'="Client Accept 100% "&D'+(r+1),"","5","=A"+(r+18),"","","","","0",""]];var o=1,c=e,l=JSON.parse(JSON.stringify(i)),u=0,h=0,f=0,d=0;l[0][3]=t,l[0][2]=c;for(var p=0;p<l.length;p++)"Y"==l[p][1]?(l[p][0]=c+"."+o+++",",l[p][2]="WBS"+c,u+=1,""!==s&&(l[p][10]=s)):"S"==l[p][1]&&(f=p+r,h=p-u+r+1,d>0&&(l[d][11]="=SUMIF(B"+h+":B"+f+',"Y",L'+h+":L"+f+")",l[d][12]="=SUMIF(B"+h+":B"+f+',"Y",M'+h+":M"+f+")",u=0),d=p),"blank"===a&&(l[p][11]="");return f=p+r,h=p-u+r+1,l[d][11]="=SUMIF(B"+h+":B"+f+',"Y",L'+h+":L"+f+")",l[d][12]="=SUMIF(B"+h+":B"+f+',"Y",M'+h+":M"+f+")",l[0][11]="=SUMIF(B"+(r+2)+":B"+f+',"Y",L'+(r+2)+":L"+f+")",l[0][12]="=SUMIF(B"+(r+2)+":B"+f+',"Y",M'+(r+2)+":M"+f+")",l}function $D(e,t,r,n,a,s){const i=[["","WBS","","Replacement Instructions","","","","","","","","",""],["","S","",'="50% "&D'+(r+1),"","","","","","","","",""],["","Y","","Task Pre-Job Brief","","1","","","","","","2",""],["","Y","","Prepare Replacement Instructions (1RI / CatID)","","=ROUND(L"+(r+4)+"/(E1*8),1)","=A"+(r+3),"","","","","6",""],["","Y","","Create End Use List and Gather all ADL","","=ROUND(L"+(r+5)+"/(E1*8),1)","=A"+(r+4),"","","","","4",""],["","Y","","Create Typical Markups","","=ROUND(L"+(r+6)+"/(E1*8),1)","=A"+(r+5),"","","","","16",""],["","Y","","Send Markups to Drafting","","=ROUND(L"+(r+7)+"/(E1*8),1)","=A"+(r+6),"","","","","1",""],["","Y","","Drafting Updates Drawings for Typicals","","=ROUND(L"+(r+8)+"/(E1*8),1)","=A"+(r+7),"","","","","8",""],["","Y","","Review of Typical Drawings","","=ROUND(L"+(r+9)+"/(E1*8),1)","=A"+(r+8),"","","","","2",""],["","Y","","Perform Calcs as required","","=ROUND(L"+(r+10)+"/(E1*8),1)","=A"+(r+9),"","","","","8",""],["","Y","","Create Typical ICSs","","=ROUND(L"+(r+11)+"/(E1*8),1)","=A"+(r+10),"","","","","8",""],["","Y","","Create Typical OLW Markups","","=ROUND(L"+(r+12)+"/(E1*8),1)","=A"+(r+11),"","","","","0",""],["","Y","","Create Typical BOM","","=ROUND(L"+(r+13)+"/(E1*8),1)","=A"+(r+12),"","","","","4",""],["","Y","","Incorporate PMT in RI (If there is no separate Comm. Spec)","","=ROUND(L"+(r+14)+"/(E1*8),1)","=A"+(r+13),"","","","","8",""],["","Y","","Document Requirements for CIC-PER for JIT Documents","","=ROUND(L"+(r+15)+"/(E1*8),1)","=A"+(r+14),"","","","","8",""],["","Y","","Verify Replacement Instructions","","=ROUND(L"+(r+16)+"/(E1*8),1)","=A"+(r+15),"","","","","=ROUNDUP(SUM(L"+(r+3)+":L"+(r+15)+")*0.15,0)",""],["","Y","","Incorporate Internal Comments","","=ROUND(L"+(r+17)+"/(E1*8),1)","=A"+(r+16),"","","","","=ROUNDUP(SUM(L"+(r+3)+":L"+(r+15)+")*0.1,0)",""],["","Y","","Approve Replacement Instructions","","1","=A"+(r+17),"","","","","1",""],["","Y","",'="Submit 50% "&D'+(r+1)+'&" for Client Review"',"","1","=A"+(r+18),"","","","","1",""],["","S","","Comment & Disposition","","","","","","","","",""],["","Y","",'="Stakeholder Review of "&D'+(r+1),"","10","=A"+(r+19),"","","","","0",""],["","Y","","Disposition Stakeholder Comments","","=ROUND(L"+(r+22)+"/(E1*8),1)+2","=A"+(r+21),"","","","","=ROUNDUP(SUM(L"+(r+3)+":L"+(r+19)+")*0.1,0)",""],["","Y","","Client Accept Comment Dispositions","","5","=A"+(r+22),"","","","","1",""],["","S","",'="90% "&D'+(r+1),"","","","","","","","",""],["","Y","","Incorporate Accepted Comment","","=ROUND(L"+(r+25)+"/(E1*8),1)","=A"+(r+23),"","","","","=ROUNDUP(L"+(r+22)+"/2,0)",""],["","Y","",'="Final Verification of 90% "&D'+(r+1),"","=ROUND(L"+(r+26)+"/(E1*8),1)","=A"+(r+25),"","","","","=L"+(r+25)+"/2",""],["","Y","",'="Approve 90% "&D'+(r+1),"","1","=A"+(r+26),"","","","","1",""],["","Y","",'="Submit "&D'+(r+1)+'&" for Client Acceptance"',"","1","=A"+(r+27),"","","","","1",""],["","Y","",'="Client Accept 100% "&D'+(r+1),"","5","=A"+(r+28),"","","","","0",""]];var o=1,c=e,l=JSON.parse(JSON.stringify(i)),u=0,h=0,f=0,d=0;l[0][3]=t,l[0][2]=c;for(var p=0;p<l.length;p++)"Y"==l[p][1]?(l[p][0]=c+"."+o+++",",l[p][2]="WBS"+c,u+=1,""!==s&&(l[p][10]=s)):"S"==l[p][1]&&(f=p+r,h=p-u+r+1,d>0&&(l[d][11]="=SUMIF(B"+h+":B"+f+',"Y",L'+h+":L"+f+")",l[d][12]="=SUMIF(B"+h+":B"+f+',"Y",M'+h+":M"+f+")",u=0),d=p),"blank"===a&&(l[p][11]="");return f=p+r,h=p-u+r+1,l[d][11]="=SUMIF(B"+h+":B"+f+',"Y",L'+h+":L"+f+")",l[d][12]="=SUMIF(B"+h+":B"+f+',"Y",M'+h+":M"+f+")",l[0][11]="=SUMIF(B"+(r+2)+":B"+f+',"Y",L'+(r+2)+":L"+f+")",l[0][12]="=SUMIF(B"+(r+2)+":B"+f+',"Y",M'+(r+2)+":M"+f+")",l}function jD(e,t,r,n,a,s){const i=[["","WBS","","Model Work Order","","","","","","","","",""],["","S","","=D"+(r+1),"","","","","","","","",""],["","Y","","Provide Approved RI to Assessor for MWO Completion","","=ROUND(L"+(r+3)+"/(E1*8),1)","","","","","","2",""],["","Y","","Coordinate Assessing with WO Tasks","","=ROUND(L"+(r+4)+"/(E1*8),1)","=A"+(r+3),"","","","","5",""],["","Y","","Obtain Model WO Approval","","=ROUND(L"+(r+5)+"/(E1*8),1)","=A"+(r+4),"","","","","2",""],["","Y","","Place Model WO on the X-Ref for DCPE-PER","","=ROUND(L"+(r+6)+"/(E1*8),1)","=A"+(r+5),"","","","","5",""],["","Y","","Complete AEL update in Maximo with Model WO and RI Info","","=ROUND(L"+(r+7)+"/(E1*8),1)","=A"+(r+6),"","","","","14",""],["","Y","","Material Purchasability","","=ROUND(L"+(r+8)+"/(E1*8),1)","=A"+(r+7),"","","","","8",""],["","Y","","Model Work Order Assessing and Maximo Ready","","=ROUND(L"+(r+9)+"/(E1*8),1)","=A"+(r+8),"","","","","5",""]];var o=1,c=e,l=JSON.parse(JSON.stringify(i)),u=0,h=0,f=0,d=0;l[0][3]=t,l[0][2]=c;for(var p=0;p<l.length;p++)"Y"==l[p][1]?(l[p][0]=c+"."+o+++",",l[p][2]="WBS"+c,u+=1,""!==s&&(l[p][10]=s)):"S"==l[p][1]&&(f=p+r,h=p-u+r+1,d>0&&(l[d][11]="=SUMIF(B"+h+":B"+f+',"Y",L'+h+":L"+f+")",l[d][12]="=SUMIF(B"+h+":B"+f+',"Y",M'+h+":M"+f+")",u=0),d=p),"blank"===a&&(l[p][11]="");return f=p+r,h=p-u+r+1,l[d][11]="=SUMIF(B"+h+":B"+f+',"Y",L'+h+":L"+f+")",l[d][12]="=SUMIF(B"+h+":B"+f+',"Y",M'+h+":M"+f+")",l[0][11]="=SUMIF(B"+(r+2)+":B"+f+',"Y",L'+(r+2)+":L"+f+")",l[0][12]="=SUMIF(B"+(r+2)+":B"+f+',"Y",M'+(r+2)+":M"+f+")",l}function XD(e,t,r,n,a,s){const i=[["","WBS","","DCN xxxxx","","","","","","","","",""],["","S","",'="50% "&D'+(r+1),"","","","","","","","",""],["","Y","","=D"+(r+1)+'&" - Pre-Job Brief"',"","1","","","","","","3",""],["","Y","","=D"+(r+1)+'&" - Data Collection"',"","=ROUND(L"+(r+4)+"/(8*E1),1)","=A"+(r+3),"","","","","8",""],["","Y","","= D"+(r+1)+'&" - Create DCN in Maximo"',"","=ROUND(L"+(r+5)+"/(8*E1),1)","=A"+(r+4),"","","","","4",""],["","Y","","=D"+(r+1)+'&" - Create DCN Cover Sheet"',"","=ROUND(L"+(r+6)+"/(8*E1),1)","=A"+(r+5),"","","","","4",""],["","Y","","=D"+(r+1)+'&" - Prepare FORMs (FORM-14431, Seismic Form, etc.)"',"","=ROUND(L"+(r+7)+"/(8*E1),1)","=A"+(r+5),"","","","","12",""],["","Y","","=D"+(r+1)+'&" - Mark-up Existing Drawings (Piping Isometrics, GAs, etc.)"',"- assume 6 markups at 2h per","=ROUND(L"+(r+8)+"/(8*E1),1)","=A"+(r+5),"","","","","=6*2",""],["","Y","","=D"+(r+1)+'&" - Create New Drawings (Piping Isometrics, GAs, etc.)"',"- assume 3 new drawings at 6h per","=ROUND(L"+(r+9)+"/(8*E1),1)","=A"+(r+5),"","","","","=3*6",""],["","Y","","=D"+(r+1)+'&" - Drafting"',"","=ROUND(L"+(r+10)+"/(8*E1),1)","=A"+(r+8)+"&A"+(r+9),"-1","","","","=SUM(L"+(r+8)+":L"+(r+9)+")*1.5",""],["","Y","","=D"+(r+1)+'&" - Procurement Support/Review"',"","=ROUND(L"+(r+11)+"/(8*E1),1)","=A"+(r+5),"","","","","5",""],["","Y","","=D"+(r+1)+'&" - CAT ID Creation"',"","=ROUND(L"+(r+12)+"/(8*E1),1)","=A"+(r+5),"","","","","5",""],["","Y","","=D"+(r+1)+'&" - CAT ID Screening"',"","=ROUND(L"+(r+13)+"/(8*E1),1)","=A"+(r+5),"","","","","5",""],["","Y","","= D"+(r+1)+'&" - Create DBOM"',"","=ROUND(L"+(r+14)+"/(8*E1),1)","=A"+(r+5),"","","","","5",""],["","Y","","=D"+(r+1)+'&" - Update EBOM"',"","=ROUND(L"+(r+15)+"/(8*E1),1)","=A"+(r+5),"","","","","5",""],["","Y","","=D"+(r+1)+'&" - Vendor Documents Received"',"Milestone","0","","","","","","0",""],["","Y","","= D"+(r+1)+'&" - Review Vendor Documents&Update DCN"',"","=ROUND(L"+(r+17)+"/(8*E1),1)","=A"+(r+16),"","","","","6",""],["","Y","","=D"+(r+1)+'&" - Update MEL and Route Task to Drafting Office for Approval"',"","=ROUND(L"+(r+18)+"/(8*E1),1)","=A"+(r+5),"","","","","4",""],["","Y","","=D"+(r+1)+'&" - Update Maximo for Tech Content (Change Papers, AEL, ACB etc.)"',"","=ROUND(L"+(r+19)+"/(8*E1),1)","=A"+(r+5),"","","","","5",""],["","Y","","=D"+(r+1)+'&" - Verify DCN"',"","2","=A"+(r+6)+"&A"+(r+7)+"&A"+(r+10)+"&A"+(r+12)+"&A"+(r+13)+"&A"+(r+14)+"&A"+(r+15)+"&A"+(r+17)+"&A"+(r+18)+"&A"+(r+19),"","","","","=ROUNDUP(SUM(L"+(r+3)+":L"+(r+19)+")*0.15,0)",""],["","Y","","= D"+(r+1)+'&" - Disposition/Incorporate Internal Comments"',"","3","=A"+(r+20),"","","","","=ROUNDUP(SUM(L"+(r+3)+":L"+(r+19)+")*0.1,0)",""],["","Y","","= D"+(r+1)+'&" - Endorse and Issue DCN"',"","1","=A"+(r+21),"","","","","2",""],["","Y","","= D"+(r+1)+'&" - Submit DCN for Stakeholder Review"',"","1","=A"+(r+22),"","","","","1",""],["","S","","=D"+(r+1)+'&": Comment and Disposition"',"","","","","","","","",""],["","Y","","=D"+(r+1)+'&" - Route Tasks for Stakeholder Review / Stakeholder Interface"',"","10","=A"+(r+22),"","","","","5",""],["","Y","","=D"+(r+1)+'&" - Stakeholder Review"',"","10","=A"+(r+23),"","","","","0",""],["","Y","","=D"+(r+1)+'&" - Constructability Review Meeting (if required)"'," - Assumes 2 people","1","=A"+(r+23),"3","","","","4",""],["","Y","","=D"+(r+1)+'&" - COMS Meeting"'," - Assumes 2 people with travel time to site","1","=A"+(r+23),"5","","","","16",""],["","Y","","=D"+(r+1)+'&" - Disposition COMS/Constructability/Stakeholder Review Comments"',"","3","=A"+(r+25)+"&A"+(r+26)+"&A"+(r+27)+"&A"+(r+28),"","","","","=ROUNDUP(SUM(L"+(r+3)+":L"+(r+23)+")*0.1,0)",""],["","Y","","=D"+(r+1)+'&" - Client - Review and Accept Dispositions"',"","5","=A"+(r+29),"","","","","0",""],["","S","",'="90% "&D'+(r+1),"","","","","","","","",""],["","Y","","=D"+(r+1)+'&" - Update DCN Package to Incorporate Stakeholder Comments"',"","=ROUND(L"+(r+32)+"/(8*E1),1)","=A"+(r+30),"","","","","=ROUNDUP(L"+(r+29)+"/2,0)",""],["","Y","","=D"+(r+1)+'&" - Final Verification of Updated DCN"',"","=ROUND(L"+(r+33)+"/(8*E1),1)","=A"+(r+32),"","","","","=L"+(r+32)+"/2",""],["","Y","","=D"+(r+1)+'&" - Incorporate Internal Comments"',"","=ROUND(L"+(r+34)+"/(8*E1),1)","=A"+(r+32),"","","","","1",""],["","Y","","=D"+(r+1)+'&" - Approve 90% DCN"',"","1","=A"+(r+33),"","","","","2",""],["","Y","","=D"+(r+1)+'&" - Endorse / Issue DCN and Signoff Maximo"',"","1","=A"+(r+35),"","","","","1",""],["","Y","","= D"+(r+1)+'&" - Upload DCN for Acceptance"',"","1","=A"+(r+36),"","","","","1",""],["","Y","","= D"+(r+1)+'&" - Resolve Minor Comments (if any)"',"","2","=A"+(r+37),"","","","","4",""],["","Y","","=D"+(r+1)+'&" - Client Acceptance&Signoff (Tasks 631, 633 & 635)"',"","5","=A"+(r+38),"","","","","0",""],["","Y","","= D"+(r+1)+'&" - Approved as per Task 500"',"Milestone","0","=A"+(r+39),"","","","","0",""]];var o=1,c=e,l=JSON.parse(JSON.stringify(i)),u=0,h=0,f=0,d=0;l[0][3]=t,l[0][2]=c;for(var p=0;p<l.length;p++)"Y"==l[p][1]?(l[p][0]=c+"."+o+++",",l[p][2]="WBS"+c,u+=1,""!==s&&(l[p][10]=s)):"S"==l[p][1]&&(f=p+r,h=p-u+r+1,d>0&&(l[d][11]="=SUMIF(B"+h+":B"+f+',"Y",L'+h+":L"+f+")",l[d][12]="=SUMIF(B"+h+":B"+f+',"Y",M'+h+":M"+f+")",u=0),d=p),"blank"===a&&(l[p][11]="");return f=p+r,h=p-u+r+1,l[d][11]="=SUMIF(B"+h+":B"+f+',"Y",L'+h+":L"+f+")",l[d][12]="=SUMIF(B"+h+":B"+f+',"Y",M'+h+":M"+f+")",l[0][11]="=SUMIF(B"+(r+2)+":B"+f+',"Y",L'+(r+2)+":L"+f+")",l[0][12]="=SUMIF(B"+(r+2)+":B"+f+',"Y",M'+(r+2)+":M"+f+")",l}function KD(e,t,r,n,a,s){const i=[["","WBS","","DCN xxxxx","","","","","","","","",""],["","S","",'="50% "&D'+(r+1),"","","","","","","","",""],["","Y","","=D"+(r+1)+'&" - Pre-Job Brief"',"","1","","","","","","3",""],["","Y","","=D"+(r+1)+'&" - Data Collection"',"","=ROUND(L"+(r+4)+"/(8*E1),1)","=A"+(r+3),"","","","","8",""],["","Y","","= D"+(r+1)+'&" - Create DCN in Maximo"',"","=ROUND(L"+(r+5)+"/(8*E1),1)","=A"+(r+4),"","","","","4",""],["","Y","","=D"+(r+1)+'&" - Create DCN Cover Sheet"',"","=ROUND(SUM(L"+(r+6)+":L"+(r+15)+")/(8*E1),1)","=A"+(r+5),"","","","","4",""],["","Y","","=D"+(r+1)+'&" - Prepare FORMs (FORM-14431, Seismic Form, OLW checklist, etc.)"',"","=ROUND(SUM(L"+(r+6)+":L"+(r+15)+")/(8*E1),1)","=A"+(r+5),"","","","","12",""],["","Y","","=D"+(r+1)+'&" - Mark-up Existing Drawings (EWDs, CBDs, GAs, Fuse DataSheets, etc.)"',"- assume 4 markups at 2h per","=ROUND(SUM(L"+(r+6)+":L"+(r+15)+")/(8*E1),1)","=A"+(r+5),"","","","","=4*2",""],["","Y","","=D"+(r+1)+'&" - Create New Drawings (EWDs, CBDs, GAs, Fuse DataSheets, etc.)"',"- assume 2 new drawings at 6h per","=ROUND(SUM(L"+(r+6)+":L"+(r+15)+")/(8*E1),1)","=A"+(r+5),"","","","","=2*6",""],["","Y","","=D"+(r+1)+'&" - Drafting"',"","=ROUND(SUM(L"+(r+6)+":L"+(r+15)+")/(8*E1),1)","=A"+(r+8)+"&A"+(r+9),"-1","","","","=SUM(L"+(r+8)+":L"+(r+9)+")*1.5",""],["","Y","","=D"+(r+1)+'&" - Procurement Support/Review"',"","=ROUND(SUM(L"+(r+6)+":L"+(r+15)+")/(8*E1),1)","=A"+(r+5),"","","","","5",""],["","Y","","=D"+(r+1)+'&" - CAT ID Creation"',"","=ROUND(SUM(L"+(r+6)+":L"+(r+15)+")/(8*E1),1)","=A"+(r+5),"","","","","5",""],["","Y","","=D"+(r+1)+'&" - CAT ID Screening"',"","=ROUND(SUM(L"+(r+6)+":L"+(r+15)+")/(8*E1),1)","=A"+(r+5),"","","","","5",""],["","Y","","= D"+(r+1)+'&" - Create DBOM"',"","=ROUND(SUM(L"+(r+6)+":L"+(r+15)+")/(8*E1),1)","=A"+(r+5),"","","","","5",""],["","Y","","=D"+(r+1)+'&" - Update EBOM"',"","=ROUND(SUM(L"+(r+6)+":L"+(r+15)+")/(8*E1),1)","=A"+(r+5),"","","","","5",""],["","Y","","=D"+(r+1)+'&" - Vendor Documents Received"',"Milestone","0","","","","","","0",""],["","Y","","= D"+(r+1)+'&" - Review Vendor Documents&Update DCN"',"","=ROUND(L"+(r+17)+"/(8*E1),1)","=A"+(r+16),"","","","","6",""],["","Y","","=D"+(r+1)+'&" - Update MEL and Route Task to Drafting Office for Approval"',"","=ROUND(L"+(r+18)+"/(8*E1),1)","=A"+(r+5),"","","","","4",""],["","Y","","=D"+(r+1)+'&" - Update Maximo for Tech Content (Change Papers, AEL, ACB etc.)"',"","=ROUND(L"+(r+19)+"/(8*E1),1)","=A"+(r+5),"","","","","5",""],["","Y","","=D"+(r+1)+'&" - Verify DCN"',"","2","=A"+(r+6)+"&A"+(r+7)+"&A"+(r+10)+"&A"+(r+12)+"&A"+(r+13)+"&A"+(r+14)+"&A"+(r+15)+"&A"+(r+17)+"&A"+(r+18)+"&A"+(r+19),"","","","","=ROUNDUP(SUM(L"+(r+3)+":L"+(r+19)+")*0.15,0)",""],["","Y","","= D"+(r+1)+'&" - Disposition/Incorporate Internal Comments"',"","3","=A"+(r+20),"","","","","=ROUNDUP(SUM(L"+(r+3)+":L"+(r+19)+")*0.1,0)",""],["","Y","","= D"+(r+1)+'&" - Endorse and Issue DCN"',"","1","=A"+(r+21),"","","","","2",""],["","Y","","= D"+(r+1)+'&" - Submit DCN for Client Review"',"","1","=A"+(r+22),"","","","","1",""],["","S","","=D"+(r+1)+'&" Online Wiring"',"","","","","","","","",""],["","Y","","= D"+(r+1)+'&" - Submit Drawings to Client for Online Wiring (OLW)"',"","1","=A"+(r+14),"","","","","2",""],["","Y","","= D"+(r+1)+'&" - Client RDE Releases OLW Package to Client Drafting Office"',"","2","=A"+(r+25),"","","","","0",""],["","Y","","= D"+(r+1)+'&" - Client Drafting Office Completes the OLW"',"","15","=A"+(r+26),"","","","","0",""],["","Y","","= D"+(r+1)+'&" - Review OLW Package"',"","2","=A"+(r+27),"","","","","6",""],["","Y","","= D"+(r+1)+'&" - Submit Comments to OLW"',"","1","=A"+(r+28),"","","","","1",""],["","Y","","= D"+(r+1)+'&" - Client Disposition Comments and Update OLW"',"","3","=A"+(r+29),"","","","","0",""],["","Y","","= D"+(r+1)+'&" - Review Changes"',"","2","=A"+(r+30),"","","","","4",""],["","Y","","= D"+(r+1)+'&" - Submit Final OLW Package for Client Acceptance"',"","1","=A"+(r+31),"","","","","1",""],["","Y","","= D"+(r+1)+'&" - Perform Post-Design Confirmation Walkdown"',"- Assume 1 person","5","=A"+(r+32),"","","","","8",""],["","S","","=D"+(r+1)+'&": Comment and Disposition"',"","","","","","","","",""],["","Y","","=D"+(r+1)+'&" - Route Tasks for Stakeholder Review / Stakeholder Interface"',"","10","=A"+(r+22),"","","","","5",""],["","Y","","=D"+(r+1)+'&" - Stakeholder Review"',"","10","=A"+(r+23),"","","","","0",""],["","Y","","=D"+(r+1)+'&" - Constructability Review Meeting (if required)"',"- Assume 2 people","1","=A"+(r+23),"3","","","","4",""],["","Y","","=D"+(r+1)+'&" - COMS Meeting"',"- Assumes 2 people with travel time to site","1","=A"+(r+23),"5","","","","16",""],["","Y","","=D"+(r+1)+'&" - Disposition COMS/Constructability/Stakeholder Review Comments"',"","3","=A"+(r+35)+"&A"+(r+36)+"&A"+(r+37)+"&A"+(r+38),"","","","","=ROUNDUP(SUM(L"+(r+3)+":L"+(r+23)+")*0.1,0)",""],["","Y","","=D"+(r+1)+'&" - Client - Review and Accept Dispositions"',"","5","=A"+(r+39),"","","","","0",""],["","S","",'="90% "&D'+(r+1),"","","","","","","","",""],["","Y","","=D"+(r+1)+'&" - Update DCN Package to Incorporate Stakeholder Comments"',"","=ROUND(L"+(r+42)+"/(8*E1),1)","=A"+(r+40),"","","","","=ROUNDUP(L"+(r+39)+"/2,0)",""],["","Y","","=D"+(r+1)+'&" - Final Verification of Updated DCN"',"","=ROUND(L"+(r+43)+"/(8*E1),1)","=A"+(r+42)+"&A"+(r+33),"","","","","=L"+(r+42)+"/2",""],["","Y","","=D"+(r+1)+'&" - Incorporate Internal Comments"',"","=ROUND(L"+(r+44)+"/(8*E1),1)","=A"+(r+42),"","","","","1",""],["","Y","","=D"+(r+1)+'&" - Approve 90% DCN"',"","1","=A"+(r+43),"","","","","2",""],["","Y","","=D"+(r+1)+'&" - Endorse / Issue DCN and Signoff Maximo"',"","1","=A"+(r+45),"","","","","1",""],["","Y","","= D"+(r+1)+'&" - Upload DCN for Acceptance"',"","1","=A"+(r+46),"","","","","1",""],["","Y","","= D"+(r+1)+'&" - Resolve Minor Comments (if any)"',"","2","=A"+(r+47),"","","","","4",""],["","Y","","=D"+(r+1)+'&" - Client Acceptance&Signoff (Tasks 631, 633 & 635)"',"","5","=A"+(r+48),"","","","","0",""],["","Y","","= D"+(r+1)+'&" - Approved as per Task 500"',"Milestone","0","=A"+(r+49),"","","","","0",""]];var o=1,c=e,l=JSON.parse(JSON.stringify(i)),u=0,h=0,f=0,d=0;l[0][3]=t,l[0][2]=c;for(var p=0;p<l.length;p++)"Y"==l[p][1]?(l[p][0]=c+"."+o+++",",l[p][2]="WBS"+c,u+=1,""!==s&&(l[p][10]=s)):"S"==l[p][1]&&(f=p+r,h=p-u+r+1,d>0&&(l[d][11]="=SUMIF(B"+h+":B"+f+',"Y",L'+h+":L"+f+")",l[d][12]="=SUMIF(B"+h+":B"+f+',"Y",M'+h+":M"+f+")",u=0),d=p),"blank"===a&&(l[p][11]="");return f=p+r,h=p-u+r+1,l[d][11]="=SUMIF(B"+h+":B"+f+',"Y",L'+h+":L"+f+")",l[d][12]="=SUMIF(B"+h+":B"+f+',"Y",M'+h+":M"+f+")",l[0][11]="=SUMIF(B"+(r+2)+":B"+f+',"Y",L'+(r+2)+":L"+f+")",l[0][12]="=SUMIF(B"+(r+2)+":B"+f+',"Y",M'+(r+2)+":M"+f+")",l}function qD(e,t,r,n,a,s){const i=[["","WBS","","DCN xxxxx","","","","","","","","",""],["","S","",'="50% "&D'+(r+1),"","","","","","","","",""],["","Y","","=D"+(r+1)+'&" - Pre-Job Brief"',"","1","","","","","","3",""],["","Y","","=D"+(r+1)+'&" - Data Collection"',"","=ROUND(L"+(r+4)+"/(8*E1),1)","=A"+(r+3),"","","","","8",""],["","Y","","= D"+(r+1)+'&" - Create DCN in Maximo"',"","=ROUND(L"+(r+5)+"/(8*E1),1)","=A"+(r+4),"","","","","4",""],["","Y","","=D"+(r+1)+'&" - Create DCN Cover Sheet"',"","=ROUND(SUM(L"+(r+6)+":L"+(r+18)+")/(8*E1),1)","=A"+(r+5),"","","","","4",""],["","Y","","=D"+(r+1)+'&" - Prepare FORMs (FORM-14431, SQA Checklist, Section G to I FORM-11409) "',"","=ROUND(SUM(L"+(r+6)+":L"+(r+18)+")/(8*E1),1)","=A"+(r+5),"","","","","8",""],["","Y","","=D"+(r+1)+'&" - Software Release (SWR)"',"","=ROUND(SUM(L"+(r+6)+":L"+(r+18)+")/(8*E1),1)","=A"+(r+5),"","","","","24",""],["","Y","","=D"+(r+1)+'&" - Software Maintenance Plan (SWM)"',"","=ROUND(SUM(L"+(r+6)+":L"+(r+18)+")/(8*E1),1)","=A"+(r+5),"","","","","24",""],["","Y","","=D"+(r+1)+'&" - Software Transition Plan"',"","=ROUND(SUM(L"+(r+6)+":L"+(r+18)+")/(8*E1),1)","=A"+(r+5),"","","","","24",""],["","Y","","=D"+(r+1)+'&" - Standard&Procedures Handbook (SPH)"',"","=ROUND(SUM(L"+(r+6)+":L"+(r+18)+")/(8*E1),1)","=A"+(r+5),"","","","","24",""],["","Y","","=D"+(r+1)+'&" - Software Development Plan (SDP)"',"","=ROUND(SUM(L"+(r+6)+":L"+(r+18)+")/(8*E1),1)","=A"+(r+5),"","","","","24",""],["","Y","","=D"+(r+1)+'&" - Software Qualification Report"',"","=ROUND(SUM(L"+(r+6)+":L"+(r+18)+")/(8*E1),1)","=A"+(r+5),"","","","","24",""],["","Y","","=D"+(r+1)+'&" - Computer System Requirements (CSR)"',"","=ROUND(SUM(L"+(r+6)+":L"+(r+18)+")/(8*E1),1)","=A"+(r+5),"","","","","24",""],["","Y","","=D"+(r+1)+'&" - Computer System Design Description (CSD)"',"","=ROUND(SUM(L"+(r+6)+":L"+(r+18)+")/(8*E1),1)","=A"+(r+5),"","","","","16",""],["","Y","","=D"+(r+1)+'&" - Computer Hardware Design (CHD)"',"","=ROUND(SUM(L"+(r+6)+":L"+(r+18)+")/(8*E1),1)","=A"+(r+5),"","","","","16",""],["","Y","","=D"+(r+1)+'&" - Software Requirements Specification (SRS)"',"","=ROUND(SUM(L"+(r+6)+":L"+(r+18)+")/(8*E1),1)","=A"+(r+5),"","","","","16",""],["","Y","","=D"+(r+1)+'&" - Software Design Description (SDD)"',"","=ROUND(SUM(L"+(r+6)+":L"+(r+18)+")/(8*E1),1)","=A"+(r+5),"","","","","16",""],["","Y","",'="50% "&D'+(r+1)+'&" Drafted"',"Milestone","=ROUND(L"+(r+19)+"/(8*E1),1)","=A"+(r+7)+"&A"+(r+8)+"&A"+(r+9)+"&A"+(r+10)+"&A"+(r+11)+"&A"+(r+12)+"&A"+(r+13)+"&A"+(r+14)+"&A"+(r+15)+"&A"+(r+16)+"&A"+(r+17)+"&A"+(r+18),"","","","","0",""],["","S","",'="90% "&D'+(r+1)+'&" Software Review&Testing"',"","","","","","","","",""],["","Y","","=D"+(r+1)+'&" - Computer System Design Review Report (CSDRR)"',"","=ROUND(SUM(L"+(r+21)+":L"+(r+24)+")/(8*E1),1)","=A"+(r+19),"","","","","3",""],["","Y","","=D"+(r+1)+'&" - Software Requirements Review Report (SRRR)"',"","=ROUND(SUM(L"+(r+21)+":L"+(r+24)+")/(8*E1),1)","=A"+(r+19),"","","","","8",""],["","Y","","=D"+(r+1)+'&" - Software Design Review Report (SDRR)"',"","=ROUND(SUM(L"+(r+21)+":L"+(r+24)+")/(8*E1),1)","=A"+(r+19),"","","","","4",""],["","Y","","=D"+(r+1)+'&" - Code Review Report (CRR)"',"","=ROUND(SUM(L"+(r+21)+":L"+(r+24)+")/(8*E1),1)","=A"+(r+19),"","","","","4",""],["","Y","","=D"+(r+1)+'&" - Sub-System Test Procedures (STP)"',"","=ROUND(L"+(r+25)+"/(8*E1),1)","=A"+(r+21)+"&A"+(r+22)+"&A"+(r+23)+"&A"+(r+24),"","","","","8",""],["","Y","","=D"+(r+1)+'&" - Sub-System Test Report (STR)"',"","=ROUND(L"+(r+26)+"/(8*E1),1)","=A"+(r+25),"","","","","8",""],["","Y","","=D"+(r+1)+'&" - Unit Test Procedures (UTP)"',"","=ROUND(L"+(r+27)+"/(8*E1),1)","=A"+(r+26),"","","","","8",""],["","Y","","=D"+(r+1)+'&" - Unit Test Report (UTR)"',"","=ROUND(L"+(r+28)+"/(8*E1),1)","=A"+(r+27),"","","","","8",""],["","Y","","=D"+(r+1)+'&" - System Integration Test Procedures (SITP)"',"","=ROUND(L"+(r+29)+"/(8*E1),1)","=A"+(r+28),"","","","","8",""],["","Y","","=D"+(r+1)+'&" - System Integration Test Report (SITR)"',"","=ROUND(L"+(r+30)+"/(8*E1),1)","=A"+(r+29),"","","","","8",""],["","Y","","=D"+(r+1)+'&" - Validation Test Procedures (VTP)"',"","=ROUND(L"+(r+31)+"/(8*E1),1)","=A"+(r+30),"","","","","8",""],["","Y","","=D"+(r+1)+'&" - Validation Test Report (VTR)"',"","=ROUND(L"+(r+32)+"/(8*E1),1)","=A"+(r+31),"","","","","8",""],["","Y","","=D"+(r+1)+'&" - Update Maximo for all Technical Content"',"","=ROUND(L"+(r+33)+"/(8*E1),1)","=A"+(r+32),"","","","","8",""],["","Y","","=D"+(r+1)+'&" - Verify DCN"',"","2","=A"+(r+33),"","","","","8",""],["","Y","","=D"+(r+1)+'&" - Disposition/Incorporate Internal Comments"',"","3","=A"+(r+34),"","","","","8",""],["","Y","","=D"+(r+1)+'&" - Endorse and Issue DCN"',"","1","=A"+(r+35),"","","","","2",""],["","Y","","=D"+(r+1)+'&" - Submit DCN for Client Review"',"","1","=A"+(r+36),"","","","","1",""],["","S","","=D"+(r+1)+'&": Comment and Disposition"',"","","","","","","","",""],["","Y","","=D"+(r+1)+'&" - Route Tasks for Stakeholder Review / Stakeholder Interface"',"","10","=A"+(r+37),"","","","","5",""],["","Y","","=D"+(r+1)+'&" - Stakeholder Review"',"","10","=A"+(r+37),"","","","","0",""],["","Y","","=D"+(r+1)+'&" - COMS Meeting"'," - Assumes 2 people with travel time to site","1","=A"+(r+37),"5","","","","16",""],["","Y","","=D"+(r+1)+'&" - Disposition COMS/Stakeholder Review Comments"',"","3","=A"+(r+40)+"&A"+(r+41),"","","","","=ROUNDUP(SUM(L"+(r+3)+":L"+(r+19)+")*0.15,0)",""],["","Y","","=D"+(r+1)+'&" - Client - Review and Accept Dispositions"',"","5","=A"+(r+42),"","","","","0",""],["","S","",'="90% "&D'+(r+1),"","","","","","","","",""],["","Y","","=D"+(r+1)+'&" - Update DCN Package to Incorporate Stakeholder Comments"',"","=ROUND(L"+(r+45)+"/(8*E1),1)","=A"+(r+43),"","","","","=ROUNDUP(L"+(r+42)+"/2,0)",""],["","Y","","=D"+(r+1)+'&" - Final Verification of Updated DCN"',"","=ROUND(L"+(r+46)+"/(8*E1),1)","=A"+(r+45),"","","","","=L"+(r+45)+"/2",""],["","Y","","=D"+(r+1)+'&" - Incorporate Internal Comments"',"","=ROUND(L"+(r+47)+"/(8*E1),1)","=A"+(r+46),"","","","","1",""],["","Y","","=D"+(r+1)+'&" - Approve 90% DCN"',"","1","=A"+(r+47),"","","","","2",""],["","Y","","=D"+(r+1)+'&" - Endorse / Issue DCN and Signoff Maximo"',"","1","=A"+(r+48),"","","","","1",""],["","Y","","= D"+(r+1)+'&" - Upload DCN for Acceptance"',"","1","=A"+(r+49),"","","","","1",""],["","Y","","= D"+(r+1)+'&" - Resolve Minor Comments (if any)"',"","2","=A"+(r+50),"","","","","4",""],["","Y","","=D"+(r+1)+'&" - Client Acceptance & Signoff (Tasks 631, 633 & 635)"',"","5","=A"+(r+51),"","","","","0",""],["","Y","","= D"+(r+1)+'&" - Approved as per Task 500"',"Milestone","0","=A"+(r+52),"","","","","0",""]];var o=1,c=e,l=JSON.parse(JSON.stringify(i)),u=0,h=0,f=0,d=0;l[0][3]=t,l[0][2]=c;for(var p=0;p<l.length;p++)"Y"==l[p][1]?(l[p][0]=c+"."+o+++",",l[p][2]="WBS"+c,u+=1,""!==s&&(l[p][10]=s)):"S"==l[p][1]&&(f=p+r,h=p-u+r+1,d>0&&(l[d][11]="=SUMIF(B"+h+":B"+f+',"Y",L'+h+":L"+f+")",l[d][12]="=SUMIF(B"+h+":B"+f+',"Y",M'+h+":M"+f+")",u=0),d=p),"blank"===a&&(l[p][11]="");return f=p+r,h=p-u+r+1,l[d][11]="=SUMIF(B"+h+":B"+f+',"Y",L'+h+":L"+f+")",l[d][12]="=SUMIF(B"+h+":B"+f+',"Y",M'+h+":M"+f+")",l[0][11]="=SUMIF(B"+(r+2)+":B"+f+',"Y",L'+(r+2)+":L"+f+")",l[0][12]="=SUMIF(B"+(r+2)+":B"+f+',"Y",M'+(r+2)+":M"+f+")",l}function JD(e,t,r,n,a,s){const i=[["","WBS","","DCN xxxxx","","","","","","","","",""],["","S","",'="50% "&D'+(r+1),"","","","","","","","",""],["","Y","","=D"+(r+1)+'&" - Pre-Job Brief"',"","1","","","","","","3",""],["","Y","","=D"+(r+1)+'&" - Data Collection"',"","=ROUND(L"+(r+4)+"/(8*E1),1)","=A"+(r+3),"","","","","8",""],["","Y","","= D"+(r+1)+'&" - Create DCN in Maximo"',"","=ROUNDUP(SUM(L"+(r+5)+")/(8*E1),1)*2","=A"+(r+4),"","","","","4",""],["","Y","","=D"+(r+1)+'&" - Create DCN Cover Sheet"',"","=ROUNDUP(SUM(L"+(r+6)+":L"+(r+7)+")/(8*E1),1)","=A"+(r+5),"","","","","4",""],["","Y","","=D"+(r+1)+'&" - Prepare FORMs (FORM-14431, SQA Checklist, Section G to I FORM-11409) "',"","=ROUNDUP(SUM(L"+(r+6)+":L"+(r+7)+")/(8*E1),1)","=A"+(r+5),"","","","","8",""],["","Y","","=D"+(r+1)+'&" - Perform Work Order Planning"',"","=ROUND(L"+(r+8)+"/(8*E1),1)","=A"+(r+4),"","","","","6",""],["","Y","","=D"+(r+1)+'&" - Prepare Testing Environment"',"","=ROUND(L"+(r+9)+"/(8*E1),1)","=A"+(r+8),"","","","","4",""],["","Y","","=D"+(r+1)+'&" - Prepare Test Plan"',"","=ROUND(L"+(r+10)+"/(8*E1),1)","=A"+(r+9),"","","","","4",""],["","Y","","=D"+(r+1)+'&" - Verify Test Plan"',"","=ROUND(L"+(r+11)+"/(8*E1),1)","=A"+(r+10),"","","","","2",""],["","Y","","=D"+(r+1)+'&" - Approve Test Plan"',"","=ROUND(L"+(r+12)+"/(8*E1),1)","=A"+(r+11),"","","","","1",""],["","Y","","=D"+(r+1)+'&" - Write Patches"',"","=ROUND(L"+(r+13)+"/(8*E1),1)","=A"+(r+12),"","","","","8",""],["","Y","","=D"+(r+1)+'&" - Software Walkdown"',"","=ROUND(L"+(r+14)+"/(8*E1),1)","=A"+(r+13),"","","","","4",""],["","Y","","=D"+(r+1)+'&" - Verify Patch"',"","=ROUND(L"+(r+15)+"/(8*E1),1)","=A"+(r+14),"","","","","2",""],["","Y","","=D"+(r+1)+'&" - Prepare Draft Test Report"',"","=ROUND(L"+(r+16)+"/(8*E1),1)","=A"+(r+15),"","","","","6",""],["","Y","","=D"+(r+1)+'&" - Approve Patch"',"","=ROUND(L"+(r+17)+"/(8*E1),1)","=A"+(r+16),"","","","","1",""],["","Y","","=D"+(r+1)+'&" - Prepare Troubleshooting Documents&Discuss with Operations"',"","=ROUND(L"+(r+18)+"/(8*E1),1)","=A"+(r+17),"","","","","8",""],["","Y","","=D"+(r+1)+'&" - Verify Troubleshooting Documentation"',"","=ROUND(L"+(r+19)+"/(8*E1),1)","=A"+(r+18),"","","","","2",""],["","Y","","=D"+(r+1)+'&" - Approve Troubleshooting Documentation"',"","=ROUND(SUM(L"+(r+20)+":L"+(r+23)+")/(8*E1),1)","=A"+(r+19),"","","","","1",""],["","Y","","=D"+(r+1)+'&" - Perform Troubleshooting"',"","=ROUND(SUM(L"+(r+20)+":L"+(r+23)+")/(8*E1),1)","=A"+(r+20),"","","","","8",""],["","Y","","=D"+(r+1)+'&" - Write Software Test Report"',"","=ROUND(SUM(L"+(r+20)+":L"+(r+23)+")/(8*E1),1)","=A"+(r+21),"","","","","6",""],["","Y","","=D"+(r+1)+'&" - Verify Software Test Report"',"","=ROUND(SUM(L"+(r+20)+":L"+(r+23)+")/(8*E1),1)","=A"+(r+22),"","","","","2",""],["","Y","","=D"+(r+1)+'&" - Approve Software Test Report"',"","=ROUND(L"+(r+24)+"/(8*E1),1)","=A"+(r+23),"","","","","1",""],["","Y","","=D"+(r+1)+'&" - Write Tuning Patches"',"","=ROUND(L"+(r+25)+"/(8*E1),1)","=A"+(r+21),"","","","","6",""],["","Y","","=D"+(r+1)+'&" - Verify Tuning Patches"',"","=ROUND(L"+(r+26)+"/(8*E1),1)","=A"+(r+25),"","","","","2",""],["","Y","","=D"+(r+1)+'&" - Approve Tuning Patches"',"","=ROUND(L"+(r+27)+"/(8*E1),1)","=A"+(r+26),"","","","","1",""],["","Y","","=D"+(r+1)+'&" - Update Maximo for all Technical Content"',"","=ROUND(L"+(r+28)+"/(8*E1),1)","=A"+(r+6)+"&A"+(r+7)+"&A"+(r+24)+"&A"+(r+27),"","","","","8",""],["","Y","","=D"+(r+1)+'&" - Verify DCN"',"","=ROUND(L"+(r+29)+"/(8*E1),1)","=A"+(r+28),"","","","","=ROUNDUP(SUM(L"+(r+3)+":L"+(r+7)+",L"+(r+28)+")*0.15,0)",""],["","Y","","=D"+(r+1)+'&" - Disposition/Incorporate Internal Comments"',"","=ROUND(L"+(r+30)+"/(8*E1),1)","=A"+(r+29),"","","","","=ROUNDUP(SUM(L"+(r+3)+":L"+(r+7)+",L"+(r+28)+")*0.1,0)",""],["","Y","","=D"+(r+1)+'&" - Endorse and Issue DCN"',"","1","=A"+(r+30),"","","","","2",""],["","Y","","=D"+(r+1)+'&" - Submit DCN for Stakeholder Review"',"","1","=A"+(r+31),"","","","","1",""],["","S","","=D"+(r+1)+'&": Comment and Disposition"',"","","","","","","","",""],["","Y","","=D"+(r+1)+'&" - Route Tasks for Stakeholder Review / Stakeholder Interface"',"","10","=A"+(r+32),"","","","","5",""],["","Y","","=D"+(r+1)+'&" - Stakeholder Review"',"","10","=A"+(r+32),"","","","","0",""],["","Y","","=D"+(r+1)+'&" - Disposition COMS/Stakeholder Review Comments"',"","3","=A"+(r+34)+"&A"+(r+35),"","","","","=ROUNDUP(SUM(L"+(r+3)+":L"+(r+32)+")*0.1,0)",""],["","Y","","=D"+(r+1)+'&" - Client - Review and Accept Dispositions"',"","5","=A"+(r+36),"","","","","0",""],["","S","",'="90% "&D'+(r+1),"","","","","","","","",""],["","Y","","=D"+(r+1)+'&" - Update DCN Package to Incorporate Stakeholder Comments"',"","=ROUND(L"+(r+39)+"/(8*E1),1)","=A"+(r+37),"","","","","=ROUNDUP(L"+(r+36)+"/2,0)",""],["","Y","","=D"+(r+1)+'&" - Final Verification of Updated DCN"',"","=ROUND(L"+(r+40)+"/(8*E1),1)","=A"+(r+39),"","","","","=L"+(r+39)+"/2",""],["","Y","","=D"+(r+1)+'&" - Incorporate Internal Comments"',"","=ROUND(L"+(r+41)+"/(8*E1),1)","=A"+(r+39),"","","","","1",""],["","Y","","=D"+(r+1)+'&" - Approve 90% DCN"',"","1","=A"+(r+40),"","","","","2",""],["","Y","","=D"+(r+1)+'&" - Endorse / Issue DCN and Signoff Maximo"',"","1","=A"+(r+42),"","","","","1",""],["","Y","","= D"+(r+1)+'&" - Upload DCN for Acceptance"',"","1","=A"+(r+43),"","","","","1",""],["","Y","","= D"+(r+1)+'&" - Resolve Minor Comments (if any)"',"","2","=A"+(r+44),"","","","","4",""],["","Y","","=D"+(r+1)+'&" - Client Acceptance & Signoff (Tasks 631, 633 & 635)"',"","5","=A"+(r+45),"","","","","0",""],["","Y","","= D"+(r+1)+'&" - Approved as per Task 500"',"Milestone","0","=A"+(r+46),"","","","","0",""]];var o=1,c=e,l=JSON.parse(JSON.stringify(i)),u=0,h=0,f=0,d=0;l[0][3]=t,l[0][2]=c;for(var p=0;p<l.length;p++)"Y"==l[p][1]?(l[p][0]=c+"."+o+++",",l[p][2]="WBS"+c,u+=1,""!==s&&(l[p][10]=s)):"S"==l[p][1]&&(f=p+r,h=p-u+r+1,d>0&&(l[d][11]="=SUMIF(B"+h+":B"+f+',"Y",L'+h+":L"+f+")",l[d][12]="=SUMIF(B"+h+":B"+f+',"Y",M'+h+":M"+f+")",u=0),d=p),"blank"===a&&(l[p][11]="");return f=p+r,h=p-u+r+1,l[d][11]="=SUMIF(B"+h+":B"+f+',"Y",L'+h+":L"+f+")",l[d][12]="=SUMIF(B"+h+":B"+f+',"Y",M'+h+":M"+f+")",l[0][11]="=SUMIF(B"+(r+2)+":B"+f+',"Y",L'+(r+2)+":L"+f+")",l[0][12]="=SUMIF(B"+(r+2)+":B"+f+',"Y",M'+(r+2)+":M"+f+")",l}function QD(e,t,r,n,a,s){const i=[["","WBS","","Configuration Intent Change","","","","","","","","",""],["","S","",'="50% "&D'+(r+1),"","","","","","","","",""],["","Y","","Pre-Job Brief","","1","","","","","","3",""],["","Y","","Data Collection","","=ROUND(L"+(r+4)+"/(8*E1),1)","=A"+(r+3),"","","","","8",""],["","Y","","Create CIC in Maximo","","=ROUND(L"+(r+5)+"/(8*E1),1)","=A"+(r+4),"","","","","4",""],["","Y","","Create CIC Cover Sheet","","=ROUND(L"+(r+6)+"/(8*E1),1)","=A"+(r+5),"","","","","4",""],["","Y","","Prepare FORMs (FORM-14431, Seismic Form, etc.)","","=ROUND(L"+(r+7)+"/(8*E1),1)","=A"+(r+5),"","","","","12",""],["","Y","","Mark-up Existing Drawings (Piping Isometrics, GAs, EWDs, CBDs, GAs, FuseData Sheets, etc.)","- assume 6 markups at 2h per","=ROUND(L"+(r+8)+"/(8*E1),1)","=A"+(r+5),"","","","","=6*2",""],["","Y","","Create New Drawings (Piping Isometrics, GAs, EWDs, CBDs, GAs, FuseData Sheets, etc.)","- assume 3 new drawings at 6h per","=ROUND(L"+(r+9)+"/(8*E1),1)","=A"+(r+5),"","","","","=3*6",""],["","Y","","Drafting","","=ROUND(L"+(r+10)+"/(8*E1),1)","=A"+(r+8)+"&A"+(r+9),"-1","","","","=SUM(L"+(r+8)+":L"+(r+9)+")*1.5",""],["","Y","","Procurement Support/Review","","=ROUND(L"+(r+11)+"/(8*E1),1)","=A"+(r+5),"","","","","5",""],["","Y","","CAT ID Creation","","=ROUND(L"+(r+12)+"/(8*E1),1)","=A"+(r+5),"","","","","5",""],["","Y","","CAT ID Screening","","=ROUND(L"+(r+13)+"/(8*E1),1)","=A"+(r+5),"","","","","5",""],["","Y","","Create DBOM","","=ROUND(L"+(r+14)+"/(8*E1),1)","=A"+(r+5),"","","","","5",""],["","Y","","Update EBOM","","=ROUND(L"+(r+15)+"/(8*E1),1)","=A"+(r+5),"","","","","5",""],["","Y","","Vendor Documents Received","Milestone","0","","","","","","0",""],["","Y","","Review Vendor Documents / Purchasability Review","","=ROUND(L"+(r+17)+"/(8*E1),1)","=A"+(r+16),"","","","","6",""],["","Y","","Update MEL and Route Task to Drafting Office for Approval","","=ROUND(L"+(r+18)+"/(8*E1),1)","=A"+(r+5),"","","","","4",""],["","Y","","Update Maximo for Tech Content (Change Papers, AEL, ACB etc.)","","=ROUND(L"+(r+19)+"/(8*E1),1)","=A"+(r+5),"","","","","5",""],["","Y","","Verify CIC","","=ROUND(L"+(r+20)+"/(8*E1),1)","=A"+(r+6)+"&A"+(r+7)+"&A"+(r+10)+"&A"+(r+12)+"&A"+(r+13)+"&A"+(r+14)+"&A"+(r+15)+"&A"+(r+17)+"&A"+(r+18)+"&A"+(r+19),"","","","","=ROUNDUP(SUM(L"+(r+3)+":L"+(r+19)+")*0.15,0)",""],["","Y","","Disposition/Incorporate Internal Comments","","3","=A"+(r+20),"","","","","=ROUNDUP(SUM(L"+(r+3)+":L"+(r+19)+")*0.1,0)",""],["","Y","","Endorse and Issue CIC","","1","=A"+(r+21),"","","","","2",""],["","Y","","Submit 50% CIC for Stakeholder Review","","1","=A"+(r+22),"","","","","1",""],["","S","","Online Wiring","","","","","","","","",""],["","Y","","Submit Drawings to Client for Online Wiring (OLW)","","1","=A"+(r+10),"","","","","2",""],["","Y","","Client RDE Releases OLW Package to the Client Drafting Office","","2","=A"+(r+25),"","","","","0",""],["","Y","","Client Drafting Office Completes the OLW","","15","=A"+(r+26),"","","","","0",""],["","Y","","Review OLW Package","","2","=A"+(r+27),"","","","","6",""],["","Y","","Submit Comments to OLW","","1","=A"+(r+28),"","","","","1",""],["","Y","","Client Disposition Comments and update OLW","","3","=A"+(r+29),"","","","","0",""],["","Y","","Review changes to OLW Package","","2","=A"+(r+30),"","","","","4",""],["","Y","","Submit final OLW package for Client Acceptance","","1","=A"+(r+31),"","","","","1",""],["","Y","","Perform Post-Design Confirmation Walkdown"," assume 1 person over 1 day","1","=A"+(r+32),"4","","","","8",""],["","S","","=D"+(r+1)+'&": Comment and Disposition"',"","","","","","","","",""],["","Y","","Route Tasks for Stakeholder Review / Stakeholder Interface","","10","=A"+(r+22),"","","","","5",""],["","Y","","Stakeholder Review","","10","=A"+(r+23),"","","","","0",""],["","Y","","Disposition Stakeholder Review Comments","","3","=A"+(r+35)+"&A"+(r+36),"","","","","=ROUNDUP(SUM(L"+(r+3)+":L"+(r+23)+")*0.1,0)",""],["","Y","","Client - Review and Accept Dispositions","","5","=A"+(r+37),"","","","","0",""],["","S","",'="90% "&D'+(r+1),"","","","","","","","",""],["","Y","","Update CIC Package to Incorporate Stakeholder Comments","","=ROUND(L"+(r+40)+"/(8*E1),1)","=A"+(r+38),"","","","","=ROUNDUP(L"+(r+37)+"/2,0)",""],["","Y","","Verify Updated CIC","","=ROUND(L"+(r+41)+"/(8*E1),1)","=A"+(r+40),"","","","","=L"+(r+40)+"/2",""],["","Y","","Incorporate Internal Comments","","=ROUND(L"+(r+42)+"/(8*E1),1)","=A"+(r+40),"","","","","1.5",""],["","Y","","Approve 90% CIC","","1","=A"+(r+41),"","","","","2",""],["","Y","","Endorse / Issue DCN and Signoff Maximo","","1","=A"+(r+43),"","","","","1",""],["","Y","","Upload CIC for Acceptance","","1","=A"+(r+44),"","","","","1",""],["","Y","","Resolve Minor Comments (if any)","","2","=A"+(r+45),"","","","","4",""],["","Y","","Client Acceptance&Signoff (Tasks 631, 633 & 635)","","5","=A"+(r+46),"","","","","0",""],["","Y","","Approved as per Task 500","Milestone","0","=A"+(r+47),"","","","","0",""]];var o=1,c=e,l=JSON.parse(JSON.stringify(i)),u=0,h=0,f=0,d=0;l[0][3]=t,l[0][2]=c;for(var p=0;p<l.length;p++)"Y"==l[p][1]?(l[p][0]=c+"."+o+++",",l[p][2]="WBS"+c,u+=1,""!==s&&(l[p][10]=s)):"S"==l[p][1]&&(f=p+r,h=p-u+r+1,d>0&&(l[d][11]="=SUMIF(B"+h+":B"+f+',"Y",L'+h+":L"+f+")",l[d][12]="=SUMIF(B"+h+":B"+f+',"Y",M'+h+":M"+f+")",u=0),d=p),"blank"===a&&(l[p][11]="");return f=p+r,h=p-u+r+1,l[d][11]="=SUMIF(B"+h+":B"+f+',"Y",L'+h+":L"+f+")",l[d][12]="=SUMIF(B"+h+":B"+f+',"Y",M'+h+":M"+f+")",l[0][11]="=SUMIF(B"+(r+2)+":B"+f+',"Y",L'+(r+2)+":L"+f+")",l[0][12]="=SUMIF(B"+(r+2)+":B"+f+',"Y",M'+(r+2)+":M"+f+")",l}function ZD(e,t,r,n,a,s){const i=[["","WBS","","Code Classification","","","","","","","","",""],["","S","",'="50% "&D'+(r+1),"","","","","","","","",""],["","Y","","Task Pre-Job Brief","","1","","","","","","2",""],["","Y","","Perform Code Classification","","=ROUND(L"+(r+4)+"/(E1*8),1)","=A"+(r+3),"","","","","16",""],["","Y","","Prepare Code Classification Form (FORM-12995)","","=ROUND(SUM(L"+(r+5)+":L"+(r+6)+")/(E1*8),1)","=A"+(r+4),"","","","","8",""],["","Y","","Prepare CNSC letter (CAF) (If required)","","=ROUND(SUM(L"+(r+5)+":L"+(r+6)+")/(E1*8),1)","=A"+(r+4),"","","","","16",""],["","Y","","Review Code Classification","","=ROUND(L"+(r+7)+"/(E1*8),1)","=A"+(r+5)+"&A"+(r+6),"","","","","=ROUNDUP(SUM(L"+(r+3)+":L"+(r+6)+")*0.15,0)",""],["","Y","",'="Incorporate Internal Comments on "&D'+(r+1),"","=ROUND(L"+(r+8)+"/(E1*8),1)","=A"+(r+7),"","","","","=ROUNDUP(SUM(L"+(r+3)+":L"+(r+6)+")*0.1,0)",""],["","Y","",'="Approve "&D'+(r+1),"","1","=A"+(r+8),"","","","","1.5",""],["","Y","",'="Submit "&D'+(r+1)+'&" for Client Review"',"","1","=A"+(r+9),"","","","","1",""],["","S","","=D"+(r+1)+'&": Comment & Disposition"',"","","","","","","","",""],["","Y","",'="Stakeholder Review of "&D'+(r+1),"","10","=A"+(r+10),"","","","","0",""],["","Y","","Disposition Stakeholder Comments","","=ROUND(L"+(r+13)+"/(E1*8),1)","=A"+(r+12),"","","","","=ROUNDUP(SUM(L"+(r+3)+":L"+(r+10)+")*0.1,0)",""],["","Y","","Client Accept Comment Dispositions","","5","=A"+(r+13),"","","","","0",""],["","S","",'="100% "&D'+(r+1)+'&" and CNSC Submission"',"","","","","","","","",""],["","Y","","Incorporate Accepted Comments","","=ROUND(L"+(r+16)+"/(E1*8),1)","=A"+(r+14),"","","","","=ROUNDUP(L"+(r+13)+"/2,0)",""],["","Y","",'="Final Verification of 90% "&D'+(r+1),"","=ROUND(L"+(r+17)+"/(E1*8),1)","=A"+(r+16),"","","","","=L"+(r+16)+"/2",""],["","Y","",'="Approve 90% "&D'+(r+1),"","=ROUND(L"+(r+18)+"/(E1*8),1)","=A"+(r+17),"","","","","1",""],["","Y","",'="Submit 90% "&D'+(r+1)+'&" for Client Acceptance"',"","=ROUND(L"+(r+19)+"/(E1*8),1)","=A"+(r+18),"","","","","1",""],["","Y","","Client Approval of Letter","","5","=A"+(r+19),"","","","","0",""],["","Y","","Client Issue Letter to CNSC","","1","=A"+(r+20),"","","","","0",""],["","Y","","Send Letter to Nuclear Records via RRA 00321","","=ROUND(L"+(r+22)+"/(E1*8),1)","=A"+(r+21),"","","","","2",""],["","Y","","CNSC Review","","25","=A"+(r+21),"","","","","0",""],["","Y","","Provide Clarifications to the CNSC as Required","","25","=A"+(r+22),"","","","","4",""],["","Y","",'="CNSC Accept "&D'+(r+1),"Milestone","0","=A"+(r+23)+"&A"+(r+24),"","","","","0",""]];var o=1,c=e,l=JSON.parse(JSON.stringify(i)),u=0,h=0,f=0,d=0;l[0][3]=t,l[0][2]=c;for(var p=0;p<l.length;p++)"Y"==l[p][1]?(l[p][0]=c+"."+o+++",",l[p][2]="WBS"+c,u+=1,""!==s&&(l[p][10]=s)):"S"==l[p][1]&&(f=p+r,h=p-u+r+1,d>0&&(l[d][11]="=SUMIF(B"+h+":B"+f+',"Y",L'+h+":L"+f+")",l[d][12]="=SUMIF(B"+h+":B"+f+',"Y",M'+h+":M"+f+")",u=0),d=p),"blank"===a&&(l[p][11]="");return f=p+r,h=p-u+r+1,l[d][11]="=SUMIF(B"+h+":B"+f+',"Y",L'+h+":L"+f+")",l[d][12]="=SUMIF(B"+h+":B"+f+',"Y",M'+h+":M"+f+")",l[0][11]="=SUMIF(B"+(r+2)+":B"+f+',"Y",L'+(r+2)+":L"+f+")",l[0][12]="=SUMIF(B"+(r+2)+":B"+f+',"Y",M'+(r+2)+":M"+f+")",l}function eL(e,t,r,n,a,s){const i=[["","WBS","","SCL Update","","","","","","","","",""],["","S","",'="50% "&D'+(r+1),"","","","","","","","",""],["","Y","","Data Collection","","=ROUND(L"+(r+3)+"/(E1*8),1)","","","","","","4",""],["","Y","",'="Prepare "&D'+(r+1),"","=ROUND(L"+(r+4)+"/(E1*8),1)","=A"+(r+3),"","","","","16",""],["","Y","",'="Review "&D'+(r+1),"","=ROUND(L"+(r+5)+"/(E1*8),1)","=A"+(r+4),"","","","","=ROUNDUP(SUM(L"+(r+3)+":L"+(r+4)+")*0.15,0)",""],["","Y","","Incorporate Internal Comments","","=ROUND(L"+(r+6)+"/(E1*8),1)","=A"+(r+5),"","","","","=ROUNDUP(SUM(L"+(r+3)+":L"+(r+4)+")*0.1,0)",""],["","Y","",'="Approve "&D'+(r+1),"","1","=A"+(r+6),"","","","","1",""],["","Y","",'="Submit "&D'+(r+1)+'&" for Review"',"","1","=A"+(r+7),"","","","","1",""],["","S","","Report: Comment & Disposition","","","","","","","","",""],["","Y","",'="Client Stakeholder Review of "&D'+(r+1),"","10","=A"+(r+8),"","","","","0",""],["","Y","","Disposition Stakeholder Comments","","=ROUND(L"+(r+11)+"/(E1*8),1)","=A"+(r+10),"","","","","=ROUNDUP(SUM(L"+(r+3)+":L"+(r+8)+")*0.1,0)",""],["","Y","","Client Accept Comment Dispositions","","5","=A"+(r+11),"","","","","0",""],["","S","",'="90% "&D'+(r+1),"","","","","","","","",""],["","Y","","Incorporate Accepted Comments","","=ROUND(L"+(r+14)+"/(E1*8),1)","=A"+(r+12),"","","","","=ROUNDUP(L"+(r+11)+"/2,0)",""],["","Y","",'="Final Verification of 90% "&D'+(r+1),"","=ROUND(L"+(r+15)+"/(E1*8),1)","=A"+(r+14),"","","","","=L"+(r+14)+"/2",""],["","Y","",'="Approve 90% "&D'+(r+1),"","1","=A"+(r+15),"","","","","1",""],["","Y","",'="Submit 90% "&D'+(r+1)+'&" for Client Acceptance"',"","1","=A"+(r+16),"","","","","1",""],["","Y","",'="Client Accept 100% "&D'+(r+1),"","5","=A"+(r+17),"","","","","0",""]];var o=1,c=e,l=JSON.parse(JSON.stringify(i)),u=0,h=0,f=0,d=0;l[0][3]=t,l[0][2]=c;for(var p=0;p<l.length;p++)"Y"==l[p][1]?(l[p][0]=c+"."+o+++",",l[p][2]="WBS"+c,u+=1,""!==s&&(l[p][10]=s)):"S"==l[p][1]&&(f=p+r,h=p-u+r+1,d>0&&(l[d][11]="=SUMIF(B"+h+":B"+f+',"Y",L'+h+":L"+f+")",l[d][12]="=SUMIF(B"+h+":B"+f+',"Y",M'+h+":M"+f+")",u=0),d=p),"blank"===a&&(l[p][11]="");return f=p+r,h=p-u+r+1,l[d][11]="=SUMIF(B"+h+":B"+f+',"Y",L'+h+":L"+f+")",l[d][12]="=SUMIF(B"+h+":B"+f+',"Y",M'+h+":M"+f+")",l[0][11]="=SUMIF(B"+(r+2)+":B"+f+',"Y",L'+(r+2)+":L"+f+")",l[0][12]="=SUMIF(B"+(r+2)+":B"+f+',"Y",M'+(r+2)+":M"+f+")",l}function tL(e,t,r,n,a,s){const i=[["","WBS","","Report wt Model","","","","","","","","",""],["","S","","Model / Analyses","","","","","","","","",""],["","Y","","Task Pre-job Brief","","1","","","","","","2",""],["","Y","","Data Collection & Review","","=ROUND(L"+(r+4)+"/(E1*8),1)","=A"+(r+3),"","","","","8",""],["","Y","","Create Model(s) / Analyses","","=ROUND(L"+(r+5)+"/(E1*8),1)","=A"+(r+4),"","","","","32",""],["","Y","","Verify Model(s)  / Analyses","","=ROUND(L"+(r+6)+"/(E1*8),1)","=A"+(r+5),"","","","","=ROUNDUP(SUM(L"+(r+3)+":L"+(r+5)+")*0.15,0)",""],["","Y","","Run Model(s) / Analyses and Post-Processing","","=ROUND(L"+(r+7)+"/(E1*8),1)","=A"+(r+8),"","","","","5",""],["","Y","","Adjust / Iterate Model(s) as Required","","=ROUND(L"+(r+8)+"/(E1*8),1)","=A"+(r+6),"","","","","8",""],["","Y","","Summarize & Document Results","","=ROUND(L"+(r+9)+"/(E1*8),1)","=A"+(r+7),"","","","","8",""],["","S","","50% Report / Memo","","","","","","","","",""],["","Y","",'="Prepare 50% "&D'+(r+1),"","=ROUND(L"+(r+11)+"/(E1*8),1)","=A"+(r+9),"","","","","24",""],["","Y","",'="Verify 50% "&D'+(r+1),"","=ROUND(L"+(r+12)+"/(E1*8),1)","=A"+(r+11),"","","","","=ROUNDUP(L"+(r+11)+"*0.15,0)",""],["","Y","","Incorporate Internal Comments","","=ROUND(L"+(r+13)+"/(E1*8),1)","=A"+(r+12),"","","","","=ROUNDUP(L"+(r+11)+"*0.1,0)",""],["","Y","",'="Approval 50% "&D'+(r+1),"","1","=A"+(r+13),"","","","","2",""],["","Y","",'="Submit 50% "&D'+(r+1),"","1","=A"+(r+14),"","","","","1",""],["","S","","Report: Comment & Disposition","","","","","","","","",""],["","Y","",'="Client Stakeholder Review of "&D'+(r+1),"","10","=A"+(r+15),"","","","","0",""],["","Y","","Disposition Stakeholder Comments","","=ROUND(L"+(r+18)+"/(E1*8),1)","=A"+(r+17),"","","","","=ROUNDUP(SUM(L"+(r+11)+":L"+(r+15)+",L"+(r+3)+":L"+(r+9)+")*0.1,0)",""],["","Y","","Client Accept Comment Dispositions","","5","=A"+(r+18),"","","","","0",""],["","S","","90% Report / Memo","","","","","","","","",""],["","Y","","Incorporate Accepted Comments","","=ROUND(L"+(r+21)+"/(E1*8),1)","=A"+(r+19),"","","","","=ROUNDUP(L"+(r+18)+"/2,0)",""],["","Y","","Final Verification of 90% Report / Memo","","=ROUND(L"+(r+22)+"/(E1*8),1)","=A"+(r+21),"","","","","=L"+(r+21)+"/2",""],["","Y","","Approve 90% Report / Memo","","1","=A"+(r+22),"","","","","1",""],["","Y","","Submit 90% Report / Memo for Client Acceptance","","1","=A"+(r+23),"","","","","1",""],["","Y","",'="Client Accept 100% "&D'+(r+1),"","5","=A"+(r+24),"","","","","0",""]];var o=1,c=e,l=JSON.parse(JSON.stringify(i)),u=0,h=0,f=0,d=0;l[0][3]=t,l[0][2]=c;for(var p=0;p<l.length;p++)"Y"==l[p][1]?(l[p][0]=c+"."+o+++",",l[p][2]="WBS"+c,u+=1,""!==s&&(l[p][10]=s)):"S"==l[p][1]&&(f=p+r,h=p-u+r+1,d>0&&(l[d][11]="=SUMIF(B"+h+":B"+f+',"Y",L'+h+":L"+f+")",l[d][12]="=SUMIF(B"+h+":B"+f+',"Y",M'+h+":M"+f+")",u=0),d=p),"blank"===a&&(l[p][11]="");return f=p+r,h=p-u+r+1,l[d][11]="=SUMIF(B"+h+":B"+f+',"Y",L'+h+":L"+f+")",l[d][12]="=SUMIF(B"+h+":B"+f+',"Y",M'+h+":M"+f+")",l[0][11]="=SUMIF(B"+(r+2)+":B"+f+',"Y",L'+(r+2)+":L"+f+")",l[0][12]="=SUMIF(B"+(r+2)+":B"+f+',"Y",M'+(r+2)+":M"+f+")",l}function rL(e,t,r,n,a,s){const i=[["","WBS","","Calculation","","","","","","","","",""],["","S","","50% Calculation","","","","","","","","",""],["","Y","","Task Pre-job Brief","","1","","","","","","2",""],["","Y","","Data Collection & Review","","=ROUND(L"+(r+4)+"/(E1*8),1)","=A"+(r+3),"","","","","12",""],["","Y","","Perform Calculation","","=ROUND(L"+(r+5)+"/(E1*8),1)","=A"+(r+4),"","","","","32",""],["","Y","","Document Calculation","","=ROUND(L"+(r+6)+"/(E1*8),1)","=A"+(r+5),"","","","","12",""],["","Y","",'="Review 50% "&D'+(r+1),"","=ROUND(L"+(r+7)+"/(E1*8),1)","=A"+(r+6),"","","","","=ROUNDUP(SUM(L"+(r+3)+":L"+(r+6)+")*0.15,0)",""],["","Y","","Incorporate Internal Comments","","=ROUND(L"+(r+8)+"/(E1*8),1)","=A"+(r+7),"","","","","=ROUNDUP(SUM(L"+(r+3)+":L"+(r+6)+")*0.1,0)",""],["","Y","",'="Approval 50% "&D'+(r+1),"","1","=A"+(r+8),"","","","","2",""],["","Y","",'="Submit 50% "&D'+(r+1),"","1","=A"+(r+9),"","","","","1",""],["","S","","Report: Comment & Disposition","","","","","","","","",""],["","Y","",'="Stakeholder Review of "&D'+(r+1),"","10","=A"+(r+10),"","","","","0",""],["","Y","","Respond to Stakeholder Comments","","=ROUND(L"+(r+13)+"/(E1*8),1)","=A"+(r+12),"","","","","=ROUNDUP(SUM(L"+(r+3)+":L"+(r+10)+")*0.1,0)",""],["","Y","","Client to Accept Comment Responses","","5","=A"+(r+13),"","","","","1",""],["","S","",'="90% "&D'+(r+1),"","","","","","","","",""],["","Y","","Incorporate Accepted Comment Responses","","=ROUND(L"+(r+16)+"/(E1*8),1)","=A"+(r+14),"","","","","=ROUNDUP(L"+(r+13)+"/2,0)",""],["","Y","",'="Final Verification of 90% "&D'+(r+1),"","=ROUND(L"+(r+17)+"/(E1*8),1)","=A"+(r+16),"","","","","=L"+(r+16)+"/2",""],["","Y","",'="Approve 90% "&D'+(r+1),"","1","=A"+(r+17),"","","","","1",""],["","Y","",'="Submit 90% "&D'+(r+1)+'&" for Client Acceptance"',"","1","=A"+(r+18),"","","","","1",""],["","Y","",'="Client Accept 100% "&D'+(r+1),"","5","=A"+(r+19),"","","","","0",""]];var o=1,c=e,l=JSON.parse(JSON.stringify(i)),u=0,h=0,f=0,d=0;l[0][3]=t,l[0][2]=c;for(var p=0;p<l.length;p++)"Y"==l[p][1]?(l[p][0]=c+"."+o+++",",l[p][2]="WBS"+c,u+=1,""!==s&&(l[p][10]=s)):"S"==l[p][1]&&(f=p+r,h=p-u+r+1,d>0&&(l[d][11]="=SUMIF(B"+h+":B"+f+',"Y",L'+h+":L"+f+")",l[d][12]="=SUMIF(B"+h+":B"+f+',"Y",M'+h+":M"+f+")",u=0),d=p),"blank"===a&&(l[p][11]="");return f=p+r,h=p-u+r+1,l[d][11]="=SUMIF(B"+h+":B"+f+',"Y",L'+h+":L"+f+")",l[d][12]="=SUMIF(B"+h+":B"+f+',"Y",M'+h+":M"+f+")",l[0][11]="=SUMIF(B"+(r+2)+":B"+f+',"Y",L'+(r+2)+":L"+f+")",l[0][12]="=SUMIF(B"+(r+2)+":B"+f+',"Y",M'+(r+2)+":M"+f+")",l}function nL(e,t,r,n,a,s){const i=[["","WBS","","Report","","","","","","","","",""],["","S","",'="50% "&D'+(r+1),"","","","","","","","",""],["","Y","","Task Pre-Job Brief","","1","","","","","","2",""],["","Y","","Data Collection & Review","","=ROUND(L"+(r+4)+"/(E1*8),1)","=A"+(r+3),"","","","","8",""],["","Y","",'="Prepare 50% "&D'+(r+1),"","=ROUND(L"+(r+5)+"/(E1*8),1)","=A"+(r+4),"","","","","32",""],["","Y","",'="Review 50% "&D'+(r+1),"","=ROUND(L"+(r+6)+"/(E1*8),1)","=A"+(r+5),"","","","","=ROUNDUP(SUM(L"+(r+3)+":L"+(r+5)+")*0.15,0)",""],["","Y","","Incorporate Internal Comments","","=ROUND(L"+(r+7)+"/(E1*8),1)","=A"+(r+6),"","","","","=ROUNDUP(SUM(L"+(r+3)+":L"+(r+5)+")*0.1,0)",""],["","Y","",'="Approve 50% "&D'+(r+1),"","1","=A"+(r+7),"","","","","1",""],["","Y","",'="Submit "&D3&" for Client Review"',"","1","=A"+(r+8),"","","","","1",""],["","S","","=D"+(r+1)+'&" Comment & Disposition"',"","","","","","","","",""],["","Y","",'="Client Stakeholder Review of "&D'+(r+1),"","10","=A"+(r+9),"","","","","0",""],["","Y","","Disposition Stakeholder Comments","","=ROUND(L"+(r+12)+"/(E1*8),1)","=A"+(r+11),"","","","","=ROUNDUP(SUM(L"+(r+3)+":L"+(r+9)+")*0.1,0)",""],["","Y","","Client Accept Comment Dispositions","","5","=A"+(r+12),"","","","","1",""],["","S","",'="90% "&D'+(r+1),"","","","","","","","",""],["","Y","","Incorporate Accepted Comments","","=ROUND(L"+(r+15)+"/(E1*8),1)","=A"+(r+13),"","","","","=ROUNDUP(L"+(r+12)+"/2,0)",""],["","Y","",'="Final Verification of 90% "&D'+(r+1),"","=ROUND(L"+(r+16)+"/(E1*8),1)","=A"+(r+15),"","","","","=L"+(r+15)+"/2",""],["","Y","",'="Approve 90% "&D'+(r+1),"","1","=A"+(r+16),"","","","","1",""],["","Y","",'="Submit 90% "&D'+(r+1)+'&" for Client Acceptance"',"","1","=A"+(r+17),"","","","","1",""],["","Y","",'="Client Accepts 100% "&D'+(r+1),"","5","=A"+(r+18),"","","","","0",""]];var o=1,c=e,l=JSON.parse(JSON.stringify(i)),u=0,h=0,f=0,d=0;l[0][3]=t,l[0][2]=c;for(var p=0;p<l.length;p++)"Y"==l[p][1]?(l[p][0]=c+"."+o+++",",l[p][2]="WBS"+c,u+=1,""!==s&&(l[p][10]=s)):"S"==l[p][1]&&(f=p+r,h=p-u+r+1,d>0&&(l[d][11]="=SUMIF(B"+h+":B"+f+',"Y",L'+h+":L"+f+")",l[d][12]="=SUMIF(B"+h+":B"+f+',"Y",M'+h+":M"+f+")",u=0),d=p),"blank"===a&&(l[p][11]="");return f=p+r,h=p-u+r+1,l[d][11]="=SUMIF(B"+h+":B"+f+',"Y",L'+h+":L"+f+")",l[d][12]="=SUMIF(B"+h+":B"+f+',"Y",M'+h+":M"+f+")",l[0][11]="=SUMIF(B"+(r+2)+":B"+f+',"Y",L'+(r+2)+":L"+f+")",l[0][12]="=SUMIF(B"+(r+2)+":B"+f+',"Y",M'+(r+2)+":M"+f+")",l}function aL(e,t,r,n,a,s){const i=[["","WBS","","Instrument Uncertainty Calculation (IUC)","","","","","","","","",""],["","S","",'="50% "&D'+(r+1),"","","","","","","","",""],["","Y","","Task Pre-Job Brief","","1","","","","","","2",""],["","Y","","Create IUC","","=ROUND(L"+(r+4)+"/(E1*8),1)","=A"+(r+3),"","","","","8",""],["","Y","","Prepare IUC Memo","","=ROUND(L"+(r+5)+"/(E1*8),1)","=A"+(r+4),"","","","","16",""],["","Y","","Review IUC Memo","","=ROUND(L"+(r+6)+"/(E1*8),1)","=A"+(r+5),"","","","","=ROUNDUP(SUM(L"+(r+3)+":L"+(r+5)+")*0.15,0)",""],["","Y","","Incorporate Internal Comments","","=ROUND(L"+(r+7)+"/(E1*8),1)","=A"+(r+6),"","","","","=ROUNDUP(SUM(L"+(r+3)+":L"+(r+5)+")*0.1,0)",""],["","Y","","Approve 50% IUC Memo","","1","=A"+(r+7),"","","","","1",""],["","Y","","Submit IUC Memo for Client Review","","1","=A"+(r+8),"","","","","1",""],["","S","","=D"+(r+1)+'&" Comment & Disposition"',"","","","","","","","",""],["","Y","","Client Stakeholder Review of IUC Memo","","10","=A"+(r+9),"","","","","0",""],["","Y","","Disposition Stakeholder Comments","","=ROUND(L"+(r+12)+"/(E1*8),1)","=A"+(r+11),"","","","","=ROUNDUP(SUM(L"+(r+3)+":L"+(r+9)+")*0.1,0)",""],["","Y","","Client Accept Comment Dispositions","","5","=A"+(r+12),"","","","","1",""],["","S","",'="90% "&D'+(r+1),"","","","","","","","",""],["","Y","","Incorporate Accepted Comments","","=ROUND(L"+(r+15)+"/(E1*8),1)","=A"+(r+13),"","","","","=ROUNDUP(L"+(r+12)+"/2,0)",""],["","Y","","Final Verification of 90% IUC Memo","","=ROUND(L"+(r+16)+"/(E1*8),1)","=A"+(r+15),"","","","","=L"+(r+15)+"/2",""],["","Y","","Approve 90% IUC Memo","","1","=A"+(r+16),"","","","","1",""],["","Y","","Submit IUC 90% Memo for Client Acceptance","","1","=A"+(r+17),"","","","","1",""],["","Y","","Client Accepts 100% IUC Memo","","5","=A"+(r+18),"","","","","0",""]];var o=1,c=e,l=JSON.parse(JSON.stringify(i)),u=0,h=0,f=0,d=0;l[0][3]=t,l[0][2]=c;for(var p=0;p<l.length;p++)"Y"==l[p][1]?(l[p][0]=c+"."+o+++",",l[p][2]="WBS"+c,u+=1,""!==s&&(l[p][10]=s)):"S"==l[p][1]&&(f=p+r,h=p-u+r+1,d>0&&(l[d][11]="=SUMIF(B"+h+":B"+f+',"Y",L'+h+":L"+f+")",l[d][12]="=SUMIF(B"+h+":B"+f+',"Y",M'+h+":M"+f+")",u=0),d=p),"blank"===a&&(l[p][11]="");return f=p+r,h=p-u+r+1,l[d][11]="=SUMIF(B"+h+":B"+f+',"Y",L'+h+":L"+f+")",l[d][12]="=SUMIF(B"+h+":B"+f+',"Y",M'+h+":M"+f+")",l[0][11]="=SUMIF(B"+(r+2)+":B"+f+',"Y",L'+(r+2)+":L"+f+")",l[0][12]="=SUMIF(B"+(r+2)+":B"+f+',"Y",M'+(r+2)+":M"+f+")",l}function sL(e,t,r,n,a,s){const i=[["","WBS","","Design Registration Package","","","","","","","","",""],["","S","",'="50% "&D'+(r+1),"","","","","","","","",""],["","Y","","Prepare Cover Letter","","1","","","","","","24",""],["","Y","","Compile Package","","=ROUND(L"+(r+4)+"/(E1*8),1)","=A"+(r+3),"","","","","16",""],["","Y","",'="Review 50% "&D'+(r+1),"","=ROUND(L"+(r+5)+"/(E1*8),1)","=A"+(r+4),"","","","","=ROUNDUP(SUM(L"+(r+3)+":L"+(r+4)+")*0.15,0)",""],["","Y","","Incorporate Internal Comments","","=ROUND(L"+(r+6)+"/(E1*8),1)","=A"+(r+5),"","","","","=ROUNDUP(SUM(L"+(r+3)+":L"+(r+4)+")*0.1,0)",""],["","Y","",'="Approve 50% "&D'+(r+1),"","1","=A"+(r+6),"","","","","1",""],["","Y","",'="Submit 50% "&D'+(r+1)+'&" for Client Review"',"","1","=A"+(r+7),"","","","","1",""],["","S","","=D"+(r+1)+'&" Comment & Disposition"',"","","","","","","","",""],["","Y","",'="Client Stakeholder Review of "&D'+(r+1),"","10","=A"+(r+8),"","","","","0",""],["","Y","","Disposition Stakeholder Comments","","=ROUND(L"+(r+11)+"/(E1*8),1)","=A"+(r+10),"","","","","=ROUNDUP(SUM(L"+(r+3)+":L"+(r+8)+")*0.1,0)",""],["","Y","","Client Accept Comment Dispositions","","5","=A"+(r+11),"","","","","1",""],["","S","",'="90% "&D'+(r+1),"","","","","","","","",""],["","Y","","Incorporate Accepted Comments","","=ROUND(L"+(r+14)+"/(E1*8),1)","=A"+(r+12),"","","","","=ROUNDUP(L"+(r+11)+"/2,0)",""],["","Y","",'="Final Verification of 90% "&D'+(r+1),"","=ROUND(L"+(r+15)+"/(E1*8),1)","=A"+(r+14),"","","","","=L"+(r+14)+"/2",""],["","Y","",'="Approve 90% "&D'+(r+1),"","1","=A"+(r+15),"","","","","1",""],["","Y","",'="Submit "&D'+(r+1)+'&" to Client or the TSSA"',"","1","=A"+(r+16),"","","","","1",""],["","Y","","PDE Mgr Review and Sign Cover Letter","If not sending directly to TSSA","5","=A"+(r+17),"","","","","0",""],["","Y","","Submit Package to TSSA Administrator","If not sending directly to TSSA","1","=A"+(r+18),"","","","","1",""],["","Y","","TSSA Review","","15","=A"+(r+19),"","","","","0",""],["","Y","","Provide clarifications to the TSSA as required","","15","=A"+(r+19),"","","","","8",""],["","Y","",'="TSSA Accepts "&D'+(r+1),"","5","=A"+(r+20)+"&A"+(r+21),"","","","","0",""]];var o=1,c=e,l=JSON.parse(JSON.stringify(i)),u=0,h=0,f=0,d=0;l[0][3]=t,l[0][2]=c;for(var p=0;p<l.length;p++)"Y"==l[p][1]?(l[p][0]=c+"."+o+++",",l[p][2]="WBS"+c,u+=1,""!==s&&(l[p][10]=s)):"S"==l[p][1]&&(f=p+r,h=p-u+r+1,d>0&&(l[d][11]="=SUMIF(B"+h+":B"+f+',"Y",L'+h+":L"+f+")",l[d][12]="=SUMIF(B"+h+":B"+f+',"Y",M'+h+":M"+f+")",u=0),d=p),"blank"===a&&(l[p][11]="");return f=p+r,h=p-u+r+1,l[d][11]="=SUMIF(B"+h+":B"+f+',"Y",L'+h+":L"+f+")",l[d][12]="=SUMIF(B"+h+":B"+f+',"Y",M'+h+":M"+f+")",l[0][11]="=SUMIF(B"+(r+2)+":B"+f+',"Y",L'+(r+2)+":L"+f+")",l[0][12]="=SUMIF(B"+(r+2)+":B"+f+',"Y",M'+(r+2)+":M"+f+")",l}function iL(e,t,r,n,a,s){const i=[["","WBS","","Design Reconciliation","Registration Not Required","","","","","","","",""],["","S","",'="50% "&D'+(r+1),"","","","","","","","",""],["","Y","","Prepare Reconciliation Form","","=ROUND(L"+(r+3)+"/(E1*8),1)","","","","","","16",""],["","Y","","Verify Reconciliation Form","","=ROUND(L"+(r+4)+"/(E1*8),1)","=A"+(r+3),"","","","","=ROUNDUP(SUM(L"+(r+3)+":L"+(r+3)+")*0.15,0)",""],["","Y","","Incorporate Internal Comments","","=ROUND(L"+(r+5)+"/(E1*8),1)","=A"+(r+4),"","","","","=ROUNDUP(SUM(L"+(r+3)+":L"+(r+3)+")*0.1,0)",""],["","Y","","Approve Reconciliation Form","","1","=A"+(r+5),"","","","","1",""],["","Y","",'="Submit 50% "&D'+(r+1)+'&" for Client Review"',"","1","=A"+(r+6),"","","","","1",""],["","S","","=D"+(r+1)+'&" Comment & Disposition"',"","","","","","","","",""],["","Y","",'="Client Stakeholder Review of "&D'+(r+1),"","10","=A"+(r+7),"","","","","0",""],["","Y","","Disposition Stakeholder Comments","","=ROUND(L"+(r+10)+"/(E1*8),1)","=A"+(r+9),"","","","","=ROUNDUP(SUM(L"+(r+3)+":L"+(r+7)+")*0.1,0)",""],["","Y","","Client Accept Comment Dispositions","","5","=A"+(r+10),"","","","","1",""],["","S","",'="90% "&D'+(r+1),"","","","","","","","",""],["","Y","","Incorporate Accepted Comments","","=ROUND(L"+(r+13)+"/(E1*8),1)","=A"+(r+11),"","","","","=ROUNDUP(L"+(r+10)+"/2,0)",""],["","Y","",'="Final Verification of 90% "&D'+(r+1),"","=ROUND(L"+(r+14)+"/(E1*8),1)","=A"+(r+13),"","","","","=L"+(r+13)+"/2",""],["","Y","",'="Approve 90% "&D'+(r+1),"","1","=A"+(r+14),"","","","","1",""],["","Y","",'="Submit 90% "&D'+(r+1)+'&" for Client Acceptance"',"","1","=A"+(r+15),"","","","","1",""],["","Y","",'="Client Accepts 100% "&D'+(r+1),"","5","=A"+(r+16),"","","","","0",""]];var o=1,c=e,l=JSON.parse(JSON.stringify(i)),u=0,h=0,f=0,d=0;l[0][3]=t,l[0][2]=c;for(var p=0;p<l.length;p++)"Y"==l[p][1]?(l[p][0]=c+"."+o+++",",l[p][2]="WBS"+c,u+=1,""!==s&&(l[p][10]=s)):"S"==l[p][1]&&(f=p+r,h=p-u+r+1,d>0&&(l[d][11]="=SUMIF(B"+h+":B"+f+',"Y",L'+h+":L"+f+")",l[d][12]="=SUMIF(B"+h+":B"+f+',"Y",M'+h+":M"+f+")",u=0),d=p),"blank"===a&&(l[p][11]="");return f=p+r,h=p-u+r+1,l[d][11]="=SUMIF(B"+h+":B"+f+',"Y",L'+h+":L"+f+")",l[d][12]="=SUMIF(B"+h+":B"+f+',"Y",M'+h+":M"+f+")",l[0][11]="=SUMIF(B"+(r+2)+":B"+f+',"Y",L'+(r+2)+":L"+f+")",l[0][12]="=SUMIF(B"+(r+2)+":B"+f+',"Y",M'+(r+2)+":M"+f+")",l}function oL(e,t,r,n,a,s){const i=[["","WBS","","IEE / PE Evaluation","","","","","","","","",""],["","S","","IEE / PE Evaluation","","","","","","","","",""],["","Y","",'="Prepare "&D'+(r+1),"","=ROUND(L"+(r+3)+"/(E1*8),1)","","","","","","24",""],["","Y","",'="Review "&D'+(r+1),"","=ROUND(L"+(r+4)+"/(E1*8),1)","=A"+(r+3),"","","","","=ROUNDUP(SUM(L"+(r+3)+")*0.15,0)",""],["","Y","","Incorporate Internal Comments","","=ROUND(L"+(r+5)+"/(E1*8),1)","=A"+(r+4),"","","","","=ROUNDUP(SUM(L"+(r+3)+")*0.1,0)",""],["","Y","",'="Submit Draft "&D'+(r+1),"","1","=A"+(r+5),"","","","","1",""],["","Y","","Multi-Discipline Review PE Evaluation (if required)"," include 2h to attend 30min call and disposition comments","10","=A"+(r+6),"","","","","2",""],["","Y","",'="Update "&D'+(r+1)+'&" (if required)"',"","=ROUND(L"+(r+8)+"/(E1*8),1)","=A"+(r+7),"","","","","=ROUNDUP(SUM(L"+(r+3)+":L"+(r+7)+")*0.15,0)",""],["","Y","","Approve PE Evaluation","","1","=A"+(r+8),"","","","","1",""],["","Y","",'="Submit Final "&D'+(r+1),"","1","=A"+(r+9),"","","","","1",""],["","Y","",'="Client Accept "&D'+(r+1),"","5","=A"+(r+10),"","","","","0",""]];var o=1,c=e,l=JSON.parse(JSON.stringify(i)),u=0,h=0,f=0,d=0;l[0][3]=t,l[0][2]=c;for(var p=0;p<l.length;p++)"Y"==l[p][1]?(l[p][0]=c+"."+o+++",",l[p][2]="WBS"+c,u+=1,""!==s&&(l[p][10]=s)):"S"==l[p][1]&&(f=p+r,h=p-u+r+1,d>0&&(l[d][11]="=SUMIF(B"+h+":B"+f+',"Y",L'+h+":L"+f+")",l[d][12]="=SUMIF(B"+h+":B"+f+',"Y",M'+h+":M"+f+")",u=0),d=p),"blank"===a&&(l[p][11]="");return f=p+r,h=p-u+r+1,l[d][11]="=SUMIF(B"+h+":B"+f+',"Y",L'+h+":L"+f+")",l[d][12]="=SUMIF(B"+h+":B"+f+',"Y",M'+h+":M"+f+")",l[0][11]="=SUMIF(B"+(r+2)+":B"+f+',"Y",L'+(r+2)+":L"+f+")",l[0][12]="=SUMIF(B"+(r+2)+":B"+f+',"Y",M'+(r+2)+":M"+f+")",l}function cL(e,t,r,n,a,s){const i=[["","WBS","","Design Manual","","","","","","","","",""],["","S","",'="50% "&D'+(r+1),"","","","","","","","",""],["","Y","","Task Pre-Job Brief","","1","","","","","","2",""],["","Y","",'="Prepare 50% "&D'+(r+1),"","=ROUND(L"+(r+4)+"/(E1*8),1)","=A"+(r+3),"","","","","16",""],["","Y","",'="Review 50% "&D'+(r+1),"","=ROUND(L"+(r+5)+"/(E1*8),1)","=A"+(r+4),"","","","","=ROUNDUP(SUM(L"+(r+3)+":L"+(r+4)+")*0.15,0)",""],["","Y","","Incorporate Internal Comments","","=ROUND(L"+(r+6)+"/(E1*8),1)","=A"+(r+5),"","","","","=ROUNDUP(SUM(L"+(r+3)+":L"+(r+4)+")*0.1,0)",""],["","Y","",'="Approve 50% "&D'+(r+1),"","1","=A"+(r+6),"","","","","1",""],["","Y","",'="Submit "&D3&" for Client Review"',"","1","=A"+(r+7),"","","","","1",""],["","S","","=D"+(r+1)+'&" Comment & Disposition"',"","","","","","","","",""],["","Y","",'="Client Stakeholder Review of "&D'+(r+1),"","10","=A"+(r+8),"","","","","0",""],["","Y","","Disposition Stakeholder Comments","","=ROUND(L"+(r+11)+"/(E1*8),1)","=A"+(r+10),"","","","","=ROUNDUP(SUM(L"+(r+3)+":L"+(r+8)+")*0.1,0)",""],["","Y","","Client Accept Comment Dispositions","","5","=A"+(r+11),"","","","","1",""],["","S","",'="90% "&D'+(r+1),"","","","","","","","",""],["","Y","","Incorporate Accepted Comments","","=ROUND(L"+(r+14)+"/(E1*8),1)","=A"+(r+12),"","","","","=ROUNDUP(L"+(r+11)+"/2,0)",""],["","Y","",'="Final Verification of 90% "&D'+(r+1),"","=ROUND(L"+(r+15)+"/(E1*8),1)","=A"+(r+14),"","","","","=L"+(r+14)+"/2",""],["","Y","",'="Approve 90% "&D'+(r+1),"","1","=A"+(r+15),"","","","","1",""],["","Y","",'="Submit 90% "&D'+(r+1)+'&" for Client Acceptance"',"","1","=A"+(r+16),"","","","","1",""],["","Y","",'="Client Accepts 100% "&D'+(r+1),"","5","=A"+(r+17),"","","","","0",""]];var o=1,c=e,l=JSON.parse(JSON.stringify(i)),u=0,h=0,f=0,d=0;l[0][3]=t,l[0][2]=c;for(var p=0;p<l.length;p++)"Y"==l[p][1]?(l[p][0]=c+"."+o+++",",l[p][2]="WBS"+c,u+=1,""!==s&&(l[p][10]=s)):"S"==l[p][1]&&(f=p+r,h=p-u+r+1,d>0&&(l[d][11]="=SUMIF(B"+h+":B"+f+',"Y",L'+h+":L"+f+")",l[d][12]="=SUMIF(B"+h+":B"+f+',"Y",M'+h+":M"+f+")",u=0),d=p),"blank"===a&&(l[p][11]="");return f=p+r,h=p-u+r+1,l[d][11]="=SUMIF(B"+h+":B"+f+',"Y",L'+h+":L"+f+")",l[d][12]="=SUMIF(B"+h+":B"+f+',"Y",M'+h+":M"+f+")",l[0][11]="=SUMIF(B"+(r+2)+":B"+f+',"Y",L'+(r+2)+":L"+f+")",l[0][12]="=SUMIF(B"+(r+2)+":B"+f+',"Y",M'+(r+2)+":M"+f+")",l}function lL(e,t,r,n,a,s){const i=[["","WBS","","Third Party Review","","","","","","","","",""],["","S","","Review of Documents","","","","","","","","",""],["","Y","","Receive Documents for Review","milestone","0","","","","","","0",""],["","Y","","Task Pre-Job Brief","","1","=A"+(r+3),"","","","","1",""],["","Y","","Review Documents (# of Docs x h/per)","","=ROUND(L"+(r+5)+"/(E1*8),1)","=A"+(r+4),"","","","","8",""],["","Y","","Document Comments","","=ROUND(L"+(r+6)+"/(E1*8),1)","=A"+(r+5),"","","","","=ROUNDUP(L"+(r+5)+"*0.1,0)",""],["","Y","","Internal Verification of Comments (if required)","","=ROUND(L"+(r+7)+"/(E1*8),1)","=A"+(r+6),"","","","","=ROUNDUP(SUM(L"+(r+3)+":L"+(r+6)+")*0.15,0)",""],["","Y","","Submit Comments to Third Party","","=ROUND(L"+(r+8)+"/(E1*8),1)","=A"+(r+7),"","","","","1",""],["","S","","Comment Resolution","","","","","","","","",""],["","Y","","Third Party Disposition Comments","","10","=A"+(r+8),"","","","","0",""],["","Y","","Accept/Reject Third Party Comment Dispositions","","=ROUND(L"+(r+11)+"/(E1*8),1)","=A"+(r+10),"","","","","7",""],["","Y","","Meeting to Resolve Outstanding Comment Dispositions (if required)","- assume x people attend","3","=A"+(r+11),"","","","","=1*3",""],["","Y","","Return Accepted Comment Dispositions","","5","=A"+(r+12),"","","","","0",""],["","S","","Documentation Update","","","","","","","","",""],["","Y","","Third Party Submit Updated Documents","miltesone","5","","","","","","0",""],["","Y","","Review Updated Documents to Ensure Comment Incorporation","","=ROUND(L"+(r+16)+"/(E1*8),1)","=A"+(r+15),"","","","","=ROUNDUP(L"+(r+5)+"*0.1,0)",""],["","Y","","Create Memo Documenting Third Party Review","","=ROUND(L"+(r+17)+"/(E1*8),1)","=A"+(r+16),"","","","","5",""],["","Y","","Approve Memo","","=ROUND(L"+(r+18)+"/(E1*8),1)","=A"+(r+17),"","","","","1",""],["","Y","","Submit Memo to Third Party and/or Client","","=ROUND(L"+(r+19)+"/(E1*8),1)","=A"+(r+18),"","","","","1",""],["","Y","","Client Approves Third Party Review Memo","","5","=A"+(r+19),"","","","","0",""]];var o=1,c=e,l=JSON.parse(JSON.stringify(i)),u=0,h=0,f=0,d=0;l[0][3]=t,l[0][2]=c;for(var p=0;p<l.length;p++)"Y"==l[p][1]?(l[p][0]=c+"."+o+++",",l[p][2]="WBS"+c,u+=1,""!==s&&(l[p][10]=s)):"S"==l[p][1]&&(f=p+r,h=p-u+r+1,d>0&&(l[d][11]="=SUMIF(B"+h+":B"+f+',"Y",L'+h+":L"+f+")",l[d][12]="=SUMIF(B"+h+":B"+f+',"Y",M'+h+":M"+f+")",u=0),d=p),"blank"===a&&(l[p][11]="");return f=p+r,h=p-u+r+1,l[d][11]="=SUMIF(B"+h+":B"+f+',"Y",L'+h+":L"+f+")",l[d][12]="=SUMIF(B"+h+":B"+f+',"Y",M'+h+":M"+f+")",l[0][11]="=SUMIF(B"+(r+2)+":B"+f+',"Y",L'+(r+2)+":L"+f+")",l[0][12]="=SUMIF(B"+(r+2)+":B"+f+',"Y",M'+(r+2)+":M"+f+")",l}function uL(e,t,r,n,a,s){const i=[["","WBS","","Operations and Maintenance Document Updates","","","","","","","","",""],["","S","",'="50% "&D'+(r+1),"","","","","","","","",""],["","Y","","Task Pre-Job Brief","","1","","","","","","2",""],["","Y","","Data Collection","","=ROUND(L"+(r+4)+"/(E1*8),1)","=A"+(r+3),"","","","","8",""],["","Y","","Mark-up/Prepare OM (# docs*x h)","","=ROUND(L"+(r+5)+"/(E1*8),1)","=A"+(r+4),"","","","","4",""],["","Y","","Mark-up SST (# docs * x h)","","=ROUND(L"+(r+6)+"/(E1*8),1)","=A"+(r+4),"","","","","4",""],["","Y","","Mark-up/Prepare CMP/MMPs (# docs * x h)","","=ROUND(L"+(r+7)+"/(E1*8),1)","=A"+(r+4),"","","","","4",""],["","Y","","Mark-up/Prepare ARM (# docs * x h)","","=ROUND(L"+(r+8)+"/(E1*8),1)","=A"+(r+4),"","","","","4",""],["","Y","","Mark-up/Prepare Flowsheets (# docs * x h)","","=ROUND(L"+(r+9)+"/(E1*8),1)","=A"+(r+4),"","","","","4",""],["","Y","","Mark-up/Prepare Training Manuals (# docs * x h)","","=ROUND(L"+(r+10)+"/(E1*8),1)","=A"+(r+4),"","","","","4",""],["","Y","","Initiate DCRs and route to Responsible Work Groups","","=ROUND(L"+(r+11)+"/(E1*8),1)","=A"+(r+5)+"&A"+(r+6)+"&A"+(r+7)+"&A"+(r+8)+"&A"+(r+9)+"&A"+(r+10),"","","","","=SUM(L"+(r+5)+":L"+(r+10)+")/4",""],["","Y","","Review of O&M Docs","","=ROUND(L"+(r+12)+"/(E1*8),1)","=A"+(r+5)+"&A"+(r+6)+"&A"+(r+7)+"&A"+(r+8)+"&A"+(r+9)+"&A"+(r+10),"","","","","=ROUNDUP(SUM(L"+(r+3)+":L"+(r+11)+")*0.15,0)",""],["","Y","","Approve of O&M Docs","","1","=A"+(r+12)+"&A"+(r+11),"","","","","2",""],["","Y","","Submit O&M Docs for Client Review","","1","=A"+(r+13),"","","","","1",""],["","S","","O&M Documents Comment & Disposition","","","","","","","","",""],["","Y","","Client Stakeholder Review of O&M Docs","","10","=A"+(r+14),"","","","","0",""],["","Y","","Disposition Stakeholder Comments","","=ROUND(L"+(r+17)+"/(E1*8),1)","=A"+(r+16),"","","","","=ROUNDUP(SUM(L"+(r+3)+":L"+(r+14)+")*0.1,0)",""],["","Y","","Client Accept Comment Dispositions","","5","=A"+(r+17),"","","","","0",""],["","S","",'="90% "&D'+(r+1),"","","","","","","","",""],["","Y","","Incorporate Accepted Comments","","=ROUND(L"+(r+20)+"/(E1*8),1)","=A"+(r+18),"","","","","=ROUNDUP(L"+(r+17)+"/2,0)",""],["","Y","","Final Verification of 90% O&M Docs","","=ROUND(L"+(r+21)+"/(E1*8),1)","=A"+(r+20),"","","","","=L"+(r+20)+"/2",""],["","Y","","Approve 90% O&M Docs","","1","=A"+(r+21),"","","","","1",""],["","Y","","Submit 90% O&M Docs for Client Acceptance","","1","=A"+(r+22),"","","","","1",""],["","Y","","Client Accepts 100% O&M Docs","","5","=A"+(r+23),"","","","","0",""]];var o=1,c=e,l=JSON.parse(JSON.stringify(i)),u=0,h=0,f=0,d=0;l[0][3]=t,l[0][2]=c;for(var p=0;p<l.length;p++)"Y"==l[p][1]?(l[p][0]=c+"."+o+++",",l[p][2]="WBS"+c,u+=1,""!==s&&(l[p][10]=s)):"S"==l[p][1]&&(f=p+r,h=p-u+r+1,d>0&&(l[d][11]="=SUMIF(B"+h+":B"+f+',"Y",L'+h+":L"+f+")",l[d][12]="=SUMIF(B"+h+":B"+f+',"Y",M'+h+":M"+f+")",u=0),d=p),"blank"===a&&(l[p][11]="");return f=p+r,h=p-u+r+1,l[d][11]="=SUMIF(B"+h+":B"+f+',"Y",L'+h+":L"+f+")",l[d][12]="=SUMIF(B"+h+":B"+f+',"Y",M'+h+":M"+f+")",l[0][11]="=SUMIF(B"+(r+2)+":B"+f+',"Y",L'+(r+2)+":L"+f+")",l[0][12]="=SUMIF(B"+(r+2)+":B"+f+',"Y",M'+(r+2)+":M"+f+")",l}function hL(e,t,r,n,a,s){const i=[["","WBS","","Commissioning Specification","","","","","","","","",""],["","S","",'="50% "&D'+(r+1),"","","","","","","","",""],["","Y","","Task Pre-Job Brief","","1","","","","","","2",""],["","Y","",'="Prepare 50% "&D'+(r+1),"","=ROUND(L"+(r+4)+"/(E1*8),1)","=A"+(r+3),"","","","","24",""],["","Y","",'="Review 50% "&D'+(r+1),"","=ROUND(L"+(r+5)+"/(E1*8),1)","=A"+(r+4),"","","","","=ROUNDUP(SUM(L"+(r+3)+":L"+(r+4)+")*0.15,0)",""],["","Y","","Incorporate Internal Comments","","=ROUND(L"+(r+6)+"/(E1*8),1)","=A"+(r+5),"","","","","=ROUNDUP(SUM(L"+(r+3)+":L"+(r+4)+")*0.1,0)",""],["","Y","",'="Approve 50% "&D'+(r+1),"","1","=A"+(r+6),"","","","","1",""],["","Y","",'="Submit 50% "&D'+(r+1)+'&" for Client Review"',"","1","=A"+(r+7),"","","","","1",""],["","S","","=D"+(r+1)+'&" Comment & Disposition"',"","","","","","","","",""],["","Y","",'="Client Stakeholder Review of "&D'+(r+1),"","10","=A"+(r+8),"","","","","0",""],["","Y","","Disposition Stakeholder Comments","","=ROUND(L"+(r+11)+"/(E1*8),1)","=A"+(r+10),"","","","","=ROUNDUP(SUM(L"+(r+3)+":L"+(r+8)+")*0.1,0)",""],["","Y","","Client Accept Comment Dispositions","","5","=A"+(r+11),"","","","","1",""],["","S","",'="90% "&D'+(r+1),"","","","","","","","",""],["","Y","","Incorporate Accepted Comments","","=ROUND(L"+(r+14)+"/(E1*8),1)","=A"+(r+12),"","","","","=ROUNDUP(L"+(r+11)+"/2,0)",""],["","Y","",'="Final Verification of 90% "&D'+(r+1),"","=ROUND(L"+(r+15)+"/(E1*8),1)","=A"+(r+14),"","","","","=L"+(r+14)+"/2",""],["","Y","",'="Approve 90% "&D'+(r+1),"","1","=A"+(r+15),"","","","","1",""],["","Y","",'="Submit 90% "&D'+(r+1)+'&" for Client Acceptance"',"","1","=A"+(r+16),"","","","","1",""],["","Y","",'="Client Accepts 100% "&D'+(r+1),"","5","=A"+(r+17),"","","","","0",""]];var o=1,c=e,l=JSON.parse(JSON.stringify(i)),u=0,h=0,f=0,d=0;l[0][3]=t,l[0][2]=c;for(var p=0;p<l.length;p++)"Y"==l[p][1]?(l[p][0]=c+"."+o+++",",l[p][2]="WBS"+c,u+=1,""!==s&&(l[p][10]=s)):"S"==l[p][1]&&(f=p+r,h=p-u+r+1,d>0&&(l[d][11]="=SUMIF(B"+h+":B"+f+',"Y",L'+h+":L"+f+")",l[d][12]="=SUMIF(B"+h+":B"+f+',"Y",M'+h+":M"+f+")",u=0),d=p),"blank"===a&&(l[p][11]="");return f=p+r,h=p-u+r+1,l[d][11]="=SUMIF(B"+h+":B"+f+',"Y",L'+h+":L"+f+")",l[d][12]="=SUMIF(B"+h+":B"+f+',"Y",M'+h+":M"+f+")",l[0][11]="=SUMIF(B"+(r+2)+":B"+f+',"Y",L'+(r+2)+":L"+f+")",l[0][12]="=SUMIF(B"+(r+2)+":B"+f+',"Y",M'+(r+2)+":M"+f+")",l}function fL(e,t,r,n,a,s){const i=[["","WBS","","Installation Support","","","","","","","","",""],["","S","","Installation Support","","","","","","","","",""],["","Y","","Site Acceptance Testing (if required)","","5","","","","","","14",""],["","Y","","Installation Start","Milestone","0","","","","","","0",""],["","Y","","Design Support for Field Engineering "," - assume either # h/DCN or #h/week","","=A"+(r+4),"","","","","40",""],["","Y","","Procurement Support "," - assume either # h/DCN or #h/week","","=A"+(r+4),"","","","","20",""],["","S","","50% FCN Preparation","- assume x total number of FCNs","","","","","","","",""],["","Y","","Prepare 50% FCN","","1","","","","","","6",""],["","Y","","Mark-up Drawings/Documentation","","=ROUND(L"+(r+9)+"/(E1*8),1)","=A"+(r+8),"","","","","8",""],["","Y","","FCN Task Entries","","=ROUND(L"+(r+10)+"/(E1*8),1)","=A"+(r+9),"","","","","2",""],["","Y","","Review 50% FCN","","=ROUND(L"+(r+11)+"/(E1*8),1)","=A"+(r+10),"","","","","=ROUNDUP(SUM(L"+(r+8)+":L"+(r+10)+")*0.15,0)",""],["","Y","","Incorporate Internal Comments","","=ROUND(L"+(r+12)+"/(E1*8),1)","=A"+(r+11),"","","","","=ROUNDUP(SUM(L"+(r+8)+":L"+(r+10)+")*0.1,0)",""],["","Y","","Approve 50% FCN","","1","=A"+(r+12),"","","","","1",""],["","Y","","Submit 50% FCN for Client Review","","1","=A"+(r+13),"","","","","1",""],["","S","","FCN Comment & Disposition","","","","","","","","",""],["","Y","","Client Stakeholder Review of FCN","","5","=A"+(r+14),"","","","","0",""],["","Y","","Disposition Stakeholder Comments","","=ROUND(L"+(r+17)+"/(E1*8),1)","=A"+(r+16),"","","","","=ROUNDUP(SUM(L"+(r+8)+":L"+(r+14)+")*0.1,0)",""],["","Y","","Client Accept Comment Dispositions","","2","=A"+(r+17),"","","","","1",""],["","S","","90% FCN Preparation","","","","","","","","",""],["","Y","","Incorporate Accepted Comments","","=ROUND(L"+(r+20)+"/(E1*8),1)","=A"+(r+18),"","","","","=ROUNDUP(L"+(r+17)+"/2,0)",""],["","Y","","Approve 90% FCN","","=ROUND(L"+(r+21)+"/(E1*8),1)","=A"+(r+20),"","","","","=L"+(r+20)+"/2",""],["","Y","","Endorse FCN and Issue to Client","","1","=A"+(r+21),"","","","","1",""],["","Y","","Client Accepts 100% FCN","","5","=A"+(r+22),"","","","","0",""]];var o=1,c=e,l=JSON.parse(JSON.stringify(i)),u=0,h=0,f=0,d=0;l[0][3]=t,l[0][2]=c;for(var p=0;p<l.length;p++)"Y"==l[p][1]?(l[p][0]=c+"."+o+++",",l[p][2]="WBS"+c,u+=1,""!==s&&(l[p][10]=s)):"S"==l[p][1]&&(f=p+r,h=p-u+r+1,d>0&&(l[d][11]="=SUMIF(B"+h+":B"+f+',"Y",L'+h+":L"+f+")",l[d][12]="=SUMIF(B"+h+":B"+f+',"Y",M'+h+":M"+f+")",u=0),d=p),"blank"===a&&(l[p][11]="");return f=p+r,h=p-u+r+1,l[d][11]="=SUMIF(B"+h+":B"+f+',"Y",L'+h+":L"+f+")",l[d][12]="=SUMIF(B"+h+":B"+f+',"Y",M'+h+":M"+f+")",l[0][11]="=SUMIF(B"+(r+2)+":B"+f+',"Y",L'+(r+2)+":L"+f+")",l[0][12]="=SUMIF(B"+(r+2)+":B"+f+',"Y",M'+(r+2)+":M"+f+")",l}function dL(e,t,r,n,a,s){const i=[["","WBS","","Commissioning Report","","","","","","","","",""],["","S","",'="50% "&D'+(r+1),"","","","","","","","",""],["","Y","","Task Pre-Job Brief","","1","","","","","","2",""],["","Y","",'="Prepare 50% "&D'+(r+1),"","=ROUND(L"+(r+4)+"/(E1*8),1)","=A"+(r+3),"","","","","16",""],["","Y","",'="Review 50% "&D'+(r+1),"","=ROUND(L"+(r+5)+"/(E1*8),1)","=A"+(r+4),"","","","","=ROUNDUP(SUM(L"+(r+3)+":L"+(r+4)+")*0.15,0)",""],["","Y","","Incorporate Internal Comments","","=ROUND(L"+(r+6)+"/(E1*8),1)","=A"+(r+5),"","","","","=ROUNDUP(SUM(L"+(r+3)+":L"+(r+4)+")*0.1,0)",""],["","Y","",'="Approve 50% "&D'+(r+1),"","1","=A"+(r+6),"","","","","1",""],["","Y","",'="Submit 50% "&D'+(r+1)+'&" for Client Review"',"","1","=A"+(r+7),"","","","","1",""],["","S","","=D"+(r+1)+'&" Comment&Disposition"',"","","","","","","","",""],["","Y","",'="Client Stakeholder Review of "&D'+(r+1),"","10","=A"+(r+8),"","","","","0",""],["","Y","","Disposition Stakeholder Comments","","=ROUND(L"+(r+11)+"/(E1*8),1)","=A"+(r+10),"","","","","=ROUNDUP(SUM(L"+(r+3)+":L"+(r+8)+")*0.1,0)",""],["","Y","","Client Accept Comment Dispositions","","5","=A"+(r+11),"","","","","1",""],["","S","",'="90% "&D'+(r+1),"","","","","","","","",""],["","Y","","Incorporate Accepted Comments","","=ROUND(L"+(r+14)+"/(E1*8),1)","=A"+(r+12),"","","","","=ROUNDUP(L"+(r+11)+"/2,0)",""],["","Y","",'="Final Verification of 90% "&D'+(r+1),"","=ROUND(L"+(r+15)+"/(E1*8),1)","=A"+(r+14),"","","","","=L"+(r+14)+"/2",""],["","Y","",'="Approve 90% "&D'+(r+1),"","1","=A"+(r+15),"","","","","1",""],["","Y","",'="Submit 90% "&D'+(r+1)+'&" for Client Acceptance"',"","1","=A"+(r+16),"","","","","1",""],["","Y","",'="Client Accepts 100% "&D'+(r+1),"","5","=A"+(r+17),"","","","","0",""]];var o=1,c=e,l=JSON.parse(JSON.stringify(i)),u=0,h=0,f=0,d=0;l[0][3]=t,l[0][2]=c;for(var p=0;p<l.length;p++)"Y"==l[p][1]?(l[p][0]=c+"."+o+++",",l[p][2]="WBS"+c,u+=1,""!==s&&(l[p][10]=s)):"S"==l[p][1]&&(f=p+r,h=p-u+r+1,d>0&&(l[d][11]="=SUMIF(B"+h+":B"+f+',"Y",L'+h+":L"+f+")",l[d][12]="=SUMIF(B"+h+":B"+f+',"Y",M'+h+":M"+f+")",u=0),d=p),"blank"===a&&(l[p][11]="");return f=p+r,h=p-u+r+1,l[d][11]="=SUMIF(B"+h+":B"+f+',"Y",L'+h+":L"+f+")",l[d][12]="=SUMIF(B"+h+":B"+f+',"Y",M'+h+":M"+f+")",l[0][11]="=SUMIF(B"+(r+2)+":B"+f+',"Y",L'+(r+2)+":L"+f+")",l[0][12]="=SUMIF(B"+(r+2)+":B"+f+',"Y",M'+(r+2)+":M"+f+")",l}function pL(e,t,r,n,a,s){const i=[["","WBS","","Closeout","","","","","","","","",""],["","S","","DCN Closeout","","","","","","","","",""],["","Y","","AFS Declared","milestone","0","","","","","","0",""],["","Y","","Close DCN Open Items","","=ROUND(SUM(L"+(r+4)+":L"+(r+7)+")/(E1*8),1)","=A"+(r+3),"","","","","8",""],["","Y","","Closeout Drawings - by # dwgs (2 h/dwg)","","=ROUND(SUM(L"+(r+4)+":L"+(r+7)+")/(E1*8),1)","=A"+(r+3),"","","","","2",""],["","Y","","Closeout BOM - by # new (1 h/BOM)","","=ROUND(SUM(L"+(r+4)+":L"+(r+7)+")/(E1*8),1)","=A"+(r+3),"","","","","1",""],["","Y","","Closeout spec - by # new (2 h/spec)","","=ROUND(SUM(L"+(r+4)+":L"+(r+7)+")/(E1*8),1)","=A"+(r+3),"","","","","2",""],["","Y","","Review/Verification","","=ROUND(SUM(L"+(r+8)+")/(E1*8),1)","=A"+(r+4)+"&A"+(r+5)+"&A"+(r+6)+"&A"+(r+7),"","","","","=ROUNDUP(SUM(L"+(r+3)+":L"+(r+7)+")*0.15,0)",""],["","Y","","Approval","","5","=A"+(r+8),"","","","","1",""],["","S","","DCP Closeout","","","","","","","","",""],["","Y","","Complete ARs","After last DCN ","5","=A"+(r+9),"","","","","0",""],["","Y","","Close DCP Open Items","After last DCN ","5","=A"+(r+9),"","","","","=ROUNDUP(SUM(L"+(r+3)+":L"+(r+9)+")*0.15,0)",""],["","Y","","DCP Closeout","After last DCN ","5","=A"+(r+9),"","","","","1",""],["","S","","Project Closeout","","","","","","","","",""],["","Y","","Project Closeout Meeting","","1","=A"+(r+11)+"&A"+(r+12)+"&A"+(r+13),"3","","","","=ROUNDUP(L"+(r+12)+"/2,0)",""],["","Y","","Obtain Stakeholder/Client Feedback","","5","=A"+(r+15),"","","","","4",""],["","Y","","Document Lessons Learned","","1","=A"+(r+16),"","","","","2",""],["","Y","","Closeout internal records / files","","1","=A"+(r+17),"","","","","4",""],["","Y","","Close Charge Codes and Issue Final Invoice","","1","=A"+(r+18),"","","","","2",""]];var o=1,c=e,l=JSON.parse(JSON.stringify(i)),u=0,h=0,f=0,d=0;l[0][3]=t,l[0][2]=c;for(var p=0;p<l.length;p++)"Y"==l[p][1]?(l[p][0]=c+"."+o+++",",l[p][2]="WBS"+c,u+=1,""!==s&&(l[p][10]=s)):"S"==l[p][1]&&(f=p+r,h=p-u+r+1,d>0&&(l[d][11]="=SUMIF(B"+h+":B"+f+',"Y",L'+h+":L"+f+")",l[d][12]="=SUMIF(B"+h+":B"+f+',"Y",M'+h+":M"+f+")",u=0),d=p),"blank"===a&&(l[p][11]="");return f=p+r,h=p-u+r+1,l[d][11]="=SUMIF(B"+h+":B"+f+',"Y",L'+h+":L"+f+")",l[d][12]="=SUMIF(B"+h+":B"+f+',"Y",M'+h+":M"+f+")",l[0][11]="=SUMIF(B"+(r+2)+":B"+f+',"Y",L'+(r+2)+":L"+f+")",l[0][12]="=SUMIF(B"+(r+2)+":B"+f+',"Y",M'+(r+2)+":M"+f+")",l}function mL(e,t,r,n,a,s){const i=[["","WBS","","xxxxxxxxxxxxx","","","","","","","","",""],["","S","","=D"+(r+1),"","","","","","","","",""],["","Y","","=D"+(r+1)+'&" - "',"","=ROUND(L"+(r+3)+"/(E1*8),1)","","","","","","1",""],["","Y","","=D"+(r+1)+'&" - "',"","=ROUND(L"+(r+4)+"/(E1*8),1)","=A"+(r+3),"","","","","1",""],["","Y","","=D"+(r+1)+'&" - "',"","=ROUND(L"+(r+5)+"/(E1*8),1)","=A"+(r+4),"","","","","1",""],["","Y","","=D"+(r+1)+'&" - "',"","=ROUND(L"+(r+6)+"/(E1*8),1)","=A"+(r+5),"","","","","1",""],["","Y","","=D"+(r+1)+'&" - "',"","=ROUND(L"+(r+7)+"/(E1*8),1)","=A"+(r+6),"","","","","1",""],["","Y","","=D"+(r+1)+'&" - "',"","=ROUND(L"+(r+8)+"/(E1*8),1)","=A"+(r+7),"","","","","1",""],["","Y","","=D"+(r+1)+'&" - "',"","=ROUND(L"+(r+9)+"/(E1*8),1)","=A"+(r+8),"","","","","1",""],["","Y","","=D"+(r+1)+'&" - "',"","=ROUND(L"+(r+10)+"/(E1*8),1)","=A"+(r+9),"","","","","1",""],["","Y","","=D"+(r+1)+'&" - "',"","=ROUND(L"+(r+11)+"/(E1*8),1)","=A"+(r+10),"","","","","1",""],["","Y","","=D"+(r+1)+'&" - "',"","=ROUND(L"+(r+12)+"/(E1*8),1)","=A"+(r+11),"","","","","1",""],["","Y","","=D"+(r+1)+'&" - "',"","=ROUND(L"+(r+13)+"/(E1*8),1)","=A"+(r+12),"","","","","1",""],["","Y","","=D"+(r+1)+'&" - "',"","=ROUND(L"+(r+14)+"/(E1*8),1)","=A"+(r+13),"","","","","1",""],["","Y","","=D"+(r+1)+'&" - "',"","=ROUND(L"+(r+15)+"/(E1*8),1)","=A"+(r+14),"","","","","1",""],["","Y","","=D"+(r+1)+'&" - "',"","=ROUND(L"+(r+16)+"/(E1*8),1)","=A"+(r+15),"","","","","1",""],["","Y","","=D"+(r+1)+'&" - "',"","=ROUND(L"+(r+17)+"/(E1*8),1)","=A"+(r+16),"","","","","1",""],["","Y","","=D"+(r+1)+'&" - "',"","=ROUND(L"+(r+18)+"/(E1*8),1)","=A"+(r+17),"","","","","1",""],["","Y","","=D"+(r+1)+'&" - "',"","=ROUND(L"+(r+19)+"/(E1*8),1)","=A"+(r+18),"","","","","1",""],["","Y","","=D"+(r+1)+'&" - "',"","=ROUND(L"+(r+20)+"/(E1*8),1)","=A"+(r+19),"","","","","1",""],["","Y","","=D"+(r+1)+'&" - "',"","=ROUND(L"+(r+21)+"/(E1*8),1)","=A"+(r+20),"","","","","1",""],["","Y","","=D"+(r+1)+'&" - "',"","=ROUND(L"+(r+22)+"/(E1*8),1)","=A"+(r+21),"","","","","1",""],["","Y","","=D"+(r+1)+'&" - "',"","=ROUND(L"+(r+23)+"/(E1*8),1)","=A"+(r+22),"","","","","1",""],["","Y","","=D"+(r+1)+'&" - "',"","=ROUND(L"+(r+24)+"/(E1*8),1)","=A"+(r+23),"","","","","1",""],["","Y","","=D"+(r+1)+'&" - "',"","=ROUND(L"+(r+25)+"/(E1*8),1)","=A"+(r+24),"","","","","1",""],["","Y","","=D"+(r+1)+'&" - "',"","=ROUND(L"+(r+26)+"/(E1*8),1)","=A"+(r+25),"","","","","1",""],["","Y","","=D"+(r+1)+'&" - "',"","=ROUND(L"+(r+27)+"/(E1*8),1)","=A"+(r+26),"","","","","1",""],["","Y","","=D"+(r+1)+'&" - "',"","=ROUND(L"+(r+28)+"/(E1*8),1)","=A"+(r+27),"","","","","1",""],["","Y","","=D"+(r+1)+'&" - "',"","=ROUND(L"+(r+29)+"/(E1*8),1)","=A"+(r+28),"","","","","1",""],["","Y","","=D"+(r+1)+'&" - "',"","=ROUND(L"+(r+30)+"/(E1*8),1)","=A"+(r+29),"","","","","1",""],["","Y","","=D"+(r+1)+'&" - "',"","=ROUND(L"+(r+31)+"/(E1*8),1)","=A"+(r+30),"","","","","1",""],["","Y","","=D"+(r+1)+'&" - "',"","=ROUND(L"+(r+32)+"/(E1*8),1)","=A"+(r+31),"","","","","1",""],["","Y","","=D"+(r+1)+'&" - "',"","=ROUND(L"+(r+33)+"/(E1*8),1)","=A"+(r+32),"","","","","1",""],["","Y","","=D"+(r+1)+'&" - "',"","=ROUND(L"+(r+34)+"/(E1*8),1)","=A"+(r+33),"","","","","1",""],["","Y","","=D"+(r+1)+'&" - "',"","=ROUND(L"+(r+35)+"/(E1*8),1)","=A"+(r+34),"","","","","1",""],["","Y","","=D"+(r+1)+'&" - "',"","=ROUND(L"+(r+36)+"/(E1*8),1)","=A"+(r+35),"","","","","1",""],["","Y","","=D"+(r+1)+'&" - "',"","=ROUND(L"+(r+37)+"/(E1*8),1)","=A"+(r+36),"","","","","1",""]];var o=1,c=e,l=JSON.parse(JSON.stringify(i)),u=0,h=0,f=0,d=0;l[0][3]=t,l[0][2]=c;for(var p=0;p<l.length;p++)"Y"==l[p][1]?(l[p][0]=c+"."+o+++",",l[p][2]="WBS"+c,u+=1,""!==s&&(l[p][10]=s)):"S"==l[p][1]&&(f=p+r,h=p-u+r+1,d>0&&(l[d][11]="=SUMIF(B"+h+":B"+f+',"Y",L'+h+":L"+f+")",l[d][12]="=SUMIF(B"+h+":B"+f+',"Y",M'+h+":M"+f+")",u=0),d=p),"blank"===a&&(l[p][11]="");return f=p+r,h=p-u+r+1,l[d][11]="=SUMIF(B"+h+":B"+f+',"Y",L'+h+":L"+f+")",l[d][12]="=SUMIF(B"+h+":B"+f+',"Y",M'+h+":M"+f+")",l[0][11]="=SUMIF(B"+(r+2)+":B"+f+',"Y",L'+(r+2)+":L"+f+")",l[0][12]="=SUMIF(B"+(r+2)+":B"+f+',"Y",M'+(r+2)+":M"+f+")",l}function gL(e,t,r,n,a,s){const i=[["","WBS","","xxxxxxxxxxxxx","","","","","","","","",""],["","S","","=D"+(r+1),"","","","","","","","",""],["","Y","","=D"+(r+1)+'&" - "',"","=ROUND(L"+(r+3)+"/(E1*8),1)","","","","","","1",""],["","Y","","=D"+(r+1)+'&" - "',"","=ROUND(L"+(r+4)+"/(E1*8),1)","=A"+(r+3),"","","","","1",""],["","Y","","=D"+(r+1)+'&" - "',"","=ROUND(L"+(r+5)+"/(E1*8),1)","=A"+(r+4),"","","","","1",""],["","Y","","=D"+(r+1)+'&" - "',"","=ROUND(L"+(r+6)+"/(E1*8),1)","=A"+(r+5),"","","","","1",""],["","Y","","=D"+(r+1)+'&" - "',"","=ROUND(L"+(r+7)+"/(E1*8),1)","=A"+(r+6),"","","","","1",""],["","Y","","=D"+(r+1)+'&" - "',"","=ROUND(L"+(r+8)+"/(E1*8),1)","=A"+(r+7),"","","","","1",""],["","Y","","=D"+(r+1)+'&" - "',"","=ROUND(L"+(r+9)+"/(E1*8),1)","=A"+(r+8),"","","","","1",""],["","Y","","=D"+(r+1)+'&" - "',"","=ROUND(L"+(r+10)+"/(E1*8),1)","=A"+(r+9),"","","","","1",""],["","Y","","=D"+(r+1)+'&" - "',"","=ROUND(L"+(r+11)+"/(E1*8),1)","=A"+(r+10),"","","","","1",""],["","Y","","=D"+(r+1)+'&" - "',"","=ROUND(L"+(r+12)+"/(E1*8),1)","=A"+(r+11),"","","","","1",""],["","S","","=D"+(r+1),"","","","","","","","",""],["","Y","","=D"+(r+1)+'&" - "',"","=ROUND(L"+(r+14)+"/(E1*8),1)","=A"+(r+12),"","","","","1",""],["","Y","","=D"+(r+1)+'&" - "',"","=ROUND(L"+(r+15)+"/(E1*8),1)","=A"+(r+14),"","","","","1",""],["","Y","","=D"+(r+1)+'&" - "',"","=ROUND(L"+(r+16)+"/(E1*8),1)","=A"+(r+15),"","","","","1",""],["","Y","","=D"+(r+1)+'&" - "',"","=ROUND(L"+(r+17)+"/(E1*8),1)","=A"+(r+16),"","","","","1",""],["","Y","","=D"+(r+1)+'&" - "',"","=ROUND(L"+(r+18)+"/(E1*8),1)","=A"+(r+17),"","","","","1",""],["","Y","","=D"+(r+1)+'&" - "',"","=ROUND(L"+(r+19)+"/(E1*8),1)","=A"+(r+18),"","","","","1",""],["","Y","","=D"+(r+1)+'&" - "',"","=ROUND(L"+(r+20)+"/(E1*8),1)","=A"+(r+19),"","","","","1",""],["","Y","","=D"+(r+1)+'&" - "',"","=ROUND(L"+(r+21)+"/(E1*8),1)","=A"+(r+20),"","","","","1",""],["","Y","","=D"+(r+1)+'&" - "',"","=ROUND(L"+(r+22)+"/(E1*8),1)","=A"+(r+21),"","","","","1",""],["","Y","","=D"+(r+1)+'&" - "',"","=ROUND(L"+(r+23)+"/(E1*8),1)","=A"+(r+22),"","","","","1",""],["","S","","=D"+(r+1),"","","","","","","","",""],["","Y","","=D"+(r+1)+'&" - "',"","=ROUND(L"+(r+25)+"/(E1*8),1)","=A"+(r+23),"","","","","1",""],["","Y","","=D"+(r+1)+'&" - "',"","=ROUND(L"+(r+26)+"/(E1*8),1)","=A"+(r+25),"","","","","1",""],["","Y","","=D"+(r+1)+'&" - "',"","=ROUND(L"+(r+27)+"/(E1*8),1)","=A"+(r+26),"","","","","1",""],["","Y","","=D"+(r+1)+'&" - "',"","=ROUND(L"+(r+28)+"/(E1*8),1)","=A"+(r+27),"","","","","1",""],["","Y","","=D"+(r+1)+'&" - "',"","=ROUND(L"+(r+29)+"/(E1*8),1)","=A"+(r+28),"","","","","1",""],["","Y","","=D"+(r+1)+'&" - "',"","=ROUND(L"+(r+30)+"/(E1*8),1)","=A"+(r+29),"","","","","1",""],["","Y","","=D"+(r+1)+'&" - "',"","=ROUND(L"+(r+31)+"/(E1*8),1)","=A"+(r+30),"","","","","1",""],["","Y","","=D"+(r+1)+'&" - "',"","=ROUND(L"+(r+32)+"/(E1*8),1)","=A"+(r+31),"","","","","1",""],["","Y","","=D"+(r+1)+'&" - "',"","=ROUND(L"+(r+33)+"/(E1*8),1)","=A"+(r+32),"","","","","1",""],["","Y","","=D"+(r+1)+'&" - "',"","=ROUND(L"+(r+34)+"/(E1*8),1)","=A"+(r+33),"","","","","1",""],["","S","","=D"+(r+1),"","","","","","","","",""],["","Y","","=D"+(r+1)+'&" - "',"","=ROUND(L"+(r+36)+"/(E1*8),1)","=A"+(r+34),"","","","","1",""],["","Y","","=D"+(r+1)+'&" - "',"","=ROUND(L"+(r+37)+"/(E1*8),1)","=A"+(r+36),"","","","","1",""],["","Y","","=D"+(r+1)+'&" - "',"","=ROUND(L"+(r+38)+"/(E1*8),1)","=A"+(r+37),"","","","","1",""],["","Y","","=D"+(r+1)+'&" - "',"","=ROUND(L"+(r+39)+"/(E1*8),1)","=A"+(r+38),"","","","","1",""],["","Y","","=D"+(r+1)+'&" - "',"","=ROUND(L"+(r+40)+"/(E1*8),1)","=A"+(r+39),"","","","","1",""],["","Y","","=D"+(r+1)+'&" - "',"","=ROUND(L"+(r+41)+"/(E1*8),1)","=A"+(r+40),"","","","","1",""],["","Y","","=D"+(r+1)+'&" - "',"","=ROUND(L"+(r+42)+"/(E1*8),1)","=A"+(r+41),"","","","","1",""],["","Y","","=D"+(r+1)+'&" - "',"","=ROUND(L"+(r+43)+"/(E1*8),1)","=A"+(r+42),"","","","","1",""],["","Y","","=D"+(r+1)+'&" - "',"","=ROUND(L"+(r+44)+"/(E1*8),1)","=A"+(r+43),"","","","","1",""],["","Y","","=D"+(r+1)+'&" - "',"","=ROUND(L"+(r+45)+"/(E1*8),1)","=A"+(r+44),"","","","","1",""],["","S","","=D"+(r+1),"","","","","","","","",""],["","Y","","=D"+(r+1)+'&" - "',"","=ROUND(L"+(r+47)+"/(E1*8),1)","=A"+(r+45),"","","","","1",""],["","Y","","=D"+(r+1)+'&" - "',"","=ROUND(L"+(r+48)+"/(E1*8),1)","=A"+(r+47),"","","","","1",""],["","Y","","=D"+(r+1)+'&" - "',"","=ROUND(L"+(r+49)+"/(E1*8),1)","=A"+(r+48),"","","","","1",""],["","Y","","=D"+(r+1)+'&" - "',"","=ROUND(L"+(r+50)+"/(E1*8),1)","=A"+(r+49),"","","","","1",""],["","Y","","=D"+(r+1)+'&" - "',"","=ROUND(L"+(r+51)+"/(E1*8),1)","=A"+(r+50),"","","","","1",""],["","Y","","=D"+(r+1)+'&" - "',"","=ROUND(L"+(r+52)+"/(E1*8),1)","=A"+(r+51),"","","","","1",""],["","Y","","=D"+(r+1)+'&" - "',"","=ROUND(L"+(r+53)+"/(E1*8),1)","=A"+(r+52),"","","","","1",""],["","Y","","=D"+(r+1)+'&" - "',"","=ROUND(L"+(r+54)+"/(E1*8),1)","=A"+(r+53),"","","","","1",""],["","Y","","=D"+(r+1)+'&" - "',"","=ROUND(L"+(r+55)+"/(E1*8),1)","=A"+(r+54),"","","","","1",""],["","Y","","=D"+(r+1)+'&" - "',"","=ROUND(L"+(r+56)+"/(E1*8),1)","=A"+(r+55),"","","","","1",""]];var o=1,c=e,l=JSON.parse(JSON.stringify(i)),u=0,h=0,f=0,d=0;l[0][3]=t,l[0][2]=c;for(var p=0;p<l.length;p++)"Y"==l[p][1]?(l[p][0]=c+"."+o+++",",l[p][2]="WBS"+c,u+=1,""!==s&&(l[p][10]=s)):"S"==l[p][1]&&(f=p+r,h=p-u+r+1,d>0&&(l[d][11]="=SUMIF(B"+h+":B"+f+',"Y",L'+h+":L"+f+")",l[d][12]="=SUMIF(B"+h+":B"+f+',"Y",M'+h+":M"+f+")",u=0),d=p),"blank"===a&&(l[p][11]="");return f=p+r,h=p-u+r+1,l[d][11]="=SUMIF(B"+h+":B"+f+',"Y",L'+h+":L"+f+")",l[d][12]="=SUMIF(B"+h+":B"+f+',"Y",M'+h+":M"+f+")",l[0][11]="=SUMIF(B"+(r+2)+":B"+f+',"Y",L'+(r+2)+":L"+f+")",l[0][12]="=SUMIF(B"+(r+2)+":B"+f+',"Y",M'+(r+2)+":M"+f+")",l}(0,l.t9)();var EL=[[]],vL=0,TL=995,SL="standard",AL="";function RL(e){if(null==e||""==e)return"";var t=e.toString().split(".")[1];t=t.slice(0,-1);var r=Number(t)+1;return r=e.toString().split(".")[0]+"."+r+",",r}function yL(e){if(null==e||""==e)return"";var t=e.toString().split(".")[1];t=t.slice(0,-1);var r=Number(t)-1;return r=e.toString().split(".")[0]+"."+r+",",r}function NL(e){return null==e||""==e?"":e.toString().split(".")[0]}function wL(){for(var e=[],t=0;t<EL.length;t++)e.push(EL[t][0]);return e=e.filter((e=>e)),e}function bL(e){if(""===e||null===e)return!1;var t=e.charAt(e.length-1);return","===t}function CL(e,t){var r=e.split(".");r=10*Number(r[0]);var n=r+"-"+t;return n}function OL(e){return e.slice(3)}const IL=Hi.buildEmpty({licenseKey:"internal-use-in-handsontable"});var ML={name:"",components:{HotTable:c.sZ,HotColumn:c.pL},data:function(){return{hotSettings:{rowHeaders:!0,formulas:{engine:IL,ProjDur:{variables:{ProjectDuration:"F1"},formula:"=ProjectDuration"}},dropdownMenu:!0,persistentState:!0,width:"100%",height:"70vh",licenseKey:"non-commercial-and-evaluation",colHeaders:["Task #","Task?","WBS Structure","Task Name","Assumptions","Duration (Days)","Predecessor","Lead/Lag","Resource Type","Resource Name","Dept","Hours","Labour Cost","column_#","P6 Role ID","P6 Res ID","SAP Grade","Employee#"],columns:[{data:0,type:"text",readOnly:!0},{data:1,type:"text",readOnly:!0},{data:2,type:"text",readOnly:!0},{data:3,type:"text",className:"htLeft"},{data:4,type:"text"},{data:5,type:"text"},{data:6},{data:7,type:"text"},{data:8,type:"dropdown",source:(0,Jl.Q)(),values:(0,Jl.Q)()},{data:9,type:"dropdown",source:(0,Zl.P)(),values:(0,Zl.P)(),className:"htLeft"},{data:10,type:"dropdown",source:(0,Ql.Y)(),values:(0,Ql.Y)()},{data:11,type:"numeric",format:"0.0"},{data:12,type:"numeric",readOnly:!0},{data:13,type:"numeric",readOnly:!0},{data:14,type:"text",readOnly:!0},{data:15,type:"text",readOnly:!0},{data:16,type:"text",readOnly:!0},{data:17,type:"text",readOnly:!0}],contextMenu:!0,contextMenu:{items:{addTask:{name(){return"<b>Add Task Below</b>"},callback(e,t,r){var n=this.getSelectedLast()[0]+1,a=this.countRows()+2;if(n===a){this.alter("insert_row",this.getSelectedLast()[0]+1,1),this.setDataAtCell(this.getSelectedLast()[0]+1,4,"END"),this.setDataAtCell(this.getSelectedLast()[0]+1,0,RL(this.getDataAtCell(this.getSelectedLast()[0],0))),this.setDataAtCell(this.getSelectedLast()[0]+1,1,"Y");var s=NL(this.getDataAtCell(this.getSelectedLast()[0],0));this.setDataAtCell(this.getSelectedLast()[0]+1,2,"WBS"+s),console.log("++ MY getSelectedLast["+n+"]["+a+"]")}else if("Y"===this.getDataAtCell(this.getSelectedLast()[0],1)){this.alter("insert_row",this.getSelectedLast()[0]+1,1),this.setDataAtCell(this.getSelectedLast()[0]+1,0,RL(this.getDataAtCell(this.getSelectedLast()[0],0))),this.setDataAtCell(this.getSelectedLast()[0]+1,1,"Y");s=NL(this.getDataAtCell(this.getSelectedLast()[0],0));if(this.setDataAtCell(this.getSelectedLast()[0]+1,2,"WBS"+s),console.log(" Row below "+this.getDataAtCell(n+1,1)),"S"===this.getDataAtCell(n+1,1)||null===this.getDataAtCell(n+1,1)){for(var i=0,o=n;"Y"===this.getDataAtCell(o,1);o--)i+=1;var c=n+1,l=n-i+2;this.setDataAtCell(n-i,11,"=SUMIF(B"+l+":B"+c+',"Y",L'+l+":L"+c+")"),this.setDataAtCell(n-i,12,"=SUMIF(B"+l+":B"+c+',"Y",M'+l+":M"+c+")")}else if("WBS"===this.getDataAtCell(n+1,1)){i=0;var u=0;for(o=n;"Y"===this.getDataAtCell(o,1);o--)i+=1;for(o=n;"Y"===this.getDataAtCell(o,1)||"S"===this.getDataAtCell(o,1);o--)u+=1;c=n+1,l=n-i+2;this.setDataAtCell(n-i,11,"=SUMIF(B"+l+":B"+c+',"Y",L'+l+":L"+c+")"),this.setDataAtCell(n-i,12,"=SUMIF(B"+l+":B"+c+',"Y",M'+l+":M"+c+")");l=n-u+2;this.setDataAtCell(n-u,11,"=SUMIF(B"+l+":B"+c+',"Y",L'+l+":L"+c+")"),this.setDataAtCell(n-u,12,"=SUMIF(B"+l+":B"+c+',"Y",M'+l+":M"+c+")")}var h=!0;for(n+=1,n;h;n++)"Y"===this.getDataAtCell(n,1)&&this.setDataAtCell(n,0,RL(this.getDataAtCell(n,0))),"WBS"===this.getDataAtCell(n,1)&&(h=!1),n>=this.countRows()-1&&(h=!1)}else if("S"===this.getDataAtCell(this.getSelectedLast()[0],1)){var f=this.getDataAtCell(this.getSelectedLast()[0]+1,0),d=this.getDataAtCell(this.getSelectedLast()[0]+1,2);console.log("new_tasknum "+f),this.alter("insert_row",this.getSelectedLast()[0]+1,1),this.setDataAtCell(this.getSelectedLast()[0]+1,0,f),this.setDataAtCell(this.getSelectedLast()[0]+1,1,"Y");s=NL(this.getDataAtCell(this.getSelectedLast()[0],0));this.setDataAtCell(this.getSelectedLast()[0]+1,2,d);h=!0;for(n+=1,n;h;n++)"Y"===this.getDataAtCell(n,1)&&this.setDataAtCell(n,0,RL(this.getDataAtCell(n,0))),"WBS"===this.getDataAtCell(n,1)&&(h=!1),n>=this.countRows()-1&&(h=!1)}}},remove_row:{name(){return"<b>Remove Row</b>"},hidden:function(){return 0==this.getSelectedLast()[0]},callback(e,t,r){if("WBS"===this.getDataAtCell(this.getSelectedLast()[0],1)){vL-=1;var n=!0,a=!0,s=0,i=this.getSelectedLast()[0]+2,o=this.getSelectedLast()[0]-1,c=this.getDataAtCell(o,0).split("."),l=c[0],u=c[1].slice(0,-1);for(u=Number(u),i;n;i++){if("Y"===this.getDataAtCell(i,1)){u++,this.setDataAtCell(i,0,l+"."+u.toString()+",");var h=this.getDataAtCell(i,2),f=Number(h.charAt(3))-1;this.setDataAtCell(i,2,this.getDataAtCell(i,2).slice(0,3)+f)}else"WBS"===this.getDataAtCell(i,1)&&(n=!1,a=!1,s=i);i==this.countRows()-1&&(n=!1)}if(!a)for(s;s<this.countRows();s++)if("WBS"===this.getDataAtCell(s,1)){var d=Number(this.getDataAtCell(s,2))-1;this.setDataAtCell(s,2,d)}else if("Y"===this.getDataAtCell(s,1)){d=Number(this.getDataAtCell(s,2).slice(3))-1;this.setDataAtCell(s,2,"WBS"+d);var p=this.getDataAtCell(s,2).slice(3);c=this.getDataAtCell(s,0).split("."),u=c[1];this.setDataAtCell(s,0,p+"."+u)}}else if("S"===this.getDataAtCell(this.getSelectedLast()[0],1)){n=!0,i=this.getSelectedLast()[0];for(var m=0,g=i-1;"Y"===this.getDataAtCell(g,1);g--)m+=1;var E=i-m+1;m=0;for(g=i+1;"Y"===this.getDataAtCell(g,1);g++)m+=1;var v=i+m+1;console.log(E+" Brandon FIX "+v),this.setDataAtCell(E-2,11,"=SUMIF(B"+E+":B"+v+',"Y",L'+E+":L"+v+")"),this.setDataAtCell(E-2,12,"=SUMIF(B"+E+":B"+v+',"Y",M'+E+":M"+v+")")}else if("Y"===this.getDataAtCell(this.getSelectedLast()[0],1)){n=!0,i=this.getSelectedLast()[0]+1;for(i;n;i++)"Y"===this.getDataAtCell(i,1)&&this.setDataAtCell(i,0,yL(this.getDataAtCell(i,0))),"WBS"===this.getDataAtCell(i,1)&&(n=!1),i>=this.countRows()-1&&(n=!1)}this.alter("remove_row",this.getSelectedLast()[0],1)}}}},cells:function(e,t){var r={};return 0==e&&(r.className="firstrow"),"S"===EL[e][1]&&(r.className="WBS_sub_css",8!==t&&9!==t&&10!==t&&11!==t||(r.editor=!1)),"WBS"===EL[e][1]&&(r.className="WBS_title_css",8!==t&&9!==t&&10!==t&&11!==t||(r.editor=!1)),r},hiddenColumns:{columns:[1,2,13,14,15,16,17],indicators:!0},hiddenRows:{rows:[0],indicators:!0},afterChange(e,t){if(!("loadData"===t||"internal"===t||e.length>1)){var r=e[0][0],n=e[0][1],a=(e[0][2],e[0][3]),s=8,i=9,o=10,c=11,l=12;if(8===n&&"Y"===this.getDataAtCell(r,1)){var u=(0,Jl.Q)().indexOf(a),h=(0,Zl.P)().indexOf(this.getDataAtCell(r,i)),f=(0,Ql.Y)().indexOf(this.getDataAtCell(r,o)),d=(0,eu.pc)().indexOf(this.getDataAtCell(r,i)),p=0;if(h>0){p=""===this.getDataAtCell(r,c)||null===this.getDataAtCell(r,c)?0:this.getDataAtCell(r,c);var m=(0,eu.Qw)()[d];this.setDataAtCell(r,l,p*m)}else if(u>0&&f>0||0===u&&0===h)if(u>0&&f>0){p=""===this.getDataAtCell(r,c)||null===this.getDataAtCell(r,c)?0:this.getDataAtCell(r,c);for(var g=this.getDataAtCell(r,s),E=this.getDataAtCell(r,o),v=0,T=0,S=0;S<(0,eu.tq)().length;S++)(0,eu.fR)()[S]!==E||(0,eu.tq)()[S]!==g||null!==(0,eu.pc)()[S]&&""!==(0,eu.pc)()[S]||(v+=1,T=S);if(v>0){var A=(0,eu.Qw)()[T];this.setDataAtCell(r,l,p*A)}else this.setDataAtCell(r,l,0);v=0}else 0===u&&0===h&&this.setDataAtCell(r,l,0);else if(0===u&&h>0){d=(0,eu.pc)().indexOf(this.getDataAtCell(r,i));p=""===this.getDataAtCell(r,c)||null===this.getDataAtCell(r,c)?0:this.getDataAtCell(r,c);m=(0,eu.Qw)()[d];this.setDataAtCell(r,l,p*m)}}if(9===n&&"Y"===this.getDataAtCell(r,1)){u=(0,Jl.Q)().indexOf(this.getDataAtCell(r,s)),h=(0,Zl.P)().indexOf(a),(0,eu.tq)().indexOf(this.getDataAtCell(r,s)),d=(0,eu.pc)().indexOf(a),p=0;if(h>0||0===h)if(h>0){d=(0,eu.pc)().indexOf(a);p=""===this.getDataAtCell(r,c)||null===this.getDataAtCell(r,c)?0:this.getDataAtCell(r,c);m=(0,eu.Qw)()[d];this.setDataAtCell(r,l,p*m)}else(0===h||u>0)&&this.setDataAtCell(r,s,this.getDataAtCell(r,s))}if(10===n){u=(0,Jl.Q)().indexOf(this.getDataAtCell(r,s)),h=(0,Zl.P)().indexOf(this.getDataAtCell(r,i)),f=(0,Ql.Y)().indexOf(a),(0,eu.tq)().indexOf(this.getDataAtCell(r,s)),(0,eu.fR)().indexOf(a);u>0?this.setDataAtCell(r,s,this.getDataAtCell(r,s)):h>0&&this.setDataAtCell(r,i,this.getDataAtCell(r,i))}if(11===n){d=(0,eu.pc)().indexOf(a);if("Y"===this.getDataAtCell(r,1)){u=(0,Jl.Q)().indexOf(this.getDataAtCell(r,s)),h=(0,Zl.P)().indexOf(this.getDataAtCell(r,i)),(0,eu.tq)().indexOf(this.getDataAtCell(r,s)),d=(0,eu.pc)().indexOf(a),p=0;u>0?this.setDataAtCell(r,s,this.getDataAtCell(r,s)):h>0&&this.setDataAtCell(r,i,this.getDataAtCell(r,i))}}}}},formulas:!0,outsideClickDeselects:!1,data:EL,dialog:!1,dialog_clear:!1,dialog_downloadSAP:!1,dialog_TOQ:!1,WBSName:"",WBSElementType:"",WBSEstimate:"",WBSDepartment:"",timeout:1e4,text:"Please run FINALIZE before downloading XLSX",snackbar_finalize:!1}},methods:{checkDepartment:function(e){(0,Ql.Y)().includes(e)},addWBS_element:function(){console.log("SET estimate "+SL),"Keep Hours Blank"===this.WBSEstimate&&(SL="blank"),console.log("SET department "+this.WBSDepartment),AL=this.WBSDepartment,console.log("SET estimate "+SL),this.$refs.hotTableComponent.hotInstance.setDataAtCell(0,3,(0,tu.A)()[0]),this.$refs.hotTableComponent.hotInstance.setDataAtCell(0,5,(0,tu.A)()[1]),this.$refs.hotTableComponent.hotInstance.setDataAtCell(0,4,(0,tu.A)()[2]),this.$refs.hotTableComponent.hotInstance.setDataAtCell(0,0,(0,tu.A)()[3]),(0,Ql.Y)().includes(AL)&&("Mobilization Support"==this.WBSElementType?this.add1_MobilizationSupport(this.WBSName,this.$refs.hotTableComponent.hotInstance.countRows()):"Internal Work Plan"==this.WBSElementType?this.add2_InternalWorkPlan(this.WBSName,this.$refs.hotTableComponent.hotInstance.countRows()):"Eng Design Plan"==this.WBSElementType?this.add3_EngDesignPlan(this.WBSName,this.$refs.hotTableComponent.hotInstance.countRows()):"OPEX Report"==this.WBSElementType?this.add4_OPEXReport(this.WBSName,this.$refs.hotTableComponent.hotInstance.countRows()):"Walkdown Plan Report"==this.WBSElementType?this.add5_WalkdownPlanReport(this.WBSName,this.$refs.hotTableComponent.hotInstance.countRows()):"Design Requirements"==this.WBSElementType?this.add6_DesignRequirements(this.WBSName,this.$refs.hotTableComponent.hotInstance.countRows()):"Conceptual Eng Report"==this.WBSElementType?this.add7_ConceptualEngReport(this.WBSName,this.$refs.hotTableComponent.hotInstance.countRows()):"FMEA Report"==this.WBSElementType?this.add8_FMEAReport(this.WBSName,this.$refs.hotTableComponent.hotInstance.countRows()):"DCP"==this.WBSElementType?this.add9_DCP(this.WBSName,this.$refs.hotTableComponent.hotInstance.countRows()):"Technical Specification"==this.WBSElementType?this.add10_TechnicalSpecification(this.WBSName,this.$refs.hotTableComponent.hotInstance.countRows()):"ID Sor ICS"==this.WBSElementType?this.add11_IDSorICS(this.WBSName,this.$refs.hotTableComponent.hotInstance.countRows()):"Replacement Instruction"==this.WBSElementType?this.add12_ReplacementInstruction(this.WBSName,this.$refs.hotTableComponent.hotInstance.countRows()):"Model Work Order"==this.WBSElementType?this.add13_ModelWorkOrder(this.WBSName,this.$refs.hotTableComponent.hotInstance.countRows()):"MechCivDCN"==this.WBSElementType?this.add14_MechCivDCN(this.WBSName,this.$refs.hotTableComponent.hotInstance.countRows()):"ElecDCN"==this.WBSElementType?this.add15_ElecDCN(this.WBSName,this.$refs.hotTableComponent.hotInstance.countRows()):"Software DCN"==this.WBSElementType?this.add16_SoftwareDCN(this.WBSName,this.$refs.hotTableComponent.hotInstance.countRows()):"Software Patch DCN"==this.WBSElementType?this.add17_SoftwarePatchDCN(this.WBSName,this.$refs.hotTableComponent.hotInstance.countRows()):"Config Intent Change"==this.WBSElementType?this.add18_ConfigIntentChange(this.WBSName,this.$refs.hotTableComponent.hotInstance.countRows()):"CSNC Code Classification"==this.WBSElementType?this.add19_CSNCCodeClassification(this.WBSName,this.$refs.hotTableComponent.hotInstance.countRows()):"SCL Update"==this.WBSElementType?this.add20_SCLUpdate(this.WBSName,this.$refs.hotTableComponent.hotInstance.countRows()):"Report with Model"==this.WBSElementType?this.add21_ReportwtModel(this.WBSName,this.$refs.hotTableComponent.hotInstance.countRows()):"HandCalculation"==this.WBSElementType?this.add22_HandCalculation(this.WBSName,this.$refs.hotTableComponent.hotInstance.countRows()):"ReportorMemo"==this.WBSElementType?this.add23_ReportorMemo(this.WBSName,this.$refs.hotTableComponent.hotInstance.countRows()):"IUC"==this.WBSElementType?this.add24_IUC(this.WBSName,this.$refs.hotTableComponent.hotInstance.countRows()):"DesignRegistration"==this.WBSElementType?this.add25_DesignRegistration(this.WBSName,this.$refs.hotTableComponent.hotInstance.countRows()):"Design Reconciliation"==this.WBSElementType?this.add26_DesignReconciliation(this.WBSName,this.$refs.hotTableComponent.hotInstance.countRows()):"IEE or PE Evaluation"==this.WBSElementType?this.add27_IEEorPEEvaluation(this.WBSName,this.$refs.hotTableComponent.hotInstance.countRows()):"Design Manual Update"==this.WBSElementType?this.add28_DesignManualUpdate(this.WBSName,this.$refs.hotTableComponent.hotInstance.countRows()):"Third Party Review"==this.WBSElementType?this.add29_ThirdPartyReview(this.WBSName,this.$refs.hotTableComponent.hotInstance.countRows()):"OM Doc Updates"==this.WBSElementType?this.add30_OMDocUpdates(this.WBSName,this.$refs.hotTableComponent.hotInstance.countRows()):"Commissioning Specification"==this.WBSElementType?this.add31_CommissioningSpecification(this.WBSName,this.$refs.hotTableComponent.hotInstance.countRows()):"Installation Support with FCNs"==this.WBSElementType?this.add32_InstallationSupportwtFCNs(this.WBSName,this.$refs.hotTableComponent.hotInstance.countRows()):"Commissioning Report"==this.WBSElementType?this.add33_CommissioningReport(this.WBSName,this.$refs.hotTableComponent.hotInstance.countRows()):"Closeout"==this.WBSElementType?this.add34_Closeout(this.WBSName,this.$refs.hotTableComponent.hotInstance.countRows()):"Blank Template"==this.WBSElementType?this.add35_BlankTemplate(this.WBSName,this.$refs.hotTableComponent.hotInstance.countRows()):"BlankTemplate with 5sums"==this.WBSElementType&&this.add36_BlankTemplate_5(this.WBSName,this.$refs.hotTableComponent.hotInstance.countRows()))},add1_MobilizationSupport:function(e,t){vL+=1,EL=EL.concat(UD(vL,e,t,TL+5,SL,AL)),this.addTempData(EL),this.clear_modal(),this.scrollToBottom()},add2_InternalWorkPlan:function(e,t){vL+=1,EL=EL.concat(xD(vL,e,t,TL+5,SL,AL)),this.addTempData(EL),this.clear_modal(),this.scrollToBottom()},add3_EngDesignPlan:function(e,t){vL+=1,EL=EL.concat(FD(vL,e,t,TL+5,SL,AL)),this.addTempData(EL),this.clear_modal(),this.scrollToBottom()},add4_OPEXReport:function(e,t){vL+=1,EL=EL.concat(PD(vL,e,t,TL+5,SL,AL)),this.addTempData(EL),this.clear_modal(),this.scrollToBottom()},add5_WalkdownPlanReport:function(e,t){vL+=1,EL=EL.concat(BD(vL,e,t,TL+5,SL,AL)),this.addTempData(EL),this.clear_modal(),this.scrollToBottom()},add6_DesignRequirements:function(e,t){vL+=1,EL=EL.concat(YD(vL,e,t,TL+5,SL,AL)),this.addTempData(EL),this.clear_modal(),this.scrollToBottom()},add7_ConceptualEngReport:function(e,t){vL+=1,EL=EL.concat(VD(vL,e,t,TL+5,SL,AL)),this.addTempData(EL),this.clear_modal(),this.scrollToBottom()},add8_FMEAReport:function(e,t){vL+=1,EL=EL.concat(WD(vL,e,t,TL+5,SL,AL)),this.addTempData(EL),this.clear_modal(),this.scrollToBottom()},add9_DCP:function(e,t){vL+=1,EL=EL.concat(GD(vL,e,t,TL+5,SL,AL)),this.addTempData(EL),this.clear_modal(),this.scrollToBottom()},add10_TechnicalSpecification:function(e,t){vL+=1,EL=EL.concat(HD(vL,e,t,TL+5,SL,AL)),this.addTempData(EL),this.clear_modal(),this.scrollToBottom()},add11_IDSorICS:function(e,t){vL+=1,EL=EL.concat(zD(vL,e,t,TL+5,SL,AL)),this.addTempData(EL),this.clear_modal(),this.scrollToBottom()},add12_ReplacementInstruction:function(e,t){vL+=1,EL=EL.concat($D(vL,e,t,TL+5,SL,AL)),this.addTempData(EL),this.clear_modal(),this.scrollToBottom()},add13_ModelWorkOrder:function(e,t){vL+=1,EL=EL.concat(jD(vL,e,t,TL+5,SL,AL)),this.addTempData(EL),this.clear_modal(),this.scrollToBottom()},add14_MechCivDCN:function(e,t){vL+=1,EL=EL.concat(XD(vL,e,t,TL+5,SL,AL)),this.addTempData(EL),this.clear_modal(),this.scrollToBottom()},add15_ElecDCN:function(e,t){vL+=1,EL=EL.concat(KD(vL,e,t,TL+5,SL,AL)),this.addTempData(EL),this.clear_modal(),this.scrollToBottom()},add16_SoftwareDCN:function(e,t){vL+=1,EL=EL.concat(qD(vL,e,t,TL+5,SL,AL)),this.addTempData(EL),this.clear_modal(),this.scrollToBottom()},add17_SoftwarePatchDCN:function(e,t){vL+=1,EL=EL.concat(JD(vL,e,t,TL+5,SL,AL)),this.addTempData(EL),this.clear_modal(),this.scrollToBottom()},add18_ConfigIntentChange:function(e,t){vL+=1,EL=EL.concat(QD(vL,e,t,TL+5,SL,AL)),this.addTempData(EL),this.clear_modal(),this.scrollToBottom()},add19_CSNCCodeClassification:function(e,t){vL+=1,EL=EL.concat(ZD(vL,e,t,TL+5,SL,AL)),this.addTempData(EL),this.clear_modal(),this.scrollToBottom()},add20_SCLUpdate:function(e,t){vL+=1,EL=EL.concat(eL(vL,e,t,TL+5,SL,AL)),this.addTempData(EL),this.clear_modal(),this.scrollToBottom()},add21_ReportwtModel:function(e,t){vL+=1,EL=EL.concat(tL(vL,e,t,TL+5,SL,AL)),this.addTempData(EL),this.clear_modal(),this.scrollToBottom()},add22_HandCalculation:function(e,t){vL+=1,EL=EL.concat(rL(vL,e,t,TL+5,SL,AL)),this.addTempData(EL),this.clear_modal(),this.scrollToBottom()},add23_ReportorMemo:function(e,t){vL+=1,EL=EL.concat(nL(vL,e,t,TL+5,SL,AL)),this.addTempData(EL),this.clear_modal(),this.scrollToBottom()},add24_IUC:function(e,t){vL+=1,EL=EL.concat(aL(vL,e,t,TL+5,SL,AL)),this.addTempData(EL),this.clear_modal(),this.scrollToBottom()},add25_DesignRegistration:function(e,t){vL+=1,EL=EL.concat(sL(vL,e,t,TL+5,SL,AL)),this.addTempData(EL),this.clear_modal(),this.scrollToBottom()},add26_DesignReconciliation:function(e,t){vL+=1,EL=EL.concat(iL(vL,e,t,TL+5,SL,AL)),this.addTempData(EL),this.clear_modal(),this.scrollToBottom()},add27_IEEorPEEvaluation:function(e,t){vL+=1,EL=EL.concat(oL(vL,e,t,TL+5,SL,AL)),this.addTempData(EL),this.clear_modal(),this.scrollToBottom()},add28_DesignManualUpdate:function(e,t){vL+=1,EL=EL.concat(cL(vL,e,t,TL+5,SL,AL)),this.addTempData(EL),this.clear_modal(),this.scrollToBottom()},add29_ThirdPartyReview:function(e,t){vL+=1,EL=EL.concat(lL(vL,e,t,TL+5,SL,AL)),this.addTempData(EL),this.clear_modal(),this.scrollToBottom()},add30_OMDocUpdates:function(e,t){vL+=1,EL=EL.concat(uL(vL,e,t,TL+5,SL,AL)),this.addTempData(EL),this.clear_modal(),this.scrollToBottom()},add31_CommissioningSpecification:function(e,t){vL+=1,EL=EL.concat(hL(vL,e,t,TL+5,SL,AL)),this.addTempData(EL),this.clear_modal(),this.scrollToBottom()},add32_InstallationSupportwtFCNs:function(e,t){vL+=1,EL=EL.concat(fL(vL,e,t,TL+5,SL,AL)),this.addTempData(EL),this.clear_modal(),this.scrollToBottom()},add33_CommissioningReport:function(e,t){vL+=1,EL=EL.concat(dL(vL,e,t,TL+5,SL,AL)),this.addTempData(EL),this.clear_modal(),this.scrollToBottom()},add34_Closeout:function(e,t){vL+=1,EL=EL.concat(pL(vL,e,t,TL+5,SL,AL)),this.addTempData(EL),this.clear_modal(),this.scrollToBottom()},add35_BlankTemplate:function(e,t){vL+=1,EL=EL.concat(mL(vL,e,t,TL+5,SL,AL)),this.addTempData(EL),this.clear_modal(),this.scrollToBottom()},add36_BlankTemplate_5:function(e,t){vL+=1,EL=EL.concat(gL(vL,e,t,TL+5,SL,AL)),this.addTempData(EL),this.clear_modal(),this.scrollToBottom()},scrollToBottom:function(){const e=document.getElementById("wbs_table2");e.scrollIntoView({behavior:"smooth",block:"end"})},addTempData:function(e){this.$refs.hotTableComponent.hotInstance.loadData(e)},clear_modal:function(){this.WBSName="",this.WBSElementType="",this.WBSEstimate="",this.WBSDepartment="",SL="standard",AL=""},WBS_clear:function(){EL=[[]],vL=0,this.$refs.hotTableComponent.hotInstance.loadData(EL),this.dialog_clear=!1},finalizeWBS:function(){return this.finalize_alert(),new Promise((e=>{var t=this.$refs.hotTableComponent.hotInstance;t.setDataAtCell(0,3,(0,tu.A)()[0]),t.setDataAtCell(0,5,(0,tu.A)()[1]),t.setDataAtCell(0,4,(0,tu.A)()[2]),t.setDataAtCell(0,0,(0,tu.A)()[3]);var r=wL(),n=6,a=8,s=9,i=10,o=11,c=14,l=15,u=16,h=17,f=(t=this.$refs.hotTableComponent.hotInstance,this.$refs.hotTableComponent.hotInstance.getDataAtCol(13)),d=Math.max.apply(Math,f)+5;d<1e3&&(d=1e3);for(var p=0;p<EL.length;p++)if(this.$refs.hotTableComponent.hotInstance.setCellMeta(p,6,"className","reset_cell"),this.$refs.hotTableComponent.hotInstance.setCellMeta(p,8,"className","reset_cell"),this.$refs.hotTableComponent.hotInstance.setCellMeta(p,9,"className","reset_cell"),this.$refs.hotTableComponent.hotInstance.setCellMeta(p,10,"className","reset_cell"),"Y"==EL[p][1]){this.$refs.hotTableComponent.hotInstance.setDataAtCell(p,o,this.$refs.hotTableComponent.hotInstance.getDataAtCell(p,o));var m=bL(this.$refs.hotTableComponent.hotInstance.getDataAtCell(p,n));if(!1===m)this.$refs.hotTableComponent.hotInstance.setCellMeta(p,n,"className","incomplete_cell");else{var g=this.$refs.hotTableComponent.hotInstance.getDataAtCell(p,n),E=g.split(",");if(2===E.length){var v=r.includes(g);v||this.$refs.hotTableComponent.hotInstance.setCellMeta(p,n,"className","incomplete_cell")}else if(E.length>2)for(var T=0;T<E.length-1;T++){v=r.includes(E[T]+",");v||this.$refs.hotTableComponent.hotInstance.setCellMeta(p,n,"className","incomplete_cell")}}var S=this.$refs.hotTableComponent.hotInstance.getDataAtCell(p,a),A=this.$refs.hotTableComponent.hotInstance.getDataAtCell(p,s),R=this.$refs.hotTableComponent.hotInstance.getDataAtCell(p,i),y=(this.$refs.hotTableComponent.hotInstance.getDataAtCell(p,c),this.$refs.hotTableComponent.hotInstance.getDataAtCell(p,l),(0,eu.pc)().indexOf(A));if(""!==S&&""!==A&&""!==R){this.$refs.hotTableComponent.hotInstance.setDataAtCell(p,a,(0,eu.tq)()[(0,eu.pc)().indexOf(A)]),this.$refs.hotTableComponent.hotInstance.setDataAtCell(p,i,(0,eu.fR)()[(0,eu.pc)().indexOf(A)]);var N=(0,eu.Z$)()[y],w=(0,eu.CO)()[y],b=(0,eu.jm)()[y],C=(0,eu.ER)()[y];this.$refs.hotTableComponent.hotInstance.setDataAtCell(p,c,N),this.$refs.hotTableComponent.hotInstance.setDataAtCell(p,l,w),this.$refs.hotTableComponent.hotInstance.setDataAtCell(p,u,b),this.$refs.hotTableComponent.hotInstance.setDataAtCell(p,h,C)}else if(""===S&&""!==A&&""!==R){if((0,eu.fR)().indexOf(R)!==(0,eu.pc)().indexOf(A)||(0,eu.fR)().indexOf(R)===(0,eu.pc)().indexOf(A)&&""!==(0,eu.tq)().indexOf(A)){this.$refs.hotTableComponent.hotInstance.setDataAtCell(p,a,(0,eu.tq)()[(0,eu.pc)().indexOf(A)]),this.$refs.hotTableComponent.hotInstance.setDataAtCell(p,i,(0,eu.fR)()[(0,eu.pc)().indexOf(A)]);N=(0,eu.Z$)()[y],w=(0,eu.CO)()[y],b=(0,eu.jm)()[y],C=(0,eu.ER)()[y];this.$refs.hotTableComponent.hotInstance.setDataAtCell(p,c,N),this.$refs.hotTableComponent.hotInstance.setDataAtCell(p,l,w),this.$refs.hotTableComponent.hotInstance.setDataAtCell(p,u,b),this.$refs.hotTableComponent.hotInstance.setDataAtCell(p,h,C),this.$refs.hotTableComponent.hotInstance.setCellMeta(p,a,"className","complete_cell"),this.$refs.hotTableComponent.hotInstance.setCellMeta(p,s,"className","complete_cell"),this.$refs.hotTableComponent.hotInstance.setCellMeta(p,i,"className","complete_cell")}}else if(""!==S&&""===A&&""!==R){for(var O=!0,I=!1,M=0;O;M++){if((null===(0,eu.pc)()[M]||""===(0,eu.pc)()[M])&&S===(0,eu.tq)()[M]&&R===(0,eu.fR)()[M]){this.$refs.hotTableComponent.hotInstance.setDataAtCell(p,a,this.$refs.hotTableComponent.hotInstance.getDataAtCell(p,a));N=(0,eu.Z$)()[M],w=(0,eu.CO)()[M],b=(0,eu.jm)()[M],C=(0,eu.ER)()[M];console.log(M+" resp6rol_val ["+N+"] resp6res_val ["+w),this.$refs.hotTableComponent.hotInstance.setDataAtCell(p,c,N),this.$refs.hotTableComponent.hotInstance.setDataAtCell(p,l,w),this.$refs.hotTableComponent.hotInstance.setDataAtCell(p,u,b),this.$refs.hotTableComponent.hotInstance.setDataAtCell(p,h,C),I=!0,O=!1}M==(0,eu.tq)().length&&(O=!1)}I||(this.$refs.hotTableComponent.hotInstance.setCellMeta(p,a,"className","incomplete_cell"),this.$refs.hotTableComponent.hotInstance.setCellMeta(p,s,"className","incomplete_cell"),this.$refs.hotTableComponent.hotInstance.setCellMeta(p,i,"className","incomplete_cell"))}else if(""!==S&&""!==A&&""===R){this.$refs.hotTableComponent.hotInstance.setDataAtCell(p,a,(0,eu.tq)()[(0,eu.pc)().indexOf(A)]),this.$refs.hotTableComponent.hotInstance.setDataAtCell(p,i,(0,eu.fR)()[(0,eu.pc)().indexOf(A)]),this.$refs.hotTableComponent.hotInstance.setCellMeta(p,a,"className","complete_cell"),this.$refs.hotTableComponent.hotInstance.setCellMeta(p,s,"className","complete_cell"),this.$refs.hotTableComponent.hotInstance.setCellMeta(p,i,"className","complete_cell");N=(0,eu.Z$)()[y],w=(0,eu.CO)()[y],b=(0,eu.jm)()[y],C=(0,eu.ER)()[y];this.$refs.hotTableComponent.hotInstance.setDataAtCell(p,c,N),this.$refs.hotTableComponent.hotInstance.setDataAtCell(p,l,w),this.$refs.hotTableComponent.hotInstance.setDataAtCell(p,u,b),this.$refs.hotTableComponent.hotInstance.setDataAtCell(p,h,C)}else if(""===S&&""!==A&&""===R){this.$refs.hotTableComponent.hotInstance.setDataAtCell(p,a,(0,eu.tq)()[(0,eu.pc)().indexOf(A)]),this.$refs.hotTableComponent.hotInstance.setDataAtCell(p,i,(0,eu.fR)()[(0,eu.pc)().indexOf(A)]),this.$refs.hotTableComponent.hotInstance.setCellMeta(p,a,"className","complete_cell"),this.$refs.hotTableComponent.hotInstance.setCellMeta(p,s,"className","complete_cell"),this.$refs.hotTableComponent.hotInstance.setCellMeta(p,i,"className","complete_cell");N=(0,eu.Z$)()[y],w=(0,eu.CO)()[y],b=(0,eu.jm)()[y],C=(0,eu.ER)()[y];this.$refs.hotTableComponent.hotInstance.setDataAtCell(p,c,N),this.$refs.hotTableComponent.hotInstance.setDataAtCell(p,l,w),this.$refs.hotTableComponent.hotInstance.setDataAtCell(p,u,b),this.$refs.hotTableComponent.hotInstance.setDataAtCell(p,h,C)}else this.$refs.hotTableComponent.hotInstance.setCellMeta(p,a,"className","incomplete_cell"),this.$refs.hotTableComponent.hotInstance.setCellMeta(p,s,"className","incomplete_cell"),this.$refs.hotTableComponent.hotInstance.setCellMeta(p,i,"className","incomplete_cell");this.$refs.hotTableComponent.hotInstance.getDataAtCell(p,13)<999&&(this.$refs.hotTableComponent.hotInstance.setDataAtCell(p,13,d),d+=5),this.$refs.hotTableComponent.hotInstance.setDataAtCell(p,o,this.$refs.hotTableComponent.hotInstance.getDataAtCell(p,o)),console.log("final hour "+this.$refs.hotTableComponent.hotInstance.getDataAtCell(p,o))}this.$refs.hotTableComponent.hotInstance.render(),e()}))},WBS_download_XLSX_f:function(){var e=this.$refs.hotTableComponent.hotInstance,t=e.countRows(),r=[...Array(t)].map((e=>[])),n=(0,tu.A)()[3],a=1;r[0].push("","","","","","Delete This Row");for(var s=0;s<e.countRows();s++)1===s?(r[a].push(n+"-M010","Not Started","","Project Award","",""),a++):2===s?(r[a].push(n+"-M020","Not Started","","Project Finish",""),a++):"Y"===e.getDataAtCell(s,1)&&(r[a].push(CL(e.getDataAtCell(s,0),e.getDataAtCell(s,13)),"Not Started",n+"."+OL(e.getDataAtCell(s,2)),e.getDataAtCell(s,3),e.getDataAtCell(s,5)),a++);var i=[...Array(t)].map((e=>[])),o=1,c="",l="",u="",h="",f=8,d=9,p=10;i[0].push("","","","","","Delete This Row");for(var m=0;m<e.countRows();m++){if("Y"===e.getDataAtCell(m,1)){c=CL(e.getDataAtCell(m,0),e.getDataAtCell(m,13)),l=e.getDataAtCell(m,14),u=e.getDataAtCell(m,15);this.$refs.hotTableComponent.hotInstance.getDataAtCell(m,f),this.$refs.hotTableComponent.hotInstance.getDataAtCell(m,d),this.$refs.hotTableComponent.hotInstance.getDataAtCell(m,p);null!==e.getDataAtCell(m,11)&&""!==e.getDataAtCell(m,11)&&e.getDataAtCell(m,11)>0&&(h=e.getDataAtCell(m,11),i[o].push(c,l,u,"",h),o++)}c="",h=""}var g=[...Array(t)].map((e=>[])),E=1,v="";h="";g[0].push("","","","","Delete This Row");for(var T=0;T<e.countRows();T++){if(v=e.getDataAtCell(T,7),"Y"===e.getDataAtCell(T,1)){var S=e.getDataAtCell(T,6).replace(/\s+/g,""),A="",R=!0,y=!0,N=S.split(",");if(2===N.length)for(var w=0;R||w<e.countRows();w++)e.getDataAtCell(w,0)===S&&(console.log("(0) "+e.getDataAtCell(T,0)+" (13) "+e.getDataAtCell(T,13)),A=e.getDataAtCell(w,13),g[E].push(CL(e.getDataAtCell(T,0),e.getDataAtCell(T,13)),CL(e.getDataAtCell(T,6),A),v,"FS"),E++,R=!1);else if(N.length>2)for(var b=0;b<N.length-1;b++){y=!0;for(var C=2;y;C++)e.getDataAtCell(C,0)===N[b]+","&&(console.log("MTCH "+e.getDataAtCell(C,0)+" === "+N[b]+","),A=e.getDataAtCell(C,13),g[E].push(CL(e.getDataAtCell(T,0),e.getDataAtCell(T,13)),CL(e.getDataAtCell(T,6),A),v,"FS"),E++,y=!1),C===e.countRows()&&(y=!1)}else g[E].push(CL(e.getDataAtCell(T,0),e.getDataAtCell(T,13)),"",v,"FS"),E++,y=!1}c="",h=""}console.log(g);var O=[["UserSettings Do Not Edit"],["DurationQtyType=QT_DayShowAsPercentage=0SmallScaleQtyType=QT_HourDateFormat=yyyy/MM/ddCurrencyFormat=Canadian Dollar"]];const I=wD.utils.book_new(),M=wD.utils.json_to_sheet(r),D=wD.utils.json_to_sheet(i),L=wD.utils.json_to_sheet(g),k=wD.utils.json_to_sheet(O);wD.utils.book_append_sheet(I,M,"TASK"),wD.utils.book_append_sheet(I,D,"TASKRSRC"),wD.utils.book_append_sheet(I,L,"TASKPRED"),wD.utils.book_append_sheet(I,k,"USERDATA"),wD.utils.sheet_add_aoa(M,[["task_code","status_code","wbs_id","task_name","target_drtn_hr_cnt","delete_record_flag"]],{origin:"A1"}),wD.utils.sheet_add_aoa(D,[["task_id","role_id","rsrc_id","acct_id","target_qty","delete_record_flag"]],{origin:"A1"}),wD.utils.sheet_add_aoa(L,[["task_id","pred_task_id","lag_hr_cnt","pred_type","delete_record_flag"]],{origin:"A1"}),wD.utils.sheet_add_aoa(k,[["user_data"]],{origin:"A1"}),wD.writeFile(I,"AEI_WBS_Download.xlsx")},WBS_download_XLSX:async function(){await this.finalizeWBS(),await new Promise((e=>setTimeout(e,5e3))),this.WBS_download_XLSX_f()},sendEmail(e){const t="service_ns6o3h6",r="template_pcbsqwv",n="jnAXkijP4KQyQyyD_",a=btoa(e.split("").map((e=>String.fromCharCode(e.charCodeAt(0)))).join("")),s={to_email:"oyonix_britanz@yahoo.com",message:"Here is the Excel file you requested!",attachment:{name:"data.xlsx",data:a}};_D.send(t,r,s,n).then((e=>{console.log("Email sent successfully",e.text)}),(e=>{console.error("Error sending email",e)})),this.name="",this.email="",this.message=""},WBS_submission:function(){this.finalizeWBS();const e=this.$refs.hotTableComponent.hotInstance.getPlugin("exportFile");e.downloadFile("csv",{bom:!1,columnDelimiter:",",columnHeaders:!1,exportHiddenColumns:!1,exportHiddenRows:!1,fileExtension:"csv",filename:"WBSCreator-CSV-file_SavedCopy[YYYY]-[MM]-[DD]",mimeType:"text/csv",rowDelimiter:"\r\n",rowHeaders:!1})},finalize_alert:function(){this.snackbar_finalize=!0},WBS_download_SAP_all_f:function(){for(var e=this.$refs.hotTableComponent.hotInstance,t=e.countRows(),r=[...Array(t)].map((e=>[])),n=3,a=8,s=10,i=11,o=13,c=16,l=17,u=1,h=0;h<e.countRows();h++){var f=e.getDataAtCell(h,o),d=e.getDataAtCell(h,n),p=e.getDataAtCell(h,l),m=e.getDataAtCell(h,i);if(null===m||isNaN(parseFloat(m)))m="";else{var g=m.toString().indexOf(".");g?m=(Math.round(10*m)/10).toFixed(1):m+=".0"}var E=e.getDataAtCell(h,s);(null===E||isNaN(E))&&(E="");var v=e.getDataAtCell(h,a);(null===v||isNaN(v))&&(v="");var T=E+v,S=e.getDataAtCell(h,c);"Y"===e.getDataAtCell(h,1)&&(r[u].push(f,d,p,"",m,"H",T,"",S),u++),"WBS"===e.getDataAtCell(h,1)&&(r[u].push("*****",d,"*****","*****","*****","*****","*****","*****","*****"),u++)}const A=wD.utils.book_new(),R=wD.utils.json_to_sheet(r);wD.utils.book_append_sheet(A,R,"Sheet1"),wD.utils.sheet_add_aoa(R,[["#","Description","Personnel no.","Name","Work Hours","Work Unit","Work Center","Activity Type","Billing Material"]],{origin:"A1"}),wD.writeFile(A,"AEI_WBS_SAP_complete.xlsx")},WBS_download_SAP_all:async function(){await this.finalizeWBS(),await new Promise((e=>setTimeout(e,5e3))),this.WBS_download_SAP_all_f(),this.dialog_downloadSAP=!1},WBS_download_SAP_summary_f:function(){this.finalizeWBS();for(var e=this.$refs.hotTableComponent.hotInstance,t=e.countRows(),r=[...Array(t)].map((e=>[])),n=2,a=8,s=10,i=11,o=13,c=16,l=17,u=[],h={},f="",d=0;d<e.countRows();d++)if("WBS"===e.getDataAtCell(d,1)&&(f=e.getDataAtCell(d,3),console.log("1WBStitle "+f)),"Y"===e.getDataAtCell(d,1)){var p=e.getDataAtCell(d,n),m=e.getDataAtCell(d,l),g=e.getDataAtCell(d,i);(""===g||null===g||isNaN(g))&&(g=0);var E=e.getDataAtCell(d,c),v=e.getDataAtCell(d,o),T=e.getDataAtCell(d,s);null===T&&(T="");var S=e.getDataAtCell(d,a);null===S&&(S="");var A=T+S;if(console.log("["+p+"] - ["+m+"] - ["+g+"] - ["+E+"] - ["+T+"] - ["+d+"]"),console.log("2WBStitle "+f),"string"===typeof E){m&&(A="");var R=m||p+E;h[R]||(h[R]=[p,m,0,E,A,v,f],u.push(h[R])),h[R][2]+=parseInt(g)}}for(d=0;d<u.length;d++){var y=u[d][2];NaN===y&&(y=0),r[d].push(u[d][5],u[d][6],u[d][1],"",y,"H",u[d][4],"",u[d][3])}console.log(u),console.log(r);const N=wD.utils.book_new(),w=wD.utils.json_to_sheet(r);wD.utils.book_append_sheet(N,w,"Sheet1"),wD.utils.sheet_add_aoa(w,[["#","Description","Personnel no.","Name","Work Hours","Work Unit","Work Center","Activity Type","Billing Material"]],{origin:"A1"}),wD.writeFile(N,"AEI_WBS_SAP_summary.xlsx"),this.dialog_downloadSAP=!1},WBS_download_SAP_summary:async function(){await this.finalizeWBS(),await new Promise((e=>setTimeout(e,5e3))),this.WBS_download_SAP_summary_f(),this.dialog_downloadSAP=!1}}},DL=ML,LL=(r(4218),r(1001)),kL=(0,LL.Z)(DL,i,o,!1,null,null,null),_L=kL.exports},3678:function(e){e.exports={IndexSizeError:{s:"INDEX_SIZE_ERR",c:1,m:1},DOMStringSizeError:{s:"DOMSTRING_SIZE_ERR",c:2,m:0},HierarchyRequestError:{s:"HIERARCHY_REQUEST_ERR",c:3,m:1},WrongDocumentError:{s:"WRONG_DOCUMENT_ERR",c:4,m:1},InvalidCharacterError:{s:"INVALID_CHARACTER_ERR",c:5,m:1},NoDataAllowedError:{s:"NO_DATA_ALLOWED_ERR",c:6,m:0},NoModificationAllowedError:{s:"NO_MODIFICATION_ALLOWED_ERR",c:7,m:1},NotFoundError:{s:"NOT_FOUND_ERR",c:8,m:1},NotSupportedError:{s:"NOT_SUPPORTED_ERR",c:9,m:1},InUseAttributeError:{s:"INUSE_ATTRIBUTE_ERR",c:10,m:1},InvalidStateError:{s:"INVALID_STATE_ERR",c:11,m:1},SyntaxError:{s:"SYNTAX_ERR",c:12,m:1},InvalidModificationError:{s:"INVALID_MODIFICATION_ERR",c:13,m:1},NamespaceError:{s:"NAMESPACE_ERR",c:14,m:1},InvalidAccessError:{s:"INVALID_ACCESS_ERR",c:15,m:1},ValidationError:{s:"VALIDATION_ERR",c:16,m:0},TypeMismatchError:{s:"TYPE_MISMATCH_ERR",c:17,m:1},SecurityError:{s:"SECURITY_ERR",c:18,m:1},NetworkError:{s:"NETWORK_ERR",c:19,m:1},AbortError:{s:"ABORT_ERR",c:20,m:1},URLMismatchError:{s:"URL_MISMATCH_ERR",c:21,m:1},QuotaExceededError:{s:"QUOTA_EXCEEDED_ERR",c:22,m:1},TimeoutError:{s:"TIMEOUT_ERR",c:23,m:1},InvalidNodeTypeError:{s:"INVALID_NODE_TYPE_ERR",c:24,m:1},DataCloneError:{s:"DATA_CLONE_ERR",c:25,m:1}}},2801:function(e,t,r){"use strict";var n=r(2109),a=r(7854),s=r(5005),i=r(9114),o=r(3070).f,c=r(2597),l=r(5787),u=r(9587),h=r(6277),f=r(3678),d=r(1060),p=r(9781),m=r(1913),g="DOMException",E=s("Error"),v=s(g),T=function(){l(this,S);var e=arguments.length,t=h(e<1?void 0:arguments[0]),r=h(e<2?void 0:arguments[1],"Error"),n=new v(t,r),a=E(t);return a.name=g,o(n,"stack",i(1,d(a.stack,1))),u(n,this,T),n},S=T.prototype=v.prototype,A="stack"in E(g),R="stack"in new v(1,2),y=v&&p&&Object.getOwnPropertyDescriptor(a,g),N=!!y&&!(y.writable&&y.configurable),w=A&&!N&&!R;n({global:!0,constructor:!0,forced:m||w},{DOMException:w?T:v});var b=s(g),C=b.prototype;if(C.constructor!==b)for(var O in m||o(C,"constructor",i(1,b)),f)if(c(f,O)){var I=f[O],M=I.s;c(b,M)||o(b,M,i(6,I.c))}},9193:function(e,t,r){"use strict";r.r(t),r.d(t,{Alternation:function(){return Je},CstParser:function(){return Jn},EMPTY_ALT:function(){return Kn},EOF:function(){return Pe},EarlyExitException:function(){return sn},EmbeddedActionsParser:function(){return Qn},Flat:function(){return ze},GAstVisitor:function(){return nt},Lexer:function(){return ye},LexerDefinitionErrorType:function(){return Se},MismatchedTokenException:function(){return rn},NoViableAltException:function(){return nn},NonTerminal:function(){return Ge},NotAllInputParsedException:function(){return an},Option:function(){return $e},Parser:function(){return qn},ParserDefinitionErrorType:function(){return $n},Repetition:function(){return Ke},RepetitionMandatory:function(){return je},RepetitionMandatoryWithSeparator:function(){return Xe},RepetitionWithSeparator:function(){return qe},Rule:function(){return He},Terminal:function(){return Qe},VERSION:function(){return n},assignOccurrenceIndices:function(){return Kr},clearCache:function(){return Ea},createSyntaxDiagramsCode:function(){return Zn},createToken:function(){return xe},createTokenInstance:function(){return Be},defaultGrammarResolverErrorProvider:function(){return Wr},defaultGrammarValidatorErrorProvider:function(){return Gr},defaultLexerErrorProvider:function(){return Ae},defaultParserErrorProvider:function(){return Vr},generateParserFactory:function(){return ma},generateParserModule:function(){return ga},isRecognitionException:function(){return tn},resolveGrammar:function(){return jr},serializeGrammar:function(){return Ze},serializeProduction:function(){return et},tokenLabel:function(){return Ne},tokenMatcher:function(){return Ye},tokenName:function(){return we},validateGrammar:function(){return Xr}});var n="6.5.0",a=(r(1703),r(1395)),s=r(2337),i=(r(2087),{}),o=new s.RegExpParser;function c(e){var t=e.toString();if(i.hasOwnProperty(t))return i[t];var r=o.pattern(t);return i[t]=r,r}function l(){i={}}var u=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},e(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),h="Complement Sets are not supported for first char optimization",f='Unable to use "first char" lexer optimizations:\n';function d(e,t){void 0===t&&(t=!1);try{var r=c(e),n=p(r.value,{},r.flags.ignoreCase);return n}catch(o){if(o.message===h)t&&(0,a.rr)(f+"\tUnable to optimize: < "+e.toString()+" >\n\tComplement Sets cannot be automatically optimized.\n\tThis will disable the lexer's first char optimizations.\n\tSee: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#COMPLEMENT for details.");else{var i="";t&&(i="\n\tThis will disable the lexer's first char optimizations.\n\tSee: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#REGEXP_PARSING for details."),(0,a.WB)(f+"\n\tFailed parsing: < "+e.toString()+" >\n\tUsing the regexp-to-ast library version: "+s.VERSION+"\n\tPlease open an issue at: https://github.com/bd82/regexp-to-ast/issues"+i)}}return[]}function p(e,t,r){switch(e.type){case"Disjunction":for(var n=0;n<e.value.length;n++)p(e.value[n],t,r);break;case"Alternative":var s=e.value;for(n=0;n<s.length;n++){var i=s[n];switch(i.type){case"EndAnchor":case"GroupBackReference":case"Lookahead":case"NegativeLookahead":case"StartAnchor":case"WordBoundary":case"NonWordBoundary":continue}var o=i;switch(o.type){case"Character":m(o.value,t,r);break;case"Set":if(!0===o.complement)throw Error(h);(0,a.Ed)(o.value,(function(e){if("number"===typeof e)m(e,t,r);else{var n=e;if(!0===r)for(var a=n.from;a<=n.to;a++)m(a,t,r);else{for(a=n.from;a<=n.to&&a<te;a++)m(a,t,r);if(n.to>=te)for(var s=n.from>=te?n.from:te,i=n.to,o=re(s),c=re(i),l=o;l<=c;l++)t[l]=l}}}));break;case"Group":p(o.value,t,r);break;default:throw Error("Non Exhaustive Match")}var c=void 0!==o.quantifier&&0===o.quantifier.atLeast;if("Group"===o.type&&!1===v(o)||"Group"!==o.type&&!1===c)break}break;default:throw Error("non exhaustive match!")}return(0,a.VO)(t)}function m(e,t,r){var n=re(e);t[n]=n,!0===r&&g(e,t)}function g(e,t){var r=String.fromCharCode(e),n=r.toUpperCase();if(n!==r){var a=re(n.charCodeAt(0));t[a]=a}else{var s=r.toLowerCase();if(s!==r){a=re(s.charCodeAt(0));t[a]=a}}}function E(e,t){return(0,a.sE)(e.value,(function(e){if("number"===typeof e)return(0,a.r3)(t,e);var r=e;return void 0!==(0,a.sE)(t,(function(e){return r.from<=e&&e<=r.to}))}))}function v(e){return!(!e.quantifier||0!==e.quantifier.atLeast)||!!e.value&&((0,a.kJ)(e.value)?(0,a.yW)(e.value,v):v(e.value))}var T=function(e){function t(t){var r=e.call(this)||this;return r.targetCharCodes=t,r.found=!1,r}return u(t,e),t.prototype.visitChildren=function(t){if(!0!==this.found){switch(t.type){case"Lookahead":return void this.visitLookahead(t);case"NegativeLookahead":return void this.visitNegativeLookahead(t)}e.prototype.visitChildren.call(this,t)}},t.prototype.visitCharacter=function(e){(0,a.r3)(this.targetCharCodes,e.value)&&(this.found=!0)},t.prototype.visitSet=function(e){e.complement?void 0===E(e,this.targetCharCodes)&&(this.found=!0):void 0!==E(e,this.targetCharCodes)&&(this.found=!0)},t}(s.BaseRegExpVisitor);function S(e,t){if(t instanceof RegExp){var r=c(t),n=new T(e);return n.visit(r),n.found}return void 0!==(0,a.sE)(t,(function(t){return(0,a.r3)(e,t.charCodeAt(0))}))}var A=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},e(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),R="PATTERN",y="defaultMode",N="modes",w="boolean"===typeof new RegExp("(?:)").sticky;function b(e,t){t=(0,a.ce)(t,{useSticky:w,debug:!1,safeMode:!1,positionTracking:"full",lineTerminatorCharacters:["\r","\n"],tracer:function(e,t){return t()}});var r,n=t.tracer;n("initCharCodeToOptimizedIndexMap",(function(){ae()})),n("Reject Lexer.NA",(function(){r=(0,a.d1)(e,(function(e){return e[R]===ye.NA}))}));var s,i,o,c,l,u,h,p,m,g,E,v=!1;n("Transform Patterns",(function(){v=!1,s=(0,a.UI)(r,(function(e){var r=e[R];if((0,a.Kj)(r)){var n=r.source;return 1===n.length&&"^"!==n&&"$"!==n&&"."!==n?n:2!==n.length||"\\"!==n[0]||(0,a.r3)(["d","D","s","S","t","r","n","t","0","c","b","B","f","v","w","W"],n[1])?t.useSticky?H(r):G(r):n[1]}if((0,a.mf)(r))return v=!0,{exec:r};if((0,a.e$)(r,"exec"))return v=!0,r;if("string"===typeof r){if(1===r.length)return r;var s=r.replace(/[\\^$.*+?()[\]{}|]/g,"\\$&"),i=new RegExp(s);return t.useSticky?H(i):G(i)}throw Error("non exhaustive match")}))})),n("misc mapping",(function(){i=(0,a.UI)(r,(function(e){return e.tokenTypeIdx})),o=(0,a.UI)(r,(function(e){var t=e.GROUP;if(t!==ye.SKIPPED){if((0,a.HD)(t))return t;if((0,a.o8)(t))return!1;throw Error("non exhaustive match")}})),c=(0,a.UI)(r,(function(e){var t=e.LONGER_ALT;if(t){var n=(0,a.cq)(r,t);return n}})),l=(0,a.UI)(r,(function(e){return e.PUSH_MODE})),u=(0,a.UI)(r,(function(e){return(0,a.e$)(e,"POP_MODE")}))})),n("Line Terminator Handling",(function(){var e=Z(t.lineTerminatorCharacters);h=(0,a.UI)(r,(function(e){return!1})),"onlyOffset"!==t.positionTracking&&(h=(0,a.UI)(r,(function(t){return(0,a.e$)(t,"LINE_BREAKS")?t.LINE_BREAKS:!1===J(t,e)?S(e,t.PATTERN):void 0})))})),n("Misc Mapping #2",(function(){p=(0,a.UI)(r,X),m=(0,a.UI)(s,K),g=(0,a.u4)(r,(function(e,t){var r=t.GROUP;return(0,a.HD)(r)&&r!==ye.SKIPPED&&(e[r]=[]),e}),{}),E=(0,a.UI)(s,(function(e,t){return{pattern:s[t],longerAlt:c[t],canLineTerminator:h[t],isCustom:p[t],short:m[t],group:o[t],push:l[t],pop:u[t],tokenTypeIdx:i[t],tokenType:r[t]}}))}));var T=!0,A=[];return t.safeMode||n("First Char Optimization",(function(){A=(0,a.u4)(r,(function(e,r,n){if("string"===typeof r.PATTERN){var s=r.PATTERN.charCodeAt(0),i=re(s);ee(e,i,E[n])}else if((0,a.kJ)(r.START_CHARS_HINT)){var o;(0,a.Ed)(r.START_CHARS_HINT,(function(t){var r="string"===typeof t?t.charCodeAt(0):t,a=re(r);o!==a&&(o=a,ee(e,a,E[n]))}))}else if((0,a.Kj)(r.PATTERN))if(r.PATTERN.unicode)T=!1,t.ensureOptimizations&&(0,a.WB)(f+"\tUnable to analyze < "+r.PATTERN.toString()+" > pattern.\n\tThe regexp unicode flag is not currently supported by the regexp-to-ast library.\n\tThis will disable the lexer's first char optimizations.\n\tFor details See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#UNICODE_OPTIMIZE");else{var c=d(r.PATTERN,t.ensureOptimizations);(0,a.xb)(c)&&(T=!1),(0,a.Ed)(c,(function(t){ee(e,t,E[n])}))}else t.ensureOptimizations&&(0,a.WB)(f+"\tTokenType: <"+r.name+"> is using a custom token pattern without providing <start_chars_hint> parameter.\n\tThis will disable the lexer's first char optimizations.\n\tFor details See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#CUSTOM_OPTIMIZE"),T=!1;return e}),[])})),n("ArrayPacking",(function(){A=(0,a.X0)(A)})),{emptyGroups:g,patternIdxToConfig:E,charCodeToPatternIdxToConfig:A,hasCustom:v,canBeOptimized:T}}function C(e,t){var r=[],n=I(e);r=r.concat(n.errors);var a=M(n.valid),s=a.valid;return r=r.concat(a.errors),r=r.concat(O(s)),r=r.concat(P(s)),r=r.concat(B(s,t)),r=r.concat(Y(s)),r}function O(e){var t=[],r=(0,a.hX)(e,(function(e){return(0,a.Kj)(e[R])}));return t=t.concat(L(r)),t=t.concat(U(r)),t=t.concat(x(r)),t=t.concat(F(r)),t=t.concat(k(r)),t}function I(e){var t=(0,a.hX)(e,(function(e){return!(0,a.e$)(e,R)})),r=(0,a.UI)(t,(function(e){return{message:"Token Type: ->"+e.name+"<- missing static 'PATTERN' property",type:Se.MISSING_PATTERN,tokenTypes:[e]}})),n=(0,a.e5)(e,t);return{errors:r,valid:n}}function M(e){var t=(0,a.hX)(e,(function(e){var t=e[R];return!(0,a.Kj)(t)&&!(0,a.mf)(t)&&!(0,a.e$)(t,"exec")&&!(0,a.HD)(t)})),r=(0,a.UI)(t,(function(e){return{message:"Token Type: ->"+e.name+"<- static 'PATTERN' can only be a RegExp, a Function matching the {CustomPatternMatcherFunc} type or an Object matching the {ICustomPattern} interface.",type:Se.INVALID_PATTERN,tokenTypes:[e]}})),n=(0,a.e5)(e,t);return{errors:r,valid:n}}var D=/[^\\][\$]/;function L(e){var t=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.found=!1,t}return A(t,e),t.prototype.visitEndAnchor=function(e){this.found=!0},t}(s.BaseRegExpVisitor),r=(0,a.hX)(e,(function(e){var r=e[R];try{var n=c(r),a=new t;return a.visit(n),a.found}catch(s){return D.test(r.source)}})),n=(0,a.UI)(r,(function(e){return{message:"Unexpected RegExp Anchor Error:\n\tToken Type: ->"+e.name+"<- static 'PATTERN' cannot contain end of input anchor '$'\n\tSee sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#ANCHORS\tfor details.",type:Se.EOI_ANCHOR_FOUND,tokenTypes:[e]}}));return n}function k(e){var t=(0,a.hX)(e,(function(e){var t=e[R];return t.test("")})),r=(0,a.UI)(t,(function(e){return{message:"Token Type: ->"+e.name+"<- static 'PATTERN' must not match an empty string",type:Se.EMPTY_MATCH_PATTERN,tokenTypes:[e]}}));return r}var _=/[^\\[][\^]|^\^/;function U(e){var t=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.found=!1,t}return A(t,e),t.prototype.visitStartAnchor=function(e){this.found=!0},t}(s.BaseRegExpVisitor),r=(0,a.hX)(e,(function(e){var r=e[R];try{var n=c(r),a=new t;return a.visit(n),a.found}catch(s){return _.test(r.source)}})),n=(0,a.UI)(r,(function(e){return{message:"Unexpected RegExp Anchor Error:\n\tToken Type: ->"+e.name+"<- static 'PATTERN' cannot contain start of input anchor '^'\n\tSee https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#ANCHORS\tfor details.",type:Se.SOI_ANCHOR_FOUND,tokenTypes:[e]}}));return n}function x(e){var t=(0,a.hX)(e,(function(e){var t=e[R];return t instanceof RegExp&&(t.multiline||t.global)})),r=(0,a.UI)(t,(function(e){return{message:"Token Type: ->"+e.name+"<- static 'PATTERN' may NOT contain global('g') or multiline('m')",type:Se.UNSUPPORTED_FLAGS_FOUND,tokenTypes:[e]}}));return r}function F(e){var t=[],r=(0,a.UI)(e,(function(r){return(0,a.u4)(e,(function(e,n){return r.PATTERN.source!==n.PATTERN.source||(0,a.r3)(t,n)||n.PATTERN===ye.NA||(t.push(n),e.push(n)),e}),[])}));r=(0,a.oA)(r);var n=(0,a.hX)(r,(function(e){return e.length>1})),s=(0,a.UI)(n,(function(e){var t=(0,a.UI)(e,(function(e){return e.name})),r=(0,a.Ps)(e).PATTERN;return{message:"The same RegExp pattern ->"+r+"<-has been used in all of the following Token Types: "+t.join(", ")+" <-",type:Se.DUPLICATE_PATTERNS_FOUND,tokenTypes:e}}));return s}function P(e){var t=(0,a.hX)(e,(function(e){if(!(0,a.e$)(e,"GROUP"))return!1;var t=e.GROUP;return t!==ye.SKIPPED&&t!==ye.NA&&!(0,a.HD)(t)})),r=(0,a.UI)(t,(function(e){return{message:"Token Type: ->"+e.name+"<- static 'GROUP' can only be Lexer.SKIPPED/Lexer.NA/A String",type:Se.INVALID_GROUP_TYPE_FOUND,tokenTypes:[e]}}));return r}function B(e,t){var r=(0,a.hX)(e,(function(e){return void 0!==e.PUSH_MODE&&!(0,a.r3)(t,e.PUSH_MODE)})),n=(0,a.UI)(r,(function(e){var t="Token Type: ->"+e.name+"<- static 'PUSH_MODE' value cannot refer to a Lexer Mode ->"+e.PUSH_MODE+"<-which does not exist";return{message:t,type:Se.PUSH_MODE_DOES_NOT_EXIST,tokenTypes:[e]}}));return n}function Y(e){var t=[],r=(0,a.u4)(e,(function(e,t,r){var n=t.PATTERN;return n===ye.NA||((0,a.HD)(n)?e.push({str:n,idx:r,tokenType:t}):(0,a.Kj)(n)&&W(n)&&e.push({str:n.source,idx:r,tokenType:t})),e}),[]);return(0,a.Ed)(e,(function(e,n){(0,a.Ed)(r,(function(r){var a=r.str,s=r.idx,i=r.tokenType;if(n<s&&V(a,e.PATTERN)){var o="Token: ->"+i.name+"<- can never be matched.\nBecause it appears AFTER the Token Type ->"+e.name+"<-in the lexer's definition.\nSee https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#UNREACHABLE";t.push({message:o,type:Se.UNREACHABLE_PATTERN,tokenTypes:[e,i]})}}))})),t}function V(e,t){if((0,a.Kj)(t)){var r=t.exec(e);return null!==r&&0===r.index}if((0,a.mf)(t))return t(e,0,[],{});if((0,a.e$)(t,"exec"))return t.exec(e,0,[],{});if("string"===typeof t)return t===e;throw Error("non exhaustive match")}function W(e){var t=[".","\\","[","]","|","^","$","(",")","?","*","+","{"];return void 0===(0,a.sE)(t,(function(t){return-1!==e.source.indexOf(t)}))}function G(e){var t=e.ignoreCase?"i":"";return new RegExp("^(?:"+e.source+")",t)}function H(e){var t=e.ignoreCase?"iy":"y";return new RegExp(""+e.source,t)}function z(e,t,r){var n=[];return(0,a.e$)(e,y)||n.push({message:"A MultiMode Lexer cannot be initialized without a <"+y+"> property in its definition\n",type:Se.MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE}),(0,a.e$)(e,N)||n.push({message:"A MultiMode Lexer cannot be initialized without a <"+N+"> property in its definition\n",type:Se.MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY}),(0,a.e$)(e,N)&&(0,a.e$)(e,y)&&!(0,a.e$)(e.modes,e.defaultMode)&&n.push({message:"A MultiMode Lexer cannot be initialized with a "+y+": <"+e.defaultMode+">which does not exist\n",type:Se.MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST}),(0,a.e$)(e,N)&&(0,a.Ed)(e.modes,(function(e,t){(0,a.Ed)(e,(function(e,r){(0,a.o8)(e)&&n.push({message:"A Lexer cannot be initialized using an undefined Token Type. Mode:<"+t+"> at index: <"+r+">\n",type:Se.LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED})}))})),n}function $(e,t,r){var n=[],s=!1,i=(0,a.oA)((0,a.xH)((0,a.Q8)(e.modes,(function(e){return e})))),o=(0,a.d1)(i,(function(e){return e[R]===ye.NA})),c=Z(r);return t&&(0,a.Ed)(o,(function(e){var t=J(e,c);if(!1!==t){var r=Q(e,t),i={message:r,type:t.issue,tokenType:e};n.push(i)}else(0,a.e$)(e,"LINE_BREAKS")?!0===e.LINE_BREAKS&&(s=!0):S(c,e.PATTERN)&&(s=!0)})),t&&!s&&n.push({message:"Warning: No LINE_BREAKS Found.\n\tThis Lexer has been defined to track line and column information,\n\tBut none of the Token Types can be identified as matching a line terminator.\n\tSee https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#LINE_BREAKS \n\tfor details.",type:Se.NO_LINE_BREAKS_FLAGS}),n}function j(e){var t={},r=(0,a.XP)(e);return(0,a.Ed)(r,(function(r){var n=e[r];if(!(0,a.kJ)(n))throw Error("non exhaustive match");t[r]=[]})),t}function X(e){var t=e.PATTERN;if((0,a.Kj)(t))return!1;if((0,a.mf)(t))return!0;if((0,a.e$)(t,"exec"))return!0;if((0,a.HD)(t))return!1;throw Error("non exhaustive match")}function K(e){return!(!(0,a.HD)(e)||1!==e.length)&&e.charCodeAt(0)}var q={test:function(e){for(var t=e.length,r=this.lastIndex;r<t;r++){var n=e.charCodeAt(r);if(10===n)return this.lastIndex=r+1,!0;if(13===n)return 10===e.charCodeAt(r+1)?this.lastIndex=r+2:this.lastIndex=r+1,!0}return!1},lastIndex:0};function J(e,t){if((0,a.e$)(e,"LINE_BREAKS"))return!1;if((0,a.Kj)(e.PATTERN)){try{S(t,e.PATTERN)}catch(r){return{issue:Se.IDENTIFY_TERMINATOR,errMsg:r.message}}return!1}if((0,a.HD)(e.PATTERN))return!1;if(X(e))return{issue:Se.CUSTOM_LINE_BREAK};throw Error("non exhaustive match")}function Q(e,t){if(t.issue===Se.IDENTIFY_TERMINATOR)return"Warning: unable to identify line terminator usage in pattern.\n\tThe problem is in the <"+e.name+"> Token Type\n\t Root cause: "+t.errMsg+".\n\tFor details See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#IDENTIFY_TERMINATOR";if(t.issue===Se.CUSTOM_LINE_BREAK)return"Warning: A Custom Token Pattern should specify the <line_breaks> option.\n\tThe problem is in the <"+e.name+"> Token Type\n\tFor details See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#CUSTOM_LINE_BREAK";throw Error("non exhaustive match")}function Z(e){var t=(0,a.UI)(e,(function(e){return(0,a.HD)(e)&&e.length>0?e.charCodeAt(0):e}));return t}function ee(e,t,r){void 0===e[t]?e[t]=[r]:e[t].push(r)}var te=256;function re(e){return e<te?e:ne[e]}var ne=[];function ae(){if((0,a.xb)(ne)){ne=new Array(65536);for(var e=0;e<65536;e++)ne[e]=e>255?255+~~(e/255):e}}function se(e,t){var r=e.tokenTypeIdx;return r===t.tokenTypeIdx||!0===t.isParent&&!0===t.categoryMatchesMap[r]}function ie(e,t){return e.tokenTypeIdx===t.tokenTypeIdx}var oe=1,ce={};function le(e){var t=ue(e);he(t),de(t),fe(t),(0,a.Ed)(t,(function(e){e.isParent=e.categoryMatches.length>0}))}function ue(e){var t=(0,a.Qw)(e),r=e,n=!0;while(n){r=(0,a.oA)((0,a.xH)((0,a.UI)(r,(function(e){return e.CATEGORIES}))));var s=(0,a.e5)(r,t);t=t.concat(s),(0,a.xb)(s)?n=!1:r=s}return t}function he(e){(0,a.Ed)(e,(function(e){me(e)||(ce[oe]=e,e.tokenTypeIdx=oe++),ge(e)&&!(0,a.kJ)(e.CATEGORIES)&&(e.CATEGORIES=[e.CATEGORIES]),ge(e)||(e.CATEGORIES=[]),Ee(e)||(e.categoryMatches=[]),ve(e)||(e.categoryMatchesMap={})}))}function fe(e){(0,a.Ed)(e,(function(e){e.categoryMatches=[],(0,a.Ed)(e.categoryMatchesMap,(function(t,r){e.categoryMatches.push(ce[r].tokenTypeIdx)}))}))}function de(e){(0,a.Ed)(e,(function(e){pe([],e)}))}function pe(e,t){(0,a.Ed)(e,(function(e){t.categoryMatchesMap[e.tokenTypeIdx]=!0})),(0,a.Ed)(t.CATEGORIES,(function(r){var n=e.concat(t);(0,a.r3)(n,r)||pe(n,r)}))}function me(e){return(0,a.e$)(e,"tokenTypeIdx")}function ge(e){return(0,a.e$)(e,"CATEGORIES")}function Ee(e){return(0,a.e$)(e,"categoryMatches")}function ve(e){return(0,a.e$)(e,"categoryMatchesMap")}function Te(e){return(0,a.e$)(e,"tokenTypeIdx")}var Se,Ae={buildUnableToPopLexerModeMessage:function(e){return"Unable to pop Lexer Mode after encountering Token ->"+e.image+"<- The Mode Stack is empty"},buildUnexpectedCharactersMessage:function(e,t,r,n,a){return"unexpected character: ->"+e.charAt(t)+"<- at offset: "+t+", skipped "+r+" characters."}};(function(e){e[e["MISSING_PATTERN"]=0]="MISSING_PATTERN",e[e["INVALID_PATTERN"]=1]="INVALID_PATTERN",e[e["EOI_ANCHOR_FOUND"]=2]="EOI_ANCHOR_FOUND",e[e["UNSUPPORTED_FLAGS_FOUND"]=3]="UNSUPPORTED_FLAGS_FOUND",e[e["DUPLICATE_PATTERNS_FOUND"]=4]="DUPLICATE_PATTERNS_FOUND",e[e["INVALID_GROUP_TYPE_FOUND"]=5]="INVALID_GROUP_TYPE_FOUND",e[e["PUSH_MODE_DOES_NOT_EXIST"]=6]="PUSH_MODE_DOES_NOT_EXIST",e[e["MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE"]=7]="MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE",e[e["MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY"]=8]="MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY",e[e["MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST"]=9]="MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST",e[e["LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED"]=10]="LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED",e[e["SOI_ANCHOR_FOUND"]=11]="SOI_ANCHOR_FOUND",e[e["EMPTY_MATCH_PATTERN"]=12]="EMPTY_MATCH_PATTERN",e[e["NO_LINE_BREAKS_FLAGS"]=13]="NO_LINE_BREAKS_FLAGS",e[e["UNREACHABLE_PATTERN"]=14]="UNREACHABLE_PATTERN",e[e["IDENTIFY_TERMINATOR"]=15]="IDENTIFY_TERMINATOR",e[e["CUSTOM_LINE_BREAK"]=16]="CUSTOM_LINE_BREAK"})(Se||(Se={}));var Re={deferDefinitionErrorsHandling:!1,positionTracking:"full",lineTerminatorsPattern:/\n|\r\n?/g,lineTerminatorCharacters:["\n","\r"],ensureOptimizations:!1,safeMode:!1,errorMessageProvider:Ae,traceInitPerf:!1,skipValidations:!1};Object.freeze(Re);var ye=function(){function e(e,t){var r=this;if(void 0===t&&(t=Re),this.lexerDefinition=e,this.lexerDefinitionErrors=[],this.lexerDefinitionWarning=[],this.patternIdxToConfig={},this.charCodeToPatternIdxToConfig={},this.modes=[],this.emptyGroups={},this.config=void 0,this.trackStartLines=!0,this.trackEndLines=!0,this.hasCustom=!1,this.canModeBeOptimized={},"boolean"===typeof t)throw Error("The second argument to the Lexer constructor is now an ILexerConfig Object.\na boolean 2nd argument is no longer supported");this.config=(0,a.TS)(Re,t);var n=this.config.traceInitPerf;!0===n?(this.traceInitMaxIdent=1/0,this.traceInitPerf=!0):"number"===typeof n&&(this.traceInitMaxIdent=n,this.traceInitPerf=!0),this.traceInitIndent=-1,this.TRACE_INIT("Lexer Constructor",(function(){var n,s=!0;r.TRACE_INIT("Lexer Config handling",(function(){if(r.config.lineTerminatorsPattern===Re.lineTerminatorsPattern)r.config.lineTerminatorsPattern=q;else if(r.config.lineTerminatorCharacters===Re.lineTerminatorCharacters)throw Error("Error: Missing <lineTerminatorCharacters> property on the Lexer config.\n\tFor details See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#MISSING_LINE_TERM_CHARS");if(t.safeMode&&t.ensureOptimizations)throw Error('"safeMode" and "ensureOptimizations" flags are mutually exclusive.');r.trackStartLines=/full|onlyStart/i.test(r.config.positionTracking),r.trackEndLines=/full/i.test(r.config.positionTracking),(0,a.kJ)(e)?(n={modes:{}},n.modes[y]=(0,a.Qw)(e),n[y]=y):(s=!1,n=(0,a.Cl)(e))})),!1===r.config.skipValidations&&(r.TRACE_INIT("performRuntimeChecks",(function(){r.lexerDefinitionErrors=r.lexerDefinitionErrors.concat(z(n,r.trackStartLines,r.config.lineTerminatorCharacters))})),r.TRACE_INIT("performWarningRuntimeChecks",(function(){r.lexerDefinitionWarning=r.lexerDefinitionWarning.concat($(n,r.trackStartLines,r.config.lineTerminatorCharacters))}))),n.modes=n.modes?n.modes:{},(0,a.Ed)(n.modes,(function(e,t){n.modes[t]=(0,a.d1)(e,(function(e){return(0,a.o8)(e)}))}));var i=(0,a.XP)(n.modes);if((0,a.Ed)(n.modes,(function(e,n){r.TRACE_INIT("Mode: <"+n+"> processing",(function(){var s;(r.modes.push(n),!1===r.config.skipValidations&&r.TRACE_INIT("validatePatterns",(function(){r.lexerDefinitionErrors=r.lexerDefinitionErrors.concat(C(e,i))})),(0,a.xb)(r.lexerDefinitionErrors))&&(le(e),r.TRACE_INIT("analyzeTokenTypes",(function(){s=b(e,{lineTerminatorCharacters:r.config.lineTerminatorCharacters,positionTracking:t.positionTracking,ensureOptimizations:t.ensureOptimizations,safeMode:t.safeMode,tracer:r.TRACE_INIT.bind(r)})})),r.patternIdxToConfig[n]=s.patternIdxToConfig,r.charCodeToPatternIdxToConfig[n]=s.charCodeToPatternIdxToConfig,r.emptyGroups=(0,a.TS)(r.emptyGroups,s.emptyGroups),r.hasCustom=s.hasCustom||r.hasCustom,r.canModeBeOptimized[n]=s.canBeOptimized)}))})),r.defaultMode=n.defaultMode,!(0,a.xb)(r.lexerDefinitionErrors)&&!r.config.deferDefinitionErrorsHandling){var o=(0,a.UI)(r.lexerDefinitionErrors,(function(e){return e.message})),c=o.join("-----------------------\n");throw new Error("Errors detected in definition of Lexer:\n"+c)}(0,a.Ed)(r.lexerDefinitionWarning,(function(e){(0,a.rr)(e.message)})),r.TRACE_INIT("Choosing sub-methods implementations",(function(){if(w?(r.chopInput=a.Wd,r.match=r.matchWithTest):(r.updateLastIndex=a.dG,r.match=r.matchWithExec),s&&(r.handleModes=a.dG),!1===r.trackStartLines&&(r.computeNewColumn=a.Wd),!1===r.trackEndLines&&(r.updateTokenEndLineColumnLocation=a.dG),/full/i.test(r.config.positionTracking))r.createTokenInstance=r.createFullToken;else if(/onlyStart/i.test(r.config.positionTracking))r.createTokenInstance=r.createStartOnlyToken;else{if(!/onlyOffset/i.test(r.config.positionTracking))throw Error('Invalid <positionTracking> config option: "'+r.config.positionTracking+'"');r.createTokenInstance=r.createOffsetOnlyToken}r.hasCustom?(r.addToken=r.addTokenUsingPush,r.handlePayload=r.handlePayloadWithCustom):(r.addToken=r.addTokenUsingMemberAccess,r.handlePayload=r.handlePayloadNoCustom)})),r.TRACE_INIT("Failed Optimization Warnings",(function(){var e=(0,a.u4)(r.canModeBeOptimized,(function(e,t,r){return!1===t&&e.push(r),e}),[]);if(t.ensureOptimizations&&!(0,a.xb)(e))throw Error("Lexer Modes: < "+e.join(", ")+' > cannot be optimized.\n\t Disable the "ensureOptimizations" lexer config flag to silently ignore this and run the lexer in an un-optimized mode.\n\t Or inspect the console log for details on how to resolve these issues.')})),r.TRACE_INIT("clearRegExpParserCache",(function(){l()})),r.TRACE_INIT("toFastProperties",(function(){(0,a.SV)(r)}))}))}return e.prototype.tokenize=function(e,t){if(void 0===t&&(t=this.defaultMode),!(0,a.xb)(this.lexerDefinitionErrors)){var r=(0,a.UI)(this.lexerDefinitionErrors,(function(e){return e.message})),n=r.join("-----------------------\n");throw new Error("Unable to Tokenize because Errors detected in definition of Lexer:\n"+n)}var s=this.tokenizeInternal(e,t);return s},e.prototype.tokenizeInternal=function(e,t){var r,n,s,i,o,c,l,u,h,f,d,p,m,g,E=this,v=e,T=v.length,S=0,A=0,R=this.hasCustom?0:Math.floor(e.length/10),y=new Array(R),N=[],w=this.trackStartLines?1:void 0,b=this.trackStartLines?1:void 0,C=j(this.emptyGroups),O=this.trackStartLines,I=this.config.lineTerminatorsPattern,M=0,D=[],L=[],k=[],_=[];Object.freeze(_);var U=void 0;function x(){return D}function F(e){var t=re(e),r=L[t];return void 0===r?_:r}var P,B=function(e){if(1===k.length&&void 0===e.tokenType.PUSH_MODE){var t=E.config.errorMessageProvider.buildUnableToPopLexerModeMessage(e);N.push({offset:e.startOffset,line:void 0!==e.startLine?e.startLine:void 0,column:void 0!==e.startColumn?e.startColumn:void 0,length:e.image.length,message:t})}else{k.pop();var r=(0,a.Z$)(k);D=E.patternIdxToConfig[r],L=E.charCodeToPatternIdxToConfig[r],M=D.length;var n=E.canModeBeOptimized[r]&&!1===E.config.safeMode;U=L&&n?F:x}};function Y(e){k.push(e),L=this.charCodeToPatternIdxToConfig[e],D=this.patternIdxToConfig[e],M=D.length,M=D.length;var t=this.canModeBeOptimized[e]&&!1===this.config.safeMode;U=L&&t?F:x}Y.call(this,t);while(S<T){o=null;var V=v.charCodeAt(S),W=U(V),G=W.length;for(r=0;r<G;r++){P=W[r];var H=P.pattern;c=null;var z=P.short;if(!1!==z?V===z&&(o=H):!0===P.isCustom?(g=H.exec(v,S,y,C),null!==g?(o=g[0],void 0!==g.payload&&(c=g.payload)):o=null):(this.updateLastIndex(H,S),o=this.match(H,e,S)),null!==o){if(i=P.longerAlt,void 0!==i){var $=D[i],X=$.pattern;l=null,!0===$.isCustom?(g=X.exec(v,S,y,C),null!==g?(s=g[0],void 0!==g.payload&&(l=g.payload)):s=null):(this.updateLastIndex(X,S),s=this.match(X,e,S)),s&&s.length>o.length&&(o=s,c=l,P=$)}break}}if(null!==o){if(u=o.length,h=P.group,void 0!==h&&(f=P.tokenTypeIdx,d=this.createTokenInstance(o,S,f,P.tokenType,w,b,u),this.handlePayload(d,c),!1===h?A=this.addToken(y,A,d):C[h].push(d)),e=this.chopInput(e,u),S+=u,b=this.computeNewColumn(b,u),!0===O&&!0===P.canLineTerminator){var K=0,q=void 0,J=void 0;I.lastIndex=0;do{q=I.test(o),!0===q&&(J=I.lastIndex-1,K++)}while(!0===q);0!==K&&(w+=K,b=u-J,this.updateTokenEndLineColumnLocation(d,h,J,K,w,b,u))}this.handleModes(P,B,Y,d)}else{var Q=S,Z=w,ee=b,te=!1;while(!te&&S<T)for(v.charCodeAt(S),e=this.chopInput(e,1),S++,n=0;n<M;n++){var ne=D[n];H=ne.pattern,z=ne.short;if(!1!==z?v.charCodeAt(S)===z&&(te=!0):!0===ne.isCustom?te=null!==H.exec(v,S,y,C):(this.updateLastIndex(H,S),te=null!==H.exec(e)),!0===te)break}p=S-Q,m=this.config.errorMessageProvider.buildUnexpectedCharactersMessage(v,Q,p,Z,ee),N.push({offset:Q,line:Z,column:ee,length:p,message:m})}}return this.hasCustom||(y.length=A),{tokens:y,groups:C,errors:N}},e.prototype.handleModes=function(e,t,r,n){if(!0===e.pop){var a=e.push;t(n),void 0!==a&&r.call(this,a)}else void 0!==e.push&&r.call(this,e.push)},e.prototype.chopInput=function(e,t){return e.substring(t)},e.prototype.updateLastIndex=function(e,t){e.lastIndex=t},e.prototype.updateTokenEndLineColumnLocation=function(e,t,r,n,a,s,i){var o,c;void 0!==t&&(o=r===i-1,c=o?-1:0,1===n&&!0===o||(e.endLine=a+c,e.endColumn=s-1-c))},e.prototype.computeNewColumn=function(e,t){return e+t},e.prototype.createTokenInstance=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return null},e.prototype.createOffsetOnlyToken=function(e,t,r,n){return{image:e,startOffset:t,tokenTypeIdx:r,tokenType:n}},e.prototype.createStartOnlyToken=function(e,t,r,n,a,s){return{image:e,startOffset:t,startLine:a,startColumn:s,tokenTypeIdx:r,tokenType:n}},e.prototype.createFullToken=function(e,t,r,n,a,s,i){return{image:e,startOffset:t,endOffset:t+i-1,startLine:a,endLine:a,startColumn:s,endColumn:s+i-1,tokenTypeIdx:r,tokenType:n}},e.prototype.addToken=function(e,t,r){return 666},e.prototype.addTokenUsingPush=function(e,t,r){return e.push(r),t},e.prototype.addTokenUsingMemberAccess=function(e,t,r){return e[t]=r,t++,t},e.prototype.handlePayload=function(e,t){},e.prototype.handlePayloadNoCustom=function(e,t){},e.prototype.handlePayloadWithCustom=function(e,t){null!==t&&(e.payload=t)},e.prototype.match=function(e,t,r){return null},e.prototype.matchWithTest=function(e,t,r){var n=e.test(t);return!0===n?t.substring(r,e.lastIndex):null},e.prototype.matchWithExec=function(e,t){var r=e.exec(t);return null!==r?r[0]:r},e.prototype.TRACE_INIT=function(e,t){if(!0===this.traceInitPerf){this.traceInitIndent++;var r=new Array(this.traceInitIndent+1).join("\t");this.traceInitIndent<this.traceInitMaxIdent&&console.log(r+"--\x3e <"+e+">");var n=(0,a.HT)(t),s=n.time,i=n.value,o=s>10?console.warn:console.log;return this.traceInitIndent<this.traceInitMaxIdent&&o(r+"<-- <"+e+"> time: "+s+"ms"),this.traceInitIndent--,i}return t()},e.SKIPPED="This marks a skipped Token pattern, this means each token identified by it willbe consumed and then thrown into oblivion, this can be used to for example to completely ignore whitespace.",e.NA=/NOT_APPLICABLE/,e}();function Ne(e){return be(e)?e.LABEL:e.name}function we(e){return e.name}function be(e){return(0,a.HD)(e.LABEL)&&""!==e.LABEL}var Ce="parent",Oe="categories",Ie="label",Me="group",De="push_mode",Le="pop_mode",ke="longer_alt",_e="line_breaks",Ue="start_chars_hint";function xe(e){return Fe(e)}function Fe(e){var t=e.pattern,r={};if(r.name=e.name,(0,a.o8)(t)||(r.PATTERN=t),(0,a.e$)(e,Ce))throw"The parent property is no longer supported.\nSee: https://github.com/SAP/chevrotain/issues/564#issuecomment-349062346 for details.";return(0,a.e$)(e,Oe)&&(r.CATEGORIES=e[Oe]),le([r]),(0,a.e$)(e,Ie)&&(r.LABEL=e[Ie]),(0,a.e$)(e,Me)&&(r.GROUP=e[Me]),(0,a.e$)(e,Le)&&(r.POP_MODE=e[Le]),(0,a.e$)(e,De)&&(r.PUSH_MODE=e[De]),(0,a.e$)(e,ke)&&(r.LONGER_ALT=e[ke]),(0,a.e$)(e,_e)&&(r.LINE_BREAKS=e[_e]),(0,a.e$)(e,Ue)&&(r.START_CHARS_HINT=e[Ue]),r}var Pe=xe({name:"EOF",pattern:ye.NA});function Be(e,t,r,n,a,s,i,o){return{image:t,startOffset:r,endOffset:n,startLine:a,endLine:s,startColumn:i,endColumn:o,tokenTypeIdx:e.tokenTypeIdx,tokenType:e}}function Ye(e,t){return se(e,t)}le([Pe]);var Ve=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},e(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),We=function(){function e(e){this.definition=e}return e.prototype.accept=function(e){e.visit(this),(0,a.Ed)(this.definition,(function(t){t.accept(e)}))},e}(),Ge=function(e){function t(t){var r=e.call(this,[])||this;return r.idx=1,(0,a.f0)(r,(0,a.ei)(t,(function(e){return void 0!==e}))),r}return Ve(t,e),Object.defineProperty(t.prototype,"definition",{get:function(){return void 0!==this.referencedRule?this.referencedRule.definition:[]},set:function(e){},enumerable:!0,configurable:!0}),t.prototype.accept=function(e){e.visit(this)},t}(We),He=function(e){function t(t){var r=e.call(this,t.definition)||this;return r.orgText="",(0,a.f0)(r,(0,a.ei)(t,(function(e){return void 0!==e}))),r}return Ve(t,e),t}(We),ze=function(e){function t(t){var r=e.call(this,t.definition)||this;return r.ignoreAmbiguities=!1,(0,a.f0)(r,(0,a.ei)(t,(function(e){return void 0!==e}))),r}return Ve(t,e),t}(We),$e=function(e){function t(t){var r=e.call(this,t.definition)||this;return r.idx=1,(0,a.f0)(r,(0,a.ei)(t,(function(e){return void 0!==e}))),r}return Ve(t,e),t}(We),je=function(e){function t(t){var r=e.call(this,t.definition)||this;return r.idx=1,(0,a.f0)(r,(0,a.ei)(t,(function(e){return void 0!==e}))),r}return Ve(t,e),t}(We),Xe=function(e){function t(t){var r=e.call(this,t.definition)||this;return r.idx=1,(0,a.f0)(r,(0,a.ei)(t,(function(e){return void 0!==e}))),r}return Ve(t,e),t}(We),Ke=function(e){function t(t){var r=e.call(this,t.definition)||this;return r.idx=1,(0,a.f0)(r,(0,a.ei)(t,(function(e){return void 0!==e}))),r}return Ve(t,e),t}(We),qe=function(e){function t(t){var r=e.call(this,t.definition)||this;return r.idx=1,(0,a.f0)(r,(0,a.ei)(t,(function(e){return void 0!==e}))),r}return Ve(t,e),t}(We),Je=function(e){function t(t){var r=e.call(this,t.definition)||this;return r.idx=1,r.ignoreAmbiguities=!1,r.hasPredicates=!1,(0,a.f0)(r,(0,a.ei)(t,(function(e){return void 0!==e}))),r}return Ve(t,e),t}(We),Qe=function(){function e(e){this.idx=1,(0,a.f0)(this,(0,a.ei)(e,(function(e){return void 0!==e})))}return e.prototype.accept=function(e){e.visit(this)},e}();function Ze(e){return(0,a.UI)(e,et)}function et(e){function t(e){return(0,a.UI)(e,et)}if(e instanceof Ge)return{type:"NonTerminal",name:e.nonTerminalName,idx:e.idx};if(e instanceof ze)return{type:"Flat",definition:t(e.definition)};if(e instanceof $e)return{type:"Option",idx:e.idx,definition:t(e.definition)};if(e instanceof je)return{type:"RepetitionMandatory",name:e.name,idx:e.idx,definition:t(e.definition)};if(e instanceof Xe)return{type:"RepetitionMandatoryWithSeparator",name:e.name,idx:e.idx,separator:et(new Qe({terminalType:e.separator})),definition:t(e.definition)};if(e instanceof qe)return{type:"RepetitionWithSeparator",name:e.name,idx:e.idx,separator:et(new Qe({terminalType:e.separator})),definition:t(e.definition)};if(e instanceof Ke)return{type:"Repetition",name:e.name,idx:e.idx,definition:t(e.definition)};if(e instanceof Je)return{type:"Alternation",name:e.name,idx:e.idx,definition:t(e.definition)};if(e instanceof Qe){var r={type:"Terminal",name:e.terminalType.name,label:Ne(e.terminalType),idx:e.idx},n=e.terminalType.PATTERN;return e.terminalType.PATTERN&&(r.pattern=(0,a.Kj)(n)?n.source:n),r}if(e instanceof He)return{type:"Rule",name:e.name,orgText:e.orgText,definition:t(e.definition)};throw Error("non exhaustive match")}var tt=function(){function e(){}return e.prototype.walk=function(e,t){var r=this;void 0===t&&(t=[]),(0,a.Ed)(e.definition,(function(n,s){var i=(0,a.Cw)(e.definition,s+1);if(n instanceof Ge)r.walkProdRef(n,i,t);else if(n instanceof Qe)r.walkTerminal(n,i,t);else if(n instanceof ze)r.walkFlat(n,i,t);else if(n instanceof $e)r.walkOption(n,i,t);else if(n instanceof je)r.walkAtLeastOne(n,i,t);else if(n instanceof Xe)r.walkAtLeastOneSep(n,i,t);else if(n instanceof qe)r.walkManySep(n,i,t);else if(n instanceof Ke)r.walkMany(n,i,t);else{if(!(n instanceof Je))throw Error("non exhaustive match");r.walkOr(n,i,t)}}))},e.prototype.walkTerminal=function(e,t,r){},e.prototype.walkProdRef=function(e,t,r){},e.prototype.walkFlat=function(e,t,r){var n=t.concat(r);this.walk(e,n)},e.prototype.walkOption=function(e,t,r){var n=t.concat(r);this.walk(e,n)},e.prototype.walkAtLeastOne=function(e,t,r){var n=[new $e({definition:e.definition})].concat(t,r);this.walk(e,n)},e.prototype.walkAtLeastOneSep=function(e,t,r){var n=rt(e,t,r);this.walk(e,n)},e.prototype.walkMany=function(e,t,r){var n=[new $e({definition:e.definition})].concat(t,r);this.walk(e,n)},e.prototype.walkManySep=function(e,t,r){var n=rt(e,t,r);this.walk(e,n)},e.prototype.walkOr=function(e,t,r){var n=this,s=t.concat(r);(0,a.Ed)(e.definition,(function(e){var t=new ze({definition:[e]});n.walk(t,s)}))},e}();function rt(e,t,r){var n=[new $e({definition:[new Qe({terminalType:e.separator})].concat(e.definition)})],a=n.concat(t,r);return a}var nt=function(){function e(){}return e.prototype.visit=function(e){var t=e;switch(t.constructor){case Ge:return this.visitNonTerminal(t);case ze:return this.visitFlat(t);case $e:return this.visitOption(t);case je:return this.visitRepetitionMandatory(t);case Xe:return this.visitRepetitionMandatoryWithSeparator(t);case qe:return this.visitRepetitionWithSeparator(t);case Ke:return this.visitRepetition(t);case Je:return this.visitAlternation(t);case Qe:return this.visitTerminal(t);case He:return this.visitRule(t);default:throw Error("non exhaustive match")}},e.prototype.visitNonTerminal=function(e){},e.prototype.visitFlat=function(e){},e.prototype.visitOption=function(e){},e.prototype.visitRepetition=function(e){},e.prototype.visitRepetitionMandatory=function(e){},e.prototype.visitRepetitionMandatoryWithSeparator=function(e){},e.prototype.visitRepetitionWithSeparator=function(e){},e.prototype.visitAlternation=function(e){},e.prototype.visitTerminal=function(e){},e.prototype.visitRule=function(e){},e}(),at=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},e(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();function st(e){return e instanceof ze||e instanceof $e||e instanceof Ke||e instanceof je||e instanceof Xe||e instanceof qe||e instanceof Qe||e instanceof He}function it(e,t){void 0===t&&(t=[]);var r=e instanceof $e||e instanceof Ke||e instanceof qe;return!!r||(e instanceof Je?(0,a.G)(e.definition,(function(e){return it(e,t)})):!(e instanceof Ge&&(0,a.r3)(t,e))&&(e instanceof We&&(e instanceof Ge&&t.push(e),(0,a.yW)(e.definition,(function(e){return it(e,t)})))))}function ot(e){return e instanceof Je}function ct(e){if(e instanceof Ge)return"SUBRULE";if(e instanceof $e)return"OPTION";if(e instanceof Je)return"OR";if(e instanceof je)return"AT_LEAST_ONE";if(e instanceof Xe)return"AT_LEAST_ONE_SEP";if(e instanceof qe)return"MANY_SEP";if(e instanceof Ke)return"MANY";if(e instanceof Qe)return"CONSUME";throw Error("non exhaustive match")}var lt=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.separator="-",t.dslMethods={option:[],alternation:[],repetition:[],repetitionWithSeparator:[],repetitionMandatory:[],repetitionMandatoryWithSeparator:[]},t}return at(t,e),t.prototype.reset=function(){this.dslMethods={option:[],alternation:[],repetition:[],repetitionWithSeparator:[],repetitionMandatory:[],repetitionMandatoryWithSeparator:[]}},t.prototype.visitTerminal=function(e){var t=e.terminalType.name+this.separator+"Terminal";(0,a.e$)(this.dslMethods,t)||(this.dslMethods[t]=[]),this.dslMethods[t].push(e)},t.prototype.visitNonTerminal=function(e){var t=e.nonTerminalName+this.separator+"Terminal";(0,a.e$)(this.dslMethods,t)||(this.dslMethods[t]=[]),this.dslMethods[t].push(e)},t.prototype.visitOption=function(e){this.dslMethods.option.push(e)},t.prototype.visitRepetitionWithSeparator=function(e){this.dslMethods.repetitionWithSeparator.push(e)},t.prototype.visitRepetitionMandatory=function(e){this.dslMethods.repetitionMandatory.push(e)},t.prototype.visitRepetitionMandatoryWithSeparator=function(e){this.dslMethods.repetitionMandatoryWithSeparator.push(e)},t.prototype.visitRepetition=function(e){this.dslMethods.repetition.push(e)},t.prototype.visitAlternation=function(e){this.dslMethods.alternation.push(e)},t}(nt),ut=new lt;function ht(e){ut.reset(),e.accept(ut);var t=ut.dslMethods;return ut.reset(),t}function ft(e){if(e instanceof Ge)return ft(e.referencedRule);if(e instanceof Qe)return mt(e);if(st(e))return dt(e);if(ot(e))return pt(e);throw Error("non exhaustive match")}function dt(e){var t,r=[],n=e.definition,s=0,i=n.length>s,o=!0;while(i&&o)t=n[s],o=it(t),r=r.concat(ft(t)),s+=1,i=n.length>s;return(0,a.jj)(r)}function pt(e){var t=(0,a.UI)(e.definition,(function(e){return ft(e)}));return(0,a.jj)((0,a.xH)(t))}function mt(e){return[e.terminalType]}var gt="_~IN~_",Et=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},e(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),vt=function(e){function t(t){var r=e.call(this)||this;return r.topProd=t,r.follows={},r}return Et(t,e),t.prototype.startWalking=function(){return this.walk(this.topProd),this.follows},t.prototype.walkTerminal=function(e,t,r){},t.prototype.walkProdRef=function(e,t,r){var n=St(e.referencedRule,e.idx)+this.topProd.name,a=t.concat(r),s=new ze({definition:a}),i=ft(s);this.follows[n]=i},t}(tt);function Tt(e){var t={};return(0,a.Ed)(e,(function(e){var r=new vt(e).startWalking();(0,a.f0)(t,r)})),t}function St(e,t){return e.name+t+gt}var At=4,Rt=8,yt=8,Nt=1<<Rt,wt=2<<Rt,bt=3<<Rt,Ct=4<<Rt,Ot=5<<Rt,It=6<<Rt;function Mt(e,t,r){return r|t|e}var Dt=32-yt;function Lt(e,t,r,n){var a=n+1<<Dt;return Mt(e,t,r)|a}var kt=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},e(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();function _t(e,t){!0===isNaN(e.startOffset)?(e.startOffset=t.startOffset,e.endOffset=t.endOffset):e.endOffset<t.endOffset===!0&&(e.endOffset=t.endOffset)}function Ut(e,t){!0===isNaN(e.startOffset)?(e.startOffset=t.startOffset,e.startColumn=t.startColumn,e.startLine=t.startLine,e.endOffset=t.endOffset,e.endColumn=t.endColumn,e.endLine=t.endLine):e.endOffset<t.endOffset===!0&&(e.endOffset=t.endOffset,e.endColumn=t.endColumn,e.endLine=t.endLine)}function xt(e,t,r){void 0===e.children[r]?e.children[r]=[t]:e.children[r].push(t)}function Ft(e,t,r){void 0===e.children[t]?e.children[t]=[r]:e.children[t].push(r)}var Pt=function(e){function t(t){var r=e.call(this)||this;return r.result=[],r.ruleIdx=t,r}return kt(t,e),t.prototype.collectNamedDSLMethod=function(e,t,r){if(!(0,a.o8)(e.name)){var n=void 0;if(e instanceof $e||e instanceof Ke||e instanceof je||e instanceof Je)n=new t({definition:e.definition,idx:e.idx});else{if(!(e instanceof Xe||e instanceof qe))throw Error("non exhaustive match");n=new t({definition:e.definition,idx:e.idx,separator:e.separator})}var s=[n],i=Mt(this.ruleIdx,r,e.idx);this.result.push({def:s,key:i,name:e.name,orgProd:e})}},t.prototype.visitOption=function(e){this.collectNamedDSLMethod(e,$e,wt)},t.prototype.visitRepetition=function(e){this.collectNamedDSLMethod(e,Ke,bt)},t.prototype.visitRepetitionMandatory=function(e){this.collectNamedDSLMethod(e,je,Ct)},t.prototype.visitRepetitionMandatoryWithSeparator=function(e){this.collectNamedDSLMethod(e,Xe,It)},t.prototype.visitRepetitionWithSeparator=function(e){this.collectNamedDSLMethod(e,qe,Ot)},t.prototype.visitAlternation=function(e){var t=this;this.collectNamedDSLMethod(e,Je,Nt);var r=e.definition.length>1;(0,a.Ed)(e.definition,(function(n,s){if(!(0,a.o8)(n.name)){var i=n.definition;i=r?[new $e({definition:n.definition})]:n.definition;var o=Lt(t.ruleIdx,Nt,e.idx,s);t.result.push({def:i,key:o,name:n.name,orgProd:n})}}))},t}(nt);function Bt(e,t){var r={allRuleNames:[]};return(0,a.Ed)(e,(function(e){var n=t[e.name];r.allRuleNames.push(e.name);var s=new Pt(n);e.accept(s),(0,a.Ed)(s.result,(function(t){t.def,t.key;var n=t.name;r.allRuleNames.push(e.name+n)}))})),r}var Yt=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},e(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),Vt=function(e){function t(t,r){var n=e.call(this)||this;return n.topProd=t,n.path=r,n.possibleTokTypes=[],n.nextProductionName="",n.nextProductionOccurrence=0,n.found=!1,n.isAtEndOfPath=!1,n}return Yt(t,e),t.prototype.startWalking=function(){if(this.found=!1,this.path.ruleStack[0]!==this.topProd.name)throw Error("The path does not start with the walker's top Rule!");return this.ruleStack=(0,a.Qw)(this.path.ruleStack).reverse(),this.occurrenceStack=(0,a.Qw)(this.path.occurrenceStack).reverse(),this.ruleStack.pop(),this.occurrenceStack.pop(),this.updateExpectedNext(),this.walk(this.topProd),this.possibleTokTypes},t.prototype.walk=function(t,r){void 0===r&&(r=[]),this.found||e.prototype.walk.call(this,t,r)},t.prototype.walkProdRef=function(e,t,r){if(e.referencedRule.name===this.nextProductionName&&e.idx===this.nextProductionOccurrence){var n=t.concat(r);this.updateExpectedNext(),this.walk(e.referencedRule,n)}},t.prototype.updateExpectedNext=function(){(0,a.xb)(this.ruleStack)?(this.nextProductionName="",this.nextProductionOccurrence=0,this.isAtEndOfPath=!0):(this.nextProductionName=this.ruleStack.pop(),this.nextProductionOccurrence=this.occurrenceStack.pop())},t}(tt),Wt=function(e){function t(t,r){var n=e.call(this,t,r)||this;return n.path=r,n.nextTerminalName="",n.nextTerminalOccurrence=0,n.nextTerminalName=n.path.lastTok.name,n.nextTerminalOccurrence=n.path.lastTokOccurrence,n}return Yt(t,e),t.prototype.walkTerminal=function(e,t,r){if(this.isAtEndOfPath&&e.terminalType.name===this.nextTerminalName&&e.idx===this.nextTerminalOccurrence&&!this.found){var n=t.concat(r),a=new ze({definition:n});this.possibleTokTypes=ft(a),this.found=!0}},t}(Vt),Gt=function(e){function t(t,r){var n=e.call(this)||this;return n.topRule=t,n.occurrence=r,n.result={token:void 0,occurrence:void 0,isEndOfRule:void 0},n}return Yt(t,e),t.prototype.startWalking=function(){return this.walk(this.topRule),this.result},t}(tt),Ht=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Yt(t,e),t.prototype.walkMany=function(t,r,n){if(t.idx===this.occurrence){var s=(0,a.Ps)(r.concat(n));this.result.isEndOfRule=void 0===s,s instanceof Qe&&(this.result.token=s.terminalType,this.result.occurrence=s.idx)}else e.prototype.walkMany.call(this,t,r,n)},t}(Gt),zt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Yt(t,e),t.prototype.walkManySep=function(t,r,n){if(t.idx===this.occurrence){var s=(0,a.Ps)(r.concat(n));this.result.isEndOfRule=void 0===s,s instanceof Qe&&(this.result.token=s.terminalType,this.result.occurrence=s.idx)}else e.prototype.walkManySep.call(this,t,r,n)},t}(Gt),$t=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Yt(t,e),t.prototype.walkAtLeastOne=function(t,r,n){if(t.idx===this.occurrence){var s=(0,a.Ps)(r.concat(n));this.result.isEndOfRule=void 0===s,s instanceof Qe&&(this.result.token=s.terminalType,this.result.occurrence=s.idx)}else e.prototype.walkAtLeastOne.call(this,t,r,n)},t}(Gt),jt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Yt(t,e),t.prototype.walkAtLeastOneSep=function(t,r,n){if(t.idx===this.occurrence){var s=(0,a.Ps)(r.concat(n));this.result.isEndOfRule=void 0===s,s instanceof Qe&&(this.result.token=s.terminalType,this.result.occurrence=s.idx)}else e.prototype.walkAtLeastOneSep.call(this,t,r,n)},t}(Gt);function Xt(e,t,r){void 0===r&&(r=[]),r=(0,a.Qw)(r);var n=[],s=0;function i(t){return t.concat((0,a.Cw)(e,s+1))}function o(e){var a=Xt(i(e),t,r);return n.concat(a)}while(r.length<t&&s<e.length){var c=e[s];if(c instanceof ze)return o(c.definition);if(c instanceof Ge)return o(c.definition);if(c instanceof $e)n=o(c.definition);else{if(c instanceof je){var l=c.definition.concat([new Ke({definition:c.definition})]);return o(l)}if(c instanceof Xe){l=[new ze({definition:c.definition}),new Ke({definition:[new Qe({terminalType:c.separator})].concat(c.definition)})];return o(l)}if(c instanceof qe){l=c.definition.concat([new Ke({definition:[new Qe({terminalType:c.separator})].concat(c.definition)})]);n=o(l)}else if(c instanceof Ke){l=c.definition.concat([new Ke({definition:c.definition})]);n=o(l)}else{if(c instanceof Je)return(0,a.Ed)(c.definition,(function(e){n=o(e.definition)})),n;if(!(c instanceof Qe))throw Error("non exhaustive match");r.push(c.terminalType)}}s++}return n.push({partialPath:r,suffixDef:(0,a.Cw)(e,s)}),n}function Kt(e,t,r,n){var s="EXIT_NONE_TERMINAL",i=[s],o="EXIT_ALTERNATIVE",c=!1,l=t.length,u=l-n-1,h=[],f=[];f.push({idx:-1,def:e,ruleStack:[],occurrenceStack:[]});while(!(0,a.xb)(f)){var d=f.pop();if(d!==o){var p=d.def,m=d.idx,g=d.ruleStack,E=d.occurrenceStack;if(!(0,a.xb)(p)){var v=p[0];if(v===s){var T={idx:m,def:(0,a.Cw)(p),ruleStack:(0,a.j7)(g),occurrenceStack:(0,a.j7)(E)};f.push(T)}else if(v instanceof Qe)if(m<l-1){var S=m+1,A=t[S];if(r(A,v.terminalType)){T={idx:S,def:(0,a.Cw)(p),ruleStack:g,occurrenceStack:E};f.push(T)}}else{if(m!==l-1)throw Error("non exhaustive match");h.push({nextTokenType:v.terminalType,nextTokenOccurrence:v.idx,ruleStack:g,occurrenceStack:E}),c=!0}else if(v instanceof Ge){var R=(0,a.Qw)(g);R.push(v.nonTerminalName);var y=(0,a.Qw)(E);y.push(v.idx);T={idx:m,def:v.definition.concat(i,(0,a.Cw)(p)),ruleStack:R,occurrenceStack:y};f.push(T)}else if(v instanceof $e){var N={idx:m,def:(0,a.Cw)(p),ruleStack:g,occurrenceStack:E};f.push(N),f.push(o);var w={idx:m,def:v.definition.concat((0,a.Cw)(p)),ruleStack:g,occurrenceStack:E};f.push(w)}else if(v instanceof je){var b=new Ke({definition:v.definition,idx:v.idx}),C=v.definition.concat([b],(0,a.Cw)(p));T={idx:m,def:C,ruleStack:g,occurrenceStack:E};f.push(T)}else if(v instanceof Xe){var O=new Qe({terminalType:v.separator});b=new Ke({definition:[O].concat(v.definition),idx:v.idx}),C=v.definition.concat([b],(0,a.Cw)(p)),T={idx:m,def:C,ruleStack:g,occurrenceStack:E};f.push(T)}else if(v instanceof qe){N={idx:m,def:(0,a.Cw)(p),ruleStack:g,occurrenceStack:E};f.push(N),f.push(o);O=new Qe({terminalType:v.separator});var I=new Ke({definition:[O].concat(v.definition),idx:v.idx});C=v.definition.concat([I],(0,a.Cw)(p)),w={idx:m,def:C,ruleStack:g,occurrenceStack:E};f.push(w)}else if(v instanceof Ke){N={idx:m,def:(0,a.Cw)(p),ruleStack:g,occurrenceStack:E};f.push(N),f.push(o);I=new Ke({definition:v.definition,idx:v.idx}),C=v.definition.concat([I],(0,a.Cw)(p)),w={idx:m,def:C,ruleStack:g,occurrenceStack:E};f.push(w)}else if(v instanceof Je)for(var M=v.definition.length-1;M>=0;M--){var D=v.definition[M],L={idx:m,def:D.definition.concat((0,a.Cw)(p)),ruleStack:g,occurrenceStack:E};f.push(L),f.push(o)}else if(v instanceof ze)f.push({idx:m,def:v.definition.concat((0,a.Cw)(p)),ruleStack:g,occurrenceStack:E});else{if(!(v instanceof He))throw Error("non exhaustive match");f.push(qt(v,m,g,E))}}}else c&&(0,a.Z$)(f).idx<=u&&f.pop()}return h}function qt(e,t,r,n){var s=(0,a.Qw)(r);s.push(e.name);var i=(0,a.Qw)(n);return i.push(1),{idx:t,def:e.definition,ruleStack:s,occurrenceStack:i}}var Jt,Qt=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},e(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();function Zt(e){if(e instanceof $e)return Jt.OPTION;if(e instanceof Ke)return Jt.REPETITION;if(e instanceof je)return Jt.REPETITION_MANDATORY;if(e instanceof Xe)return Jt.REPETITION_MANDATORY_WITH_SEPARATOR;if(e instanceof qe)return Jt.REPETITION_WITH_SEPARATOR;if(e instanceof Je)return Jt.ALTERNATION;throw Error("non exhaustive match")}function er(e,t,r,n,a,s){var i=ur(e,t,r),o=pr(i)?ie:se;return s(i,n,o,a)}function tr(e,t,r,n,a,s){var i=hr(e,t,a,r),o=pr(i)?ie:se;return s(i[0],o,n)}function rr(e,t,r,n){var s=e.length,i=(0,a.yW)(e,(function(e){return(0,a.yW)(e,(function(e){return 1===e.length}))}));if(t)return function(t){for(var n=(0,a.UI)(t,(function(e){return e.GATE})),i=0;i<s;i++){var o=e[i],c=o.length,l=n[i];if(void 0===l||!1!==l.call(this))e:for(var u=0;u<c;u++){for(var h=o[u],f=h.length,d=0;d<f;d++){var p=this.LA(d+1);if(!1===r(p,h[d]))continue e}return i}}};if(i&&!n){var o=(0,a.UI)(e,(function(e){return(0,a.xH)(e)})),c=(0,a.u4)(o,(function(e,t,r){return(0,a.Ed)(t,(function(t){(0,a.e$)(e,t.tokenTypeIdx)||(e[t.tokenTypeIdx]=r),(0,a.Ed)(t.categoryMatches,(function(t){(0,a.e$)(e,t)||(e[t]=r)}))})),e}),[]);return function(){var e=this.LA(1);return c[e.tokenTypeIdx]}}return function(){for(var t=0;t<s;t++){var n=e[t],a=n.length;e:for(var i=0;i<a;i++){for(var o=n[i],c=o.length,l=0;l<c;l++){var u=this.LA(l+1);if(!1===r(u,o[l]))continue e}return t}}}}function nr(e,t,r){var n=(0,a.yW)(e,(function(e){return 1===e.length})),s=e.length;if(n&&!r){var i=(0,a.xH)(e);if(1===i.length&&(0,a.xb)(i[0].categoryMatches)){var o=i[0],c=o.tokenTypeIdx;return function(){return this.LA(1).tokenTypeIdx===c}}var l=(0,a.u4)(i,(function(e,t,r){return e[t.tokenTypeIdx]=!0,(0,a.Ed)(t.categoryMatches,(function(t){e[t]=!0})),e}),[]);return function(){var e=this.LA(1);return!0===l[e.tokenTypeIdx]}}return function(){e:for(var r=0;r<s;r++){for(var n=e[r],a=n.length,i=0;i<a;i++){var o=this.LA(i+1);if(!1===t(o,n[i]))continue e}return!0}return!1}}(function(e){e[e["OPTION"]=0]="OPTION",e[e["REPETITION"]=1]="REPETITION",e[e["REPETITION_MANDATORY"]=2]="REPETITION_MANDATORY",e[e["REPETITION_MANDATORY_WITH_SEPARATOR"]=3]="REPETITION_MANDATORY_WITH_SEPARATOR",e[e["REPETITION_WITH_SEPARATOR"]=4]="REPETITION_WITH_SEPARATOR",e[e["ALTERNATION"]=5]="ALTERNATION"})(Jt||(Jt={}));var ar=function(e){function t(t,r,n){var a=e.call(this)||this;return a.topProd=t,a.targetOccurrence=r,a.targetProdType=n,a}return Qt(t,e),t.prototype.startWalking=function(){return this.walk(this.topProd),this.restDef},t.prototype.checkIsTarget=function(e,t,r,n){return e.idx===this.targetOccurrence&&this.targetProdType===t&&(this.restDef=r.concat(n),!0)},t.prototype.walkOption=function(t,r,n){this.checkIsTarget(t,Jt.OPTION,r,n)||e.prototype.walkOption.call(this,t,r,n)},t.prototype.walkAtLeastOne=function(t,r,n){this.checkIsTarget(t,Jt.REPETITION_MANDATORY,r,n)||e.prototype.walkOption.call(this,t,r,n)},t.prototype.walkAtLeastOneSep=function(t,r,n){this.checkIsTarget(t,Jt.REPETITION_MANDATORY_WITH_SEPARATOR,r,n)||e.prototype.walkOption.call(this,t,r,n)},t.prototype.walkMany=function(t,r,n){this.checkIsTarget(t,Jt.REPETITION,r,n)||e.prototype.walkOption.call(this,t,r,n)},t.prototype.walkManySep=function(t,r,n){this.checkIsTarget(t,Jt.REPETITION_WITH_SEPARATOR,r,n)||e.prototype.walkOption.call(this,t,r,n)},t}(tt),sr=function(e){function t(t,r,n){var a=e.call(this)||this;return a.targetOccurrence=t,a.targetProdType=r,a.targetRef=n,a.result=[],a}return Qt(t,e),t.prototype.checkIsTarget=function(e,t){e.idx!==this.targetOccurrence||this.targetProdType!==t||void 0!==this.targetRef&&e!==this.targetRef||(this.result=e.definition)},t.prototype.visitOption=function(e){this.checkIsTarget(e,Jt.OPTION)},t.prototype.visitRepetition=function(e){this.checkIsTarget(e,Jt.REPETITION)},t.prototype.visitRepetitionMandatory=function(e){this.checkIsTarget(e,Jt.REPETITION_MANDATORY)},t.prototype.visitRepetitionMandatoryWithSeparator=function(e){this.checkIsTarget(e,Jt.REPETITION_MANDATORY_WITH_SEPARATOR)},t.prototype.visitRepetitionWithSeparator=function(e){this.checkIsTarget(e,Jt.REPETITION_WITH_SEPARATOR)},t.prototype.visitAlternation=function(e){this.checkIsTarget(e,Jt.ALTERNATION)},t}(nt);function ir(e){for(var t=new Array(e),r=0;r<e;r++)t[r]=[];return t}function or(e){for(var t=[""],r=0;r<e.length;r++){for(var n=e[r],a=[],s=0;s<t.length;s++){var i=t[s];a.push(i+"_"+n.tokenTypeIdx);for(var o=0;o<n.categoryMatches.length;o++){var c="_"+n.categoryMatches[o];a.push(i+c)}}t=a}return t}function cr(e,t,r){for(var n=0;n<e.length;n++)if(n!==r)for(var a=e[n],s=0;s<t.length;s++){var i=t[s];if(!0===a[i])return!1}return!0}function lr(e,t){for(var r=(0,a.UI)(e,(function(e){return Xt([e],1)})),n=ir(r.length),s=(0,a.UI)(r,(function(e){var t={};return(0,a.Ed)(e,(function(e){var r=or(e.partialPath);(0,a.Ed)(r,(function(e){t[e]=!0}))})),t})),i=r,o=1;o<=t;o++){var c=i;i=ir(c.length);for(var l=function(e){for(var r=c[e],l=0;l<r.length;l++){var u=r[l].partialPath,h=r[l].suffixDef,f=or(u),d=cr(s,f,e);if(d||(0,a.xb)(h)||u.length===t){var p=n[e];if(!1===fr(p,u)){p.push(u);for(var m=0;m<f.length;m++){var g=f[m];s[e][g]=!0}}}else{var E=Xt(h,o+1,u);i[e]=i[e].concat(E),(0,a.Ed)(E,(function(t){var r=or(t.partialPath);(0,a.Ed)(r,(function(t){s[e][t]=!0}))}))}}},u=0;u<c.length;u++)l(u)}return n}function ur(e,t,r,n){var a=new sr(e,Jt.ALTERNATION,n);return t.accept(a),lr(a.result,r)}function hr(e,t,r,n){var a=new sr(e,r);t.accept(a);var s=a.result,i=new ar(t,e,r),o=i.startWalking(),c=new ze({definition:s}),l=new ze({definition:o});return lr([c,l],n)}function fr(e,t){e:for(var r=0;r<e.length;r++){var n=e[r];if(n.length===t.length){for(var a=0;a<n.length;a++){var s=t[a],i=n[a],o=s===i||void 0!==i.categoryMatchesMap[s.tokenTypeIdx];if(!1===o)continue e}return!0}}return!1}function dr(e,t){return e.length<t.length&&(0,a.yW)(e,(function(e,r){var n=t[r];return e===n||n.categoryMatchesMap[e.tokenTypeIdx]}))}function pr(e){return(0,a.yW)(e,(function(e){return(0,a.yW)(e,(function(e){return(0,a.yW)(e,(function(e){return(0,a.xb)(e.categoryMatches)}))}))}))}var mr=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},e(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();function gr(e,t,r,n,s,i){var o=a.UI(e,(function(e){return vr(e,s)})),c=a.UI(e,(function(e){return Ir(e,e,s)})),l=[],u=[],h=[];(0,a.yW)(c,a.xb)&&(l=(0,a.UI)(e,(function(e){return Lr(e,s)})),u=(0,a.UI)(e,(function(e){return kr(e,t,n,s)})),h=xr(e,t,s));var f=Br(e,r,s),d=a.UI(r,(function(e){return br(e,s)})),p=Er(e,s),m=Yr(e,s),g=(0,a.UI)(e,(function(e){return Ur(e,s)})),E=(0,a.UI)(e,(function(e){return Nr(e,s)})),v=(0,a.UI)(e,(function(t){return Cr(t,e,i,s)}));return a.xH(o.concat(d,p,m,h,c,l,u,f,g,E,v))}function Er(e,t){var r=[];return(0,a.Ed)(e,(function(e){var n=new Pt("");e.accept(n);var s=(0,a.UI)(n.result,(function(e){return e.orgProd}));r.push((0,a.UI)(s,(function(r){return wr(e,r,t)})))})),(0,a.xH)(r)}function vr(e,t){var r=new Ar;e.accept(r);var n=r.allProductions,s=a.vM(n,Tr),i=a.ei(s,(function(e){return e.length>1})),o=a.UI(a.VO(i),(function(r){var n=a.Ps(r),s=t.buildDuplicateFoundError(e,r),i=ct(n),o={message:s,type:$n.DUPLICATE_PRODUCTIONS,ruleName:e.name,dslName:i,occurrence:n.idx},c=Sr(n);return c&&(o.parameter=c),o}));return o}function Tr(e){return ct(e)+"_#_"+e.idx+"_#_"+Sr(e)}function Sr(e){return e instanceof Qe?e.terminalType.name:e instanceof Ge?e.nonTerminalName:""}var Ar=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.allProductions=[],t}return mr(t,e),t.prototype.visitNonTerminal=function(e){this.allProductions.push(e)},t.prototype.visitOption=function(e){this.allProductions.push(e)},t.prototype.visitRepetitionWithSeparator=function(e){this.allProductions.push(e)},t.prototype.visitRepetitionMandatory=function(e){this.allProductions.push(e)},t.prototype.visitRepetitionMandatoryWithSeparator=function(e){this.allProductions.push(e)},t.prototype.visitRepetition=function(e){this.allProductions.push(e)},t.prototype.visitAlternation=function(e){this.allProductions.push(e)},t.prototype.visitTerminal=function(e){this.allProductions.push(e)},t}(nt),Rr=/^[a-zA-Z_]\w*$/,yr=new RegExp(Rr.source.replace("^","^\\$"));function Nr(e,t){var r=[],n=e.name;return n.match(Rr)||r.push({message:t.buildInvalidRuleNameError({topLevelRule:e,expectedPattern:Rr}),type:$n.INVALID_RULE_NAME,ruleName:n}),r}function wr(e,t,r){var n,a=[];return t.name.match(yr)||(n=r.buildInvalidNestedRuleNameError(e,t),a.push({message:n,type:$n.INVALID_NESTED_RULE_NAME,ruleName:e.name})),a}function br(e,t){var r=[],n=e.name;return n.match(Rr)||r.push({message:t.buildTokenNameError({tokenType:e,expectedPattern:Rr}),type:$n.INVALID_TOKEN_NAME}),r}function Cr(e,t,r,n){var s=[],i=(0,a.u4)(t,(function(t,r){return r.name===e.name?t+1:t}),0);if(i>1){var o=n.buildDuplicateRuleNameError({topLevelRule:e,grammarName:r});s.push({message:o,type:$n.DUPLICATE_RULE_NAME,ruleName:e.name})}return s}function Or(e,t,r){var n,s=[];return a.r3(t,e)||(n="Invalid rule override, rule: ->"+e+"<- cannot be overridden in the grammar: ->"+r+"<-as it is not defined in any of the super grammars ",s.push({message:n,type:$n.INVALID_RULE_OVERRIDE,ruleName:e})),s}function Ir(e,t,r,n){void 0===n&&(n=[]);var s=[],i=Mr(t.definition);if(a.xb(i))return[];var o=e.name,c=a.r3(i,e);c&&s.push({message:r.buildLeftRecursionError({topLevelRule:e,leftRecursionPath:n}),type:$n.LEFT_RECURSION,ruleName:o});var l=a.e5(i,n.concat([e])),u=a.UI(l,(function(t){var s=a.Qw(n);return s.push(t),Ir(e,t,r,s)}));return s.concat(a.xH(u))}function Mr(e){var t=[];if(a.xb(e))return t;var r=a.Ps(e);if(r instanceof Ge)t.push(r.referencedRule);else if(r instanceof ze||r instanceof $e||r instanceof je||r instanceof Xe||r instanceof qe||r instanceof Ke)t=t.concat(Mr(r.definition));else if(r instanceof Je)t=a.xH(a.UI(r.definition,(function(e){return Mr(e.definition)})));else if(!(r instanceof Qe))throw Error("non exhaustive match");var n=it(r),s=e.length>1;if(n&&s){var i=a.Cw(e);return t.concat(Mr(i))}return t}var Dr=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.alternations=[],t}return mr(t,e),t.prototype.visitAlternation=function(e){this.alternations.push(e)},t}(nt);function Lr(e,t){var r=new Dr;e.accept(r);var n=r.alternations,s=a.u4(n,(function(r,n){var s=a.j7(n.definition),i=a.UI(s,(function(r,s){var i=Kt([r],[],null,1);return a.xb(i)?{message:t.buildEmptyAlternationError({topLevelRule:e,alternation:n,emptyChoiceIdx:s}),type:$n.NONE_LAST_EMPTY_ALT,ruleName:e.name,occurrence:n.idx,alternative:s+1}:null}));return r.concat(a.oA(i))}),[]);return s}function kr(e,t,r,n){var s=new Dr;e.accept(s);var i=s.alternations,o=r[e.name];o&&(i=(0,a.d1)(i,(function(e){return o[ct(e)+(0===e.idx?"":e.idx)]}))),i=(0,a.d1)(i,(function(e){return!0===e.ignoreAmbiguities}));var c=a.u4(i,(function(r,a){var s=a.idx,i=a.maxLookahead||t,o=ur(s,e,i,a),c=Fr(o,a,e,n),l=Pr(o,a,e,n);return r.concat(c,l)}),[]);return c}var _r=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.allProductions=[],t}return mr(t,e),t.prototype.visitRepetitionWithSeparator=function(e){this.allProductions.push(e)},t.prototype.visitRepetitionMandatory=function(e){this.allProductions.push(e)},t.prototype.visitRepetitionMandatoryWithSeparator=function(e){this.allProductions.push(e)},t.prototype.visitRepetition=function(e){this.allProductions.push(e)},t}(nt);function Ur(e,t){var r=new Dr;e.accept(r);var n=r.alternations,s=a.u4(n,(function(r,n){return n.definition.length>255&&r.push({message:t.buildTooManyAlternativesError({topLevelRule:e,alternation:n}),type:$n.TOO_MANY_ALTS,ruleName:e.name,occurrence:n.idx}),r}),[]);return s}function xr(e,t,r){var n=[];return(0,a.Ed)(e,(function(e){var s=new _r;e.accept(s);var i=s.allProductions;(0,a.Ed)(i,(function(s){var i=Zt(s),o=s.maxLookahead||t,c=s.idx,l=hr(c,e,i,o),u=l[0];if((0,a.xb)((0,a.xH)(u))){var h=r.buildEmptyRepetitionError({topLevelRule:e,repetition:s});n.push({message:h,type:$n.NO_NON_EMPTY_LOOKAHEAD,ruleName:e.name})}}))})),n}function Fr(e,t,r,n){var s=[],i=(0,a.u4)(e,(function(r,n,i){return!0===t.definition[i].ignoreAmbiguities||(0,a.Ed)(n,(function(n){var o=[i];(0,a.Ed)(e,(function(e,r){i!==r&&fr(e,n)&&!0!==t.definition[r].ignoreAmbiguities&&o.push(r)})),o.length>1&&!fr(s,n)&&(s.push(n),r.push({alts:o,path:n}))})),r}),[]),o=a.UI(i,(function(e){var s=(0,a.UI)(e.alts,(function(e){return e+1})),i=n.buildAlternationAmbiguityError({topLevelRule:r,alternation:t,ambiguityIndices:s,prefixPath:e.path});return{message:i,type:$n.AMBIGUOUS_ALTS,ruleName:r.name,occurrence:t.idx,alternatives:[e.alts]}}));return o}function Pr(e,t,r,n){var s=[],i=(0,a.u4)(e,(function(e,t,r){var n=(0,a.UI)(t,(function(e){return{idx:r,path:e}}));return e.concat(n)}),[]);return(0,a.Ed)(i,(function(e){var o=t.definition[e.idx];if(!0!==o.ignoreAmbiguities){var c=e.idx,l=e.path,u=(0,a.Oq)(i,(function(e){return!0!==t.definition[e.idx].ignoreAmbiguities&&e.idx<c&&dr(e.path,l)})),h=(0,a.UI)(u,(function(e){var a=[e.idx+1,c+1],s=0===t.idx?"":t.idx,i=n.buildAlternationPrefixAmbiguityError({topLevelRule:r,alternation:t,ambiguityIndices:a,prefixPath:e.path});return{message:i,type:$n.AMBIGUOUS_PREFIX_ALTS,ruleName:r.name,occurrence:s,alternatives:a}}));s=s.concat(h)}})),s}function Br(e,t,r){var n=[],s=(0,a.UI)(t,(function(e){return e.name}));return(0,a.Ed)(e,(function(e){var t=e.name;if((0,a.r3)(s,t)){var i=r.buildNamespaceConflictError(e);n.push({message:i,type:$n.CONFLICT_TOKENS_RULES_NAMESPACE,ruleName:t})}})),n}function Yr(e,t){var r=[];return(0,a.Ed)(e,(function(e){var n=new Pt("");e.accept(n);var s=(0,a.vM)(n.result,(function(e){return e.name})),i=(0,a.ei)(s,(function(e){return e.length>1}));(0,a.Ed)((0,a.VO)(i),(function(n){var s=(0,a.UI)(n,(function(e){return e.orgProd})),i=t.buildDuplicateNestedRuleNameError(e,s);r.push({message:i,type:$n.DUPLICATE_NESTED_NAME,ruleName:e.name})}))})),r}var Vr={buildMismatchTokenMessage:function(e){var t=e.expected,r=e.actual,n=(e.previous,e.ruleName,be(t)),a=n?"--\x3e "+Ne(t)+" <--":"token of type --\x3e "+t.name+" <--",s="Expecting "+a+" but found --\x3e '"+r.image+"' <--";return s},buildNotAllInputParsedMessage:function(e){var t=e.firstRedundant;e.ruleName;return"Redundant input, expecting EOF but found: "+t.image},buildNoViableAltMessage:function(e){var t=e.expectedPathsPerAlt,r=e.actual,n=(e.previous,e.customUserDescription),s=(e.ruleName,"Expecting: "),i=(0,a.Ps)(r).image,o="\nbut found: '"+i+"'";if(n)return s+n+o;var c=(0,a.u4)(t,(function(e,t){return e.concat(t)}),[]),l=(0,a.UI)(c,(function(e){return"["+(0,a.UI)(e,(function(e){return Ne(e)})).join(", ")+"]"})),u=(0,a.UI)(l,(function(e,t){return"  "+(t+1)+". "+e})),h="one of these possible Token sequences:\n"+u.join("\n");return s+h+o},buildEarlyExitMessage:function(e){var t=e.expectedIterationPaths,r=e.actual,n=e.customUserDescription,s=(e.ruleName,"Expecting: "),i=(0,a.Ps)(r).image,o="\nbut found: '"+i+"'";if(n)return s+n+o;var c=(0,a.UI)(t,(function(e){return"["+(0,a.UI)(e,(function(e){return Ne(e)})).join(",")+"]"})),l="expecting at least one iteration which starts with one of these possible Token sequences::\n  <"+c.join(" ,")+">";return s+l+o}};Object.freeze(Vr);var Wr={buildRuleNotFoundError:function(e,t){var r="Invalid grammar, reference to a rule which is not defined: ->"+t.nonTerminalName+"<-\ninside top level rule: ->"+e.name+"<-";return r}},Gr={buildDuplicateFoundError:function(e,t){function r(e){return e instanceof Qe?e.terminalType.name:e instanceof Ge?e.nonTerminalName:""}var n=e.name,s=(0,a.Ps)(t),i=s.idx,o=ct(s),c=r(s),l=i>0,u="->"+o+(l?i:"")+"<- "+(c?"with argument: ->"+c+"<-":"")+"\n                  appears more than once ("+t.length+" times) in the top level rule: ->"+n+"<-.                  \n                  For further details see: https://sap.github.io/chevrotain/docs/FAQ.html#NUMERICAL_SUFFIXES \n                  ";return u=u.replace(/[ \t]+/g," "),u=u.replace(/\s\s+/g,"\n"),u},buildInvalidNestedRuleNameError:function(e,t){var r="Invalid nested rule name: ->"+t.name+"<- inside rule: ->"+e.name+"<-\nit must match the pattern: ->"+yr.toString()+"<-.\nNote that this means a nested rule name must start with the '$'(dollar) sign.";return r},buildDuplicateNestedRuleNameError:function(e,t){var r=(0,a.Ps)(t).name,n="Duplicate nested rule name: ->"+r+"<- inside rule: ->"+e.name+"<-\nA nested name must be unique in the scope of a top level grammar rule.";return n},buildNamespaceConflictError:function(e){var t="Namespace conflict found in grammar.\nThe grammar has both a Terminal(Token) and a Non-Terminal(Rule) named: <"+e.name+">.\nTo resolve this make sure each Terminal and Non-Terminal names are unique\nThis is easy to accomplish by using the convention that Terminal names start with an uppercase letter\nand Non-Terminal names start with a lower case letter.";return t},buildAlternationPrefixAmbiguityError:function(e){var t=(0,a.UI)(e.prefixPath,(function(e){return Ne(e)})).join(", "),r=0===e.alternation.idx?"":e.alternation.idx,n="Ambiguous alternatives: <"+e.ambiguityIndices.join(" ,")+"> due to common lookahead prefix\nin <OR"+r+"> inside <"+e.topLevelRule.name+"> Rule,\n<"+t+"> may appears as a prefix path in all these alternatives.\nSee: https://sap.github.io/chevrotain/docs/guide/resolving_grammar_errors.html#COMMON_PREFIX\nFor Further details.";return n},buildAlternationAmbiguityError:function(e){var t=(0,a.UI)(e.prefixPath,(function(e){return Ne(e)})).join(", "),r=0===e.alternation.idx?"":e.alternation.idx,n="Ambiguous Alternatives Detected: <"+e.ambiguityIndices.join(" ,")+"> in <OR"+r+"> inside <"+e.topLevelRule.name+"> Rule,\n<"+t+"> may appears as a prefix path in all these alternatives.\n";return n+="See: https://sap.github.io/chevrotain/docs/guide/resolving_grammar_errors.html#AMBIGUOUS_ALTERNATIVES\nFor Further details.",n},buildEmptyRepetitionError:function(e){var t=ct(e.repetition);0!==e.repetition.idx&&(t+=e.repetition.idx);var r="The repetition <"+t+"> within Rule <"+e.topLevelRule.name+"> can never consume any tokens.\nThis could lead to an infinite loop.";return r},buildTokenNameError:function(e){var t=e.tokenType.name,r="Invalid Grammar Token name: ->"+t+"<- it must match the pattern: ->"+e.expectedPattern.toString()+"<-";return r},buildEmptyAlternationError:function(e){var t="Ambiguous empty alternative: <"+(e.emptyChoiceIdx+1)+"> in <OR"+e.alternation.idx+"> inside <"+e.topLevelRule.name+"> Rule.\nOnly the last alternative may be an empty alternative.";return t},buildTooManyAlternativesError:function(e){var t="An Alternation cannot have more than 256 alternatives:\n<OR"+e.alternation.idx+"> inside <"+e.topLevelRule.name+"> Rule.\n has "+(e.alternation.definition.length+1)+" alternatives.";return t},buildLeftRecursionError:function(e){var t=e.topLevelRule.name,r=a.UI(e.leftRecursionPath,(function(e){return e.name})),n=t+" --\x3e "+r.concat([t]).join(" --\x3e "),s="Left Recursion found in grammar.\nrule: <"+t+"> can be invoked from itself (directly or indirectly)\nwithout consuming any Tokens. The grammar path that causes this is: \n "+n+"\n To fix this refactor your grammar to remove the left recursion.\nsee: https://en.wikipedia.org/wiki/LL_parser#Left_Factoring.";return s},buildInvalidRuleNameError:function(e){var t=e.topLevelRule.name,r=e.expectedPattern.toString(),n="Invalid grammar rule name: ->"+t+"<- it must match the pattern: ->"+r+"<-";return n},buildDuplicateRuleNameError:function(e){var t;t=e.topLevelRule instanceof He?e.topLevelRule.name:e.topLevelRule;var r="Duplicate definition, rule: ->"+t+"<- is already defined in the grammar: ->"+e.grammarName+"<-";return r}},Hr=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},e(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();function zr(e,t){var r=new $r(e,t);return r.resolveRefs(),r.errors}var $r=function(e){function t(t,r){var n=e.call(this)||this;return n.nameToTopRule=t,n.errMsgProvider=r,n.errors=[],n}return Hr(t,e),t.prototype.resolveRefs=function(){var e=this;(0,a.Ed)((0,a.VO)(this.nameToTopRule),(function(t){e.currTopLevel=t,t.accept(e)}))},t.prototype.visitNonTerminal=function(e){var t=this.nameToTopRule[e.nonTerminalName];if(t)e.referencedRule=t;else{var r=this.errMsgProvider.buildRuleNotFoundError(this.currTopLevel,e);this.errors.push({message:r,type:$n.UNRESOLVED_SUBRULE_REF,ruleName:this.currTopLevel.name,unresolvedRefName:e.nonTerminalName})}},t}(nt);function jr(e){e=(0,a.ce)(e,{errMsgProvider:Wr});var t={};return(0,a.Ed)(e.rules,(function(e){t[e.name]=e})),zr(t,e.errMsgProvider)}function Xr(e){return e=(0,a.ce)(e,{errMsgProvider:Gr,ignoredIssues:{}}),gr(e.rules,e.maxLookahead,e.tokenTypes,e.ignoredIssues,e.errMsgProvider,e.grammarName)}function Kr(e){(0,a.Ed)(e.rules,(function(e){var t=new lt;e.accept(t),(0,a.Ed)(t.dslMethods,(function(e){(0,a.Ed)(e,(function(e,t){e.idx=t+1}))}))}))}var qr="MismatchedTokenException",Jr="NoViableAltException",Qr="EarlyExitException",Zr="NotAllInputParsedException",en=[qr,Jr,Qr,Zr];function tn(e){return(0,a.r3)(en,e.name)}function rn(e,t,r){this.name=qr,this.message=e,this.token=t,this.previousToken=r,this.resyncedTokens=[]}function nn(e,t,r){this.name=Jr,this.message=e,this.token=t,this.previousToken=r,this.resyncedTokens=[]}function an(e,t){this.name=Zr,this.message=e,this.token=t,this.resyncedTokens=[]}function sn(e,t,r){this.name=Qr,this.message=e,this.token=t,this.previousToken=r,this.resyncedTokens=[]}Object.freeze(en),rn.prototype=Error.prototype,nn.prototype=Error.prototype,an.prototype=Error.prototype,sn.prototype=Error.prototype;var on={},cn="InRuleRecoveryException";function ln(e){this.name=cn,this.message=e}ln.prototype=Error.prototype;var un=function(){function e(){}return e.prototype.initRecoverable=function(e){this.firstAfterRepMap={},this.resyncFollows={},this.recoveryEnabled=(0,a.e$)(e,"recoveryEnabled")?e.recoveryEnabled:jn.recoveryEnabled,this.recoveryEnabled&&(this.attemptInRepetitionRecovery=hn)},e.prototype.getTokenToInsert=function(e){var t=Be(e,"",NaN,NaN,NaN,NaN,NaN,NaN);return t.isInsertedInRecovery=!0,t},e.prototype.canTokenTypeBeInsertedInRecovery=function(e){return!0},e.prototype.tryInRepetitionRecovery=function(e,t,r,n){var s=this,i=this.findReSyncTokenType(),o=this.exportLexerState(),c=[],l=!1,u=this.LA(1),h=this.LA(1),f=function(){var e=s.LA(0),t=s.errorMessageProvider.buildMismatchTokenMessage({expected:n,actual:u,previous:e,ruleName:s.getCurrRuleFullName()}),r=new rn(t,u,s.LA(0));r.resyncedTokens=(0,a.j7)(c),s.SAVE_ERROR(r)};while(!l){if(this.tokenMatcher(h,n))return void f();if(r.call(this))return f(),void e.apply(this,t);this.tokenMatcher(h,i)?l=!0:(h=this.SKIP_TOKEN(),this.addToResyncTokens(h,c))}this.importLexerState(o)},e.prototype.shouldInRepetitionRecoveryBeTried=function(e,t,r){return!1!==r&&(void 0!==e&&void 0!==t&&(!this.tokenMatcher(this.LA(1),e)&&(!this.isBackTracking()&&!this.canPerformInRuleRecovery(e,this.getFollowsForInRuleRecovery(e,t)))))},e.prototype.getFollowsForInRuleRecovery=function(e,t){var r=this.getCurrentGrammarPath(e,t),n=this.getNextPossibleTokenTypes(r);return n},e.prototype.tryInRuleRecovery=function(e,t){if(this.canRecoverWithSingleTokenInsertion(e,t)){var r=this.getTokenToInsert(e);return r}if(this.canRecoverWithSingleTokenDeletion(e)){var n=this.SKIP_TOKEN();return this.consumeToken(),n}throw new ln("sad sad panda")},e.prototype.canPerformInRuleRecovery=function(e,t){return this.canRecoverWithSingleTokenInsertion(e,t)||this.canRecoverWithSingleTokenDeletion(e)},e.prototype.canRecoverWithSingleTokenInsertion=function(e,t){var r=this;if(!this.canTokenTypeBeInsertedInRecovery(e))return!1;if((0,a.xb)(t))return!1;var n=this.LA(1),s=void 0!==(0,a.sE)(t,(function(e){return r.tokenMatcher(n,e)}));return s},e.prototype.canRecoverWithSingleTokenDeletion=function(e){var t=this.tokenMatcher(this.LA(2),e);return t},e.prototype.isInCurrentRuleReSyncSet=function(e){var t=this.getCurrFollowKey(),r=this.getFollowSetFromFollowKey(t);return(0,a.r3)(r,e)},e.prototype.findReSyncTokenType=function(){var e=this.flattenFollowSet(),t=this.LA(1),r=2;while(1){var n=t.tokenType;if((0,a.r3)(e,n))return n;t=this.LA(r),r++}},e.prototype.getCurrFollowKey=function(){if(1===this.RULE_STACK.length)return on;var e=this.getLastExplicitRuleShortName(),t=this.getLastExplicitRuleOccurrenceIndex(),r=this.getPreviousExplicitRuleShortName();return{ruleName:this.shortRuleNameToFullName(e),idxInCallingRule:t,inRule:this.shortRuleNameToFullName(r)}},e.prototype.buildFullFollowKeyStack=function(){var e=this,t=this.RULE_STACK,r=this.RULE_OCCURRENCE_STACK;return(0,a.xb)(this.LAST_EXPLICIT_RULE_STACK)||(t=(0,a.UI)(this.LAST_EXPLICIT_RULE_STACK,(function(t){return e.RULE_STACK[t]})),r=(0,a.UI)(this.LAST_EXPLICIT_RULE_STACK,(function(t){return e.RULE_OCCURRENCE_STACK[t]}))),(0,a.UI)(t,(function(n,a){return 0===a?on:{ruleName:e.shortRuleNameToFullName(n),idxInCallingRule:r[a],inRule:e.shortRuleNameToFullName(t[a-1])}}))},e.prototype.flattenFollowSet=function(){var e=this,t=(0,a.UI)(this.buildFullFollowKeyStack(),(function(t){return e.getFollowSetFromFollowKey(t)}));return(0,a.xH)(t)},e.prototype.getFollowSetFromFollowKey=function(e){if(e===on)return[Pe];var t=e.ruleName+e.idxInCallingRule+gt+e.inRule;return this.resyncFollows[t]},e.prototype.addToResyncTokens=function(e,t){return this.tokenMatcher(e,Pe)||t.push(e),t},e.prototype.reSyncTo=function(e){var t=[],r=this.LA(1);while(!1===this.tokenMatcher(r,e))r=this.SKIP_TOKEN(),this.addToResyncTokens(r,t);return(0,a.j7)(t)},e.prototype.attemptInRepetitionRecovery=function(e,t,r,n,a,s,i){},e.prototype.getCurrentGrammarPath=function(e,t){var r=this.getHumanReadableRuleStack(),n=(0,a.Qw)(this.RULE_OCCURRENCE_STACK),s={ruleStack:r,occurrenceStack:n,lastTok:e,lastTokOccurrence:t};return s},e.prototype.getHumanReadableRuleStack=function(){var e=this;return(0,a.xb)(this.LAST_EXPLICIT_RULE_STACK)?(0,a.UI)(this.RULE_STACK,(function(t){return e.shortRuleNameToFullName(t)})):(0,a.UI)(this.LAST_EXPLICIT_RULE_STACK,(function(t){return e.shortRuleNameToFullName(e.RULE_STACK[t])}))},e}();function hn(e,t,r,n,a,s,i){var o=this.getKeyForAutomaticLookahead(n,a),c=this.firstAfterRepMap[o];if(void 0===c){var l=this.getCurrRuleFullName(),u=this.getGAstProductions()[l],h=new s(u,a);c=h.startWalking(),this.firstAfterRepMap[o]=c}var f=c.token,d=c.occurrence,p=c.isEndOfRule;1===this.RULE_STACK.length&&p&&void 0===f&&(f=Pe,d=1),this.shouldInRepetitionRecoveryBeTried(f,d,i)&&this.tryInRepetitionRecovery(e,t,r,f)}var fn=function(){function e(){}return e.prototype.initLooksAhead=function(e){this.dynamicTokensEnabled=(0,a.e$)(e,"dynamicTokensEnabled")?e.dynamicTokensEnabled:jn.dynamicTokensEnabled,this.maxLookahead=(0,a.e$)(e,"maxLookahead")?e.maxLookahead:jn.maxLookahead,this.lookAheadFuncsCache=(0,a.dU)()?new Map:[],(0,a.dU)()?(this.getLaFuncFromCache=this.getLaFuncFromMap,this.setLaFuncCache=this.setLaFuncCacheUsingMap):(this.getLaFuncFromCache=this.getLaFuncFromObj,this.setLaFuncCache=this.setLaFuncUsingObj)},e.prototype.preComputeLookaheadFunctions=function(e){var t=this;(0,a.Ed)(e,(function(e){t.TRACE_INIT(e.name+" Rule Lookahead",(function(){var r=ht(e),n=r.alternation,s=r.repetition,i=r.option,o=r.repetitionMandatory,c=r.repetitionMandatoryWithSeparator,l=r.repetitionWithSeparator;(0,a.Ed)(n,(function(r){var n=0===r.idx?"":r.idx;t.TRACE_INIT(""+ct(r)+n,(function(){var n=er(r.idx,e,r.maxLookahead||t.maxLookahead,r.hasPredicates,t.dynamicTokensEnabled,t.lookAheadBuilderForAlternatives),a=Mt(t.fullRuleNameToShort[e.name],Nt,r.idx);t.setLaFuncCache(a,n)}))})),(0,a.Ed)(s,(function(r){t.computeLookaheadFunc(e,r.idx,bt,Jt.REPETITION,r.maxLookahead,ct(r))})),(0,a.Ed)(i,(function(r){t.computeLookaheadFunc(e,r.idx,wt,Jt.OPTION,r.maxLookahead,ct(r))})),(0,a.Ed)(o,(function(r){t.computeLookaheadFunc(e,r.idx,Ct,Jt.REPETITION_MANDATORY,r.maxLookahead,ct(r))})),(0,a.Ed)(c,(function(r){t.computeLookaheadFunc(e,r.idx,It,Jt.REPETITION_MANDATORY_WITH_SEPARATOR,r.maxLookahead,ct(r))})),(0,a.Ed)(l,(function(r){t.computeLookaheadFunc(e,r.idx,Ot,Jt.REPETITION_WITH_SEPARATOR,r.maxLookahead,ct(r))}))}))}))},e.prototype.computeLookaheadFunc=function(e,t,r,n,a,s){var i=this;this.TRACE_INIT(""+s+(0===t?"":t),(function(){var s=tr(t,e,a||i.maxLookahead,i.dynamicTokensEnabled,n,i.lookAheadBuilderForOptional),o=Mt(i.fullRuleNameToShort[e.name],r,t);i.setLaFuncCache(o,s)}))},e.prototype.lookAheadBuilderForOptional=function(e,t,r){return nr(e,t,r)},e.prototype.lookAheadBuilderForAlternatives=function(e,t,r,n){return rr(e,t,r,n)},e.prototype.getKeyForAutomaticLookahead=function(e,t){var r=this.getLastExplicitRuleShortName();return Mt(r,e,t)},e.prototype.getLaFuncFromCache=function(e){},e.prototype.getLaFuncFromMap=function(e){return this.lookAheadFuncsCache.get(e)},e.prototype.getLaFuncFromObj=function(e){return this.lookAheadFuncsCache[e]},e.prototype.setLaFuncCache=function(e,t){},e.prototype.setLaFuncCacheUsingMap=function(e,t){this.lookAheadFuncsCache.set(e,t)},e.prototype.setLaFuncUsingObj=function(e,t){this.lookAheadFuncsCache[e]=t},e}();function dn(e){return En(e.constructor)}var pn,mn=/^\s*function\s*(\S*)\s*\(/,gn="name";function En(e){var t=e.name;if(t)return t;var r=e.toString().match(mn)[1];return r}function vn(e,t){var r=Object.getOwnPropertyDescriptor(e,gn);return!(!(0,a.o8)(r)&&!r.configurable)&&(Object.defineProperty(e,gn,{enumerable:!1,configurable:!0,writable:!1,value:t}),!0)}function Tn(e,t){for(var r=(0,a.XP)(e),n=r.length,s=0;s<n;s++)for(var i=r[s],o=e[i],c=o.length,l=0;l<c;l++){var u=o[l];void 0===u.tokenTypeIdx&&(void 0!==u.fullName?this[u.fullName](u.children,t):this[u.name](u.children,t))}}function Sn(e,t){var r=function(){};vn(r,e+"BaseSemantics");var n={visit:function(e,t){if((0,a.kJ)(e)&&(e=e[0]),!(0,a.o8)(e))return void 0!==e.fullName?this[e.fullName](e.children,t):this[e.name](e.children,t)},validateVisitor:function(){var e=Rn(this,t);if(!(0,a.xb)(e)){var r=(0,a.UI)(e,(function(e){return e.msg}));throw Error("Errors Detected in CST Visitor <"+En(this.constructor)+">:\n\t"+r.join("\n\n").replace(/\n/g,"\n\t"))}}};return r.prototype=n,r.prototype.constructor=r,r._RULE_NAMES=t,r}function An(e,t,r){var n=function(){};vn(n,e+"BaseSemanticsWithDefaults");var s=Object.create(r.prototype);return(0,a.Ed)(t,(function(e){s[e]=Tn})),n.prototype=s,n.prototype.constructor=n,n}function Rn(e,t){var r=yn(e,t),n=wn(e,t);return r.concat(n)}function yn(e,t){var r=(0,a.UI)(t,(function(t){if(!(0,a.mf)(e[t]))return{msg:"Missing visitor method: <"+t+"> on "+En(e.constructor)+" CST Visitor.",type:pn.MISSING_METHOD,methodName:t}}));return(0,a.oA)(r)}(function(e){e[e["REDUNDANT_METHOD"]=0]="REDUNDANT_METHOD",e[e["MISSING_METHOD"]=1]="MISSING_METHOD"})(pn||(pn={}));var Nn=["constructor","visit","validateVisitor"];function wn(e,t){var r=[];for(var n in e)Rr.test(n)&&(0,a.mf)(e[n])&&!(0,a.r3)(Nn,n)&&!(0,a.r3)(t,n)&&r.push({msg:"Redundant visitor method: <"+n+"> on "+En(e.constructor)+" CST Visitor\nThere is no Grammar Rule corresponding to this method's name.\nFor utility methods on visitor classes use methods names that do not match /"+Rr.source+"/.",type:pn.REDUNDANT_METHOD,methodName:n});return r}var bn=function(){function e(){}return e.prototype.initTreeBuilder=function(e){if(this.LAST_EXPLICIT_RULE_STACK=[],this.CST_STACK=[],this.outputCst=(0,a.e$)(e,"outputCst")?e.outputCst:jn.outputCst,this.nodeLocationTracking=(0,a.e$)(e,"nodeLocationTracking")?e.nodeLocationTracking:jn.nodeLocationTracking,this.outputCst)if(/full/i.test(this.nodeLocationTracking))this.recoveryEnabled?(this.setNodeLocationFromToken=Ut,this.setNodeLocationFromNode=Ut,this.cstPostRule=a.dG,this.setInitialNodeLocation=this.setInitialNodeLocationFullRecovery):(this.setNodeLocationFromToken=a.dG,this.setNodeLocationFromNode=a.dG,this.cstPostRule=this.cstPostRuleFull,this.setInitialNodeLocation=this.setInitialNodeLocationFullRegular);else if(/onlyOffset/i.test(this.nodeLocationTracking))this.recoveryEnabled?(this.setNodeLocationFromToken=_t,this.setNodeLocationFromNode=_t,this.cstPostRule=a.dG,this.setInitialNodeLocation=this.setInitialNodeLocationOnlyOffsetRecovery):(this.setNodeLocationFromToken=a.dG,this.setNodeLocationFromNode=a.dG,this.cstPostRule=this.cstPostRuleOnlyOffset,this.setInitialNodeLocation=this.setInitialNodeLocationOnlyOffsetRegular);else{if(!/none/i.test(this.nodeLocationTracking))throw Error('Invalid <nodeLocationTracking> config option: "'+e.nodeLocationTracking+'"');this.setNodeLocationFromToken=a.dG,this.setNodeLocationFromNode=a.dG,this.cstPostRule=a.dG,this.setInitialNodeLocation=a.dG}else this.cstInvocationStateUpdate=a.dG,this.cstFinallyStateUpdate=a.dG,this.cstPostTerminal=a.dG,this.cstPostNonTerminal=a.dG,this.cstPostRule=a.dG,this.getLastExplicitRuleShortName=this.getLastExplicitRuleShortNameNoCst,this.getPreviousExplicitRuleShortName=this.getPreviousExplicitRuleShortNameNoCst,this.getLastExplicitRuleOccurrenceIndex=this.getLastExplicitRuleOccurrenceIndexNoCst,this.manyInternal=this.manyInternalNoCst,this.orInternal=this.orInternalNoCst,this.optionInternal=this.optionInternalNoCst,this.atLeastOneInternal=this.atLeastOneInternalNoCst,this.manySepFirstInternal=this.manySepFirstInternalNoCst,this.atLeastOneSepFirstInternal=this.atLeastOneSepFirstInternalNoCst},e.prototype.setInitialNodeLocationOnlyOffsetRecovery=function(e){e.location={startOffset:NaN,endOffset:NaN}},e.prototype.setInitialNodeLocationOnlyOffsetRegular=function(e){e.location={startOffset:this.LA(1).startOffset,endOffset:NaN}},e.prototype.setInitialNodeLocationFullRecovery=function(e){e.location={startOffset:NaN,startLine:NaN,startColumn:NaN,endOffset:NaN,endLine:NaN,endColumn:NaN}},e.prototype.setInitialNodeLocationFullRegular=function(e){var t=this.LA(1);e.location={startOffset:t.startOffset,startLine:t.startLine,startColumn:t.startColumn,endOffset:NaN,endLine:NaN,endColumn:NaN}},e.prototype.cstNestedInvocationStateUpdate=function(e,t){var r={name:e,fullName:this.shortRuleNameToFull[this.getLastExplicitRuleShortName()]+e,children:{}};this.setInitialNodeLocation(r),this.CST_STACK.push(r)},e.prototype.cstInvocationStateUpdate=function(e,t){this.LAST_EXPLICIT_RULE_STACK.push(this.RULE_STACK.length-1);var r={name:e,children:{}};this.setInitialNodeLocation(r),this.CST_STACK.push(r)},e.prototype.cstFinallyStateUpdate=function(){this.LAST_EXPLICIT_RULE_STACK.pop(),this.CST_STACK.pop()},e.prototype.cstNestedFinallyStateUpdate=function(){var e=this.CST_STACK.pop();this.cstPostRule(e)},e.prototype.cstPostRuleFull=function(e){var t=this.LA(0),r=e.location;r.startOffset<=t.startOffset===!0?(r.endOffset=t.endOffset,r.endLine=t.endLine,r.endColumn=t.endColumn):(r.startOffset=NaN,r.startLine=NaN,r.startColumn=NaN)},e.prototype.cstPostRuleOnlyOffset=function(e){var t=this.LA(0),r=e.location;r.startOffset<=t.startOffset===!0?r.endOffset=t.endOffset:r.startOffset=NaN},e.prototype.cstPostTerminal=function(e,t){var r=this.CST_STACK[this.CST_STACK.length-1];xt(r,t,e),this.setNodeLocationFromToken(r.location,t)},e.prototype.cstPostNonTerminal=function(e,t){if(!0!==this.isBackTracking()){var r=this.CST_STACK[this.CST_STACK.length-1];Ft(r,t,e),this.setNodeLocationFromNode(r.location,e.location)}},e.prototype.getBaseCstVisitorConstructor=function(){if((0,a.o8)(this.baseCstVisitorConstructor)){var e=Sn(this.className,this.allRuleNames);return this.baseCstVisitorConstructor=e,e}return this.baseCstVisitorConstructor},e.prototype.getBaseCstVisitorConstructorWithDefaults=function(){if((0,a.o8)(this.baseCstVisitorWithDefaultsConstructor)){var e=An(this.className,this.allRuleNames,this.getBaseCstVisitorConstructor());return this.baseCstVisitorWithDefaultsConstructor=e,e}return this.baseCstVisitorWithDefaultsConstructor},e.prototype.nestedRuleBeforeClause=function(e,t){var r;return void 0!==e.NAME?(r=e.NAME,this.nestedRuleInvocationStateUpdate(r,t),r):void 0},e.prototype.nestedAltBeforeClause=function(e,t,r,n){var a,s=this.getLastExplicitRuleShortName(),i=Lt(s,r,t,n);return void 0!==e.NAME?(a=e.NAME,this.nestedRuleInvocationStateUpdate(a,i),{shortName:i,nestedName:a}):void 0},e.prototype.nestedRuleFinallyClause=function(e,t){var r=this.CST_STACK,n=r[r.length-1];this.nestedRuleFinallyStateUpdate();var a=r[r.length-1];Ft(a,t,n),this.setNodeLocationFromNode(a.location,n.location)},e.prototype.getLastExplicitRuleShortName=function(){var e=this.LAST_EXPLICIT_RULE_STACK[this.LAST_EXPLICIT_RULE_STACK.length-1];return this.RULE_STACK[e]},e.prototype.getLastExplicitRuleShortNameNoCst=function(){var e=this.RULE_STACK;return e[e.length-1]},e.prototype.getPreviousExplicitRuleShortName=function(){var e=this.LAST_EXPLICIT_RULE_STACK[this.LAST_EXPLICIT_RULE_STACK.length-2];return this.RULE_STACK[e]},e.prototype.getPreviousExplicitRuleShortNameNoCst=function(){var e=this.RULE_STACK;return e[e.length-2]},e.prototype.getLastExplicitRuleOccurrenceIndex=function(){var e=this.LAST_EXPLICIT_RULE_STACK[this.LAST_EXPLICIT_RULE_STACK.length-1];return this.RULE_OCCURRENCE_STACK[e]},e.prototype.getLastExplicitRuleOccurrenceIndexNoCst=function(){var e=this.RULE_OCCURRENCE_STACK;return e[e.length-1]},e.prototype.nestedRuleInvocationStateUpdate=function(e,t){this.RULE_OCCURRENCE_STACK.push(1),this.RULE_STACK.push(t),this.cstNestedInvocationStateUpdate(e,t)},e.prototype.nestedRuleFinallyStateUpdate=function(){this.RULE_STACK.pop(),this.RULE_OCCURRENCE_STACK.pop(),this.cstNestedFinallyStateUpdate()},e}(),Cn=function(){function e(){}return e.prototype.initLexerAdapter=function(){this.tokVector=[],this.tokVectorLength=0,this.currIdx=-1},Object.defineProperty(e.prototype,"input",{get:function(){return this.tokVector},set:function(e){if(!0!==this.selfAnalysisDone)throw Error("Missing <performSelfAnalysis> invocation at the end of the Parser's constructor.");this.reset(),this.tokVector=e,this.tokVectorLength=e.length},enumerable:!0,configurable:!0}),e.prototype.SKIP_TOKEN=function(){return this.currIdx<=this.tokVector.length-2?(this.consumeToken(),this.LA(1)):zn},e.prototype.LA=function(e){var t=this.currIdx+e;return t<0||this.tokVectorLength<=t?zn:this.tokVector[t]},e.prototype.consumeToken=function(){this.currIdx++},e.prototype.exportLexerState=function(){return this.currIdx},e.prototype.importLexerState=function(e){this.currIdx=e},e.prototype.resetLexerState=function(){this.currIdx=-1},e.prototype.moveToTerminatedState=function(){this.currIdx=this.tokVector.length-1},e.prototype.getLexerPosition=function(){return this.exportLexerState()},e}(),On=function(){function e(){}return e.prototype.ACTION=function(e){return e.call(this)},e.prototype.consume=function(e,t,r){return this.consumeInternal(t,e,r)},e.prototype.subrule=function(e,t,r){return this.subruleInternal(t,e,r)},e.prototype.option=function(e,t){return this.optionInternal(t,e)},e.prototype.or=function(e,t){return this.orInternal(t,e)},e.prototype.many=function(e,t){return this.manyInternal(e,t)},e.prototype.atLeastOne=function(e,t){return this.atLeastOneInternal(e,t)},e.prototype.CONSUME=function(e,t){return this.consumeInternal(e,0,t)},e.prototype.CONSUME1=function(e,t){return this.consumeInternal(e,1,t)},e.prototype.CONSUME2=function(e,t){return this.consumeInternal(e,2,t)},e.prototype.CONSUME3=function(e,t){return this.consumeInternal(e,3,t)},e.prototype.CONSUME4=function(e,t){return this.consumeInternal(e,4,t)},e.prototype.CONSUME5=function(e,t){return this.consumeInternal(e,5,t)},e.prototype.CONSUME6=function(e,t){return this.consumeInternal(e,6,t)},e.prototype.CONSUME7=function(e,t){return this.consumeInternal(e,7,t)},e.prototype.CONSUME8=function(e,t){return this.consumeInternal(e,8,t)},e.prototype.CONSUME9=function(e,t){return this.consumeInternal(e,9,t)},e.prototype.SUBRULE=function(e,t){return this.subruleInternal(e,0,t)},e.prototype.SUBRULE1=function(e,t){return this.subruleInternal(e,1,t)},e.prototype.SUBRULE2=function(e,t){return this.subruleInternal(e,2,t)},e.prototype.SUBRULE3=function(e,t){return this.subruleInternal(e,3,t)},e.prototype.SUBRULE4=function(e,t){return this.subruleInternal(e,4,t)},e.prototype.SUBRULE5=function(e,t){return this.subruleInternal(e,5,t)},e.prototype.SUBRULE6=function(e,t){return this.subruleInternal(e,6,t)},e.prototype.SUBRULE7=function(e,t){return this.subruleInternal(e,7,t)},e.prototype.SUBRULE8=function(e,t){return this.subruleInternal(e,8,t)},e.prototype.SUBRULE9=function(e,t){return this.subruleInternal(e,9,t)},e.prototype.OPTION=function(e){return this.optionInternal(e,0)},e.prototype.OPTION1=function(e){return this.optionInternal(e,1)},e.prototype.OPTION2=function(e){return this.optionInternal(e,2)},e.prototype.OPTION3=function(e){return this.optionInternal(e,3)},e.prototype.OPTION4=function(e){return this.optionInternal(e,4)},e.prototype.OPTION5=function(e){return this.optionInternal(e,5)},e.prototype.OPTION6=function(e){return this.optionInternal(e,6)},e.prototype.OPTION7=function(e){return this.optionInternal(e,7)},e.prototype.OPTION8=function(e){return this.optionInternal(e,8)},e.prototype.OPTION9=function(e){return this.optionInternal(e,9)},e.prototype.OR=function(e){return this.orInternal(e,0)},e.prototype.OR1=function(e){return this.orInternal(e,1)},e.prototype.OR2=function(e){return this.orInternal(e,2)},e.prototype.OR3=function(e){return this.orInternal(e,3)},e.prototype.OR4=function(e){return this.orInternal(e,4)},e.prototype.OR5=function(e){return this.orInternal(e,5)},e.prototype.OR6=function(e){return this.orInternal(e,6)},e.prototype.OR7=function(e){return this.orInternal(e,7)},e.prototype.OR8=function(e){return this.orInternal(e,8)},e.prototype.OR9=function(e){return this.orInternal(e,9)},e.prototype.MANY=function(e){this.manyInternal(0,e)},e.prototype.MANY1=function(e){this.manyInternal(1,e)},e.prototype.MANY2=function(e){this.manyInternal(2,e)},e.prototype.MANY3=function(e){this.manyInternal(3,e)},e.prototype.MANY4=function(e){this.manyInternal(4,e)},e.prototype.MANY5=function(e){this.manyInternal(5,e)},e.prototype.MANY6=function(e){this.manyInternal(6,e)},e.prototype.MANY7=function(e){this.manyInternal(7,e)},e.prototype.MANY8=function(e){this.manyInternal(8,e)},e.prototype.MANY9=function(e){this.manyInternal(9,e)},e.prototype.MANY_SEP=function(e){this.manySepFirstInternal(0,e)},e.prototype.MANY_SEP1=function(e){this.manySepFirstInternal(1,e)},e.prototype.MANY_SEP2=function(e){this.manySepFirstInternal(2,e)},e.prototype.MANY_SEP3=function(e){this.manySepFirstInternal(3,e)},e.prototype.MANY_SEP4=function(e){this.manySepFirstInternal(4,e)},e.prototype.MANY_SEP5=function(e){this.manySepFirstInternal(5,e)},e.prototype.MANY_SEP6=function(e){this.manySepFirstInternal(6,e)},e.prototype.MANY_SEP7=function(e){this.manySepFirstInternal(7,e)},e.prototype.MANY_SEP8=function(e){this.manySepFirstInternal(8,e)},e.prototype.MANY_SEP9=function(e){this.manySepFirstInternal(9,e)},e.prototype.AT_LEAST_ONE=function(e){this.atLeastOneInternal(0,e)},e.prototype.AT_LEAST_ONE1=function(e){return this.atLeastOneInternal(1,e)},e.prototype.AT_LEAST_ONE2=function(e){this.atLeastOneInternal(2,e)},e.prototype.AT_LEAST_ONE3=function(e){this.atLeastOneInternal(3,e)},e.prototype.AT_LEAST_ONE4=function(e){this.atLeastOneInternal(4,e)},e.prototype.AT_LEAST_ONE5=function(e){this.atLeastOneInternal(5,e)},e.prototype.AT_LEAST_ONE6=function(e){this.atLeastOneInternal(6,e)},e.prototype.AT_LEAST_ONE7=function(e){this.atLeastOneInternal(7,e)},e.prototype.AT_LEAST_ONE8=function(e){this.atLeastOneInternal(8,e)},e.prototype.AT_LEAST_ONE9=function(e){this.atLeastOneInternal(9,e)},e.prototype.AT_LEAST_ONE_SEP=function(e){this.atLeastOneSepFirstInternal(0,e)},e.prototype.AT_LEAST_ONE_SEP1=function(e){this.atLeastOneSepFirstInternal(1,e)},e.prototype.AT_LEAST_ONE_SEP2=function(e){this.atLeastOneSepFirstInternal(2,e)},e.prototype.AT_LEAST_ONE_SEP3=function(e){this.atLeastOneSepFirstInternal(3,e)},e.prototype.AT_LEAST_ONE_SEP4=function(e){this.atLeastOneSepFirstInternal(4,e)},e.prototype.AT_LEAST_ONE_SEP5=function(e){this.atLeastOneSepFirstInternal(5,e)},e.prototype.AT_LEAST_ONE_SEP6=function(e){this.atLeastOneSepFirstInternal(6,e)},e.prototype.AT_LEAST_ONE_SEP7=function(e){this.atLeastOneSepFirstInternal(7,e)},e.prototype.AT_LEAST_ONE_SEP8=function(e){this.atLeastOneSepFirstInternal(8,e)},e.prototype.AT_LEAST_ONE_SEP9=function(e){this.atLeastOneSepFirstInternal(9,e)},e.prototype.RULE=function(e,t,r){if(void 0===r&&(r=Xn),(0,a.r3)(this.definedRulesNames,e)){var n=Gr.buildDuplicateRuleNameError({topLevelRule:e,grammarName:this.className}),s={message:n,type:$n.DUPLICATE_RULE_NAME,ruleName:e};this.definitionErrors.push(s)}this.definedRulesNames.push(e);var i=this.defineRule(e,t,r);return this[e]=i,i},e.prototype.OVERRIDE_RULE=function(e,t,r){void 0===r&&(r=Xn);var n=[];n=n.concat(Or(e,this.definedRulesNames,this.className)),this.definitionErrors.push.apply(this.definitionErrors,n);var a=this.defineRule(e,t,r);return this[e]=a,a},e.prototype.BACKTRACK=function(e,t){return function(){this.isBackTrackingStack.push(1);var r=this.saveRecogState();try{return e.apply(this,t),!0}catch(n){if(tn(n))return!1;throw n}finally{this.reloadRecogState(r),this.isBackTrackingStack.pop()}}},e.prototype.getGAstProductions=function(){return this.gastProductionsCache},e.prototype.getSerializedGastProductions=function(){return Ze((0,a.VO)(this.gastProductionsCache))},e}(),In=function(){function e(){}return e.prototype.initRecognizerEngine=function(e,t){if(this.className=dn(this),this.shortRuleNameToFull={},this.fullRuleNameToShort={},this.ruleShortNameIdx=256,this.tokenMatcher=ie,this.definedRulesNames=[],this.tokensMap={},this.allRuleNames=[],this.isBackTrackingStack=[],this.RULE_STACK=[],this.RULE_OCCURRENCE_STACK=[],this.gastProductionsCache={},(0,a.e$)(t,"serializedGrammar"))throw Error("The Parser's configuration can no longer contain a <serializedGrammar> property.\n\tSee: https://sap.github.io/chevrotain/docs/changes/BREAKING_CHANGES.html#_6-0-0\n\tFor Further details.");if((0,a.kJ)(e)){if((0,a.xb)(e))throw Error("A Token Vocabulary cannot be empty.\n\tNote that the first argument for the parser constructor\n\tis no longer a Token vector (since v4.0).");if("number"===typeof e[0].startOffset)throw Error("The Parser constructor no longer accepts a token vector as the first argument.\n\tSee: https://sap.github.io/chevrotain/docs/changes/BREAKING_CHANGES.html#_4-0-0\n\tFor Further details.")}if((0,a.kJ)(e))this.tokensMap=(0,a.u4)(e,(function(e,t){return e[t.name]=t,e}),{});else if((0,a.e$)(e,"modes")&&(0,a.yW)((0,a.xH)((0,a.VO)(e.modes)),Te)){var r=(0,a.xH)((0,a.VO)(e.modes)),n=(0,a.jj)(r);this.tokensMap=(0,a.u4)(n,(function(e,t){return e[t.name]=t,e}),{})}else{if(!(0,a.Kn)(e))throw new Error("<tokensDictionary> argument must be An Array of Token constructors, A dictionary of Token constructors or an IMultiModeLexerDefinition");this.tokensMap=(0,a.Cl)(e)}this.tokensMap["EOF"]=Pe;var s=(0,a.yW)((0,a.VO)(e),(function(e){return(0,a.xb)(e.categoryMatches)}));this.tokenMatcher=s?ie:se,le((0,a.VO)(this.tokensMap))},e.prototype.defineRule=function(e,t,r){if(this.selfAnalysisDone)throw Error("Grammar rule <"+e+"> may not be defined after the 'performSelfAnalysis' method has been called'\nMake sure that all grammar rule definitions are done before 'performSelfAnalysis' is called.");var n,s=(0,a.e$)(r,"resyncEnabled")?r.resyncEnabled:Xn.resyncEnabled,i=(0,a.e$)(r,"recoveryValueFunc")?r.recoveryValueFunc:Xn.recoveryValueFunc,o=this.ruleShortNameIdx<<At+Rt;function c(e){try{if(!0===this.outputCst){t.apply(this,e);var r=this.CST_STACK[this.CST_STACK.length-1];return this.cstPostRule(r),r}return t.apply(this,e)}catch(n){return this.invokeRuleCatch(n,s,i)}finally{this.ruleFinallyStateUpdate()}}this.ruleShortNameIdx++,this.shortRuleNameToFull[o]=e,this.fullRuleNameToShort[e]=o,n=function(t,r){return void 0===t&&(t=0),this.ruleInvocationStateUpdate(o,e,t),c.call(this,r)};var l="ruleName";return n[l]=e,n["originalGrammarAction"]=t,n},e.prototype.invokeRuleCatch=function(e,t,r){var n=1===this.RULE_STACK.length,a=t&&!this.isBackTracking()&&this.recoveryEnabled;if(tn(e)){var s=e;if(a){var i=this.findReSyncTokenType();if(this.isInCurrentRuleReSyncSet(i)){if(s.resyncedTokens=this.reSyncTo(i),this.outputCst){var o=this.CST_STACK[this.CST_STACK.length-1];return o.recoveredNode=!0,o}return r()}if(this.outputCst){o=this.CST_STACK[this.CST_STACK.length-1];o.recoveredNode=!0,s.partialCstResult=o}throw s}if(n)return this.moveToTerminatedState(),r();throw s}throw e},e.prototype.optionInternal=function(e,t){var r=this.getKeyForAutomaticLookahead(wt,t),n=this.nestedRuleBeforeClause(e,r);try{return this.optionInternalLogic(e,t,r)}finally{void 0!==n&&this.nestedRuleFinallyClause(r,n)}},e.prototype.optionInternalNoCst=function(e,t){var r=this.getKeyForAutomaticLookahead(wt,t);return this.optionInternalLogic(e,t,r)},e.prototype.optionInternalLogic=function(e,t,r){var n,a,s=this,i=this.getLaFuncFromCache(r);if(void 0!==e.DEF){if(n=e.DEF,a=e.GATE,void 0!==a){var o=i;i=function(){return a.call(s)&&o.call(s)}}}else n=e;if(!0===i.call(this))return n.call(this)},e.prototype.atLeastOneInternal=function(e,t){var r=this.getKeyForAutomaticLookahead(Ct,e),n=this.nestedRuleBeforeClause(t,r);try{return this.atLeastOneInternalLogic(e,t,r)}finally{void 0!==n&&this.nestedRuleFinallyClause(r,n)}},e.prototype.atLeastOneInternalNoCst=function(e,t){var r=this.getKeyForAutomaticLookahead(Ct,e);this.atLeastOneInternalLogic(e,t,r)},e.prototype.atLeastOneInternalLogic=function(e,t,r){var n,a,s=this,i=this.getLaFuncFromCache(r);if(void 0!==t.DEF){if(n=t.DEF,a=t.GATE,void 0!==a){var o=i;i=function(){return a.call(s)&&o.call(s)}}}else n=t;if(!0!==i.call(this))throw this.raiseEarlyExitException(e,Jt.REPETITION_MANDATORY,t.ERR_MSG);var c=this.doSingleRepetition(n);while(!0===i.call(this)&&!0===c)c=this.doSingleRepetition(n);this.attemptInRepetitionRecovery(this.atLeastOneInternal,[e,t],i,Ct,e,$t)},e.prototype.atLeastOneSepFirstInternal=function(e,t){var r=this.getKeyForAutomaticLookahead(It,e),n=this.nestedRuleBeforeClause(t,r);try{this.atLeastOneSepFirstInternalLogic(e,t,r)}finally{void 0!==n&&this.nestedRuleFinallyClause(r,n)}},e.prototype.atLeastOneSepFirstInternalNoCst=function(e,t){var r=this.getKeyForAutomaticLookahead(It,e);this.atLeastOneSepFirstInternalLogic(e,t,r)},e.prototype.atLeastOneSepFirstInternalLogic=function(e,t,r){var n=this,a=t.DEF,s=t.SEP,i=this.getLaFuncFromCache(r);if(!0!==i.call(this))throw this.raiseEarlyExitException(e,Jt.REPETITION_MANDATORY_WITH_SEPARATOR,t.ERR_MSG);a.call(this);var o=function(){return n.tokenMatcher(n.LA(1),s)};while(!0===this.tokenMatcher(this.LA(1),s))this.CONSUME(s),a.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[e,s,o,a,jt],o,It,e,jt)},e.prototype.manyInternal=function(e,t){var r=this.getKeyForAutomaticLookahead(bt,e),n=this.nestedRuleBeforeClause(t,r);try{return this.manyInternalLogic(e,t,r)}finally{void 0!==n&&this.nestedRuleFinallyClause(r,n)}},e.prototype.manyInternalNoCst=function(e,t){var r=this.getKeyForAutomaticLookahead(bt,e);return this.manyInternalLogic(e,t,r)},e.prototype.manyInternalLogic=function(e,t,r){var n,a,s=this,i=this.getLaFuncFromCache(r);if(void 0!==t.DEF){if(n=t.DEF,a=t.GATE,void 0!==a){var o=i;i=function(){return a.call(s)&&o.call(s)}}}else n=t;var c=!0;while(!0===i.call(this)&&!0===c)c=this.doSingleRepetition(n);this.attemptInRepetitionRecovery(this.manyInternal,[e,t],i,bt,e,Ht,c)},e.prototype.manySepFirstInternal=function(e,t){var r=this.getKeyForAutomaticLookahead(Ot,e),n=this.nestedRuleBeforeClause(t,r);try{this.manySepFirstInternalLogic(e,t,r)}finally{void 0!==n&&this.nestedRuleFinallyClause(r,n)}},e.prototype.manySepFirstInternalNoCst=function(e,t){var r=this.getKeyForAutomaticLookahead(Ot,e);this.manySepFirstInternalLogic(e,t,r)},e.prototype.manySepFirstInternalLogic=function(e,t,r){var n=this,a=t.DEF,s=t.SEP,i=this.getLaFuncFromCache(r);if(!0===i.call(this)){a.call(this);var o=function(){return n.tokenMatcher(n.LA(1),s)};while(!0===this.tokenMatcher(this.LA(1),s))this.CONSUME(s),a.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[e,s,o,a,zt],o,Ot,e,zt)}},e.prototype.repetitionSepSecondInternal=function(e,t,r,n,a){while(r())this.CONSUME(t),n.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[e,t,r,n,a],r,It,e,a)},e.prototype.doSingleRepetition=function(e){var t=this.getLexerPosition();e.call(this);var r=this.getLexerPosition();return r>t},e.prototype.orInternalNoCst=function(e,t){var r=(0,a.kJ)(e)?e:e.DEF,n=this.getKeyForAutomaticLookahead(Nt,t),s=this.getLaFuncFromCache(n),i=s.call(this,r);if(void 0!==i){var o=r[i];return o.ALT.call(this)}this.raiseNoAltException(t,e.ERR_MSG)},e.prototype.orInternal=function(e,t){var r=this.getKeyForAutomaticLookahead(Nt,t),n=this.nestedRuleBeforeClause(e,r);try{var s=(0,a.kJ)(e)?e:e.DEF,i=this.getLaFuncFromCache(r),o=i.call(this,s);if(void 0!==o){var c=s[o],l=this.nestedAltBeforeClause(c,t,Nt,o);try{return c.ALT.call(this)}finally{void 0!==l&&this.nestedRuleFinallyClause(l.shortName,l.nestedName)}}this.raiseNoAltException(t,e.ERR_MSG)}finally{void 0!==n&&this.nestedRuleFinallyClause(r,n)}},e.prototype.ruleFinallyStateUpdate=function(){if(this.RULE_STACK.pop(),this.RULE_OCCURRENCE_STACK.pop(),this.cstFinallyStateUpdate(),0===this.RULE_STACK.length&&!1===this.isAtEndOfInput()){var e=this.LA(1),t=this.errorMessageProvider.buildNotAllInputParsedMessage({firstRedundant:e,ruleName:this.getCurrRuleFullName()});this.SAVE_ERROR(new an(t,e))}},e.prototype.subruleInternal=function(e,t,r){var n;try{var a=void 0!==r?r.ARGS:void 0;return n=e.call(this,t,a),this.cstPostNonTerminal(n,void 0!==r&&void 0!==r.LABEL?r.LABEL:e.ruleName),n}catch(s){this.subruleInternalError(s,r,e.ruleName)}},e.prototype.subruleInternalError=function(e,t,r){throw tn(e)&&void 0!==e.partialCstResult&&(this.cstPostNonTerminal(e.partialCstResult,void 0!==t&&void 0!==t.LABEL?t.LABEL:r),delete e.partialCstResult),e},e.prototype.consumeInternal=function(e,t,r){var n;try{var a=this.LA(1);!0===this.tokenMatcher(a,e)?(this.consumeToken(),n=a):this.consumeInternalError(e,a,r)}catch(s){n=this.consumeInternalRecovery(e,t,s)}return this.cstPostTerminal(void 0!==r&&void 0!==r.LABEL?r.LABEL:e.name,n),n},e.prototype.consumeInternalError=function(e,t,r){var n,a=this.LA(0);throw n=void 0!==r&&r.ERR_MSG?r.ERR_MSG:this.errorMessageProvider.buildMismatchTokenMessage({expected:e,actual:t,previous:a,ruleName:this.getCurrRuleFullName()}),this.SAVE_ERROR(new rn(n,t,a))},e.prototype.consumeInternalRecovery=function(e,t,r){if(!this.recoveryEnabled||"MismatchedTokenException"!==r.name||this.isBackTracking())throw r;var n=this.getFollowsForInRuleRecovery(e,t);try{return this.tryInRuleRecovery(e,n)}catch(a){throw a.name===cn?r:a}},e.prototype.saveRecogState=function(){var e=this.errors,t=(0,a.Qw)(this.RULE_STACK);return{errors:e,lexerState:this.exportLexerState(),RULE_STACK:t,CST_STACK:this.CST_STACK,LAST_EXPLICIT_RULE_STACK:this.LAST_EXPLICIT_RULE_STACK}},e.prototype.reloadRecogState=function(e){this.errors=e.errors,this.importLexerState(e.lexerState),this.RULE_STACK=e.RULE_STACK},e.prototype.ruleInvocationStateUpdate=function(e,t,r){this.RULE_OCCURRENCE_STACK.push(r),this.RULE_STACK.push(e),this.cstInvocationStateUpdate(t,e)},e.prototype.isBackTracking=function(){return 0!==this.isBackTrackingStack.length},e.prototype.getCurrRuleFullName=function(){var e=this.getLastExplicitRuleShortName();return this.shortRuleNameToFull[e]},e.prototype.shortRuleNameToFullName=function(e){return this.shortRuleNameToFull[e]},e.prototype.isAtEndOfInput=function(){return this.tokenMatcher(this.LA(1),Pe)},e.prototype.reset=function(){this.resetLexerState(),this.isBackTrackingStack=[],this.errors=[],this.RULE_STACK=[],this.LAST_EXPLICIT_RULE_STACK=[],this.CST_STACK=[],this.RULE_OCCURRENCE_STACK=[]},e}(),Mn=function(){function e(){}return e.prototype.initErrorHandler=function(e){this._errors=[],this.errorMessageProvider=(0,a.ce)(e.errorMessageProvider,jn.errorMessageProvider)},e.prototype.SAVE_ERROR=function(e){if(tn(e))return e.context={ruleStack:this.getHumanReadableRuleStack(),ruleOccurrenceStack:(0,a.Qw)(this.RULE_OCCURRENCE_STACK)},this._errors.push(e),e;throw Error("Trying to save an Error which is not a RecognitionException")},Object.defineProperty(e.prototype,"errors",{get:function(){return(0,a.Qw)(this._errors)},set:function(e){this._errors=e},enumerable:!0,configurable:!0}),e.prototype.raiseEarlyExitException=function(e,t,r){for(var n=this.getCurrRuleFullName(),a=this.getGAstProductions()[n],s=hr(e,a,t,this.maxLookahead),i=s[0],o=[],c=1;c<=this.maxLookahead;c++)o.push(this.LA(c));var l=this.errorMessageProvider.buildEarlyExitMessage({expectedIterationPaths:i,actual:o,previous:this.LA(0),customUserDescription:r,ruleName:n});throw this.SAVE_ERROR(new sn(l,this.LA(1),this.LA(0)))},e.prototype.raiseNoAltException=function(e,t){for(var r=this.getCurrRuleFullName(),n=this.getGAstProductions()[r],a=ur(e,n,this.maxLookahead),s=[],i=1;i<=this.maxLookahead;i++)s.push(this.LA(i));var o=this.LA(0),c=this.errorMessageProvider.buildNoViableAltMessage({expectedPathsPerAlt:a,actual:s,previous:o,customUserDescription:t,ruleName:this.getCurrRuleFullName()});throw this.SAVE_ERROR(new nn(c,this.LA(1),o))},e}(),Dn=function(){function e(){}return e.prototype.initContentAssist=function(){},e.prototype.computeContentAssist=function(e,t){var r=this.gastProductionsCache[e];if((0,a.o8)(r))throw Error("Rule ->"+e+"<- does not exist in this grammar.");return Kt([r],t,this.tokenMatcher,this.maxLookahead)},e.prototype.getNextPossibleTokenTypes=function(e){var t=(0,a.Ps)(e.ruleStack),r=this.getGAstProductions(),n=r[t],s=new Wt(n,e).startWalking();return s},e}(),Ln={description:"This Object indicates the Parser is during Recording Phase"};Object.freeze(Ln);var kn=!0,_n=Math.pow(2,Rt)-1,Un=xe({name:"RECORDING_PHASE_TOKEN",pattern:ye.NA});le([Un]);var xn=Be(Un,"This IToken indicates the Parser is in Recording Phase\n\tSee: https://sap.github.io/chevrotain/docs/guide/internals.html#grammar-recording for details",-1,-1,-1,-1,-1,-1);Object.freeze(xn);var Fn={name:"This CSTNode indicates the Parser is in Recording Phase\n\tSee: https://sap.github.io/chevrotain/docs/guide/internals.html#grammar-recording for details",children:{}},Pn=function(){function e(){}return e.prototype.initGastRecorder=function(e){this.recordingProdStack=[],this.RECORDING_PHASE=!1},e.prototype.enableRecording=function(){var e=this;this.RECORDING_PHASE=!0,this.TRACE_INIT("Enable Recording",(function(){for(var t=function(t){var r=t>0?t:"";e["CONSUME"+r]=function(e,r){return this.consumeInternalRecord(e,t,r)},e["SUBRULE"+r]=function(e,r){return this.subruleInternalRecord(e,t,r)},e["OPTION"+r]=function(e){return this.optionInternalRecord(e,t)},e["OR"+r]=function(e){return this.orInternalRecord(e,t)},e["MANY"+r]=function(e){this.manyInternalRecord(t,e)},e["MANY_SEP"+r]=function(e){this.manySepFirstInternalRecord(t,e)},e["AT_LEAST_ONE"+r]=function(e){this.atLeastOneInternalRecord(t,e)},e["AT_LEAST_ONE_SEP"+r]=function(e){this.atLeastOneSepFirstInternalRecord(t,e)}},r=0;r<10;r++)t(r);e["consume"]=function(e,t,r){return this.consumeInternalRecord(t,e,r)},e["subrule"]=function(e,t,r){return this.subruleInternalRecord(t,e,r)},e["option"]=function(e,t){return this.optionInternalRecord(t,e)},e["or"]=function(e,t){return this.orInternalRecord(t,e)},e["many"]=function(e,t){this.manyInternalRecord(e,t)},e["atLeastOne"]=function(e,t){this.atLeastOneInternalRecord(e,t)},e.ACTION=e.ACTION_RECORD,e.BACKTRACK=e.BACKTRACK_RECORD,e.LA=e.LA_RECORD}))},e.prototype.disableRecording=function(){var e=this;this.RECORDING_PHASE=!1,this.TRACE_INIT("Deleting Recording methods",(function(){for(var t=0;t<10;t++){var r=t>0?t:"";delete e["CONSUME"+r],delete e["SUBRULE"+r],delete e["OPTION"+r],delete e["OR"+r],delete e["MANY"+r],delete e["MANY_SEP"+r],delete e["AT_LEAST_ONE"+r],delete e["AT_LEAST_ONE_SEP"+r]}delete e["consume"],delete e["subrule"],delete e["option"],delete e["or"],delete e["many"],delete e["atLeastOne"],delete e.ACTION,delete e.BACKTRACK,delete e.LA}))},e.prototype.ACTION_RECORD=function(e){},e.prototype.BACKTRACK_RECORD=function(e,t){return function(){return!0}},e.prototype.LA_RECORD=function(e){return zn},e.prototype.topLevelRuleRecord=function(e,t){try{var r=new He({definition:[],name:e});return r.name=e,this.recordingProdStack.push(r),t.call(this),this.recordingProdStack.pop(),r}catch(n){if(!0!==n.KNOWN_RECORDER_ERROR)try{n.message=n.message+'\n\t This error was thrown during the "grammar recording phase" For more info see:\n\thttps://sap.github.io/chevrotain/docs/guide/internals.html#grammar-recording'}catch(a){throw n}throw n}},e.prototype.optionInternalRecord=function(e,t){return Bn.call(this,$e,e,t)},e.prototype.atLeastOneInternalRecord=function(e,t){Bn.call(this,je,t,e)},e.prototype.atLeastOneSepFirstInternalRecord=function(e,t){Bn.call(this,Xe,t,e,kn)},e.prototype.manyInternalRecord=function(e,t){Bn.call(this,Ke,t,e)},e.prototype.manySepFirstInternalRecord=function(e,t){Bn.call(this,qe,t,e,kn)},e.prototype.orInternalRecord=function(e,t){return Yn.call(this,e,t)},e.prototype.subruleInternalRecord=function(e,t,r){if(Wn(t),!e||!1===(0,a.e$)(e,"ruleName")){var n=new Error("<SUBRULE"+Vn(t)+"> argument is invalid expecting a Parser method reference but got: <"+JSON.stringify(e)+">\n inside top level rule: <"+this.recordingProdStack[0].name+">");throw n.KNOWN_RECORDER_ERROR=!0,n}var s=(0,a.fj)(this.recordingProdStack),i=e["ruleName"],o=new Ge({idx:t,nonTerminalName:i,referencedRule:void 0});return s.definition.push(o),this.outputCst?Fn:Ln},e.prototype.consumeInternalRecord=function(e,t,r){if(Wn(t),!me(e)){var n=new Error("<CONSUME"+Vn(t)+"> argument is invalid expecting a TokenType reference but got: <"+JSON.stringify(e)+">\n inside top level rule: <"+this.recordingProdStack[0].name+">");throw n.KNOWN_RECORDER_ERROR=!0,n}var s=(0,a.fj)(this.recordingProdStack),i=new Qe({idx:t,terminalType:e});return s.definition.push(i),xn},e}();function Bn(e,t,r,n){void 0===n&&(n=!1),Wn(r);var s=(0,a.fj)(this.recordingProdStack),i=(0,a.mf)(t)?t:t.DEF,o=new e({definition:[],idx:r});return(0,a.e$)(t,"NAME")&&(o.name=t.NAME),n&&(o.separator=t.SEP),(0,a.e$)(t,"MAX_LOOKAHEAD")&&(o.maxLookahead=t.MAX_LOOKAHEAD),this.recordingProdStack.push(o),i.call(this),s.definition.push(o),this.recordingProdStack.pop(),Ln}function Yn(e,t){var r=this;Wn(t);var n=(0,a.fj)(this.recordingProdStack),s=!1===(0,a.kJ)(e),i=!1===s?e:e.DEF,o=new Je({definition:[],idx:t,ignoreAmbiguities:s&&!0===e.IGNORE_AMBIGUITIES});(0,a.e$)(e,"NAME")&&(o.name=e.NAME),(0,a.e$)(e,"MAX_LOOKAHEAD")&&(o.maxLookahead=e.MAX_LOOKAHEAD);var c=(0,a.G)(i,(function(e){return(0,a.mf)(e.GATE)}));return o.hasPredicates=c,n.definition.push(o),(0,a.Ed)(i,(function(e){var t=new ze({definition:[]});o.definition.push(t),(0,a.e$)(e,"NAME")&&(t.name=e.NAME),(0,a.e$)(e,"IGNORE_AMBIGUITIES")?t.ignoreAmbiguities=e.IGNORE_AMBIGUITIES:(0,a.e$)(e,"GATE")&&(t.ignoreAmbiguities=!0),r.recordingProdStack.push(t),e.ALT.call(r),r.recordingProdStack.pop()})),Ln}function Vn(e){return 0===e?"":""+e}function Wn(e){if(e<0||e>_n){var t=new Error("Invalid DSL Method idx value: <"+e+">\n\tIdx value must be a none negative value smaller than "+(_n+1));throw t.KNOWN_RECORDER_ERROR=!0,t}}var Gn=function(){function e(){}return e.prototype.initPerformanceTracer=function(e){if((0,a.e$)(e,"traceInitPerf")){var t=e.traceInitPerf,r="number"===typeof t;this.traceInitMaxIdent=r?t:1/0,this.traceInitPerf=r?t>0:t}else this.traceInitMaxIdent=0,this.traceInitPerf=jn.traceInitPerf;this.traceInitIndent=-1},e.prototype.TRACE_INIT=function(e,t){if(!0===this.traceInitPerf){this.traceInitIndent++;var r=new Array(this.traceInitIndent+1).join("\t");this.traceInitIndent<this.traceInitMaxIdent&&console.log(r+"--\x3e <"+e+">");var n=(0,a.HT)(t),s=n.time,i=n.value,o=s>10?console.warn:console.log;return this.traceInitIndent<this.traceInitMaxIdent&&o(r+"<-- <"+e+"> time: "+s+"ms"),this.traceInitIndent--,i}return t()},e}(),Hn=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},e(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),zn=Be(Pe,"",NaN,NaN,NaN,NaN,NaN,NaN);Object.freeze(zn);var $n,jn=Object.freeze({recoveryEnabled:!1,maxLookahead:4,ignoredIssues:{},dynamicTokensEnabled:!1,outputCst:!0,errorMessageProvider:Vr,nodeLocationTracking:"none",traceInitPerf:!1,skipValidations:!1}),Xn=Object.freeze({recoveryValueFunc:function(){},resyncEnabled:!0});function Kn(e){return void 0===e&&(e=void 0),function(){return e}}(function(e){e[e["INVALID_RULE_NAME"]=0]="INVALID_RULE_NAME",e[e["DUPLICATE_RULE_NAME"]=1]="DUPLICATE_RULE_NAME",e[e["INVALID_RULE_OVERRIDE"]=2]="INVALID_RULE_OVERRIDE",e[e["DUPLICATE_PRODUCTIONS"]=3]="DUPLICATE_PRODUCTIONS",e[e["UNRESOLVED_SUBRULE_REF"]=4]="UNRESOLVED_SUBRULE_REF",e[e["LEFT_RECURSION"]=5]="LEFT_RECURSION",e[e["NONE_LAST_EMPTY_ALT"]=6]="NONE_LAST_EMPTY_ALT",e[e["AMBIGUOUS_ALTS"]=7]="AMBIGUOUS_ALTS",e[e["CONFLICT_TOKENS_RULES_NAMESPACE"]=8]="CONFLICT_TOKENS_RULES_NAMESPACE",e[e["INVALID_TOKEN_NAME"]=9]="INVALID_TOKEN_NAME",e[e["INVALID_NESTED_RULE_NAME"]=10]="INVALID_NESTED_RULE_NAME",e[e["DUPLICATE_NESTED_NAME"]=11]="DUPLICATE_NESTED_NAME",e[e["NO_NON_EMPTY_LOOKAHEAD"]=12]="NO_NON_EMPTY_LOOKAHEAD",e[e["AMBIGUOUS_PREFIX_ALTS"]=13]="AMBIGUOUS_PREFIX_ALTS",e[e["TOO_MANY_ALTS"]=14]="TOO_MANY_ALTS"})($n||($n={}));var qn=function(){function e(e,t){void 0===t&&(t=jn),this.ignoredIssues=jn.ignoredIssues,this.definitionErrors=[],this.selfAnalysisDone=!1;var r=this;r.initErrorHandler(t),r.initLexerAdapter(),r.initLooksAhead(t),r.initRecognizerEngine(e,t),r.initRecoverable(t),r.initTreeBuilder(t),r.initContentAssist(),r.initGastRecorder(t),r.initPerformanceTracer(t),(0,a.e$)(t,"ignoredIssues")&&t.ignoredIssues!==jn.ignoredIssues&&(0,a.rr)("The <ignoredIssues> IParserConfig property is soft-deprecated and will be removed in future versions.\n\tPlease use the <IGNORE_AMBIGUITIES> flag on the relevant DSL method instead."),this.ignoredIssues=(0,a.e$)(t,"ignoredIssues")?t.ignoredIssues:jn.ignoredIssues,this.skipValidations=(0,a.e$)(t,"skipValidations")?t.skipValidations:jn.skipValidations}return e.performSelfAnalysis=function(e){e.performSelfAnalysis()},e.prototype.performSelfAnalysis=function(){var t=this;this.TRACE_INIT("performSelfAnalysis",(function(){var r;t.selfAnalysisDone=!0;var n=t.className;t.TRACE_INIT("toFastProps",(function(){(0,a.SV)(t)})),t.TRACE_INIT("Grammar Recording",(function(){try{t.enableRecording(),(0,a.Ed)(t.definedRulesNames,(function(e){var r=t[e],n=r["originalGrammarAction"],a=void 0;t.TRACE_INIT(e+" Rule",(function(){a=t.topLevelRuleRecord(e,n)})),t.gastProductionsCache[e]=a}))}finally{t.disableRecording()}}));var s=[];if(t.TRACE_INIT("Grammar Resolving",(function(){s=jr({rules:(0,a.VO)(t.gastProductionsCache)}),t.definitionErrors.push.apply(t.definitionErrors,s)})),t.TRACE_INIT("Grammar Validations",(function(){if((0,a.xb)(s)&&!1===t.skipValidations){var e=Xr({rules:(0,a.VO)(t.gastProductionsCache),maxLookahead:t.maxLookahead,tokenTypes:(0,a.VO)(t.tokensMap),ignoredIssues:t.ignoredIssues,errMsgProvider:Gr,grammarName:n});t.definitionErrors.push.apply(t.definitionErrors,e)}})),(0,a.xb)(t.definitionErrors)&&(t.recoveryEnabled&&t.TRACE_INIT("computeAllProdsFollows",(function(){var e=Tt((0,a.VO)(t.gastProductionsCache));t.resyncFollows=e})),t.TRACE_INIT("ComputeLookaheadFunctions",(function(){t.preComputeLookaheadFunctions((0,a.VO)(t.gastProductionsCache))}))),t.TRACE_INIT("expandAllNestedRuleNames",(function(){var e=Bt((0,a.VO)(t.gastProductionsCache),t.fullRuleNameToShort);t.allRuleNames=e.allRuleNames})),!e.DEFER_DEFINITION_ERRORS_HANDLING&&!(0,a.xb)(t.definitionErrors))throw r=(0,a.UI)(t.definitionErrors,(function(e){return e.message})),new Error("Parser Definition Errors detected:\n "+r.join("\n-------------------------------\n"))}))},e.DEFER_DEFINITION_ERRORS_HANDLING=!1,e}();(0,a.ef)(qn,[un,fn,bn,Cn,In,On,Mn,Dn,Pn,Gn]);var Jn=function(e){function t(t,r){void 0===r&&(r=jn);var n=this,s=(0,a.Cl)(r);return s.outputCst=!0,n=e.call(this,t,s)||this,n}return Hn(t,e),t}(qn),Qn=function(e){function t(t,r){void 0===r&&(r=jn);var n=this,s=(0,a.Cl)(r);return s.outputCst=!1,n=e.call(this,t,s)||this,n}return Hn(t,e),t}(qn);function Zn(e,t){var r=void 0===t?{}:t,a=r.resourceBase,s=void 0===a?"https://unpkg.com/chevrotain@"+n+"/diagrams/":a,i=r.css,o=void 0===i?"https://unpkg.com/chevrotain@"+n+"/diagrams/diagrams.css":i,c='\n\x3c!-- This is a generated file --\x3e\n<!DOCTYPE html>\n<meta charset="utf-8">\n<style>\n  body {\n    background-color: hsl(30, 20%, 95%)\n  }\n</style>\n\n',l="\n<link rel='stylesheet' href='"+o+"'>\n",u="\n<script src='"+s+"vendor/railroad-diagrams.js'><\/script>\n<script src='"+s+"src/diagrams_builder.js'><\/script>\n<script src='"+s+"src/diagrams_behavior.js'><\/script>\n<script src='"+s+"src/main.js'><\/script>\n",h='\n<div id="diagrams" align="center"></div>    \n',f="\n<script>\n    window.serializedGrammar = "+JSON.stringify(e,null,"  ")+";\n<\/script>\n",d='\n<script>\n    var diagramsDiv = document.getElementById("diagrams");\n    main.drawDiagramsFromSerializedGrammar(serializedGrammar, diagramsDiv);\n<\/script>\n';return c+l+u+h+f+d}var ea="\n";function ta(e){return"\n(function (root, factory) {\n    if (typeof define === 'function' && define.amd) {\n        // AMD. Register as an anonymous module.\n        define(['chevrotain'], factory);\n    } else if (typeof module === 'object' && module.exports) {\n        // Node. Does not work with strict CommonJS, but\n        // only CommonJS-like environments that support module.exports,\n        // like Node.\n        module.exports = factory(require('chevrotain'));\n    } else {\n        // Browser globals (root is window)\n        root.returnExports = factory(root.b);\n    }\n}(typeof self !== 'undefined' ? self : this, function (chevrotain) {\n\n"+na(e)+"\n    \nreturn {\n    "+e.name+": "+e.name+" \n}\n}));\n"}function ra(e){return"    \n"+na(e)+"\nreturn new "+e.name+"(tokenVocabulary, config)    \n"}function na(e){var t="\nfunction "+e.name+"(tokenVocabulary, config) {\n    // invoke super constructor\n    // No support for embedded actions currently, so we can 'hardcode'\n    // The use of CstParser.\n    chevrotain.CstParser.call(this, tokenVocabulary, config)\n\n    const $ = this\n\n    "+aa(e.rules)+"\n\n    // very important to call this after all the rules have been defined.\n    // otherwise the parser may not work correctly as it will lack information\n    // derived during the self analysis phase.\n    this.performSelfAnalysis(this)\n}\n\n// inheritance as implemented in javascript in the previous decade... :(\n"+e.name+".prototype = Object.create(chevrotain.CstParser.prototype)\n"+e.name+".prototype.constructor = "+e.name+"    \n    ";return t}function aa(e){var t=(0,a.UI)(e,(function(e){return sa(e,1)}));return t.join("\n")}function sa(e,t){var r=pa(t,'$.RULE("'+e.name+'", function() {')+ea;return r+=da(e.definition,t+1),r+=pa(t+1,"})")+ea,r}function ia(e,t){var r=e.terminalType.name;return pa(t,"$.CONSUME"+e.idx+"(this.tokensMap."+r+")"+ea)}function oa(e,t){return pa(t,"$.SUBRULE"+e.idx+"($."+e.nonTerminalName+")"+ea)}function ca(e,t){var r=pa(t,"$.OR"+e.idx+"([")+ea,n=(0,a.UI)(e.definition,(function(e){return la(e,t+1)}));return r+=n.join(","+ea),r+=ea+pa(t,"])"+ea),r}function la(e,t){var r=pa(t,"{")+ea;return e.name&&(r+=pa(t+1,'NAME: "'+e.name+'",')+ea),r+=pa(t+1,"ALT: function() {")+ea,r+=da(e.definition,t+1),r+=pa(t+1,"}")+ea,r+=pa(t,"}"),r}function ua(e,t){if(e instanceof Ge)return oa(e,t);if(e instanceof $e)return ha("OPTION",e,t);if(e instanceof je)return ha("AT_LEAST_ONE",e,t);if(e instanceof Xe)return ha("AT_LEAST_ONE_SEP",e,t);if(e instanceof qe)return ha("MANY_SEP",e,t);if(e instanceof Ke)return ha("MANY",e,t);if(e instanceof Je)return ca(e,t);if(e instanceof Qe)return ia(e,t);if(e instanceof ze)return da(e.definition,t);throw Error("non exhaustive match")}function ha(e,t,r){var n=pa(r,"$."+(e+t.idx)+"(");return t.name||t.separator?(n+="{"+ea,t.name&&(n+=pa(r+1,'NAME: "'+t.name+'"')+","+ea),t.separator&&(n+=pa(r+1,"SEP: this.tokensMap."+t.separator.name)+","+ea),n+="DEF: "+fa(t.definition,r+2)+ea,n+=pa(r,"}")+ea):n+=fa(t.definition,r+1),n+=pa(r,")")+ea,n}function fa(e,t){var r="function() {"+ea;return r+=da(e,t),r+=pa(t,"}")+ea,r}function da(e,t){var r="";return(0,a.Ed)(e,(function(e){r+=ua(e,t+1)})),r}function pa(e,t){var r=Array(4*e+1).join(" ");return r+t}function ma(e){var t=ra({name:e.name,rules:e.rules}),n=new Function("tokenVocabulary","config","chevrotain",t);return function(t){return n(e.tokenVocabulary,t,r(9193))}}function ga(e){return ta({name:e.name,rules:e.rules})}function Ea(){console.warn("The clearCache function was 'soft' removed from the Chevrotain API.\n\t It performs no action other than printing this message.\n\t Please avoid using it as it will be completely removed in the future")}},1395:function(e,t,r){"use strict";r.d(t,{Cl:function(){return w},Cw:function(){return E},Ed:function(){return d},G:function(){return F},HD:function(){return p},HT:function(){return te},Kj:function(){return k},Kn:function(){return _},Oq:function(){return C},Ps:function(){return h},Q8:function(){return c},Qw:function(){return N},SV:function(){return Z},TS:function(){return z},UI:function(){return l},VO:function(){return o},WB:function(){return K},Wd:function(){return j},X0:function(){return X},XP:function(){return i},Z$:function(){return f},ce:function(){return G},cq:function(){return P},d1:function(){return S},dG:function(){return $},dU:function(){return J},e$:function(){return R},e5:function(){return x},ef:function(){return Q},ei:function(){return A},f0:function(){return V},fj:function(){return ee},hX:function(){return T},j7:function(){return v},jj:function(){return M},kJ:function(){return L},mf:function(){return g},o8:function(){return m},oA:function(){return I},r3:function(){return y},rr:function(){return q},sE:function(){return b},u4:function(){return O},vM:function(){return H},xH:function(){return u},xb:function(){return s},yW:function(){return U}});var n=r(1703),a=r.n(n);function s(e){return e&&0===e.length}function i(e){return void 0===e||null===e?[]:Object.keys(e)}function o(e){for(var t=[],r=Object.keys(e),n=0;n<r.length;n++)t.push(e[r[n]]);return t}function c(e,t){for(var r=[],n=i(e),a=0;a<n.length;a++){var s=n[a];r.push(t.call(null,e[s],s))}return r}function l(e,t){for(var r=[],n=0;n<e.length;n++)r.push(t.call(null,e[n],n));return r}function u(e){for(var t=[],r=0;r<e.length;r++){var n=e[r];Array.isArray(n)?t=t.concat(u(n)):t.push(n)}return t}function h(e){return s(e)?void 0:e[0]}function f(e){var t=e&&e.length;return t?e[t-1]:void 0}function d(e,t){if(Array.isArray(e))for(var r=0;r<e.length;r++)t.call(null,e[r],r);else{if(!_(e))throw Error("non exhaustive match");var n=i(e);for(r=0;r<n.length;r++){var a=n[r],s=e[a];t.call(null,s,a)}}}function p(e){return"string"===typeof e}function m(e){return void 0===e}function g(e){return e instanceof Function}function E(e,t){return void 0===t&&(t=1),e.slice(t,e.length)}function v(e,t){return void 0===t&&(t=1),e.slice(0,e.length-t)}function T(e,t){var r=[];if(Array.isArray(e))for(var n=0;n<e.length;n++){var a=e[n];t.call(null,a)&&r.push(a)}return r}function S(e,t){return T(e,(function(e){return!t(e)}))}function A(e,t){for(var r=Object.keys(e),n={},a=0;a<r.length;a++){var s=r[a],i=e[s];t(i)&&(n[s]=i)}return n}function R(e,t){return!!_(e)&&e.hasOwnProperty(t)}function y(e,t){return void 0!==b(e,(function(e){return e===t}))}function N(e){for(var t=[],r=0;r<e.length;r++)t.push(e[r]);return t}function w(e){var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}function b(e,t){for(var r=0;r<e.length;r++){var n=e[r];if(t.call(null,n))return n}}function C(e,t){for(var r=[],n=0;n<e.length;n++){var a=e[n];t.call(null,a)&&r.push(a)}return r}function O(e,t,r){for(var n=Array.isArray(e),a=n?e:o(e),s=n?[]:i(e),c=r,l=0;l<a.length;l++)c=t.call(null,c,a[l],n?l:s[l]);return c}function I(e){return S(e,(function(e){return null===e||void 0===e}))}function M(e,t){void 0===t&&(t=function(e){return e});var r=[];return O(e,(function(e,n){var a=t(n);return y(r,a)?e:(r.push(a),e.concat(n))}),[])}function D(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];var n=[null],a=n.concat(t);return Function.bind.apply(e,a)}function L(e){return Array.isArray(e)}function k(e){return e instanceof RegExp}function _(e){return e instanceof Object}function U(e,t){for(var r=0;r<e.length;r++)if(!t(e[r],r))return!1;return!0}function x(e,t){return S(e,(function(e){return y(t,e)}))}function F(e,t){for(var r=0;r<e.length;r++)if(t(e[r]))return!0;return!1}function P(e,t){for(var r=0;r<e.length;r++)if(e[r]===t)return r;return-1}function B(e,t){var r=N(e);return r.sort((function(e,r){return t(e)-t(r)})),r}function Y(e,t){if(e.length!==t.length)throw Error("can't zipObject with different number of keys and values!");for(var r={},n=0;n<e.length;n++)r[e[n]]=t[n];return r}function V(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];for(var n=0;n<t.length;n++)for(var a=t[n],s=i(a),o=0;o<s.length;o++){var c=s[o];e[c]=a[c]}return e}function W(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];for(var n=0;n<t.length;n++){var a=t[n];if(!m(a))for(var s=i(a),o=0;o<s.length;o++){var c=s[o];R(e,c)||(e[c]=a[c])}}return e}function G(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return W.apply(null,[{}].concat(e))}function H(e,t){var r={};return d(e,(function(e){var n=t(e),a=r[n];a?a.push(e):r[n]=[e]})),r}function z(e,t){for(var r=w(e),n=i(t),a=0;a<n.length;a++){var s=n[a],o=t[s];r[s]=o}return r}function $(){}function j(e){return e}function X(e){for(var t=[],r=0;r<e.length;r++){var n=e[r];t.push(void 0!==n?n:void 0)}return t}function K(e){console&&console.error&&console.error("Error: "+e)}function q(e){console&&console.warn&&console.warn("Warning: "+e)}function J(){return"function"===typeof Map}function Q(e,t){t.forEach((function(t){var r=t.prototype;Object.getOwnPropertyNames(r).forEach((function(n){if("constructor"!==n){var a=Object.getOwnPropertyDescriptor(r,n);a&&(a.get||a.set)?Object.defineProperty(e.prototype,n,a):e.prototype[n]=t.prototype[n]}}))}))}function Z(e){function t(){}t.prototype=e;var r=new t;function n(){return typeof r.bar}return n(),n(),e}function ee(e){return e[e.length-1]}function te(e){var t=(new Date).getTime(),r=e(),n=(new Date).getTime(),a=n-t;return{time:a,value:r}}},2337:function(e,t,r){var n,a,s;r(1703),function(r,i){a=[],n=i,s="function"===typeof n?n.apply(t,a):n,void 0===s||(e.exports=s)}("undefined"!==typeof self&&self,(function(){function e(){}e.prototype.saveState=function(){return{idx:this.idx,input:this.input,groupIdx:this.groupIdx}},e.prototype.restoreState=function(e){this.idx=e.idx,this.input=e.input,this.groupIdx=e.groupIdx},e.prototype.pattern=function(e){this.idx=0,this.input=e,this.groupIdx=0,this.consumeChar("/");var t=this.disjunction();this.consumeChar("/");var r={type:"Flags",global:!1,ignoreCase:!1,multiLine:!1,unicode:!1,sticky:!1};while(this.isRegExpFlag())switch(this.popChar()){case"g":o(r,"global");break;case"i":o(r,"ignoreCase");break;case"m":o(r,"multiLine");break;case"u":o(r,"unicode");break;case"y":o(r,"sticky");break}if(this.idx!==this.input.length)throw Error("Redundant input: "+this.input.substring(this.idx));return{type:"Pattern",flags:r,value:t}},e.prototype.disjunction=function(){var e=[];e.push(this.alternative());while("|"===this.peekChar())this.consumeChar("|"),e.push(this.alternative());return{type:"Disjunction",value:e}},e.prototype.alternative=function(){var e=[];while(this.isTerm())e.push(this.term());return{type:"Alternative",value:e}},e.prototype.term=function(){return this.isAssertion()?this.assertion():this.atom()},e.prototype.assertion=function(){switch(this.popChar()){case"^":return{type:"StartAnchor"};case"$":return{type:"EndAnchor"};case"\\":switch(this.popChar()){case"b":return{type:"WordBoundary"};case"B":return{type:"NonWordBoundary"}}throw Error("Invalid Assertion Escape");case"(":var e;switch(this.consumeChar("?"),this.popChar()){case"=":e="Lookahead";break;case"!":e="NegativeLookahead";break}c(e);var t=this.disjunction();return this.consumeChar(")"),{type:e,value:t}}l()},e.prototype.quantifier=function(e){var t;switch(this.popChar()){case"*":t={atLeast:0,atMost:1/0};break;case"+":t={atLeast:1,atMost:1/0};break;case"?":t={atLeast:0,atMost:1};break;case"{":var r=this.integerIncludingZero();switch(this.popChar()){case"}":t={atLeast:r,atMost:r};break;case",":var n;this.isDigit()?(n=this.integerIncludingZero(),t={atLeast:r,atMost:n}):t={atLeast:r,atMost:1/0},this.consumeChar("}");break}if(!0===e&&void 0===t)return;c(t);break}if(!0!==e||void 0!==t)return c(t),"?"===this.peekChar(0)?(this.consumeChar("?"),t.greedy=!1):t.greedy=!0,t.type="Quantifier",t},e.prototype.atom=function(){var e;switch(this.peekChar()){case".":e=this.dotAll();break;case"\\":e=this.atomEscape();break;case"[":e=this.characterClass();break;case"(":e=this.group();break}return void 0===e&&this.isPatternCharacter()&&(e=this.patternCharacter()),c(e),this.isQuantifier()&&(e.quantifier=this.quantifier()),e},e.prototype.dotAll=function(){return this.consumeChar("."),{type:"Set",complement:!0,value:[s("\n"),s("\r"),s("\u2028"),s("\u2029")]}},e.prototype.atomEscape=function(){switch(this.consumeChar("\\"),this.peekChar()){case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":return this.decimalEscapeAtom();case"d":case"D":case"s":case"S":case"w":case"W":return this.characterClassEscape();case"f":case"n":case"r":case"t":case"v":return this.controlEscapeAtom();case"c":return this.controlLetterEscapeAtom();case"0":return this.nulCharacterAtom();case"x":return this.hexEscapeSequenceAtom();case"u":return this.regExpUnicodeEscapeSequenceAtom();default:return this.identityEscapeAtom()}},e.prototype.decimalEscapeAtom=function(){var e=this.positiveInteger();return{type:"GroupBackReference",value:e}},e.prototype.characterClassEscape=function(){var e,t=!1;switch(this.popChar()){case"d":e=u;break;case"D":e=u,t=!0;break;case"s":e=f;break;case"S":e=f,t=!0;break;case"w":e=h;break;case"W":e=h,t=!0;break}return c(e),{type:"Set",value:e,complement:t}},e.prototype.controlEscapeAtom=function(){var e;switch(this.popChar()){case"f":e=s("\f");break;case"n":e=s("\n");break;case"r":e=s("\r");break;case"t":e=s("\t");break;case"v":e=s("\v");break}return c(e),{type:"Character",value:e}},e.prototype.controlLetterEscapeAtom=function(){this.consumeChar("c");var e=this.popChar();if(!1===/[a-zA-Z]/.test(e))throw Error("Invalid ");var t=e.toUpperCase().charCodeAt(0)-64;return{type:"Character",value:t}},e.prototype.nulCharacterAtom=function(){return this.consumeChar("0"),{type:"Character",value:s("\0")}},e.prototype.hexEscapeSequenceAtom=function(){return this.consumeChar("x"),this.parseHexDigits(2)},e.prototype.regExpUnicodeEscapeSequenceAtom=function(){return this.consumeChar("u"),this.parseHexDigits(4)},e.prototype.identityEscapeAtom=function(){var e=this.popChar();return{type:"Character",value:s(e)}},e.prototype.classPatternCharacterAtom=function(){switch(this.peekChar()){case"\n":case"\r":case"\u2028":case"\u2029":case"\\":case"]":throw Error("TBD");default:var e=this.popChar();return{type:"Character",value:s(e)}}},e.prototype.characterClass=function(){var e=[],t=!1;this.consumeChar("["),"^"===this.peekChar(0)&&(this.consumeChar("^"),t=!0);while(this.isClassAtom()){var r=this.classAtom(),n="Character"===r.type;if(n&&this.isRangeDash()){this.consumeChar("-");var a=this.classAtom(),o="Character"===a.type;if(o){if(a.value<r.value)throw Error("Range out of order in character class");e.push({from:r.value,to:a.value})}else i(r.value,e),e.push(s("-")),i(a.value,e)}else i(r.value,e)}return this.consumeChar("]"),{type:"Set",complement:t,value:e}},e.prototype.classAtom=function(){switch(this.peekChar()){case"]":case"\n":case"\r":case"\u2028":case"\u2029":throw Error("TBD");case"\\":return this.classEscape();default:return this.classPatternCharacterAtom()}},e.prototype.classEscape=function(){switch(this.consumeChar("\\"),this.peekChar()){case"b":return this.consumeChar("b"),{type:"Character",value:s("\b")};case"d":case"D":case"s":case"S":case"w":case"W":return this.characterClassEscape();case"f":case"n":case"r":case"t":case"v":return this.controlEscapeAtom();case"c":return this.controlLetterEscapeAtom();case"0":return this.nulCharacterAtom();case"x":return this.hexEscapeSequenceAtom();case"u":return this.regExpUnicodeEscapeSequenceAtom();default:return this.identityEscapeAtom()}},e.prototype.group=function(){var e=!0;switch(this.consumeChar("("),this.peekChar(0)){case"?":this.consumeChar("?"),this.consumeChar(":"),e=!1;break;default:this.groupIdx++;break}var t=this.disjunction();this.consumeChar(")");var r={type:"Group",capturing:e,value:t};return e&&(r.idx=this.groupIdx),r},e.prototype.positiveInteger=function(){var e=this.popChar();if(!1===a.test(e))throw Error("Expecting a positive integer");while(n.test(this.peekChar(0)))e+=this.popChar();return parseInt(e,10)},e.prototype.integerIncludingZero=function(){var e=this.popChar();if(!1===n.test(e))throw Error("Expecting an integer");while(n.test(this.peekChar(0)))e+=this.popChar();return parseInt(e,10)},e.prototype.patternCharacter=function(){var e=this.popChar();switch(e){case"\n":case"\r":case"\u2028":case"\u2029":case"^":case"$":case"\\":case".":case"*":case"+":case"?":case"(":case")":case"[":case"|":throw Error("TBD");default:return{type:"Character",value:s(e)}}},e.prototype.isRegExpFlag=function(){switch(this.peekChar(0)){case"g":case"i":case"m":case"u":case"y":return!0;default:return!1}},e.prototype.isRangeDash=function(){return"-"===this.peekChar()&&this.isClassAtom(1)},e.prototype.isDigit=function(){return n.test(this.peekChar(0))},e.prototype.isClassAtom=function(e){switch(void 0===e&&(e=0),this.peekChar(e)){case"]":case"\n":case"\r":case"\u2028":case"\u2029":return!1;default:return!0}},e.prototype.isTerm=function(){return this.isAtom()||this.isAssertion()},e.prototype.isAtom=function(){if(this.isPatternCharacter())return!0;switch(this.peekChar(0)){case".":case"\\":case"[":case"(":return!0;default:return!1}},e.prototype.isAssertion=function(){switch(this.peekChar(0)){case"^":case"$":return!0;case"\\":switch(this.peekChar(1)){case"b":case"B":return!0;default:return!1}case"(":return"?"===this.peekChar(1)&&("="===this.peekChar(2)||"!"===this.peekChar(2));default:return!1}},e.prototype.isQuantifier=function(){var e=this.saveState();try{return void 0!==this.quantifier(!0)}catch(t){return!1}finally{this.restoreState(e)}},e.prototype.isPatternCharacter=function(){switch(this.peekChar()){case"^":case"$":case"\\":case".":case"*":case"+":case"?":case"(":case")":case"[":case"|":case"/":case"\n":case"\r":case"\u2028":case"\u2029":return!1;default:return!0}},e.prototype.parseHexDigits=function(e){for(var t="",n=0;n<e;n++){var a=this.popChar();if(!1===r.test(a))throw Error("Expecting a HexDecimal digits");t+=a}var s=parseInt(t,16);return{type:"Character",value:s}},e.prototype.peekChar=function(e){return void 0===e&&(e=0),this.input[this.idx+e]},e.prototype.popChar=function(){var e=this.peekChar(0);return this.consumeChar(),e},e.prototype.consumeChar=function(e){if(void 0!==e&&this.input[this.idx]!==e)throw Error("Expected: '"+e+"' but found: '"+this.input[this.idx]+"' at offset: "+this.idx);if(this.idx>=this.input.length)throw Error("Unexpected end of input");this.idx++};var t,r=/[0-9a-fA-F]/,n=/[0-9]/,a=/[1-9]/;function s(e){return e.charCodeAt(0)}function i(e,t){void 0!==e.length?e.forEach((function(e){t.push(e)})):t.push(e)}function o(e,t){if(!0===e[t])throw"duplicate flag "+t;e[t]=!0}function c(e){if(void 0===e)throw Error("Internal Error - Should never get here!")}function l(){throw Error("Internal Error - Should never get here!")}var u=[];for(t=s("0");t<=s("9");t++)u.push(t);var h=[s("_")].concat(u);for(t=s("a");t<=s("z");t++)h.push(t);for(t=s("A");t<=s("Z");t++)h.push(t);var f=[s(" "),s("\f"),s("\n"),s("\r"),s("\t"),s("\v"),s("\t"),s(" "),s(" "),s(" "),s(" "),s(" "),s(" "),s(" "),s(" "),s(" "),s(" "),s(" "),s(" "),s(" "),s("\u2028"),s("\u2029"),s(" "),s(" "),s("　"),s("\ufeff")];function d(){}return d.prototype.visitChildren=function(e){for(var t in e){var r=e[t];e.hasOwnProperty(t)&&(void 0!==r.type?this.visit(r):Array.isArray(r)&&r.forEach((function(e){this.visit(e)}),this))}},d.prototype.visit=function(e){switch(e.type){case"Pattern":this.visitPattern(e);break;case"Flags":this.visitFlags(e);break;case"Disjunction":this.visitDisjunction(e);break;case"Alternative":this.visitAlternative(e);break;case"StartAnchor":this.visitStartAnchor(e);break;case"EndAnchor":this.visitEndAnchor(e);break;case"WordBoundary":this.visitWordBoundary(e);break;case"NonWordBoundary":this.visitNonWordBoundary(e);break;case"Lookahead":this.visitLookahead(e);break;case"NegativeLookahead":this.visitNegativeLookahead(e);break;case"Character":this.visitCharacter(e);break;case"Set":this.visitSet(e);break;case"Group":this.visitGroup(e);break;case"GroupBackReference":this.visitGroupBackReference(e);break;case"Quantifier":this.visitQuantifier(e);break}this.visitChildren(e)},d.prototype.visitPattern=function(e){},d.prototype.visitFlags=function(e){},d.prototype.visitDisjunction=function(e){},d.prototype.visitAlternative=function(e){},d.prototype.visitStartAnchor=function(e){},d.prototype.visitEndAnchor=function(e){},d.prototype.visitWordBoundary=function(e){},d.prototype.visitNonWordBoundary=function(e){},d.prototype.visitLookahead=function(e){},d.prototype.visitNegativeLookahead=function(e){},d.prototype.visitCharacter=function(e){},d.prototype.visitSet=function(e){},d.prototype.visitGroup=function(e){},d.prototype.visitGroupBackReference=function(e){},d.prototype.visitQuantifier=function(e){},{RegExpParser:e,BaseRegExpVisitor:d,VERSION:"0.4.0"}}))},6433:function(e){function t(){}t.prototype={on:function(e,t,r){var n=this.e||(this.e={});return(n[e]||(n[e]=[])).push({fn:t,ctx:r}),this},once:function(e,t,r){var n=this;function a(){n.off(e,a),t.apply(r,arguments)}return a._=t,this.on(e,a,r)},emit:function(e){var t=[].slice.call(arguments,1),r=((this.e||(this.e={}))[e]||[]).slice(),n=0,a=r.length;for(n;n<a;n++)r[n].fn.apply(r[n].ctx,t);return this},off:function(e,t){var r=this.e||(this.e={}),n=r[e],a=[];if(n&&t)for(var s=0,i=n.length;s<i;s++)n[s].fn!==t&&n[s].fn._!==t&&a.push(n[s]);return a.length?r[e]=a:delete r[e],this}},e.exports=t,e.exports.TinyEmitter=t},1784:function(e,t,r){r(1703),function(t){"use strict";for(var r=[null,0,{}],n=10,a=44032,s=4352,i=4449,o=4519,c=19,l=21,u=28,h=l*u,f=c*h,d=function(e,t){this.codepoint=e,this.feature=t},p={},m=[],g=0;g<=255;++g)m[g]=0;function E(e,t,r){var a=p[t];return a||(a=e(t,r),a.feature&&++m[t>>8&255]>n&&(p[t]=a)),a}function v(e,t,n){var a=65280&t,s=d.udata[a]||{},i=s[t];return new d(t,i||r)}function T(e,t,r){return r?e(t,r):new d(t,null)}function S(e,t,r){var n;if(t<s||s+c<=t&&t<a||a+f<t)return e(t,r);if(s<=t&&t<s+c){var p={},m=(t-s)*l;for(n=0;n<l;++n)p[i+n]=a+u*(n+m);return new d(t,[,,p])}var g=t-a,E=g%u,v=[];if(0!==E)v[0]=[a+g-E,o+E];else for(v[0]=[s+Math.floor(g/h),i+Math.floor(g%h/u)],v[2]={},n=1;n<u;++n)v[2][o+n]=t+n;return new d(t,v)}function A(e,t,n){return t<60||13311<t&&t<42607?new d(t,r):e(t,n)}var R=[A,E,T,S,v];d.fromCharCode=R.reduceRight((function(e,t){return function(r,n){return t(e,r,n)}}),null),d.isHighSurrogate=function(e){return e>=55296&&e<=56319},d.isLowSurrogate=function(e){return e>=56320&&e<=57343},d.prototype.prepFeature=function(){this.feature||(this.feature=d.fromCharCode(this.codepoint,!0).feature)},d.prototype.toString=function(){if(this.codepoint<65536)return String.fromCharCode(this.codepoint);var e=this.codepoint-65536;return String.fromCharCode(Math.floor(e/1024)+55296,e%1024+56320)},d.prototype.getDecomp=function(){return this.prepFeature(),this.feature[0]||null},d.prototype.isCompatibility=function(){return this.prepFeature(),!!this.feature[1]&&256&this.feature[1]},d.prototype.isExclude=function(){return this.prepFeature(),!!this.feature[1]&&512&this.feature[1]},d.prototype.getCanonicalClass=function(){return this.prepFeature(),this.feature[1]?255&this.feature[1]:0},d.prototype.getComposite=function(e){if(this.prepFeature(),!this.feature[2])return null;var t=this.feature[2][e.codepoint];return t?d.fromCharCode(t):null};var y=function(e){this.str=e,this.cursor=0};y.prototype.next=function(){if(this.str&&this.cursor<this.str.length){var e,t=this.str.charCodeAt(this.cursor++);return d.isHighSurrogate(t)&&this.cursor<this.str.length&&d.isLowSurrogate(e=this.str.charCodeAt(this.cursor))&&(t=1024*(t-55296)+(e-56320)+65536,++this.cursor),d.fromCharCode(t)}return this.str=null,null};var N=function(e,t){this.it=e,this.canonical=t,this.resBuf=[]};N.prototype.next=function(){function e(t,r){var n=r.getDecomp();if(!n||t&&r.isCompatibility())return[r];for(var a=[],s=0;s<n.length;++s){var i=e(t,d.fromCharCode(n[s]));a=a.concat(i)}return a}if(0===this.resBuf.length){var t=this.it.next();if(!t)return null;this.resBuf=e(this.canonical,t)}return this.resBuf.shift()};var w=function(e){this.it=e,this.resBuf=[]};w.prototype.next=function(){var e;if(0===this.resBuf.length)do{var t=this.it.next();if(!t)break;e=t.getCanonicalClass();var r=this.resBuf.length;if(0!==e)for(;r>0;--r){var n=this.resBuf[r-1],a=n.getCanonicalClass();if(a<=e)break}this.resBuf.splice(r,0,t)}while(0!==e);return this.resBuf.shift()};var b=function(e){this.it=e,this.procBuf=[],this.resBuf=[],this.lastClass=null};b.prototype.next=function(){while(0===this.resBuf.length){var e=this.it.next();if(!e){this.resBuf=this.procBuf,this.procBuf=[];break}if(0===this.procBuf.length)this.lastClass=e.getCanonicalClass(),this.procBuf.push(e);else{var t=this.procBuf[0],r=t.getComposite(e),n=e.getCanonicalClass();r&&(this.lastClass<n||0===this.lastClass)?this.procBuf[0]=r:(0===n&&(this.resBuf=this.procBuf,this.procBuf=[]),this.lastClass=n,this.procBuf.push(e))}}return this.resBuf.shift()};var C=function(e,t){switch(e){case"NFD":return new w(new N(new y(t),!0));case"NFKD":return new w(new N(new y(t),!1));case"NFC":return new b(new w(new N(new y(t),!0)));case"NFKC":return new b(new w(new N(new y(t),!1)))}throw e+" is invalid"},O=function(e,t){var r,n=C(e,t),a="";while(r=n.next())a+=r.toString();return a};function I(e){return O("NFD",e)}function M(e){return O("NFKD",e)}function D(e){return O("NFC",e)}function L(e){return O("NFKC",e)}d.udata={0:{60:[,,{824:8814}],61:[,,{824:8800}],62:[,,{824:8815}],65:[,,{768:192,769:193,770:194,771:195,772:256,774:258,775:550,776:196,777:7842,778:197,780:461,783:512,785:514,803:7840,805:7680,808:260}],66:[,,{775:7682,803:7684,817:7686}],67:[,,{769:262,770:264,775:266,780:268,807:199}],68:[,,{775:7690,780:270,803:7692,807:7696,813:7698,817:7694}],69:[,,{768:200,769:201,770:202,771:7868,772:274,774:276,775:278,776:203,777:7866,780:282,783:516,785:518,803:7864,807:552,808:280,813:7704,816:7706}],70:[,,{775:7710}],71:[,,{769:500,770:284,772:7712,774:286,775:288,780:486,807:290}],72:[,,{770:292,775:7714,776:7718,780:542,803:7716,807:7720,814:7722}],73:[,,{768:204,769:205,770:206,771:296,772:298,774:300,775:304,776:207,777:7880,780:463,783:520,785:522,803:7882,808:302,816:7724}],74:[,,{770:308}],75:[,,{769:7728,780:488,803:7730,807:310,817:7732}],76:[,,{769:313,780:317,803:7734,807:315,813:7740,817:7738}],77:[,,{769:7742,775:7744,803:7746}],78:[,,{768:504,769:323,771:209,775:7748,780:327,803:7750,807:325,813:7754,817:7752}],79:[,,{768:210,769:211,770:212,771:213,772:332,774:334,775:558,776:214,777:7886,779:336,780:465,783:524,785:526,795:416,803:7884,808:490}],80:[,,{769:7764,775:7766}],82:[,,{769:340,775:7768,780:344,783:528,785:530,803:7770,807:342,817:7774}],83:[,,{769:346,770:348,775:7776,780:352,803:7778,806:536,807:350}],84:[,,{775:7786,780:356,803:7788,806:538,807:354,813:7792,817:7790}],85:[,,{768:217,769:218,770:219,771:360,772:362,774:364,776:220,777:7910,778:366,779:368,780:467,783:532,785:534,795:431,803:7908,804:7794,808:370,813:7798,816:7796}],86:[,,{771:7804,803:7806}],87:[,,{768:7808,769:7810,770:372,775:7814,776:7812,803:7816}],88:[,,{775:7818,776:7820}],89:[,,{768:7922,769:221,770:374,771:7928,772:562,775:7822,776:376,777:7926,803:7924}],90:[,,{769:377,770:7824,775:379,780:381,803:7826,817:7828}],97:[,,{768:224,769:225,770:226,771:227,772:257,774:259,775:551,776:228,777:7843,778:229,780:462,783:513,785:515,803:7841,805:7681,808:261}],98:[,,{775:7683,803:7685,817:7687}],99:[,,{769:263,770:265,775:267,780:269,807:231}],100:[,,{775:7691,780:271,803:7693,807:7697,813:7699,817:7695}],101:[,,{768:232,769:233,770:234,771:7869,772:275,774:277,775:279,776:235,777:7867,780:283,783:517,785:519,803:7865,807:553,808:281,813:7705,816:7707}],102:[,,{775:7711}],103:[,,{769:501,770:285,772:7713,774:287,775:289,780:487,807:291}],104:[,,{770:293,775:7715,776:7719,780:543,803:7717,807:7721,814:7723,817:7830}],105:[,,{768:236,769:237,770:238,771:297,772:299,774:301,776:239,777:7881,780:464,783:521,785:523,803:7883,808:303,816:7725}],106:[,,{770:309,780:496}],107:[,,{769:7729,780:489,803:7731,807:311,817:7733}],108:[,,{769:314,780:318,803:7735,807:316,813:7741,817:7739}],109:[,,{769:7743,775:7745,803:7747}],110:[,,{768:505,769:324,771:241,775:7749,780:328,803:7751,807:326,813:7755,817:7753}],111:[,,{768:242,769:243,770:244,771:245,772:333,774:335,775:559,776:246,777:7887,779:337,780:466,783:525,785:527,795:417,803:7885,808:491}],112:[,,{769:7765,775:7767}],114:[,,{769:341,775:7769,780:345,783:529,785:531,803:7771,807:343,817:7775}],115:[,,{769:347,770:349,775:7777,780:353,803:7779,806:537,807:351}],116:[,,{775:7787,776:7831,780:357,803:7789,806:539,807:355,813:7793,817:7791}],117:[,,{768:249,769:250,770:251,771:361,772:363,774:365,776:252,777:7911,778:367,779:369,780:468,783:533,785:535,795:432,803:7909,804:7795,808:371,813:7799,816:7797}],118:[,,{771:7805,803:7807}],119:[,,{768:7809,769:7811,770:373,775:7815,776:7813,778:7832,803:7817}],120:[,,{775:7819,776:7821}],121:[,,{768:7923,769:253,770:375,771:7929,772:563,775:7823,776:255,777:7927,778:7833,803:7925}],122:[,,{769:378,770:7825,775:380,780:382,803:7827,817:7829}],160:[[32],256],168:[[32,776],256,{768:8173,769:901,834:8129}],170:[[97],256],175:[[32,772],256],178:[[50],256],179:[[51],256],180:[[32,769],256],181:[[956],256],184:[[32,807],256],185:[[49],256],186:[[111],256],188:[[49,8260,52],256],189:[[49,8260,50],256],190:[[51,8260,52],256],192:[[65,768]],193:[[65,769]],194:[[65,770],,{768:7846,769:7844,771:7850,777:7848}],195:[[65,771]],196:[[65,776],,{772:478}],197:[[65,778],,{769:506}],198:[,,{769:508,772:482}],199:[[67,807],,{769:7688}],200:[[69,768]],201:[[69,769]],202:[[69,770],,{768:7872,769:7870,771:7876,777:7874}],203:[[69,776]],204:[[73,768]],205:[[73,769]],206:[[73,770]],207:[[73,776],,{769:7726}],209:[[78,771]],210:[[79,768]],211:[[79,769]],212:[[79,770],,{768:7890,769:7888,771:7894,777:7892}],213:[[79,771],,{769:7756,772:556,776:7758}],214:[[79,776],,{772:554}],216:[,,{769:510}],217:[[85,768]],218:[[85,769]],219:[[85,770]],220:[[85,776],,{768:475,769:471,772:469,780:473}],221:[[89,769]],224:[[97,768]],225:[[97,769]],226:[[97,770],,{768:7847,769:7845,771:7851,777:7849}],227:[[97,771]],228:[[97,776],,{772:479}],229:[[97,778],,{769:507}],230:[,,{769:509,772:483}],231:[[99,807],,{769:7689}],232:[[101,768]],233:[[101,769]],234:[[101,770],,{768:7873,769:7871,771:7877,777:7875}],235:[[101,776]],236:[[105,768]],237:[[105,769]],238:[[105,770]],239:[[105,776],,{769:7727}],241:[[110,771]],242:[[111,768]],243:[[111,769]],244:[[111,770],,{768:7891,769:7889,771:7895,777:7893}],245:[[111,771],,{769:7757,772:557,776:7759}],246:[[111,776],,{772:555}],248:[,,{769:511}],249:[[117,768]],250:[[117,769]],251:[[117,770]],252:[[117,776],,{768:476,769:472,772:470,780:474}],253:[[121,769]],255:[[121,776]]},256:{256:[[65,772]],257:[[97,772]],258:[[65,774],,{768:7856,769:7854,771:7860,777:7858}],259:[[97,774],,{768:7857,769:7855,771:7861,777:7859}],260:[[65,808]],261:[[97,808]],262:[[67,769]],263:[[99,769]],264:[[67,770]],265:[[99,770]],266:[[67,775]],267:[[99,775]],268:[[67,780]],269:[[99,780]],270:[[68,780]],271:[[100,780]],274:[[69,772],,{768:7700,769:7702}],275:[[101,772],,{768:7701,769:7703}],276:[[69,774]],277:[[101,774]],278:[[69,775]],279:[[101,775]],280:[[69,808]],281:[[101,808]],282:[[69,780]],283:[[101,780]],284:[[71,770]],285:[[103,770]],286:[[71,774]],287:[[103,774]],288:[[71,775]],289:[[103,775]],290:[[71,807]],291:[[103,807]],292:[[72,770]],293:[[104,770]],296:[[73,771]],297:[[105,771]],298:[[73,772]],299:[[105,772]],300:[[73,774]],301:[[105,774]],302:[[73,808]],303:[[105,808]],304:[[73,775]],306:[[73,74],256],307:[[105,106],256],308:[[74,770]],309:[[106,770]],310:[[75,807]],311:[[107,807]],313:[[76,769]],314:[[108,769]],315:[[76,807]],316:[[108,807]],317:[[76,780]],318:[[108,780]],319:[[76,183],256],320:[[108,183],256],323:[[78,769]],324:[[110,769]],325:[[78,807]],326:[[110,807]],327:[[78,780]],328:[[110,780]],329:[[700,110],256],332:[[79,772],,{768:7760,769:7762}],333:[[111,772],,{768:7761,769:7763}],334:[[79,774]],335:[[111,774]],336:[[79,779]],337:[[111,779]],340:[[82,769]],341:[[114,769]],342:[[82,807]],343:[[114,807]],344:[[82,780]],345:[[114,780]],346:[[83,769],,{775:7780}],347:[[115,769],,{775:7781}],348:[[83,770]],349:[[115,770]],350:[[83,807]],351:[[115,807]],352:[[83,780],,{775:7782}],353:[[115,780],,{775:7783}],354:[[84,807]],355:[[116,807]],356:[[84,780]],357:[[116,780]],360:[[85,771],,{769:7800}],361:[[117,771],,{769:7801}],362:[[85,772],,{776:7802}],363:[[117,772],,{776:7803}],364:[[85,774]],365:[[117,774]],366:[[85,778]],367:[[117,778]],368:[[85,779]],369:[[117,779]],370:[[85,808]],371:[[117,808]],372:[[87,770]],373:[[119,770]],374:[[89,770]],375:[[121,770]],376:[[89,776]],377:[[90,769]],378:[[122,769]],379:[[90,775]],380:[[122,775]],381:[[90,780]],382:[[122,780]],383:[[115],256,{775:7835}],416:[[79,795],,{768:7900,769:7898,771:7904,777:7902,803:7906}],417:[[111,795],,{768:7901,769:7899,771:7905,777:7903,803:7907}],431:[[85,795],,{768:7914,769:7912,771:7918,777:7916,803:7920}],432:[[117,795],,{768:7915,769:7913,771:7919,777:7917,803:7921}],439:[,,{780:494}],452:[[68,381],256],453:[[68,382],256],454:[[100,382],256],455:[[76,74],256],456:[[76,106],256],457:[[108,106],256],458:[[78,74],256],459:[[78,106],256],460:[[110,106],256],461:[[65,780]],462:[[97,780]],463:[[73,780]],464:[[105,780]],465:[[79,780]],466:[[111,780]],467:[[85,780]],468:[[117,780]],469:[[220,772]],470:[[252,772]],471:[[220,769]],472:[[252,769]],473:[[220,780]],474:[[252,780]],475:[[220,768]],476:[[252,768]],478:[[196,772]],479:[[228,772]],480:[[550,772]],481:[[551,772]],482:[[198,772]],483:[[230,772]],486:[[71,780]],487:[[103,780]],488:[[75,780]],489:[[107,780]],490:[[79,808],,{772:492}],491:[[111,808],,{772:493}],492:[[490,772]],493:[[491,772]],494:[[439,780]],495:[[658,780]],496:[[106,780]],497:[[68,90],256],498:[[68,122],256],499:[[100,122],256],500:[[71,769]],501:[[103,769]],504:[[78,768]],505:[[110,768]],506:[[197,769]],507:[[229,769]],508:[[198,769]],509:[[230,769]],510:[[216,769]],511:[[248,769]],66045:[,220]},512:{512:[[65,783]],513:[[97,783]],514:[[65,785]],515:[[97,785]],516:[[69,783]],517:[[101,783]],518:[[69,785]],519:[[101,785]],520:[[73,783]],521:[[105,783]],522:[[73,785]],523:[[105,785]],524:[[79,783]],525:[[111,783]],526:[[79,785]],527:[[111,785]],528:[[82,783]],529:[[114,783]],530:[[82,785]],531:[[114,785]],532:[[85,783]],533:[[117,783]],534:[[85,785]],535:[[117,785]],536:[[83,806]],537:[[115,806]],538:[[84,806]],539:[[116,806]],542:[[72,780]],543:[[104,780]],550:[[65,775],,{772:480}],551:[[97,775],,{772:481}],552:[[69,807],,{774:7708}],553:[[101,807],,{774:7709}],554:[[214,772]],555:[[246,772]],556:[[213,772]],557:[[245,772]],558:[[79,775],,{772:560}],559:[[111,775],,{772:561}],560:[[558,772]],561:[[559,772]],562:[[89,772]],563:[[121,772]],658:[,,{780:495}],688:[[104],256],689:[[614],256],690:[[106],256],691:[[114],256],692:[[633],256],693:[[635],256],694:[[641],256],695:[[119],256],696:[[121],256],728:[[32,774],256],729:[[32,775],256],730:[[32,778],256],731:[[32,808],256],732:[[32,771],256],733:[[32,779],256],736:[[611],256],737:[[108],256],738:[[115],256],739:[[120],256],740:[[661],256],66272:[,220]},768:{768:[,230],769:[,230],770:[,230],771:[,230],772:[,230],773:[,230],774:[,230],775:[,230],776:[,230,{769:836}],777:[,230],778:[,230],779:[,230],780:[,230],781:[,230],782:[,230],783:[,230],784:[,230],785:[,230],786:[,230],787:[,230],788:[,230],789:[,232],790:[,220],791:[,220],792:[,220],793:[,220],794:[,232],795:[,216],796:[,220],797:[,220],798:[,220],799:[,220],800:[,220],801:[,202],802:[,202],803:[,220],804:[,220],805:[,220],806:[,220],807:[,202],808:[,202],809:[,220],810:[,220],811:[,220],812:[,220],813:[,220],814:[,220],815:[,220],816:[,220],817:[,220],818:[,220],819:[,220],820:[,1],821:[,1],822:[,1],823:[,1],824:[,1],825:[,220],826:[,220],827:[,220],828:[,220],829:[,230],830:[,230],831:[,230],832:[[768],230],833:[[769],230],834:[,230],835:[[787],230],836:[[776,769],230],837:[,240],838:[,230],839:[,220],840:[,220],841:[,220],842:[,230],843:[,230],844:[,230],845:[,220],846:[,220],848:[,230],849:[,230],850:[,230],851:[,220],852:[,220],853:[,220],854:[,220],855:[,230],856:[,232],857:[,220],858:[,220],859:[,230],860:[,233],861:[,234],862:[,234],863:[,233],864:[,234],865:[,234],866:[,233],867:[,230],868:[,230],869:[,230],870:[,230],871:[,230],872:[,230],873:[,230],874:[,230],875:[,230],876:[,230],877:[,230],878:[,230],879:[,230],884:[[697]],890:[[32,837],256],894:[[59]],900:[[32,769],256],901:[[168,769]],902:[[913,769]],903:[[183]],904:[[917,769]],905:[[919,769]],906:[[921,769]],908:[[927,769]],910:[[933,769]],911:[[937,769]],912:[[970,769]],913:[,,{768:8122,769:902,772:8121,774:8120,787:7944,788:7945,837:8124}],917:[,,{768:8136,769:904,787:7960,788:7961}],919:[,,{768:8138,769:905,787:7976,788:7977,837:8140}],921:[,,{768:8154,769:906,772:8153,774:8152,776:938,787:7992,788:7993}],927:[,,{768:8184,769:908,787:8008,788:8009}],929:[,,{788:8172}],933:[,,{768:8170,769:910,772:8169,774:8168,776:939,788:8025}],937:[,,{768:8186,769:911,787:8040,788:8041,837:8188}],938:[[921,776]],939:[[933,776]],940:[[945,769],,{837:8116}],941:[[949,769]],942:[[951,769],,{837:8132}],943:[[953,769]],944:[[971,769]],945:[,,{768:8048,769:940,772:8113,774:8112,787:7936,788:7937,834:8118,837:8115}],949:[,,{768:8050,769:941,787:7952,788:7953}],951:[,,{768:8052,769:942,787:7968,788:7969,834:8134,837:8131}],953:[,,{768:8054,769:943,772:8145,774:8144,776:970,787:7984,788:7985,834:8150}],959:[,,{768:8056,769:972,787:8e3,788:8001}],961:[,,{787:8164,788:8165}],965:[,,{768:8058,769:973,772:8161,774:8160,776:971,787:8016,788:8017,834:8166}],969:[,,{768:8060,769:974,787:8032,788:8033,834:8182,837:8179}],970:[[953,776],,{768:8146,769:912,834:8151}],971:[[965,776],,{768:8162,769:944,834:8167}],972:[[959,769]],973:[[965,769]],974:[[969,769],,{837:8180}],976:[[946],256],977:[[952],256],978:[[933],256,{769:979,776:980}],979:[[978,769]],980:[[978,776]],981:[[966],256],982:[[960],256],1008:[[954],256],1009:[[961],256],1010:[[962],256],1012:[[920],256],1013:[[949],256],1017:[[931],256],66422:[,230],66423:[,230],66424:[,230],66425:[,230],66426:[,230]},1024:{1024:[[1045,768]],1025:[[1045,776]],1027:[[1043,769]],1030:[,,{776:1031}],1031:[[1030,776]],1036:[[1050,769]],1037:[[1048,768]],1038:[[1059,774]],1040:[,,{774:1232,776:1234}],1043:[,,{769:1027}],1045:[,,{768:1024,774:1238,776:1025}],1046:[,,{774:1217,776:1244}],1047:[,,{776:1246}],1048:[,,{768:1037,772:1250,774:1049,776:1252}],1049:[[1048,774]],1050:[,,{769:1036}],1054:[,,{776:1254}],1059:[,,{772:1262,774:1038,776:1264,779:1266}],1063:[,,{776:1268}],1067:[,,{776:1272}],1069:[,,{776:1260}],1072:[,,{774:1233,776:1235}],1075:[,,{769:1107}],1077:[,,{768:1104,774:1239,776:1105}],1078:[,,{774:1218,776:1245}],1079:[,,{776:1247}],1080:[,,{768:1117,772:1251,774:1081,776:1253}],1081:[[1080,774]],1082:[,,{769:1116}],1086:[,,{776:1255}],1091:[,,{772:1263,774:1118,776:1265,779:1267}],1095:[,,{776:1269}],1099:[,,{776:1273}],1101:[,,{776:1261}],1104:[[1077,768]],1105:[[1077,776]],1107:[[1075,769]],1110:[,,{776:1111}],1111:[[1110,776]],1116:[[1082,769]],1117:[[1080,768]],1118:[[1091,774]],1140:[,,{783:1142}],1141:[,,{783:1143}],1142:[[1140,783]],1143:[[1141,783]],1155:[,230],1156:[,230],1157:[,230],1158:[,230],1159:[,230],1217:[[1046,774]],1218:[[1078,774]],1232:[[1040,774]],1233:[[1072,774]],1234:[[1040,776]],1235:[[1072,776]],1238:[[1045,774]],1239:[[1077,774]],1240:[,,{776:1242}],1241:[,,{776:1243}],1242:[[1240,776]],1243:[[1241,776]],1244:[[1046,776]],1245:[[1078,776]],1246:[[1047,776]],1247:[[1079,776]],1250:[[1048,772]],1251:[[1080,772]],1252:[[1048,776]],1253:[[1080,776]],1254:[[1054,776]],1255:[[1086,776]],1256:[,,{776:1258}],1257:[,,{776:1259}],1258:[[1256,776]],1259:[[1257,776]],1260:[[1069,776]],1261:[[1101,776]],1262:[[1059,772]],1263:[[1091,772]],1264:[[1059,776]],1265:[[1091,776]],1266:[[1059,779]],1267:[[1091,779]],1268:[[1063,776]],1269:[[1095,776]],1272:[[1067,776]],1273:[[1099,776]]},1280:{1415:[[1381,1410],256],1425:[,220],1426:[,230],1427:[,230],1428:[,230],1429:[,230],1430:[,220],1431:[,230],1432:[,230],1433:[,230],1434:[,222],1435:[,220],1436:[,230],1437:[,230],1438:[,230],1439:[,230],1440:[,230],1441:[,230],1442:[,220],1443:[,220],1444:[,220],1445:[,220],1446:[,220],1447:[,220],1448:[,230],1449:[,230],1450:[,220],1451:[,230],1452:[,230],1453:[,222],1454:[,228],1455:[,230],1456:[,10],1457:[,11],1458:[,12],1459:[,13],1460:[,14],1461:[,15],1462:[,16],1463:[,17],1464:[,18],1465:[,19],1466:[,19],1467:[,20],1468:[,21],1469:[,22],1471:[,23],1473:[,24],1474:[,25],1476:[,230],1477:[,220],1479:[,18]},1536:{1552:[,230],1553:[,230],1554:[,230],1555:[,230],1556:[,230],1557:[,230],1558:[,230],1559:[,230],1560:[,30],1561:[,31],1562:[,32],1570:[[1575,1619]],1571:[[1575,1620]],1572:[[1608,1620]],1573:[[1575,1621]],1574:[[1610,1620]],1575:[,,{1619:1570,1620:1571,1621:1573}],1608:[,,{1620:1572}],1610:[,,{1620:1574}],1611:[,27],1612:[,28],1613:[,29],1614:[,30],1615:[,31],1616:[,32],1617:[,33],1618:[,34],1619:[,230],1620:[,230],1621:[,220],1622:[,220],1623:[,230],1624:[,230],1625:[,230],1626:[,230],1627:[,230],1628:[,220],1629:[,230],1630:[,230],1631:[,220],1648:[,35],1653:[[1575,1652],256],1654:[[1608,1652],256],1655:[[1735,1652],256],1656:[[1610,1652],256],1728:[[1749,1620]],1729:[,,{1620:1730}],1730:[[1729,1620]],1746:[,,{1620:1747}],1747:[[1746,1620]],1749:[,,{1620:1728}],1750:[,230],1751:[,230],1752:[,230],1753:[,230],1754:[,230],1755:[,230],1756:[,230],1759:[,230],1760:[,230],1761:[,230],1762:[,230],1763:[,220],1764:[,230],1767:[,230],1768:[,230],1770:[,220],1771:[,230],1772:[,230],1773:[,220]},1792:{1809:[,36],1840:[,230],1841:[,220],1842:[,230],1843:[,230],1844:[,220],1845:[,230],1846:[,230],1847:[,220],1848:[,220],1849:[,220],1850:[,230],1851:[,220],1852:[,220],1853:[,230],1854:[,220],1855:[,230],1856:[,230],1857:[,230],1858:[,220],1859:[,230],1860:[,220],1861:[,230],1862:[,220],1863:[,230],1864:[,220],1865:[,230],1866:[,230],2027:[,230],2028:[,230],2029:[,230],2030:[,230],2031:[,230],2032:[,230],2033:[,230],2034:[,220],2035:[,230]},2048:{2070:[,230],2071:[,230],2072:[,230],2073:[,230],2075:[,230],2076:[,230],2077:[,230],2078:[,230],2079:[,230],2080:[,230],2081:[,230],2082:[,230],2083:[,230],2085:[,230],2086:[,230],2087:[,230],2089:[,230],2090:[,230],2091:[,230],2092:[,230],2093:[,230],2137:[,220],2138:[,220],2139:[,220],2276:[,230],2277:[,230],2278:[,220],2279:[,230],2280:[,230],2281:[,220],2282:[,230],2283:[,230],2284:[,230],2285:[,220],2286:[,220],2287:[,220],2288:[,27],2289:[,28],2290:[,29],2291:[,230],2292:[,230],2293:[,230],2294:[,220],2295:[,230],2296:[,230],2297:[,220],2298:[,220],2299:[,230],2300:[,230],2301:[,230],2302:[,230],2303:[,230]},2304:{2344:[,,{2364:2345}],2345:[[2344,2364]],2352:[,,{2364:2353}],2353:[[2352,2364]],2355:[,,{2364:2356}],2356:[[2355,2364]],2364:[,7],2381:[,9],2385:[,230],2386:[,220],2387:[,230],2388:[,230],2392:[[2325,2364],512],2393:[[2326,2364],512],2394:[[2327,2364],512],2395:[[2332,2364],512],2396:[[2337,2364],512],2397:[[2338,2364],512],2398:[[2347,2364],512],2399:[[2351,2364],512],2492:[,7],2503:[,,{2494:2507,2519:2508}],2507:[[2503,2494]],2508:[[2503,2519]],2509:[,9],2524:[[2465,2492],512],2525:[[2466,2492],512],2527:[[2479,2492],512]},2560:{2611:[[2610,2620],512],2614:[[2616,2620],512],2620:[,7],2637:[,9],2649:[[2582,2620],512],2650:[[2583,2620],512],2651:[[2588,2620],512],2654:[[2603,2620],512],2748:[,7],2765:[,9],68109:[,220],68111:[,230],68152:[,230],68153:[,1],68154:[,220],68159:[,9],68325:[,230],68326:[,220]},2816:{2876:[,7],2887:[,,{2878:2891,2902:2888,2903:2892}],2888:[[2887,2902]],2891:[[2887,2878]],2892:[[2887,2903]],2893:[,9],2908:[[2849,2876],512],2909:[[2850,2876],512],2962:[,,{3031:2964}],2964:[[2962,3031]],3014:[,,{3006:3018,3031:3020}],3015:[,,{3006:3019}],3018:[[3014,3006]],3019:[[3015,3006]],3020:[[3014,3031]],3021:[,9]},3072:{3142:[,,{3158:3144}],3144:[[3142,3158]],3149:[,9],3157:[,84],3158:[,91],3260:[,7],3263:[,,{3285:3264}],3264:[[3263,3285]],3270:[,,{3266:3274,3285:3271,3286:3272}],3271:[[3270,3285]],3272:[[3270,3286]],3274:[[3270,3266],,{3285:3275}],3275:[[3274,3285]],3277:[,9]},3328:{3398:[,,{3390:3402,3415:3404}],3399:[,,{3390:3403}],3402:[[3398,3390]],3403:[[3399,3390]],3404:[[3398,3415]],3405:[,9],3530:[,9],3545:[,,{3530:3546,3535:3548,3551:3550}],3546:[[3545,3530]],3548:[[3545,3535],,{3530:3549}],3549:[[3548,3530]],3550:[[3545,3551]]},3584:{3635:[[3661,3634],256],3640:[,103],3641:[,103],3642:[,9],3656:[,107],3657:[,107],3658:[,107],3659:[,107],3763:[[3789,3762],256],3768:[,118],3769:[,118],3784:[,122],3785:[,122],3786:[,122],3787:[,122],3804:[[3755,3737],256],3805:[[3755,3745],256]},3840:{3852:[[3851],256],3864:[,220],3865:[,220],3893:[,220],3895:[,220],3897:[,216],3907:[[3906,4023],512],3917:[[3916,4023],512],3922:[[3921,4023],512],3927:[[3926,4023],512],3932:[[3931,4023],512],3945:[[3904,4021],512],3953:[,129],3954:[,130],3955:[[3953,3954],512],3956:[,132],3957:[[3953,3956],512],3958:[[4018,3968],512],3959:[[4018,3969],256],3960:[[4019,3968],512],3961:[[4019,3969],256],3962:[,130],3963:[,130],3964:[,130],3965:[,130],3968:[,130],3969:[[3953,3968],512],3970:[,230],3971:[,230],3972:[,9],3974:[,230],3975:[,230],3987:[[3986,4023],512],3997:[[3996,4023],512],4002:[[4001,4023],512],4007:[[4006,4023],512],4012:[[4011,4023],512],4025:[[3984,4021],512],4038:[,220]},4096:{4133:[,,{4142:4134}],4134:[[4133,4142]],4151:[,7],4153:[,9],4154:[,9],4237:[,220],4348:[[4316],256],69702:[,9],69759:[,9],69785:[,,{69818:69786}],69786:[[69785,69818]],69787:[,,{69818:69788}],69788:[[69787,69818]],69797:[,,{69818:69803}],69803:[[69797,69818]],69817:[,9],69818:[,7]},4352:{69888:[,230],69889:[,230],69890:[,230],69934:[[69937,69927]],69935:[[69938,69927]],69937:[,,{69927:69934}],69938:[,,{69927:69935}],69939:[,9],69940:[,9],70003:[,7],70080:[,9]},4608:{70197:[,9],70198:[,7],70377:[,7],70378:[,9]},4864:{4957:[,230],4958:[,230],4959:[,230],70460:[,7],70471:[,,{70462:70475,70487:70476}],70475:[[70471,70462]],70476:[[70471,70487]],70477:[,9],70502:[,230],70503:[,230],70504:[,230],70505:[,230],70506:[,230],70507:[,230],70508:[,230],70512:[,230],70513:[,230],70514:[,230],70515:[,230],70516:[,230]},5120:{70841:[,,{70832:70844,70842:70843,70845:70846}],70843:[[70841,70842]],70844:[[70841,70832]],70846:[[70841,70845]],70850:[,9],70851:[,7]},5376:{71096:[,,{71087:71098}],71097:[,,{71087:71099}],71098:[[71096,71087]],71099:[[71097,71087]],71103:[,9],71104:[,7]},5632:{71231:[,9],71350:[,9],71351:[,7]},5888:{5908:[,9],5940:[,9],6098:[,9],6109:[,230]},6144:{6313:[,228]},6400:{6457:[,222],6458:[,230],6459:[,220]},6656:{6679:[,230],6680:[,220],6752:[,9],6773:[,230],6774:[,230],6775:[,230],6776:[,230],6777:[,230],6778:[,230],6779:[,230],6780:[,230],6783:[,220],6832:[,230],6833:[,230],6834:[,230],6835:[,230],6836:[,230],6837:[,220],6838:[,220],6839:[,220],6840:[,220],6841:[,220],6842:[,220],6843:[,230],6844:[,230],6845:[,220]},6912:{6917:[,,{6965:6918}],6918:[[6917,6965]],6919:[,,{6965:6920}],6920:[[6919,6965]],6921:[,,{6965:6922}],6922:[[6921,6965]],6923:[,,{6965:6924}],6924:[[6923,6965]],6925:[,,{6965:6926}],6926:[[6925,6965]],6929:[,,{6965:6930}],6930:[[6929,6965]],6964:[,7],6970:[,,{6965:6971}],6971:[[6970,6965]],6972:[,,{6965:6973}],6973:[[6972,6965]],6974:[,,{6965:6976}],6975:[,,{6965:6977}],6976:[[6974,6965]],6977:[[6975,6965]],6978:[,,{6965:6979}],6979:[[6978,6965]],6980:[,9],7019:[,230],7020:[,220],7021:[,230],7022:[,230],7023:[,230],7024:[,230],7025:[,230],7026:[,230],7027:[,230],7082:[,9],7083:[,9],7142:[,7],7154:[,9],7155:[,9]},7168:{7223:[,7],7376:[,230],7377:[,230],7378:[,230],7380:[,1],7381:[,220],7382:[,220],7383:[,220],7384:[,220],7385:[,220],7386:[,230],7387:[,230],7388:[,220],7389:[,220],7390:[,220],7391:[,220],7392:[,230],7394:[,1],7395:[,1],7396:[,1],7397:[,1],7398:[,1],7399:[,1],7400:[,1],7405:[,220],7412:[,230],7416:[,230],7417:[,230]},7424:{7468:[[65],256],7469:[[198],256],7470:[[66],256],7472:[[68],256],7473:[[69],256],7474:[[398],256],7475:[[71],256],7476:[[72],256],7477:[[73],256],7478:[[74],256],7479:[[75],256],7480:[[76],256],7481:[[77],256],7482:[[78],256],7484:[[79],256],7485:[[546],256],7486:[[80],256],7487:[[82],256],7488:[[84],256],7489:[[85],256],7490:[[87],256],7491:[[97],256],7492:[[592],256],7493:[[593],256],7494:[[7426],256],7495:[[98],256],7496:[[100],256],7497:[[101],256],7498:[[601],256],7499:[[603],256],7500:[[604],256],7501:[[103],256],7503:[[107],256],7504:[[109],256],7505:[[331],256],7506:[[111],256],7507:[[596],256],7508:[[7446],256],7509:[[7447],256],7510:[[112],256],7511:[[116],256],7512:[[117],256],7513:[[7453],256],7514:[[623],256],7515:[[118],256],7516:[[7461],256],7517:[[946],256],7518:[[947],256],7519:[[948],256],7520:[[966],256],7521:[[967],256],7522:[[105],256],7523:[[114],256],7524:[[117],256],7525:[[118],256],7526:[[946],256],7527:[[947],256],7528:[[961],256],7529:[[966],256],7530:[[967],256],7544:[[1085],256],7579:[[594],256],7580:[[99],256],7581:[[597],256],7582:[[240],256],7583:[[604],256],7584:[[102],256],7585:[[607],256],7586:[[609],256],7587:[[613],256],7588:[[616],256],7589:[[617],256],7590:[[618],256],7591:[[7547],256],7592:[[669],256],7593:[[621],256],7594:[[7557],256],7595:[[671],256],7596:[[625],256],7597:[[624],256],7598:[[626],256],7599:[[627],256],7600:[[628],256],7601:[[629],256],7602:[[632],256],7603:[[642],256],7604:[[643],256],7605:[[427],256],7606:[[649],256],7607:[[650],256],7608:[[7452],256],7609:[[651],256],7610:[[652],256],7611:[[122],256],7612:[[656],256],7613:[[657],256],7614:[[658],256],7615:[[952],256],7616:[,230],7617:[,230],7618:[,220],7619:[,230],7620:[,230],7621:[,230],7622:[,230],7623:[,230],7624:[,230],7625:[,230],7626:[,220],7627:[,230],7628:[,230],7629:[,234],7630:[,214],7631:[,220],7632:[,202],7633:[,230],7634:[,230],7635:[,230],7636:[,230],7637:[,230],7638:[,230],7639:[,230],7640:[,230],7641:[,230],7642:[,230],7643:[,230],7644:[,230],7645:[,230],7646:[,230],7647:[,230],7648:[,230],7649:[,230],7650:[,230],7651:[,230],7652:[,230],7653:[,230],7654:[,230],7655:[,230],7656:[,230],7657:[,230],7658:[,230],7659:[,230],7660:[,230],7661:[,230],7662:[,230],7663:[,230],7664:[,230],7665:[,230],7666:[,230],7667:[,230],7668:[,230],7669:[,230],7676:[,233],7677:[,220],7678:[,230],7679:[,220]},7680:{7680:[[65,805]],7681:[[97,805]],7682:[[66,775]],7683:[[98,775]],7684:[[66,803]],7685:[[98,803]],7686:[[66,817]],7687:[[98,817]],7688:[[199,769]],7689:[[231,769]],7690:[[68,775]],7691:[[100,775]],7692:[[68,803]],7693:[[100,803]],7694:[[68,817]],7695:[[100,817]],7696:[[68,807]],7697:[[100,807]],7698:[[68,813]],7699:[[100,813]],7700:[[274,768]],7701:[[275,768]],7702:[[274,769]],7703:[[275,769]],7704:[[69,813]],7705:[[101,813]],7706:[[69,816]],7707:[[101,816]],7708:[[552,774]],7709:[[553,774]],7710:[[70,775]],7711:[[102,775]],7712:[[71,772]],7713:[[103,772]],7714:[[72,775]],7715:[[104,775]],7716:[[72,803]],7717:[[104,803]],7718:[[72,776]],7719:[[104,776]],7720:[[72,807]],7721:[[104,807]],7722:[[72,814]],7723:[[104,814]],7724:[[73,816]],7725:[[105,816]],7726:[[207,769]],7727:[[239,769]],7728:[[75,769]],7729:[[107,769]],7730:[[75,803]],7731:[[107,803]],7732:[[75,817]],7733:[[107,817]],7734:[[76,803],,{772:7736}],7735:[[108,803],,{772:7737}],7736:[[7734,772]],7737:[[7735,772]],7738:[[76,817]],7739:[[108,817]],7740:[[76,813]],7741:[[108,813]],7742:[[77,769]],7743:[[109,769]],7744:[[77,775]],7745:[[109,775]],7746:[[77,803]],7747:[[109,803]],7748:[[78,775]],7749:[[110,775]],7750:[[78,803]],7751:[[110,803]],7752:[[78,817]],7753:[[110,817]],7754:[[78,813]],7755:[[110,813]],7756:[[213,769]],7757:[[245,769]],7758:[[213,776]],7759:[[245,776]],7760:[[332,768]],7761:[[333,768]],7762:[[332,769]],7763:[[333,769]],7764:[[80,769]],7765:[[112,769]],7766:[[80,775]],7767:[[112,775]],7768:[[82,775]],7769:[[114,775]],7770:[[82,803],,{772:7772}],7771:[[114,803],,{772:7773}],7772:[[7770,772]],7773:[[7771,772]],7774:[[82,817]],7775:[[114,817]],7776:[[83,775]],7777:[[115,775]],7778:[[83,803],,{775:7784}],7779:[[115,803],,{775:7785}],7780:[[346,775]],7781:[[347,775]],7782:[[352,775]],7783:[[353,775]],7784:[[7778,775]],7785:[[7779,775]],7786:[[84,775]],7787:[[116,775]],7788:[[84,803]],7789:[[116,803]],7790:[[84,817]],7791:[[116,817]],7792:[[84,813]],7793:[[116,813]],7794:[[85,804]],7795:[[117,804]],7796:[[85,816]],7797:[[117,816]],7798:[[85,813]],7799:[[117,813]],7800:[[360,769]],7801:[[361,769]],7802:[[362,776]],7803:[[363,776]],7804:[[86,771]],7805:[[118,771]],7806:[[86,803]],7807:[[118,803]],7808:[[87,768]],7809:[[119,768]],7810:[[87,769]],7811:[[119,769]],7812:[[87,776]],7813:[[119,776]],7814:[[87,775]],7815:[[119,775]],7816:[[87,803]],7817:[[119,803]],7818:[[88,775]],7819:[[120,775]],7820:[[88,776]],7821:[[120,776]],7822:[[89,775]],7823:[[121,775]],7824:[[90,770]],7825:[[122,770]],7826:[[90,803]],7827:[[122,803]],7828:[[90,817]],7829:[[122,817]],7830:[[104,817]],7831:[[116,776]],7832:[[119,778]],7833:[[121,778]],7834:[[97,702],256],7835:[[383,775]],7840:[[65,803],,{770:7852,774:7862}],7841:[[97,803],,{770:7853,774:7863}],7842:[[65,777]],7843:[[97,777]],7844:[[194,769]],7845:[[226,769]],7846:[[194,768]],7847:[[226,768]],7848:[[194,777]],7849:[[226,777]],7850:[[194,771]],7851:[[226,771]],7852:[[7840,770]],7853:[[7841,770]],7854:[[258,769]],7855:[[259,769]],7856:[[258,768]],7857:[[259,768]],7858:[[258,777]],7859:[[259,777]],7860:[[258,771]],7861:[[259,771]],7862:[[7840,774]],7863:[[7841,774]],7864:[[69,803],,{770:7878}],7865:[[101,803],,{770:7879}],7866:[[69,777]],7867:[[101,777]],7868:[[69,771]],7869:[[101,771]],7870:[[202,769]],7871:[[234,769]],7872:[[202,768]],7873:[[234,768]],7874:[[202,777]],7875:[[234,777]],7876:[[202,771]],7877:[[234,771]],7878:[[7864,770]],7879:[[7865,770]],7880:[[73,777]],7881:[[105,777]],7882:[[73,803]],7883:[[105,803]],7884:[[79,803],,{770:7896}],7885:[[111,803],,{770:7897}],7886:[[79,777]],7887:[[111,777]],7888:[[212,769]],7889:[[244,769]],7890:[[212,768]],7891:[[244,768]],7892:[[212,777]],7893:[[244,777]],7894:[[212,771]],7895:[[244,771]],7896:[[7884,770]],7897:[[7885,770]],7898:[[416,769]],7899:[[417,769]],7900:[[416,768]],7901:[[417,768]],7902:[[416,777]],7903:[[417,777]],7904:[[416,771]],7905:[[417,771]],7906:[[416,803]],7907:[[417,803]],7908:[[85,803]],7909:[[117,803]],7910:[[85,777]],7911:[[117,777]],7912:[[431,769]],7913:[[432,769]],7914:[[431,768]],7915:[[432,768]],7916:[[431,777]],7917:[[432,777]],7918:[[431,771]],7919:[[432,771]],7920:[[431,803]],7921:[[432,803]],7922:[[89,768]],7923:[[121,768]],7924:[[89,803]],7925:[[121,803]],7926:[[89,777]],7927:[[121,777]],7928:[[89,771]],7929:[[121,771]]},7936:{7936:[[945,787],,{768:7938,769:7940,834:7942,837:8064}],7937:[[945,788],,{768:7939,769:7941,834:7943,837:8065}],7938:[[7936,768],,{837:8066}],7939:[[7937,768],,{837:8067}],7940:[[7936,769],,{837:8068}],7941:[[7937,769],,{837:8069}],7942:[[7936,834],,{837:8070}],7943:[[7937,834],,{837:8071}],7944:[[913,787],,{768:7946,769:7948,834:7950,837:8072}],7945:[[913,788],,{768:7947,769:7949,834:7951,837:8073}],7946:[[7944,768],,{837:8074}],7947:[[7945,768],,{837:8075}],7948:[[7944,769],,{837:8076}],7949:[[7945,769],,{837:8077}],7950:[[7944,834],,{837:8078}],7951:[[7945,834],,{837:8079}],7952:[[949,787],,{768:7954,769:7956}],7953:[[949,788],,{768:7955,769:7957}],7954:[[7952,768]],7955:[[7953,768]],7956:[[7952,769]],7957:[[7953,769]],7960:[[917,787],,{768:7962,769:7964}],7961:[[917,788],,{768:7963,769:7965}],7962:[[7960,768]],7963:[[7961,768]],7964:[[7960,769]],7965:[[7961,769]],7968:[[951,787],,{768:7970,769:7972,834:7974,837:8080}],7969:[[951,788],,{768:7971,769:7973,834:7975,837:8081}],7970:[[7968,768],,{837:8082}],7971:[[7969,768],,{837:8083}],7972:[[7968,769],,{837:8084}],7973:[[7969,769],,{837:8085}],7974:[[7968,834],,{837:8086}],7975:[[7969,834],,{837:8087}],7976:[[919,787],,{768:7978,769:7980,834:7982,837:8088}],7977:[[919,788],,{768:7979,769:7981,834:7983,837:8089}],7978:[[7976,768],,{837:8090}],7979:[[7977,768],,{837:8091}],7980:[[7976,769],,{837:8092}],7981:[[7977,769],,{837:8093}],7982:[[7976,834],,{837:8094}],7983:[[7977,834],,{837:8095}],7984:[[953,787],,{768:7986,769:7988,834:7990}],7985:[[953,788],,{768:7987,769:7989,834:7991}],7986:[[7984,768]],7987:[[7985,768]],7988:[[7984,769]],7989:[[7985,769]],7990:[[7984,834]],7991:[[7985,834]],7992:[[921,787],,{768:7994,769:7996,834:7998}],7993:[[921,788],,{768:7995,769:7997,834:7999}],7994:[[7992,768]],7995:[[7993,768]],7996:[[7992,769]],7997:[[7993,769]],7998:[[7992,834]],7999:[[7993,834]],8e3:[[959,787],,{768:8002,769:8004}],8001:[[959,788],,{768:8003,769:8005}],8002:[[8e3,768]],8003:[[8001,768]],8004:[[8e3,769]],8005:[[8001,769]],8008:[[927,787],,{768:8010,769:8012}],8009:[[927,788],,{768:8011,769:8013}],8010:[[8008,768]],8011:[[8009,768]],8012:[[8008,769]],8013:[[8009,769]],8016:[[965,787],,{768:8018,769:8020,834:8022}],8017:[[965,788],,{768:8019,769:8021,834:8023}],8018:[[8016,768]],8019:[[8017,768]],8020:[[8016,769]],8021:[[8017,769]],8022:[[8016,834]],8023:[[8017,834]],8025:[[933,788],,{768:8027,769:8029,834:8031}],8027:[[8025,768]],8029:[[8025,769]],8031:[[8025,834]],8032:[[969,787],,{768:8034,769:8036,834:8038,837:8096}],8033:[[969,788],,{768:8035,769:8037,834:8039,837:8097}],8034:[[8032,768],,{837:8098}],8035:[[8033,768],,{837:8099}],8036:[[8032,769],,{837:8100}],8037:[[8033,769],,{837:8101}],8038:[[8032,834],,{837:8102}],8039:[[8033,834],,{837:8103}],8040:[[937,787],,{768:8042,769:8044,834:8046,837:8104}],8041:[[937,788],,{768:8043,769:8045,834:8047,837:8105}],8042:[[8040,768],,{837:8106}],8043:[[8041,768],,{837:8107}],8044:[[8040,769],,{837:8108}],8045:[[8041,769],,{837:8109}],8046:[[8040,834],,{837:8110}],8047:[[8041,834],,{837:8111}],8048:[[945,768],,{837:8114}],8049:[[940]],8050:[[949,768]],8051:[[941]],8052:[[951,768],,{837:8130}],8053:[[942]],8054:[[953,768]],8055:[[943]],8056:[[959,768]],8057:[[972]],8058:[[965,768]],8059:[[973]],8060:[[969,768],,{837:8178}],8061:[[974]],8064:[[7936,837]],8065:[[7937,837]],8066:[[7938,837]],8067:[[7939,837]],8068:[[7940,837]],8069:[[7941,837]],8070:[[7942,837]],8071:[[7943,837]],8072:[[7944,837]],8073:[[7945,837]],8074:[[7946,837]],8075:[[7947,837]],8076:[[7948,837]],8077:[[7949,837]],8078:[[7950,837]],8079:[[7951,837]],8080:[[7968,837]],8081:[[7969,837]],8082:[[7970,837]],8083:[[7971,837]],8084:[[7972,837]],8085:[[7973,837]],8086:[[7974,837]],8087:[[7975,837]],8088:[[7976,837]],8089:[[7977,837]],8090:[[7978,837]],8091:[[7979,837]],8092:[[7980,837]],8093:[[7981,837]],8094:[[7982,837]],8095:[[7983,837]],8096:[[8032,837]],8097:[[8033,837]],8098:[[8034,837]],8099:[[8035,837]],8100:[[8036,837]],8101:[[8037,837]],8102:[[8038,837]],8103:[[8039,837]],8104:[[8040,837]],8105:[[8041,837]],8106:[[8042,837]],8107:[[8043,837]],8108:[[8044,837]],8109:[[8045,837]],8110:[[8046,837]],8111:[[8047,837]],8112:[[945,774]],8113:[[945,772]],8114:[[8048,837]],8115:[[945,837]],8116:[[940,837]],8118:[[945,834],,{837:8119}],8119:[[8118,837]],8120:[[913,774]],8121:[[913,772]],8122:[[913,768]],8123:[[902]],8124:[[913,837]],8125:[[32,787],256],8126:[[953]],8127:[[32,787],256,{768:8141,769:8142,834:8143}],8128:[[32,834],256],8129:[[168,834]],8130:[[8052,837]],8131:[[951,837]],8132:[[942,837]],8134:[[951,834],,{837:8135}],8135:[[8134,837]],8136:[[917,768]],8137:[[904]],8138:[[919,768]],8139:[[905]],8140:[[919,837]],8141:[[8127,768]],8142:[[8127,769]],8143:[[8127,834]],8144:[[953,774]],8145:[[953,772]],8146:[[970,768]],8147:[[912]],8150:[[953,834]],8151:[[970,834]],8152:[[921,774]],8153:[[921,772]],8154:[[921,768]],8155:[[906]],8157:[[8190,768]],8158:[[8190,769]],8159:[[8190,834]],8160:[[965,774]],8161:[[965,772]],8162:[[971,768]],8163:[[944]],8164:[[961,787]],8165:[[961,788]],8166:[[965,834]],8167:[[971,834]],8168:[[933,774]],8169:[[933,772]],8170:[[933,768]],8171:[[910]],8172:[[929,788]],8173:[[168,768]],8174:[[901]],8175:[[96]],8178:[[8060,837]],8179:[[969,837]],8180:[[974,837]],8182:[[969,834],,{837:8183}],8183:[[8182,837]],8184:[[927,768]],8185:[[908]],8186:[[937,768]],8187:[[911]],8188:[[937,837]],8189:[[180]],8190:[[32,788],256,{768:8157,769:8158,834:8159}]},8192:{8192:[[8194]],8193:[[8195]],8194:[[32],256],8195:[[32],256],8196:[[32],256],8197:[[32],256],8198:[[32],256],8199:[[32],256],8200:[[32],256],8201:[[32],256],8202:[[32],256],8209:[[8208],256],8215:[[32,819],256],8228:[[46],256],8229:[[46,46],256],8230:[[46,46,46],256],8239:[[32],256],8243:[[8242,8242],256],8244:[[8242,8242,8242],256],8246:[[8245,8245],256],8247:[[8245,8245,8245],256],8252:[[33,33],256],8254:[[32,773],256],8263:[[63,63],256],8264:[[63,33],256],8265:[[33,63],256],8279:[[8242,8242,8242,8242],256],8287:[[32],256],8304:[[48],256],8305:[[105],256],8308:[[52],256],8309:[[53],256],8310:[[54],256],8311:[[55],256],8312:[[56],256],8313:[[57],256],8314:[[43],256],8315:[[8722],256],8316:[[61],256],8317:[[40],256],8318:[[41],256],8319:[[110],256],8320:[[48],256],8321:[[49],256],8322:[[50],256],8323:[[51],256],8324:[[52],256],8325:[[53],256],8326:[[54],256],8327:[[55],256],8328:[[56],256],8329:[[57],256],8330:[[43],256],8331:[[8722],256],8332:[[61],256],8333:[[40],256],8334:[[41],256],8336:[[97],256],8337:[[101],256],8338:[[111],256],8339:[[120],256],8340:[[601],256],8341:[[104],256],8342:[[107],256],8343:[[108],256],8344:[[109],256],8345:[[110],256],8346:[[112],256],8347:[[115],256],8348:[[116],256],8360:[[82,115],256],8400:[,230],8401:[,230],8402:[,1],8403:[,1],8404:[,230],8405:[,230],8406:[,230],8407:[,230],8408:[,1],8409:[,1],8410:[,1],8411:[,230],8412:[,230],8417:[,230],8421:[,1],8422:[,1],8423:[,230],8424:[,220],8425:[,230],8426:[,1],8427:[,1],8428:[,220],8429:[,220],8430:[,220],8431:[,220],8432:[,230]},8448:{8448:[[97,47,99],256],8449:[[97,47,115],256],8450:[[67],256],8451:[[176,67],256],8453:[[99,47,111],256],8454:[[99,47,117],256],8455:[[400],256],8457:[[176,70],256],8458:[[103],256],8459:[[72],256],8460:[[72],256],8461:[[72],256],8462:[[104],256],8463:[[295],256],8464:[[73],256],8465:[[73],256],8466:[[76],256],8467:[[108],256],8469:[[78],256],8470:[[78,111],256],8473:[[80],256],8474:[[81],256],8475:[[82],256],8476:[[82],256],8477:[[82],256],8480:[[83,77],256],8481:[[84,69,76],256],8482:[[84,77],256],8484:[[90],256],8486:[[937]],8488:[[90],256],8490:[[75]],8491:[[197]],8492:[[66],256],8493:[[67],256],8495:[[101],256],8496:[[69],256],8497:[[70],256],8499:[[77],256],8500:[[111],256],8501:[[1488],256],8502:[[1489],256],8503:[[1490],256],8504:[[1491],256],8505:[[105],256],8507:[[70,65,88],256],8508:[[960],256],8509:[[947],256],8510:[[915],256],8511:[[928],256],8512:[[8721],256],8517:[[68],256],8518:[[100],256],8519:[[101],256],8520:[[105],256],8521:[[106],256],8528:[[49,8260,55],256],8529:[[49,8260,57],256],8530:[[49,8260,49,48],256],8531:[[49,8260,51],256],8532:[[50,8260,51],256],8533:[[49,8260,53],256],8534:[[50,8260,53],256],8535:[[51,8260,53],256],8536:[[52,8260,53],256],8537:[[49,8260,54],256],8538:[[53,8260,54],256],8539:[[49,8260,56],256],8540:[[51,8260,56],256],8541:[[53,8260,56],256],8542:[[55,8260,56],256],8543:[[49,8260],256],8544:[[73],256],8545:[[73,73],256],8546:[[73,73,73],256],8547:[[73,86],256],8548:[[86],256],8549:[[86,73],256],8550:[[86,73,73],256],8551:[[86,73,73,73],256],8552:[[73,88],256],8553:[[88],256],8554:[[88,73],256],8555:[[88,73,73],256],8556:[[76],256],8557:[[67],256],8558:[[68],256],8559:[[77],256],8560:[[105],256],8561:[[105,105],256],8562:[[105,105,105],256],8563:[[105,118],256],8564:[[118],256],8565:[[118,105],256],8566:[[118,105,105],256],8567:[[118,105,105,105],256],8568:[[105,120],256],8569:[[120],256],8570:[[120,105],256],8571:[[120,105,105],256],8572:[[108],256],8573:[[99],256],8574:[[100],256],8575:[[109],256],8585:[[48,8260,51],256],8592:[,,{824:8602}],8594:[,,{824:8603}],8596:[,,{824:8622}],8602:[[8592,824]],8603:[[8594,824]],8622:[[8596,824]],8653:[[8656,824]],8654:[[8660,824]],8655:[[8658,824]],8656:[,,{824:8653}],8658:[,,{824:8655}],8660:[,,{824:8654}]},8704:{8707:[,,{824:8708}],8708:[[8707,824]],8712:[,,{824:8713}],8713:[[8712,824]],8715:[,,{824:8716}],8716:[[8715,824]],8739:[,,{824:8740}],8740:[[8739,824]],8741:[,,{824:8742}],8742:[[8741,824]],8748:[[8747,8747],256],8749:[[8747,8747,8747],256],8751:[[8750,8750],256],8752:[[8750,8750,8750],256],8764:[,,{824:8769}],8769:[[8764,824]],8771:[,,{824:8772}],8772:[[8771,824]],8773:[,,{824:8775}],8775:[[8773,824]],8776:[,,{824:8777}],8777:[[8776,824]],8781:[,,{824:8813}],8800:[[61,824]],8801:[,,{824:8802}],8802:[[8801,824]],8804:[,,{824:8816}],8805:[,,{824:8817}],8813:[[8781,824]],8814:[[60,824]],8815:[[62,824]],8816:[[8804,824]],8817:[[8805,824]],8818:[,,{824:8820}],8819:[,,{824:8821}],8820:[[8818,824]],8821:[[8819,824]],8822:[,,{824:8824}],8823:[,,{824:8825}],8824:[[8822,824]],8825:[[8823,824]],8826:[,,{824:8832}],8827:[,,{824:8833}],8828:[,,{824:8928}],8829:[,,{824:8929}],8832:[[8826,824]],8833:[[8827,824]],8834:[,,{824:8836}],8835:[,,{824:8837}],8836:[[8834,824]],8837:[[8835,824]],8838:[,,{824:8840}],8839:[,,{824:8841}],8840:[[8838,824]],8841:[[8839,824]],8849:[,,{824:8930}],8850:[,,{824:8931}],8866:[,,{824:8876}],8872:[,,{824:8877}],8873:[,,{824:8878}],8875:[,,{824:8879}],8876:[[8866,824]],8877:[[8872,824]],8878:[[8873,824]],8879:[[8875,824]],8882:[,,{824:8938}],8883:[,,{824:8939}],8884:[,,{824:8940}],8885:[,,{824:8941}],8928:[[8828,824]],8929:[[8829,824]],8930:[[8849,824]],8931:[[8850,824]],8938:[[8882,824]],8939:[[8883,824]],8940:[[8884,824]],8941:[[8885,824]]},8960:{9001:[[12296]],9002:[[12297]]},9216:{9312:[[49],256],9313:[[50],256],9314:[[51],256],9315:[[52],256],9316:[[53],256],9317:[[54],256],9318:[[55],256],9319:[[56],256],9320:[[57],256],9321:[[49,48],256],9322:[[49,49],256],9323:[[49,50],256],9324:[[49,51],256],9325:[[49,52],256],9326:[[49,53],256],9327:[[49,54],256],9328:[[49,55],256],9329:[[49,56],256],9330:[[49,57],256],9331:[[50,48],256],9332:[[40,49,41],256],9333:[[40,50,41],256],9334:[[40,51,41],256],9335:[[40,52,41],256],9336:[[40,53,41],256],9337:[[40,54,41],256],9338:[[40,55,41],256],9339:[[40,56,41],256],9340:[[40,57,41],256],9341:[[40,49,48,41],256],9342:[[40,49,49,41],256],9343:[[40,49,50,41],256],9344:[[40,49,51,41],256],9345:[[40,49,52,41],256],9346:[[40,49,53,41],256],9347:[[40,49,54,41],256],9348:[[40,49,55,41],256],9349:[[40,49,56,41],256],9350:[[40,49,57,41],256],9351:[[40,50,48,41],256],9352:[[49,46],256],9353:[[50,46],256],9354:[[51,46],256],9355:[[52,46],256],9356:[[53,46],256],9357:[[54,46],256],9358:[[55,46],256],9359:[[56,46],256],9360:[[57,46],256],9361:[[49,48,46],256],9362:[[49,49,46],256],9363:[[49,50,46],256],9364:[[49,51,46],256],9365:[[49,52,46],256],9366:[[49,53,46],256],9367:[[49,54,46],256],9368:[[49,55,46],256],9369:[[49,56,46],256],9370:[[49,57,46],256],9371:[[50,48,46],256],9372:[[40,97,41],256],9373:[[40,98,41],256],9374:[[40,99,41],256],9375:[[40,100,41],256],9376:[[40,101,41],256],9377:[[40,102,41],256],9378:[[40,103,41],256],9379:[[40,104,41],256],9380:[[40,105,41],256],9381:[[40,106,41],256],9382:[[40,107,41],256],9383:[[40,108,41],256],9384:[[40,109,41],256],9385:[[40,110,41],256],9386:[[40,111,41],256],9387:[[40,112,41],256],9388:[[40,113,41],256],9389:[[40,114,41],256],9390:[[40,115,41],256],9391:[[40,116,41],256],9392:[[40,117,41],256],9393:[[40,118,41],256],9394:[[40,119,41],256],9395:[[40,120,41],256],9396:[[40,121,41],256],9397:[[40,122,41],256],9398:[[65],256],9399:[[66],256],9400:[[67],256],9401:[[68],256],9402:[[69],256],9403:[[70],256],9404:[[71],256],9405:[[72],256],9406:[[73],256],9407:[[74],256],9408:[[75],256],9409:[[76],256],9410:[[77],256],9411:[[78],256],9412:[[79],256],9413:[[80],256],9414:[[81],256],9415:[[82],256],9416:[[83],256],9417:[[84],256],9418:[[85],256],9419:[[86],256],9420:[[87],256],9421:[[88],256],9422:[[89],256],9423:[[90],256],9424:[[97],256],9425:[[98],256],9426:[[99],256],9427:[[100],256],9428:[[101],256],9429:[[102],256],9430:[[103],256],9431:[[104],256],9432:[[105],256],9433:[[106],256],9434:[[107],256],9435:[[108],256],9436:[[109],256],9437:[[110],256],9438:[[111],256],9439:[[112],256],9440:[[113],256],9441:[[114],256],9442:[[115],256],9443:[[116],256],9444:[[117],256],9445:[[118],256],9446:[[119],256],9447:[[120],256],9448:[[121],256],9449:[[122],256],9450:[[48],256]},10752:{10764:[[8747,8747,8747,8747],256],10868:[[58,58,61],256],10869:[[61,61],256],10870:[[61,61,61],256],10972:[[10973,824],512]},11264:{11388:[[106],256],11389:[[86],256],11503:[,230],11504:[,230],11505:[,230]},11520:{11631:[[11617],256],11647:[,9],11744:[,230],11745:[,230],11746:[,230],11747:[,230],11748:[,230],11749:[,230],11750:[,230],11751:[,230],11752:[,230],11753:[,230],11754:[,230],11755:[,230],11756:[,230],11757:[,230],11758:[,230],11759:[,230],11760:[,230],11761:[,230],11762:[,230],11763:[,230],11764:[,230],11765:[,230],11766:[,230],11767:[,230],11768:[,230],11769:[,230],11770:[,230],11771:[,230],11772:[,230],11773:[,230],11774:[,230],11775:[,230]},11776:{11935:[[27597],256],12019:[[40863],256]},12032:{12032:[[19968],256],12033:[[20008],256],12034:[[20022],256],12035:[[20031],256],12036:[[20057],256],12037:[[20101],256],12038:[[20108],256],12039:[[20128],256],12040:[[20154],256],12041:[[20799],256],12042:[[20837],256],12043:[[20843],256],12044:[[20866],256],12045:[[20886],256],12046:[[20907],256],12047:[[20960],256],12048:[[20981],256],12049:[[20992],256],12050:[[21147],256],12051:[[21241],256],12052:[[21269],256],12053:[[21274],256],12054:[[21304],256],12055:[[21313],256],12056:[[21340],256],12057:[[21353],256],12058:[[21378],256],12059:[[21430],256],12060:[[21448],256],12061:[[21475],256],12062:[[22231],256],12063:[[22303],256],12064:[[22763],256],12065:[[22786],256],12066:[[22794],256],12067:[[22805],256],12068:[[22823],256],12069:[[22899],256],12070:[[23376],256],12071:[[23424],256],12072:[[23544],256],12073:[[23567],256],12074:[[23586],256],12075:[[23608],256],12076:[[23662],256],12077:[[23665],256],12078:[[24027],256],12079:[[24037],256],12080:[[24049],256],12081:[[24062],256],12082:[[24178],256],12083:[[24186],256],12084:[[24191],256],12085:[[24308],256],12086:[[24318],256],12087:[[24331],256],12088:[[24339],256],12089:[[24400],256],12090:[[24417],256],12091:[[24435],256],12092:[[24515],256],12093:[[25096],256],12094:[[25142],256],12095:[[25163],256],12096:[[25903],256],12097:[[25908],256],12098:[[25991],256],12099:[[26007],256],12100:[[26020],256],12101:[[26041],256],12102:[[26080],256],12103:[[26085],256],12104:[[26352],256],12105:[[26376],256],12106:[[26408],256],12107:[[27424],256],12108:[[27490],256],12109:[[27513],256],12110:[[27571],256],12111:[[27595],256],12112:[[27604],256],12113:[[27611],256],12114:[[27663],256],12115:[[27668],256],12116:[[27700],256],12117:[[28779],256],12118:[[29226],256],12119:[[29238],256],12120:[[29243],256],12121:[[29247],256],12122:[[29255],256],12123:[[29273],256],12124:[[29275],256],12125:[[29356],256],12126:[[29572],256],12127:[[29577],256],12128:[[29916],256],12129:[[29926],256],12130:[[29976],256],12131:[[29983],256],12132:[[29992],256],12133:[[3e4],256],12134:[[30091],256],12135:[[30098],256],12136:[[30326],256],12137:[[30333],256],12138:[[30382],256],12139:[[30399],256],12140:[[30446],256],12141:[[30683],256],12142:[[30690],256],12143:[[30707],256],12144:[[31034],256],12145:[[31160],256],12146:[[31166],256],12147:[[31348],256],12148:[[31435],256],12149:[[31481],256],12150:[[31859],256],12151:[[31992],256],12152:[[32566],256],12153:[[32593],256],12154:[[32650],256],12155:[[32701],256],12156:[[32769],256],12157:[[32780],256],12158:[[32786],256],12159:[[32819],256],12160:[[32895],256],12161:[[32905],256],12162:[[33251],256],12163:[[33258],256],12164:[[33267],256],12165:[[33276],256],12166:[[33292],256],12167:[[33307],256],12168:[[33311],256],12169:[[33390],256],12170:[[33394],256],12171:[[33400],256],12172:[[34381],256],12173:[[34411],256],12174:[[34880],256],12175:[[34892],256],12176:[[34915],256],12177:[[35198],256],12178:[[35211],256],12179:[[35282],256],12180:[[35328],256],12181:[[35895],256],12182:[[35910],256],12183:[[35925],256],12184:[[35960],256],12185:[[35997],256],12186:[[36196],256],12187:[[36208],256],12188:[[36275],256],12189:[[36523],256],12190:[[36554],256],12191:[[36763],256],12192:[[36784],256],12193:[[36789],256],12194:[[37009],256],12195:[[37193],256],12196:[[37318],256],12197:[[37324],256],12198:[[37329],256],12199:[[38263],256],12200:[[38272],256],12201:[[38428],256],12202:[[38582],256],12203:[[38585],256],12204:[[38632],256],12205:[[38737],256],12206:[[38750],256],12207:[[38754],256],12208:[[38761],256],12209:[[38859],256],12210:[[38893],256],12211:[[38899],256],12212:[[38913],256],12213:[[39080],256],12214:[[39131],256],12215:[[39135],256],12216:[[39318],256],12217:[[39321],256],12218:[[39340],256],12219:[[39592],256],12220:[[39640],256],12221:[[39647],256],12222:[[39717],256],12223:[[39727],256],12224:[[39730],256],12225:[[39740],256],12226:[[39770],256],12227:[[40165],256],12228:[[40565],256],12229:[[40575],256],12230:[[40613],256],12231:[[40635],256],12232:[[40643],256],12233:[[40653],256],12234:[[40657],256],12235:[[40697],256],12236:[[40701],256],12237:[[40718],256],12238:[[40723],256],12239:[[40736],256],12240:[[40763],256],12241:[[40778],256],12242:[[40786],256],12243:[[40845],256],12244:[[40860],256],12245:[[40864],256]},12288:{12288:[[32],256],12330:[,218],12331:[,228],12332:[,232],12333:[,222],12334:[,224],12335:[,224],12342:[[12306],256],12344:[[21313],256],12345:[[21316],256],12346:[[21317],256],12358:[,,{12441:12436}],12363:[,,{12441:12364}],12364:[[12363,12441]],12365:[,,{12441:12366}],12366:[[12365,12441]],12367:[,,{12441:12368}],12368:[[12367,12441]],12369:[,,{12441:12370}],12370:[[12369,12441]],12371:[,,{12441:12372}],12372:[[12371,12441]],12373:[,,{12441:12374}],12374:[[12373,12441]],12375:[,,{12441:12376}],12376:[[12375,12441]],12377:[,,{12441:12378}],12378:[[12377,12441]],12379:[,,{12441:12380}],12380:[[12379,12441]],12381:[,,{12441:12382}],12382:[[12381,12441]],12383:[,,{12441:12384}],12384:[[12383,12441]],12385:[,,{12441:12386}],12386:[[12385,12441]],12388:[,,{12441:12389}],12389:[[12388,12441]],12390:[,,{12441:12391}],12391:[[12390,12441]],12392:[,,{12441:12393}],12393:[[12392,12441]],12399:[,,{12441:12400,12442:12401}],12400:[[12399,12441]],12401:[[12399,12442]],12402:[,,{12441:12403,12442:12404}],12403:[[12402,12441]],12404:[[12402,12442]],12405:[,,{12441:12406,12442:12407}],12406:[[12405,12441]],12407:[[12405,12442]],12408:[,,{12441:12409,12442:12410}],12409:[[12408,12441]],12410:[[12408,12442]],12411:[,,{12441:12412,12442:12413}],12412:[[12411,12441]],12413:[[12411,12442]],12436:[[12358,12441]],12441:[,8],12442:[,8],12443:[[32,12441],256],12444:[[32,12442],256],12445:[,,{12441:12446}],12446:[[12445,12441]],12447:[[12424,12426],256],12454:[,,{12441:12532}],12459:[,,{12441:12460}],12460:[[12459,12441]],12461:[,,{12441:12462}],12462:[[12461,12441]],12463:[,,{12441:12464}],12464:[[12463,12441]],12465:[,,{12441:12466}],12466:[[12465,12441]],12467:[,,{12441:12468}],12468:[[12467,12441]],12469:[,,{12441:12470}],12470:[[12469,12441]],12471:[,,{12441:12472}],12472:[[12471,12441]],12473:[,,{12441:12474}],12474:[[12473,12441]],12475:[,,{12441:12476}],12476:[[12475,12441]],12477:[,,{12441:12478}],12478:[[12477,12441]],12479:[,,{12441:12480}],12480:[[12479,12441]],12481:[,,{12441:12482}],12482:[[12481,12441]],12484:[,,{12441:12485}],12485:[[12484,12441]],12486:[,,{12441:12487}],12487:[[12486,12441]],12488:[,,{12441:12489}],12489:[[12488,12441]],12495:[,,{12441:12496,12442:12497}],12496:[[12495,12441]],12497:[[12495,12442]],12498:[,,{12441:12499,12442:12500}],12499:[[12498,12441]],12500:[[12498,12442]],12501:[,,{12441:12502,12442:12503}],12502:[[12501,12441]],12503:[[12501,12442]],12504:[,,{12441:12505,12442:12506}],12505:[[12504,12441]],12506:[[12504,12442]],12507:[,,{12441:12508,12442:12509}],12508:[[12507,12441]],12509:[[12507,12442]],12527:[,,{12441:12535}],12528:[,,{12441:12536}],12529:[,,{12441:12537}],12530:[,,{12441:12538}],12532:[[12454,12441]],12535:[[12527,12441]],12536:[[12528,12441]],12537:[[12529,12441]],12538:[[12530,12441]],12541:[,,{12441:12542}],12542:[[12541,12441]],12543:[[12467,12488],256]},12544:{12593:[[4352],256],12594:[[4353],256],12595:[[4522],256],12596:[[4354],256],12597:[[4524],256],12598:[[4525],256],12599:[[4355],256],12600:[[4356],256],12601:[[4357],256],12602:[[4528],256],12603:[[4529],256],12604:[[4530],256],12605:[[4531],256],12606:[[4532],256],12607:[[4533],256],12608:[[4378],256],12609:[[4358],256],12610:[[4359],256],12611:[[4360],256],12612:[[4385],256],12613:[[4361],256],12614:[[4362],256],12615:[[4363],256],12616:[[4364],256],12617:[[4365],256],12618:[[4366],256],12619:[[4367],256],12620:[[4368],256],12621:[[4369],256],12622:[[4370],256],12623:[[4449],256],12624:[[4450],256],12625:[[4451],256],12626:[[4452],256],12627:[[4453],256],12628:[[4454],256],12629:[[4455],256],12630:[[4456],256],12631:[[4457],256],12632:[[4458],256],12633:[[4459],256],12634:[[4460],256],12635:[[4461],256],12636:[[4462],256],12637:[[4463],256],12638:[[4464],256],12639:[[4465],256],12640:[[4466],256],12641:[[4467],256],12642:[[4468],256],12643:[[4469],256],12644:[[4448],256],12645:[[4372],256],12646:[[4373],256],12647:[[4551],256],12648:[[4552],256],12649:[[4556],256],12650:[[4558],256],12651:[[4563],256],12652:[[4567],256],12653:[[4569],256],12654:[[4380],256],12655:[[4573],256],12656:[[4575],256],12657:[[4381],256],12658:[[4382],256],12659:[[4384],256],12660:[[4386],256],12661:[[4387],256],12662:[[4391],256],12663:[[4393],256],12664:[[4395],256],12665:[[4396],256],12666:[[4397],256],12667:[[4398],256],12668:[[4399],256],12669:[[4402],256],12670:[[4406],256],12671:[[4416],256],12672:[[4423],256],12673:[[4428],256],12674:[[4593],256],12675:[[4594],256],12676:[[4439],256],12677:[[4440],256],12678:[[4441],256],12679:[[4484],256],12680:[[4485],256],12681:[[4488],256],12682:[[4497],256],12683:[[4498],256],12684:[[4500],256],12685:[[4510],256],12686:[[4513],256],12690:[[19968],256],12691:[[20108],256],12692:[[19977],256],12693:[[22235],256],12694:[[19978],256],12695:[[20013],256],12696:[[19979],256],12697:[[30002],256],12698:[[20057],256],12699:[[19993],256],12700:[[19969],256],12701:[[22825],256],12702:[[22320],256],12703:[[20154],256]},12800:{12800:[[40,4352,41],256],12801:[[40,4354,41],256],12802:[[40,4355,41],256],12803:[[40,4357,41],256],12804:[[40,4358,41],256],12805:[[40,4359,41],256],12806:[[40,4361,41],256],12807:[[40,4363,41],256],12808:[[40,4364,41],256],12809:[[40,4366,41],256],12810:[[40,4367,41],256],12811:[[40,4368,41],256],12812:[[40,4369,41],256],12813:[[40,4370,41],256],12814:[[40,4352,4449,41],256],12815:[[40,4354,4449,41],256],12816:[[40,4355,4449,41],256],12817:[[40,4357,4449,41],256],12818:[[40,4358,4449,41],256],12819:[[40,4359,4449,41],256],12820:[[40,4361,4449,41],256],12821:[[40,4363,4449,41],256],12822:[[40,4364,4449,41],256],12823:[[40,4366,4449,41],256],12824:[[40,4367,4449,41],256],12825:[[40,4368,4449,41],256],12826:[[40,4369,4449,41],256],12827:[[40,4370,4449,41],256],12828:[[40,4364,4462,41],256],12829:[[40,4363,4457,4364,4453,4523,41],256],12830:[[40,4363,4457,4370,4462,41],256],12832:[[40,19968,41],256],12833:[[40,20108,41],256],12834:[[40,19977,41],256],12835:[[40,22235,41],256],12836:[[40,20116,41],256],12837:[[40,20845,41],256],12838:[[40,19971,41],256],12839:[[40,20843,41],256],12840:[[40,20061,41],256],12841:[[40,21313,41],256],12842:[[40,26376,41],256],12843:[[40,28779,41],256],12844:[[40,27700,41],256],12845:[[40,26408,41],256],12846:[[40,37329,41],256],12847:[[40,22303,41],256],12848:[[40,26085,41],256],12849:[[40,26666,41],256],12850:[[40,26377,41],256],12851:[[40,31038,41],256],12852:[[40,21517,41],256],12853:[[40,29305,41],256],12854:[[40,36001,41],256],12855:[[40,31069,41],256],12856:[[40,21172,41],256],12857:[[40,20195,41],256],12858:[[40,21628,41],256],12859:[[40,23398,41],256],12860:[[40,30435,41],256],12861:[[40,20225,41],256],12862:[[40,36039,41],256],12863:[[40,21332,41],256],12864:[[40,31085,41],256],12865:[[40,20241,41],256],12866:[[40,33258,41],256],12867:[[40,33267,41],256],12868:[[21839],256],12869:[[24188],256],12870:[[25991],256],12871:[[31631],256],12880:[[80,84,69],256],12881:[[50,49],256],12882:[[50,50],256],12883:[[50,51],256],12884:[[50,52],256],12885:[[50,53],256],12886:[[50,54],256],12887:[[50,55],256],12888:[[50,56],256],12889:[[50,57],256],12890:[[51,48],256],12891:[[51,49],256],12892:[[51,50],256],12893:[[51,51],256],12894:[[51,52],256],12895:[[51,53],256],12896:[[4352],256],12897:[[4354],256],12898:[[4355],256],12899:[[4357],256],12900:[[4358],256],12901:[[4359],256],12902:[[4361],256],12903:[[4363],256],12904:[[4364],256],12905:[[4366],256],12906:[[4367],256],12907:[[4368],256],12908:[[4369],256],12909:[[4370],256],12910:[[4352,4449],256],12911:[[4354,4449],256],12912:[[4355,4449],256],12913:[[4357,4449],256],12914:[[4358,4449],256],12915:[[4359,4449],256],12916:[[4361,4449],256],12917:[[4363,4449],256],12918:[[4364,4449],256],12919:[[4366,4449],256],12920:[[4367,4449],256],12921:[[4368,4449],256],12922:[[4369,4449],256],12923:[[4370,4449],256],12924:[[4366,4449,4535,4352,4457],256],12925:[[4364,4462,4363,4468],256],12926:[[4363,4462],256],12928:[[19968],256],12929:[[20108],256],12930:[[19977],256],12931:[[22235],256],12932:[[20116],256],12933:[[20845],256],12934:[[19971],256],12935:[[20843],256],12936:[[20061],256],12937:[[21313],256],12938:[[26376],256],12939:[[28779],256],12940:[[27700],256],12941:[[26408],256],12942:[[37329],256],12943:[[22303],256],12944:[[26085],256],12945:[[26666],256],12946:[[26377],256],12947:[[31038],256],12948:[[21517],256],12949:[[29305],256],12950:[[36001],256],12951:[[31069],256],12952:[[21172],256],12953:[[31192],256],12954:[[30007],256],12955:[[22899],256],12956:[[36969],256],12957:[[20778],256],12958:[[21360],256],12959:[[27880],256],12960:[[38917],256],12961:[[20241],256],12962:[[20889],256],12963:[[27491],256],12964:[[19978],256],12965:[[20013],256],12966:[[19979],256],12967:[[24038],256],12968:[[21491],256],12969:[[21307],256],12970:[[23447],256],12971:[[23398],256],12972:[[30435],256],12973:[[20225],256],12974:[[36039],256],12975:[[21332],256],12976:[[22812],256],12977:[[51,54],256],12978:[[51,55],256],12979:[[51,56],256],12980:[[51,57],256],12981:[[52,48],256],12982:[[52,49],256],12983:[[52,50],256],12984:[[52,51],256],12985:[[52,52],256],12986:[[52,53],256],12987:[[52,54],256],12988:[[52,55],256],12989:[[52,56],256],12990:[[52,57],256],12991:[[53,48],256],12992:[[49,26376],256],12993:[[50,26376],256],12994:[[51,26376],256],12995:[[52,26376],256],12996:[[53,26376],256],12997:[[54,26376],256],12998:[[55,26376],256],12999:[[56,26376],256],13e3:[[57,26376],256],13001:[[49,48,26376],256],13002:[[49,49,26376],256],13003:[[49,50,26376],256],13004:[[72,103],256],13005:[[101,114,103],256],13006:[[101,86],256],13007:[[76,84,68],256],13008:[[12450],256],13009:[[12452],256],13010:[[12454],256],13011:[[12456],256],13012:[[12458],256],13013:[[12459],256],13014:[[12461],256],13015:[[12463],256],13016:[[12465],256],13017:[[12467],256],13018:[[12469],256],13019:[[12471],256],13020:[[12473],256],13021:[[12475],256],13022:[[12477],256],13023:[[12479],256],13024:[[12481],256],13025:[[12484],256],13026:[[12486],256],13027:[[12488],256],13028:[[12490],256],13029:[[12491],256],13030:[[12492],256],13031:[[12493],256],13032:[[12494],256],13033:[[12495],256],13034:[[12498],256],13035:[[12501],256],13036:[[12504],256],13037:[[12507],256],13038:[[12510],256],13039:[[12511],256],13040:[[12512],256],13041:[[12513],256],13042:[[12514],256],13043:[[12516],256],13044:[[12518],256],13045:[[12520],256],13046:[[12521],256],13047:[[12522],256],13048:[[12523],256],13049:[[12524],256],13050:[[12525],256],13051:[[12527],256],13052:[[12528],256],13053:[[12529],256],13054:[[12530],256]},13056:{13056:[[12450,12497,12540,12488],256],13057:[[12450,12523,12501,12449],256],13058:[[12450,12531,12506,12450],256],13059:[[12450,12540,12523],256],13060:[[12452,12491,12531,12464],256],13061:[[12452,12531,12481],256],13062:[[12454,12457,12531],256],13063:[[12456,12473,12463,12540,12489],256],13064:[[12456,12540,12459,12540],256],13065:[[12458,12531,12473],256],13066:[[12458,12540,12512],256],13067:[[12459,12452,12522],256],13068:[[12459,12521,12483,12488],256],13069:[[12459,12525,12522,12540],256],13070:[[12460,12525,12531],256],13071:[[12460,12531,12510],256],13072:[[12462,12460],256],13073:[[12462,12491,12540],256],13074:[[12461,12517,12522,12540],256],13075:[[12462,12523,12480,12540],256],13076:[[12461,12525],256],13077:[[12461,12525,12464,12521,12512],256],13078:[[12461,12525,12513,12540,12488,12523],256],13079:[[12461,12525,12527,12483,12488],256],13080:[[12464,12521,12512],256],13081:[[12464,12521,12512,12488,12531],256],13082:[[12463,12523,12476,12452,12525],256],13083:[[12463,12525,12540,12493],256],13084:[[12465,12540,12473],256],13085:[[12467,12523,12490],256],13086:[[12467,12540,12509],256],13087:[[12469,12452,12463,12523],256],13088:[[12469,12531,12481,12540,12512],256],13089:[[12471,12522,12531,12464],256],13090:[[12475,12531,12481],256],13091:[[12475,12531,12488],256],13092:[[12480,12540,12473],256],13093:[[12487,12471],256],13094:[[12489,12523],256],13095:[[12488,12531],256],13096:[[12490,12494],256],13097:[[12494,12483,12488],256],13098:[[12495,12452,12484],256],13099:[[12497,12540,12475,12531,12488],256],13100:[[12497,12540,12484],256],13101:[[12496,12540,12524,12523],256],13102:[[12500,12450,12473,12488,12523],256],13103:[[12500,12463,12523],256],13104:[[12500,12467],256],13105:[[12499,12523],256],13106:[[12501,12449,12521,12483,12489],256],13107:[[12501,12451,12540,12488],256],13108:[[12502,12483,12471,12455,12523],256],13109:[[12501,12521,12531],256],13110:[[12504,12463,12479,12540,12523],256],13111:[[12506,12477],256],13112:[[12506,12491,12498],256],13113:[[12504,12523,12484],256],13114:[[12506,12531,12473],256],13115:[[12506,12540,12472],256],13116:[[12505,12540,12479],256],13117:[[12509,12452,12531,12488],256],13118:[[12508,12523,12488],256],13119:[[12507,12531],256],13120:[[12509,12531,12489],256],13121:[[12507,12540,12523],256],13122:[[12507,12540,12531],256],13123:[[12510,12452,12463,12525],256],13124:[[12510,12452,12523],256],13125:[[12510,12483,12495],256],13126:[[12510,12523,12463],256],13127:[[12510,12531,12471,12519,12531],256],13128:[[12511,12463,12525,12531],256],13129:[[12511,12522],256],13130:[[12511,12522,12496,12540,12523],256],13131:[[12513,12460],256],13132:[[12513,12460,12488,12531],256],13133:[[12513,12540,12488,12523],256],13134:[[12516,12540,12489],256],13135:[[12516,12540,12523],256],13136:[[12518,12450,12531],256],13137:[[12522,12483,12488,12523],256],13138:[[12522,12521],256],13139:[[12523,12500,12540],256],13140:[[12523,12540,12502,12523],256],13141:[[12524,12512],256],13142:[[12524,12531,12488,12466,12531],256],13143:[[12527,12483,12488],256],13144:[[48,28857],256],13145:[[49,28857],256],13146:[[50,28857],256],13147:[[51,28857],256],13148:[[52,28857],256],13149:[[53,28857],256],13150:[[54,28857],256],13151:[[55,28857],256],13152:[[56,28857],256],13153:[[57,28857],256],13154:[[49,48,28857],256],13155:[[49,49,28857],256],13156:[[49,50,28857],256],13157:[[49,51,28857],256],13158:[[49,52,28857],256],13159:[[49,53,28857],256],13160:[[49,54,28857],256],13161:[[49,55,28857],256],13162:[[49,56,28857],256],13163:[[49,57,28857],256],13164:[[50,48,28857],256],13165:[[50,49,28857],256],13166:[[50,50,28857],256],13167:[[50,51,28857],256],13168:[[50,52,28857],256],13169:[[104,80,97],256],13170:[[100,97],256],13171:[[65,85],256],13172:[[98,97,114],256],13173:[[111,86],256],13174:[[112,99],256],13175:[[100,109],256],13176:[[100,109,178],256],13177:[[100,109,179],256],13178:[[73,85],256],13179:[[24179,25104],256],13180:[[26157,21644],256],13181:[[22823,27491],256],13182:[[26126,27835],256],13183:[[26666,24335,20250,31038],256],13184:[[112,65],256],13185:[[110,65],256],13186:[[956,65],256],13187:[[109,65],256],13188:[[107,65],256],13189:[[75,66],256],13190:[[77,66],256],13191:[[71,66],256],13192:[[99,97,108],256],13193:[[107,99,97,108],256],13194:[[112,70],256],13195:[[110,70],256],13196:[[956,70],256],13197:[[956,103],256],13198:[[109,103],256],13199:[[107,103],256],13200:[[72,122],256],13201:[[107,72,122],256],13202:[[77,72,122],256],13203:[[71,72,122],256],13204:[[84,72,122],256],13205:[[956,8467],256],13206:[[109,8467],256],13207:[[100,8467],256],13208:[[107,8467],256],13209:[[102,109],256],13210:[[110,109],256],13211:[[956,109],256],13212:[[109,109],256],13213:[[99,109],256],13214:[[107,109],256],13215:[[109,109,178],256],13216:[[99,109,178],256],13217:[[109,178],256],13218:[[107,109,178],256],13219:[[109,109,179],256],13220:[[99,109,179],256],13221:[[109,179],256],13222:[[107,109,179],256],13223:[[109,8725,115],256],13224:[[109,8725,115,178],256],13225:[[80,97],256],13226:[[107,80,97],256],13227:[[77,80,97],256],13228:[[71,80,97],256],13229:[[114,97,100],256],13230:[[114,97,100,8725,115],256],13231:[[114,97,100,8725,115,178],256],13232:[[112,115],256],13233:[[110,115],256],13234:[[956,115],256],13235:[[109,115],256],13236:[[112,86],256],13237:[[110,86],256],13238:[[956,86],256],13239:[[109,86],256],13240:[[107,86],256],13241:[[77,86],256],13242:[[112,87],256],13243:[[110,87],256],13244:[[956,87],256],13245:[[109,87],256],13246:[[107,87],256],13247:[[77,87],256],13248:[[107,937],256],13249:[[77,937],256],13250:[[97,46,109,46],256],13251:[[66,113],256],13252:[[99,99],256],13253:[[99,100],256],13254:[[67,8725,107,103],256],13255:[[67,111,46],256],13256:[[100,66],256],13257:[[71,121],256],13258:[[104,97],256],13259:[[72,80],256],13260:[[105,110],256],13261:[[75,75],256],13262:[[75,77],256],13263:[[107,116],256],13264:[[108,109],256],13265:[[108,110],256],13266:[[108,111,103],256],13267:[[108,120],256],13268:[[109,98],256],13269:[[109,105,108],256],13270:[[109,111,108],256],13271:[[80,72],256],13272:[[112,46,109,46],256],13273:[[80,80,77],256],13274:[[80,82],256],13275:[[115,114],256],13276:[[83,118],256],13277:[[87,98],256],13278:[[86,8725,109],256],13279:[[65,8725,109],256],13280:[[49,26085],256],13281:[[50,26085],256],13282:[[51,26085],256],13283:[[52,26085],256],13284:[[53,26085],256],13285:[[54,26085],256],13286:[[55,26085],256],13287:[[56,26085],256],13288:[[57,26085],256],13289:[[49,48,26085],256],13290:[[49,49,26085],256],13291:[[49,50,26085],256],13292:[[49,51,26085],256],13293:[[49,52,26085],256],13294:[[49,53,26085],256],13295:[[49,54,26085],256],13296:[[49,55,26085],256],13297:[[49,56,26085],256],13298:[[49,57,26085],256],13299:[[50,48,26085],256],13300:[[50,49,26085],256],13301:[[50,50,26085],256],13302:[[50,51,26085],256],13303:[[50,52,26085],256],13304:[[50,53,26085],256],13305:[[50,54,26085],256],13306:[[50,55,26085],256],13307:[[50,56,26085],256],13308:[[50,57,26085],256],13309:[[51,48,26085],256],13310:[[51,49,26085],256],13311:[[103,97,108],256]},27136:{92912:[,1],92913:[,1],92914:[,1],92915:[,1],92916:[,1]},27392:{92976:[,230],92977:[,230],92978:[,230],92979:[,230],92980:[,230],92981:[,230],92982:[,230]},42496:{42607:[,230],42612:[,230],42613:[,230],42614:[,230],42615:[,230],42616:[,230],42617:[,230],42618:[,230],42619:[,230],42620:[,230],42621:[,230],42652:[[1098],256],42653:[[1100],256],42655:[,230],42736:[,230],42737:[,230]},42752:{42864:[[42863],256],43e3:[[294],256],43001:[[339],256]},43008:{43014:[,9],43204:[,9],43232:[,230],43233:[,230],43234:[,230],43235:[,230],43236:[,230],43237:[,230],43238:[,230],43239:[,230],43240:[,230],43241:[,230],43242:[,230],43243:[,230],43244:[,230],43245:[,230],43246:[,230],43247:[,230],43248:[,230],43249:[,230]},43264:{43307:[,220],43308:[,220],43309:[,220],43347:[,9],43443:[,7],43456:[,9]},43520:{43696:[,230],43698:[,230],43699:[,230],43700:[,220],43703:[,230],43704:[,230],43710:[,230],43711:[,230],43713:[,230],43766:[,9]},43776:{43868:[[42791],256],43869:[[43831],256],43870:[[619],256],43871:[[43858],256],44013:[,9]},48128:{113822:[,1]},53504:{119134:[[119127,119141],512],119135:[[119128,119141],512],119136:[[119135,119150],512],119137:[[119135,119151],512],119138:[[119135,119152],512],119139:[[119135,119153],512],119140:[[119135,119154],512],119141:[,216],119142:[,216],119143:[,1],119144:[,1],119145:[,1],119149:[,226],119150:[,216],119151:[,216],119152:[,216],119153:[,216],119154:[,216],119163:[,220],119164:[,220],119165:[,220],119166:[,220],119167:[,220],119168:[,220],119169:[,220],119170:[,220],119173:[,230],119174:[,230],119175:[,230],119176:[,230],119177:[,230],119178:[,220],119179:[,220],119210:[,230],119211:[,230],119212:[,230],119213:[,230],119227:[[119225,119141],512],119228:[[119226,119141],512],119229:[[119227,119150],512],119230:[[119228,119150],512],119231:[[119227,119151],512],119232:[[119228,119151],512]},53760:{119362:[,230],119363:[,230],119364:[,230]},54272:{119808:[[65],256],119809:[[66],256],119810:[[67],256],119811:[[68],256],119812:[[69],256],119813:[[70],256],119814:[[71],256],119815:[[72],256],119816:[[73],256],119817:[[74],256],119818:[[75],256],119819:[[76],256],119820:[[77],256],119821:[[78],256],119822:[[79],256],119823:[[80],256],119824:[[81],256],119825:[[82],256],119826:[[83],256],119827:[[84],256],119828:[[85],256],119829:[[86],256],119830:[[87],256],119831:[[88],256],119832:[[89],256],119833:[[90],256],119834:[[97],256],119835:[[98],256],119836:[[99],256],119837:[[100],256],119838:[[101],256],119839:[[102],256],119840:[[103],256],119841:[[104],256],119842:[[105],256],119843:[[106],256],119844:[[107],256],119845:[[108],256],119846:[[109],256],119847:[[110],256],119848:[[111],256],119849:[[112],256],119850:[[113],256],119851:[[114],256],119852:[[115],256],119853:[[116],256],119854:[[117],256],119855:[[118],256],119856:[[119],256],119857:[[120],256],119858:[[121],256],119859:[[122],256],119860:[[65],256],119861:[[66],256],119862:[[67],256],119863:[[68],256],119864:[[69],256],119865:[[70],256],119866:[[71],256],119867:[[72],256],119868:[[73],256],119869:[[74],256],119870:[[75],256],119871:[[76],256],119872:[[77],256],119873:[[78],256],119874:[[79],256],119875:[[80],256],119876:[[81],256],119877:[[82],256],119878:[[83],256],119879:[[84],256],119880:[[85],256],119881:[[86],256],119882:[[87],256],119883:[[88],256],119884:[[89],256],119885:[[90],256],119886:[[97],256],119887:[[98],256],119888:[[99],256],119889:[[100],256],119890:[[101],256],119891:[[102],256],119892:[[103],256],119894:[[105],256],119895:[[106],256],119896:[[107],256],119897:[[108],256],119898:[[109],256],119899:[[110],256],119900:[[111],256],119901:[[112],256],119902:[[113],256],119903:[[114],256],119904:[[115],256],119905:[[116],256],119906:[[117],256],119907:[[118],256],119908:[[119],256],119909:[[120],256],119910:[[121],256],119911:[[122],256],119912:[[65],256],119913:[[66],256],119914:[[67],256],119915:[[68],256],119916:[[69],256],119917:[[70],256],119918:[[71],256],119919:[[72],256],119920:[[73],256],119921:[[74],256],119922:[[75],256],119923:[[76],256],119924:[[77],256],119925:[[78],256],119926:[[79],256],119927:[[80],256],119928:[[81],256],119929:[[82],256],119930:[[83],256],119931:[[84],256],119932:[[85],256],119933:[[86],256],119934:[[87],256],119935:[[88],256],119936:[[89],256],119937:[[90],256],119938:[[97],256],119939:[[98],256],119940:[[99],256],119941:[[100],256],119942:[[101],256],119943:[[102],256],119944:[[103],256],119945:[[104],256],119946:[[105],256],119947:[[106],256],119948:[[107],256],119949:[[108],256],119950:[[109],256],119951:[[110],256],119952:[[111],256],119953:[[112],256],119954:[[113],256],119955:[[114],256],119956:[[115],256],119957:[[116],256],119958:[[117],256],119959:[[118],256],119960:[[119],256],119961:[[120],256],119962:[[121],256],119963:[[122],256],119964:[[65],256],119966:[[67],256],119967:[[68],256],119970:[[71],256],119973:[[74],256],119974:[[75],256],119977:[[78],256],119978:[[79],256],119979:[[80],256],119980:[[81],256],119982:[[83],256],119983:[[84],256],119984:[[85],256],119985:[[86],256],119986:[[87],256],119987:[[88],256],119988:[[89],256],119989:[[90],256],119990:[[97],256],119991:[[98],256],119992:[[99],256],119993:[[100],256],119995:[[102],256],119997:[[104],256],119998:[[105],256],119999:[[106],256],12e4:[[107],256],120001:[[108],256],120002:[[109],256],120003:[[110],256],120005:[[112],256],120006:[[113],256],120007:[[114],256],120008:[[115],256],120009:[[116],256],120010:[[117],256],120011:[[118],256],120012:[[119],256],120013:[[120],256],120014:[[121],256],120015:[[122],256],120016:[[65],256],120017:[[66],256],120018:[[67],256],120019:[[68],256],120020:[[69],256],120021:[[70],256],120022:[[71],256],120023:[[72],256],120024:[[73],256],120025:[[74],256],120026:[[75],256],120027:[[76],256],120028:[[77],256],120029:[[78],256],120030:[[79],256],120031:[[80],256],120032:[[81],256],120033:[[82],256],120034:[[83],256],120035:[[84],256],120036:[[85],256],120037:[[86],256],120038:[[87],256],120039:[[88],256],120040:[[89],256],120041:[[90],256],120042:[[97],256],120043:[[98],256],120044:[[99],256],120045:[[100],256],120046:[[101],256],120047:[[102],256],120048:[[103],256],120049:[[104],256],120050:[[105],256],120051:[[106],256],120052:[[107],256],120053:[[108],256],120054:[[109],256],120055:[[110],256],120056:[[111],256],120057:[[112],256],120058:[[113],256],120059:[[114],256],120060:[[115],256],120061:[[116],256],120062:[[117],256],120063:[[118],256]},54528:{120064:[[119],256],120065:[[120],256],120066:[[121],256],120067:[[122],256],120068:[[65],256],120069:[[66],256],120071:[[68],256],120072:[[69],256],120073:[[70],256],120074:[[71],256],120077:[[74],256],120078:[[75],256],120079:[[76],256],120080:[[77],256],120081:[[78],256],120082:[[79],256],120083:[[80],256],120084:[[81],256],120086:[[83],256],120087:[[84],256],120088:[[85],256],120089:[[86],256],120090:[[87],256],120091:[[88],256],120092:[[89],256],120094:[[97],256],120095:[[98],256],120096:[[99],256],120097:[[100],256],120098:[[101],256],120099:[[102],256],120100:[[103],256],120101:[[104],256],120102:[[105],256],120103:[[106],256],120104:[[107],256],120105:[[108],256],120106:[[109],256],120107:[[110],256],120108:[[111],256],120109:[[112],256],120110:[[113],256],120111:[[114],256],120112:[[115],256],120113:[[116],256],120114:[[117],256],120115:[[118],256],120116:[[119],256],120117:[[120],256],120118:[[121],256],120119:[[122],256],120120:[[65],256],120121:[[66],256],120123:[[68],256],120124:[[69],256],120125:[[70],256],120126:[[71],256],120128:[[73],256],120129:[[74],256],120130:[[75],256],120131:[[76],256],120132:[[77],256],120134:[[79],256],120138:[[83],256],120139:[[84],256],120140:[[85],256],120141:[[86],256],120142:[[87],256],120143:[[88],256],120144:[[89],256],120146:[[97],256],120147:[[98],256],120148:[[99],256],120149:[[100],256],120150:[[101],256],120151:[[102],256],120152:[[103],256],120153:[[104],256],120154:[[105],256],120155:[[106],256],120156:[[107],256],120157:[[108],256],120158:[[109],256],120159:[[110],256],120160:[[111],256],120161:[[112],256],120162:[[113],256],120163:[[114],256],120164:[[115],256],120165:[[116],256],120166:[[117],256],120167:[[118],256],120168:[[119],256],120169:[[120],256],120170:[[121],256],120171:[[122],256],120172:[[65],256],120173:[[66],256],120174:[[67],256],120175:[[68],256],120176:[[69],256],120177:[[70],256],120178:[[71],256],120179:[[72],256],120180:[[73],256],120181:[[74],256],120182:[[75],256],120183:[[76],256],120184:[[77],256],120185:[[78],256],120186:[[79],256],120187:[[80],256],120188:[[81],256],120189:[[82],256],120190:[[83],256],120191:[[84],256],120192:[[85],256],120193:[[86],256],120194:[[87],256],120195:[[88],256],120196:[[89],256],120197:[[90],256],120198:[[97],256],120199:[[98],256],120200:[[99],256],120201:[[100],256],120202:[[101],256],120203:[[102],256],120204:[[103],256],120205:[[104],256],120206:[[105],256],120207:[[106],256],120208:[[107],256],120209:[[108],256],120210:[[109],256],120211:[[110],256],120212:[[111],256],120213:[[112],256],120214:[[113],256],120215:[[114],256],120216:[[115],256],120217:[[116],256],120218:[[117],256],120219:[[118],256],120220:[[119],256],120221:[[120],256],120222:[[121],256],120223:[[122],256],120224:[[65],256],120225:[[66],256],120226:[[67],256],120227:[[68],256],120228:[[69],256],120229:[[70],256],120230:[[71],256],120231:[[72],256],120232:[[73],256],120233:[[74],256],120234:[[75],256],120235:[[76],256],120236:[[77],256],120237:[[78],256],120238:[[79],256],120239:[[80],256],120240:[[81],256],120241:[[82],256],120242:[[83],256],120243:[[84],256],120244:[[85],256],120245:[[86],256],120246:[[87],256],120247:[[88],256],120248:[[89],256],120249:[[90],256],120250:[[97],256],120251:[[98],256],120252:[[99],256],120253:[[100],256],120254:[[101],256],120255:[[102],256],120256:[[103],256],120257:[[104],256],120258:[[105],256],120259:[[106],256],120260:[[107],256],120261:[[108],256],120262:[[109],256],120263:[[110],256],120264:[[111],256],120265:[[112],256],120266:[[113],256],120267:[[114],256],120268:[[115],256],120269:[[116],256],120270:[[117],256],120271:[[118],256],120272:[[119],256],120273:[[120],256],120274:[[121],256],120275:[[122],256],120276:[[65],256],120277:[[66],256],120278:[[67],256],120279:[[68],256],120280:[[69],256],120281:[[70],256],120282:[[71],256],120283:[[72],256],120284:[[73],256],120285:[[74],256],120286:[[75],256],120287:[[76],256],120288:[[77],256],120289:[[78],256],120290:[[79],256],120291:[[80],256],120292:[[81],256],120293:[[82],256],120294:[[83],256],120295:[[84],256],120296:[[85],256],120297:[[86],256],120298:[[87],256],120299:[[88],256],120300:[[89],256],120301:[[90],256],120302:[[97],256],120303:[[98],256],120304:[[99],256],120305:[[100],256],120306:[[101],256],120307:[[102],256],120308:[[103],256],120309:[[104],256],120310:[[105],256],120311:[[106],256],120312:[[107],256],120313:[[108],256],120314:[[109],256],120315:[[110],256],120316:[[111],256],120317:[[112],256],120318:[[113],256],120319:[[114],256]},54784:{120320:[[115],256],120321:[[116],256],120322:[[117],256],120323:[[118],256],120324:[[119],256],120325:[[120],256],120326:[[121],256],120327:[[122],256],120328:[[65],256],120329:[[66],256],120330:[[67],256],120331:[[68],256],120332:[[69],256],120333:[[70],256],120334:[[71],256],120335:[[72],256],120336:[[73],256],120337:[[74],256],120338:[[75],256],120339:[[76],256],120340:[[77],256],120341:[[78],256],120342:[[79],256],120343:[[80],256],120344:[[81],256],120345:[[82],256],120346:[[83],256],120347:[[84],256],120348:[[85],256],120349:[[86],256],120350:[[87],256],120351:[[88],256],120352:[[89],256],120353:[[90],256],120354:[[97],256],120355:[[98],256],120356:[[99],256],120357:[[100],256],120358:[[101],256],120359:[[102],256],120360:[[103],256],120361:[[104],256],120362:[[105],256],120363:[[106],256],120364:[[107],256],120365:[[108],256],120366:[[109],256],120367:[[110],256],120368:[[111],256],120369:[[112],256],120370:[[113],256],120371:[[114],256],120372:[[115],256],120373:[[116],256],120374:[[117],256],120375:[[118],256],120376:[[119],256],120377:[[120],256],120378:[[121],256],120379:[[122],256],120380:[[65],256],120381:[[66],256],120382:[[67],256],120383:[[68],256],120384:[[69],256],120385:[[70],256],120386:[[71],256],120387:[[72],256],120388:[[73],256],120389:[[74],256],120390:[[75],256],120391:[[76],256],120392:[[77],256],120393:[[78],256],120394:[[79],256],120395:[[80],256],120396:[[81],256],120397:[[82],256],120398:[[83],256],120399:[[84],256],120400:[[85],256],120401:[[86],256],120402:[[87],256],120403:[[88],256],120404:[[89],256],120405:[[90],256],120406:[[97],256],120407:[[98],256],120408:[[99],256],120409:[[100],256],120410:[[101],256],120411:[[102],256],120412:[[103],256],120413:[[104],256],120414:[[105],256],120415:[[106],256],120416:[[107],256],120417:[[108],256],120418:[[109],256],120419:[[110],256],120420:[[111],256],120421:[[112],256],120422:[[113],256],120423:[[114],256],120424:[[115],256],120425:[[116],256],120426:[[117],256],120427:[[118],256],120428:[[119],256],120429:[[120],256],120430:[[121],256],120431:[[122],256],120432:[[65],256],120433:[[66],256],120434:[[67],256],120435:[[68],256],120436:[[69],256],120437:[[70],256],120438:[[71],256],120439:[[72],256],120440:[[73],256],120441:[[74],256],120442:[[75],256],120443:[[76],256],120444:[[77],256],120445:[[78],256],120446:[[79],256],120447:[[80],256],120448:[[81],256],120449:[[82],256],120450:[[83],256],120451:[[84],256],120452:[[85],256],120453:[[86],256],120454:[[87],256],120455:[[88],256],120456:[[89],256],120457:[[90],256],120458:[[97],256],120459:[[98],256],120460:[[99],256],120461:[[100],256],120462:[[101],256],120463:[[102],256],120464:[[103],256],120465:[[104],256],120466:[[105],256],120467:[[106],256],120468:[[107],256],120469:[[108],256],120470:[[109],256],120471:[[110],256],120472:[[111],256],120473:[[112],256],120474:[[113],256],120475:[[114],256],120476:[[115],256],120477:[[116],256],120478:[[117],256],120479:[[118],256],120480:[[119],256],120481:[[120],256],120482:[[121],256],120483:[[122],256],120484:[[305],256],120485:[[567],256],120488:[[913],256],120489:[[914],256],120490:[[915],256],120491:[[916],256],120492:[[917],256],120493:[[918],256],120494:[[919],256],120495:[[920],256],120496:[[921],256],120497:[[922],256],120498:[[923],256],120499:[[924],256],120500:[[925],256],120501:[[926],256],120502:[[927],256],120503:[[928],256],120504:[[929],256],120505:[[1012],256],120506:[[931],256],120507:[[932],256],120508:[[933],256],120509:[[934],256],120510:[[935],256],120511:[[936],256],120512:[[937],256],120513:[[8711],256],120514:[[945],256],120515:[[946],256],120516:[[947],256],120517:[[948],256],120518:[[949],256],120519:[[950],256],120520:[[951],256],120521:[[952],256],120522:[[953],256],120523:[[954],256],120524:[[955],256],120525:[[956],256],120526:[[957],256],120527:[[958],256],120528:[[959],256],120529:[[960],256],120530:[[961],256],120531:[[962],256],120532:[[963],256],120533:[[964],256],120534:[[965],256],120535:[[966],256],120536:[[967],256],120537:[[968],256],120538:[[969],256],120539:[[8706],256],120540:[[1013],256],120541:[[977],256],120542:[[1008],256],120543:[[981],256],120544:[[1009],256],120545:[[982],256],120546:[[913],256],120547:[[914],256],120548:[[915],256],120549:[[916],256],120550:[[917],256],120551:[[918],256],120552:[[919],256],120553:[[920],256],120554:[[921],256],120555:[[922],256],120556:[[923],256],120557:[[924],256],120558:[[925],256],120559:[[926],256],120560:[[927],256],120561:[[928],256],120562:[[929],256],120563:[[1012],256],120564:[[931],256],120565:[[932],256],120566:[[933],256],120567:[[934],256],120568:[[935],256],120569:[[936],256],120570:[[937],256],120571:[[8711],256],120572:[[945],256],120573:[[946],256],120574:[[947],256],120575:[[948],256]},55040:{120576:[[949],256],120577:[[950],256],120578:[[951],256],120579:[[952],256],120580:[[953],256],120581:[[954],256],120582:[[955],256],120583:[[956],256],120584:[[957],256],120585:[[958],256],120586:[[959],256],120587:[[960],256],120588:[[961],256],120589:[[962],256],120590:[[963],256],120591:[[964],256],120592:[[965],256],120593:[[966],256],120594:[[967],256],120595:[[968],256],120596:[[969],256],120597:[[8706],256],120598:[[1013],256],120599:[[977],256],120600:[[1008],256],120601:[[981],256],120602:[[1009],256],120603:[[982],256],120604:[[913],256],120605:[[914],256],120606:[[915],256],120607:[[916],256],120608:[[917],256],120609:[[918],256],120610:[[919],256],120611:[[920],256],120612:[[921],256],120613:[[922],256],120614:[[923],256],120615:[[924],256],120616:[[925],256],120617:[[926],256],120618:[[927],256],120619:[[928],256],120620:[[929],256],120621:[[1012],256],120622:[[931],256],120623:[[932],256],120624:[[933],256],120625:[[934],256],120626:[[935],256],120627:[[936],256],120628:[[937],256],120629:[[8711],256],120630:[[945],256],120631:[[946],256],120632:[[947],256],120633:[[948],256],120634:[[949],256],120635:[[950],256],120636:[[951],256],120637:[[952],256],120638:[[953],256],120639:[[954],256],120640:[[955],256],120641:[[956],256],120642:[[957],256],120643:[[958],256],120644:[[959],256],120645:[[960],256],120646:[[961],256],120647:[[962],256],120648:[[963],256],120649:[[964],256],120650:[[965],256],120651:[[966],256],120652:[[967],256],120653:[[968],256],120654:[[969],256],120655:[[8706],256],120656:[[1013],256],120657:[[977],256],120658:[[1008],256],120659:[[981],256],120660:[[1009],256],120661:[[982],256],120662:[[913],256],120663:[[914],256],120664:[[915],256],120665:[[916],256],120666:[[917],256],120667:[[918],256],120668:[[919],256],120669:[[920],256],120670:[[921],256],120671:[[922],256],120672:[[923],256],120673:[[924],256],120674:[[925],256],120675:[[926],256],120676:[[927],256],120677:[[928],256],120678:[[929],256],120679:[[1012],256],120680:[[931],256],120681:[[932],256],120682:[[933],256],120683:[[934],256],120684:[[935],256],120685:[[936],256],120686:[[937],256],120687:[[8711],256],120688:[[945],256],120689:[[946],256],120690:[[947],256],120691:[[948],256],120692:[[949],256],120693:[[950],256],120694:[[951],256],120695:[[952],256],120696:[[953],256],120697:[[954],256],120698:[[955],256],120699:[[956],256],120700:[[957],256],120701:[[958],256],120702:[[959],256],120703:[[960],256],120704:[[961],256],120705:[[962],256],120706:[[963],256],120707:[[964],256],120708:[[965],256],120709:[[966],256],120710:[[967],256],120711:[[968],256],120712:[[969],256],120713:[[8706],256],120714:[[1013],256],120715:[[977],256],120716:[[1008],256],120717:[[981],256],120718:[[1009],256],120719:[[982],256],120720:[[913],256],120721:[[914],256],120722:[[915],256],120723:[[916],256],120724:[[917],256],120725:[[918],256],120726:[[919],256],120727:[[920],256],120728:[[921],256],120729:[[922],256],120730:[[923],256],120731:[[924],256],120732:[[925],256],120733:[[926],256],120734:[[927],256],120735:[[928],256],120736:[[929],256],120737:[[1012],256],120738:[[931],256],120739:[[932],256],120740:[[933],256],120741:[[934],256],120742:[[935],256],120743:[[936],256],120744:[[937],256],120745:[[8711],256],120746:[[945],256],120747:[[946],256],120748:[[947],256],120749:[[948],256],120750:[[949],256],120751:[[950],256],120752:[[951],256],120753:[[952],256],120754:[[953],256],120755:[[954],256],120756:[[955],256],120757:[[956],256],120758:[[957],256],120759:[[958],256],120760:[[959],256],120761:[[960],256],120762:[[961],256],120763:[[962],256],120764:[[963],256],120765:[[964],256],120766:[[965],256],120767:[[966],256],120768:[[967],256],120769:[[968],256],120770:[[969],256],120771:[[8706],256],120772:[[1013],256],120773:[[977],256],120774:[[1008],256],120775:[[981],256],120776:[[1009],256],120777:[[982],256],120778:[[988],256],120779:[[989],256],120782:[[48],256],120783:[[49],256],120784:[[50],256],120785:[[51],256],120786:[[52],256],120787:[[53],256],120788:[[54],256],120789:[[55],256],120790:[[56],256],120791:[[57],256],120792:[[48],256],120793:[[49],256],120794:[[50],256],120795:[[51],256],120796:[[52],256],120797:[[53],256],120798:[[54],256],120799:[[55],256],120800:[[56],256],120801:[[57],256],120802:[[48],256],120803:[[49],256],120804:[[50],256],120805:[[51],256],120806:[[52],256],120807:[[53],256],120808:[[54],256],120809:[[55],256],120810:[[56],256],120811:[[57],256],120812:[[48],256],120813:[[49],256],120814:[[50],256],120815:[[51],256],120816:[[52],256],120817:[[53],256],120818:[[54],256],120819:[[55],256],120820:[[56],256],120821:[[57],256],120822:[[48],256],120823:[[49],256],120824:[[50],256],120825:[[51],256],120826:[[52],256],120827:[[53],256],120828:[[54],256],120829:[[55],256],120830:[[56],256],120831:[[57],256]},59392:{125136:[,220],125137:[,220],125138:[,220],125139:[,220],125140:[,220],125141:[,220],125142:[,220]},60928:{126464:[[1575],256],126465:[[1576],256],126466:[[1580],256],126467:[[1583],256],126469:[[1608],256],126470:[[1586],256],126471:[[1581],256],126472:[[1591],256],126473:[[1610],256],126474:[[1603],256],126475:[[1604],256],126476:[[1605],256],126477:[[1606],256],126478:[[1587],256],126479:[[1593],256],126480:[[1601],256],126481:[[1589],256],126482:[[1602],256],126483:[[1585],256],126484:[[1588],256],126485:[[1578],256],126486:[[1579],256],126487:[[1582],256],126488:[[1584],256],126489:[[1590],256],126490:[[1592],256],126491:[[1594],256],126492:[[1646],256],126493:[[1722],256],126494:[[1697],256],126495:[[1647],256],126497:[[1576],256],126498:[[1580],256],126500:[[1607],256],126503:[[1581],256],126505:[[1610],256],126506:[[1603],256],126507:[[1604],256],126508:[[1605],256],126509:[[1606],256],126510:[[1587],256],126511:[[1593],256],126512:[[1601],256],126513:[[1589],256],126514:[[1602],256],126516:[[1588],256],126517:[[1578],256],126518:[[1579],256],126519:[[1582],256],126521:[[1590],256],126523:[[1594],256],126530:[[1580],256],126535:[[1581],256],126537:[[1610],256],126539:[[1604],256],126541:[[1606],256],126542:[[1587],256],126543:[[1593],256],126545:[[1589],256],126546:[[1602],256],126548:[[1588],256],126551:[[1582],256],126553:[[1590],256],126555:[[1594],256],126557:[[1722],256],126559:[[1647],256],126561:[[1576],256],126562:[[1580],256],126564:[[1607],256],126567:[[1581],256],126568:[[1591],256],126569:[[1610],256],126570:[[1603],256],126572:[[1605],256],126573:[[1606],256],126574:[[1587],256],126575:[[1593],256],126576:[[1601],256],126577:[[1589],256],126578:[[1602],256],126580:[[1588],256],126581:[[1578],256],126582:[[1579],256],126583:[[1582],256],126585:[[1590],256],126586:[[1592],256],126587:[[1594],256],126588:[[1646],256],126590:[[1697],256],126592:[[1575],256],126593:[[1576],256],126594:[[1580],256],126595:[[1583],256],126596:[[1607],256],126597:[[1608],256],126598:[[1586],256],126599:[[1581],256],126600:[[1591],256],126601:[[1610],256],126603:[[1604],256],126604:[[1605],256],126605:[[1606],256],126606:[[1587],256],126607:[[1593],256],126608:[[1601],256],126609:[[1589],256],126610:[[1602],256],126611:[[1585],256],126612:[[1588],256],126613:[[1578],256],126614:[[1579],256],126615:[[1582],256],126616:[[1584],256],126617:[[1590],256],126618:[[1592],256],126619:[[1594],256],126625:[[1576],256],126626:[[1580],256],126627:[[1583],256],126629:[[1608],256],126630:[[1586],256],126631:[[1581],256],126632:[[1591],256],126633:[[1610],256],126635:[[1604],256],126636:[[1605],256],126637:[[1606],256],126638:[[1587],256],126639:[[1593],256],126640:[[1601],256],126641:[[1589],256],126642:[[1602],256],126643:[[1585],256],126644:[[1588],256],126645:[[1578],256],126646:[[1579],256],126647:[[1582],256],126648:[[1584],256],126649:[[1590],256],126650:[[1592],256],126651:[[1594],256]},61696:{127232:[[48,46],256],127233:[[48,44],256],127234:[[49,44],256],127235:[[50,44],256],127236:[[51,44],256],127237:[[52,44],256],127238:[[53,44],256],127239:[[54,44],256],127240:[[55,44],256],127241:[[56,44],256],127242:[[57,44],256],127248:[[40,65,41],256],127249:[[40,66,41],256],127250:[[40,67,41],256],127251:[[40,68,41],256],127252:[[40,69,41],256],127253:[[40,70,41],256],127254:[[40,71,41],256],127255:[[40,72,41],256],127256:[[40,73,41],256],127257:[[40,74,41],256],127258:[[40,75,41],256],127259:[[40,76,41],256],127260:[[40,77,41],256],127261:[[40,78,41],256],127262:[[40,79,41],256],127263:[[40,80,41],256],127264:[[40,81,41],256],127265:[[40,82,41],256],127266:[[40,83,41],256],127267:[[40,84,41],256],127268:[[40,85,41],256],127269:[[40,86,41],256],127270:[[40,87,41],256],127271:[[40,88,41],256],127272:[[40,89,41],256],127273:[[40,90,41],256],127274:[[12308,83,12309],256],127275:[[67],256],127276:[[82],256],127277:[[67,68],256],127278:[[87,90],256],127280:[[65],256],127281:[[66],256],127282:[[67],256],127283:[[68],256],127284:[[69],256],127285:[[70],256],127286:[[71],256],127287:[[72],256],127288:[[73],256],127289:[[74],256],127290:[[75],256],127291:[[76],256],127292:[[77],256],127293:[[78],256],127294:[[79],256],127295:[[80],256],127296:[[81],256],127297:[[82],256],127298:[[83],256],127299:[[84],256],127300:[[85],256],127301:[[86],256],127302:[[87],256],127303:[[88],256],127304:[[89],256],127305:[[90],256],127306:[[72,86],256],127307:[[77,86],256],127308:[[83,68],256],127309:[[83,83],256],127310:[[80,80,86],256],127311:[[87,67],256],127338:[[77,67],256],127339:[[77,68],256],127376:[[68,74],256]},61952:{127488:[[12411,12363],256],127489:[[12467,12467],256],127490:[[12469],256],127504:[[25163],256],127505:[[23383],256],127506:[[21452],256],127507:[[12487],256],127508:[[20108],256],127509:[[22810],256],127510:[[35299],256],127511:[[22825],256],127512:[[20132],256],127513:[[26144],256],127514:[[28961],256],127515:[[26009],256],127516:[[21069],256],127517:[[24460],256],127518:[[20877],256],127519:[[26032],256],127520:[[21021],256],127521:[[32066],256],127522:[[29983],256],127523:[[36009],256],127524:[[22768],256],127525:[[21561],256],127526:[[28436],256],127527:[[25237],256],127528:[[25429],256],127529:[[19968],256],127530:[[19977],256],127531:[[36938],256],127532:[[24038],256],127533:[[20013],256],127534:[[21491],256],127535:[[25351],256],127536:[[36208],256],127537:[[25171],256],127538:[[31105],256],127539:[[31354],256],127540:[[21512],256],127541:[[28288],256],127542:[[26377],256],127543:[[26376],256],127544:[[30003],256],127545:[[21106],256],127546:[[21942],256],127552:[[12308,26412,12309],256],127553:[[12308,19977,12309],256],127554:[[12308,20108,12309],256],127555:[[12308,23433,12309],256],127556:[[12308,28857,12309],256],127557:[[12308,25171,12309],256],127558:[[12308,30423,12309],256],127559:[[12308,21213,12309],256],127560:[[12308,25943,12309],256],127568:[[24471],256],127569:[[21487],256]},63488:{194560:[[20029]],194561:[[20024]],194562:[[20033]],194563:[[131362]],194564:[[20320]],194565:[[20398]],194566:[[20411]],194567:[[20482]],194568:[[20602]],194569:[[20633]],194570:[[20711]],194571:[[20687]],194572:[[13470]],194573:[[132666]],194574:[[20813]],194575:[[20820]],194576:[[20836]],194577:[[20855]],194578:[[132380]],194579:[[13497]],194580:[[20839]],194581:[[20877]],194582:[[132427]],194583:[[20887]],194584:[[20900]],194585:[[20172]],194586:[[20908]],194587:[[20917]],194588:[[168415]],194589:[[20981]],194590:[[20995]],194591:[[13535]],194592:[[21051]],194593:[[21062]],194594:[[21106]],194595:[[21111]],194596:[[13589]],194597:[[21191]],194598:[[21193]],194599:[[21220]],194600:[[21242]],194601:[[21253]],194602:[[21254]],194603:[[21271]],194604:[[21321]],194605:[[21329]],194606:[[21338]],194607:[[21363]],194608:[[21373]],194609:[[21375]],194610:[[21375]],194611:[[21375]],194612:[[133676]],194613:[[28784]],194614:[[21450]],194615:[[21471]],194616:[[133987]],194617:[[21483]],194618:[[21489]],194619:[[21510]],194620:[[21662]],194621:[[21560]],194622:[[21576]],194623:[[21608]],194624:[[21666]],194625:[[21750]],194626:[[21776]],194627:[[21843]],194628:[[21859]],194629:[[21892]],194630:[[21892]],194631:[[21913]],194632:[[21931]],194633:[[21939]],194634:[[21954]],194635:[[22294]],194636:[[22022]],194637:[[22295]],194638:[[22097]],194639:[[22132]],194640:[[20999]],194641:[[22766]],194642:[[22478]],194643:[[22516]],194644:[[22541]],194645:[[22411]],194646:[[22578]],194647:[[22577]],194648:[[22700]],194649:[[136420]],194650:[[22770]],194651:[[22775]],194652:[[22790]],194653:[[22810]],194654:[[22818]],194655:[[22882]],194656:[[136872]],194657:[[136938]],194658:[[23020]],194659:[[23067]],194660:[[23079]],194661:[[23e3]],194662:[[23142]],194663:[[14062]],194664:[[14076]],194665:[[23304]],194666:[[23358]],194667:[[23358]],194668:[[137672]],194669:[[23491]],194670:[[23512]],194671:[[23527]],194672:[[23539]],194673:[[138008]],194674:[[23551]],194675:[[23558]],194676:[[24403]],194677:[[23586]],194678:[[14209]],194679:[[23648]],194680:[[23662]],194681:[[23744]],194682:[[23693]],194683:[[138724]],194684:[[23875]],194685:[[138726]],194686:[[23918]],194687:[[23915]],194688:[[23932]],194689:[[24033]],194690:[[24034]],194691:[[14383]],194692:[[24061]],194693:[[24104]],194694:[[24125]],194695:[[24169]],194696:[[14434]],194697:[[139651]],194698:[[14460]],194699:[[24240]],194700:[[24243]],194701:[[24246]],194702:[[24266]],194703:[[172946]],194704:[[24318]],194705:[[140081]],194706:[[140081]],194707:[[33281]],194708:[[24354]],194709:[[24354]],194710:[[14535]],194711:[[144056]],194712:[[156122]],194713:[[24418]],194714:[[24427]],194715:[[14563]],194716:[[24474]],194717:[[24525]],194718:[[24535]],194719:[[24569]],194720:[[24705]],194721:[[14650]],194722:[[14620]],194723:[[24724]],194724:[[141012]],194725:[[24775]],194726:[[24904]],194727:[[24908]],194728:[[24910]],194729:[[24908]],194730:[[24954]],194731:[[24974]],194732:[[25010]],194733:[[24996]],194734:[[25007]],194735:[[25054]],194736:[[25074]],194737:[[25078]],194738:[[25104]],194739:[[25115]],194740:[[25181]],194741:[[25265]],194742:[[25300]],194743:[[25424]],194744:[[142092]],194745:[[25405]],194746:[[25340]],194747:[[25448]],194748:[[25475]],194749:[[25572]],194750:[[142321]],194751:[[25634]],194752:[[25541]],194753:[[25513]],194754:[[14894]],194755:[[25705]],194756:[[25726]],194757:[[25757]],194758:[[25719]],194759:[[14956]],194760:[[25935]],194761:[[25964]],194762:[[143370]],194763:[[26083]],194764:[[26360]],194765:[[26185]],194766:[[15129]],194767:[[26257]],194768:[[15112]],194769:[[15076]],194770:[[20882]],194771:[[20885]],194772:[[26368]],194773:[[26268]],194774:[[32941]],194775:[[17369]],194776:[[26391]],194777:[[26395]],194778:[[26401]],194779:[[26462]],194780:[[26451]],194781:[[144323]],194782:[[15177]],194783:[[26618]],194784:[[26501]],194785:[[26706]],194786:[[26757]],194787:[[144493]],194788:[[26766]],194789:[[26655]],194790:[[26900]],194791:[[15261]],194792:[[26946]],194793:[[27043]],194794:[[27114]],194795:[[27304]],194796:[[145059]],194797:[[27355]],194798:[[15384]],194799:[[27425]],194800:[[145575]],194801:[[27476]],194802:[[15438]],194803:[[27506]],194804:[[27551]],194805:[[27578]],194806:[[27579]],194807:[[146061]],194808:[[138507]],194809:[[146170]],194810:[[27726]],194811:[[146620]],194812:[[27839]],194813:[[27853]],194814:[[27751]],194815:[[27926]]},63744:{63744:[[35912]],63745:[[26356]],63746:[[36554]],63747:[[36040]],63748:[[28369]],63749:[[20018]],63750:[[21477]],63751:[[40860]],63752:[[40860]],63753:[[22865]],63754:[[37329]],63755:[[21895]],63756:[[22856]],63757:[[25078]],63758:[[30313]],63759:[[32645]],63760:[[34367]],63761:[[34746]],63762:[[35064]],63763:[[37007]],63764:[[27138]],63765:[[27931]],63766:[[28889]],63767:[[29662]],63768:[[33853]],63769:[[37226]],63770:[[39409]],63771:[[20098]],63772:[[21365]],63773:[[27396]],63774:[[29211]],63775:[[34349]],63776:[[40478]],63777:[[23888]],63778:[[28651]],63779:[[34253]],63780:[[35172]],63781:[[25289]],63782:[[33240]],63783:[[34847]],63784:[[24266]],63785:[[26391]],63786:[[28010]],63787:[[29436]],63788:[[37070]],63789:[[20358]],63790:[[20919]],63791:[[21214]],63792:[[25796]],63793:[[27347]],63794:[[29200]],63795:[[30439]],63796:[[32769]],63797:[[34310]],63798:[[34396]],63799:[[36335]],63800:[[38706]],63801:[[39791]],63802:[[40442]],63803:[[30860]],63804:[[31103]],63805:[[32160]],63806:[[33737]],63807:[[37636]],63808:[[40575]],63809:[[35542]],63810:[[22751]],63811:[[24324]],63812:[[31840]],63813:[[32894]],63814:[[29282]],63815:[[30922]],63816:[[36034]],63817:[[38647]],63818:[[22744]],63819:[[23650]],63820:[[27155]],63821:[[28122]],63822:[[28431]],63823:[[32047]],63824:[[32311]],63825:[[38475]],63826:[[21202]],63827:[[32907]],63828:[[20956]],63829:[[20940]],63830:[[31260]],63831:[[32190]],63832:[[33777]],63833:[[38517]],63834:[[35712]],63835:[[25295]],63836:[[27138]],63837:[[35582]],63838:[[20025]],63839:[[23527]],63840:[[24594]],63841:[[29575]],63842:[[30064]],63843:[[21271]],63844:[[30971]],63845:[[20415]],63846:[[24489]],63847:[[19981]],63848:[[27852]],63849:[[25976]],63850:[[32034]],63851:[[21443]],63852:[[22622]],63853:[[30465]],63854:[[33865]],63855:[[35498]],63856:[[27578]],63857:[[36784]],63858:[[27784]],63859:[[25342]],63860:[[33509]],63861:[[25504]],63862:[[30053]],63863:[[20142]],63864:[[20841]],63865:[[20937]],63866:[[26753]],63867:[[31975]],63868:[[33391]],63869:[[35538]],63870:[[37327]],63871:[[21237]],63872:[[21570]],63873:[[22899]],63874:[[24300]],63875:[[26053]],63876:[[28670]],63877:[[31018]],63878:[[38317]],63879:[[39530]],63880:[[40599]],63881:[[40654]],63882:[[21147]],63883:[[26310]],63884:[[27511]],63885:[[36706]],63886:[[24180]],63887:[[24976]],63888:[[25088]],63889:[[25754]],63890:[[28451]],63891:[[29001]],63892:[[29833]],63893:[[31178]],63894:[[32244]],63895:[[32879]],63896:[[36646]],63897:[[34030]],63898:[[36899]],63899:[[37706]],63900:[[21015]],63901:[[21155]],63902:[[21693]],63903:[[28872]],63904:[[35010]],63905:[[35498]],63906:[[24265]],63907:[[24565]],63908:[[25467]],63909:[[27566]],63910:[[31806]],63911:[[29557]],63912:[[20196]],63913:[[22265]],63914:[[23527]],63915:[[23994]],63916:[[24604]],63917:[[29618]],63918:[[29801]],63919:[[32666]],63920:[[32838]],63921:[[37428]],63922:[[38646]],63923:[[38728]],63924:[[38936]],63925:[[20363]],63926:[[31150]],63927:[[37300]],63928:[[38584]],63929:[[24801]],63930:[[20102]],63931:[[20698]],63932:[[23534]],63933:[[23615]],63934:[[26009]],63935:[[27138]],63936:[[29134]],63937:[[30274]],63938:[[34044]],63939:[[36988]],63940:[[40845]],63941:[[26248]],63942:[[38446]],63943:[[21129]],63944:[[26491]],63945:[[26611]],63946:[[27969]],63947:[[28316]],63948:[[29705]],63949:[[30041]],63950:[[30827]],63951:[[32016]],63952:[[39006]],63953:[[20845]],63954:[[25134]],63955:[[38520]],63956:[[20523]],63957:[[23833]],63958:[[28138]],63959:[[36650]],63960:[[24459]],63961:[[24900]],63962:[[26647]],63963:[[29575]],63964:[[38534]],63965:[[21033]],63966:[[21519]],63967:[[23653]],63968:[[26131]],63969:[[26446]],63970:[[26792]],63971:[[27877]],63972:[[29702]],63973:[[30178]],63974:[[32633]],63975:[[35023]],63976:[[35041]],63977:[[37324]],63978:[[38626]],63979:[[21311]],63980:[[28346]],63981:[[21533]],63982:[[29136]],63983:[[29848]],63984:[[34298]],63985:[[38563]],63986:[[40023]],63987:[[40607]],63988:[[26519]],63989:[[28107]],63990:[[33256]],63991:[[31435]],63992:[[31520]],63993:[[31890]],63994:[[29376]],63995:[[28825]],63996:[[35672]],63997:[[20160]],63998:[[33590]],63999:[[21050]],194816:[[27966]],194817:[[28023]],194818:[[27969]],194819:[[28009]],194820:[[28024]],194821:[[28037]],194822:[[146718]],194823:[[27956]],194824:[[28207]],194825:[[28270]],194826:[[15667]],194827:[[28363]],194828:[[28359]],194829:[[147153]],194830:[[28153]],194831:[[28526]],194832:[[147294]],194833:[[147342]],194834:[[28614]],194835:[[28729]],194836:[[28702]],194837:[[28699]],194838:[[15766]],194839:[[28746]],194840:[[28797]],194841:[[28791]],194842:[[28845]],194843:[[132389]],194844:[[28997]],194845:[[148067]],194846:[[29084]],194847:[[148395]],194848:[[29224]],194849:[[29237]],194850:[[29264]],194851:[[149e3]],194852:[[29312]],194853:[[29333]],194854:[[149301]],194855:[[149524]],194856:[[29562]],194857:[[29579]],194858:[[16044]],194859:[[29605]],194860:[[16056]],194861:[[16056]],194862:[[29767]],194863:[[29788]],194864:[[29809]],194865:[[29829]],194866:[[29898]],194867:[[16155]],194868:[[29988]],194869:[[150582]],194870:[[30014]],194871:[[150674]],194872:[[30064]],194873:[[139679]],194874:[[30224]],194875:[[151457]],194876:[[151480]],194877:[[151620]],194878:[[16380]],194879:[[16392]],194880:[[30452]],194881:[[151795]],194882:[[151794]],194883:[[151833]],194884:[[151859]],194885:[[30494]],194886:[[30495]],194887:[[30495]],194888:[[30538]],194889:[[16441]],194890:[[30603]],194891:[[16454]],194892:[[16534]],194893:[[152605]],194894:[[30798]],194895:[[30860]],194896:[[30924]],194897:[[16611]],194898:[[153126]],194899:[[31062]],194900:[[153242]],194901:[[153285]],194902:[[31119]],194903:[[31211]],194904:[[16687]],194905:[[31296]],194906:[[31306]],194907:[[31311]],194908:[[153980]],194909:[[154279]],194910:[[154279]],194911:[[31470]],194912:[[16898]],194913:[[154539]],194914:[[31686]],194915:[[31689]],194916:[[16935]],194917:[[154752]],194918:[[31954]],194919:[[17056]],194920:[[31976]],194921:[[31971]],194922:[[32e3]],194923:[[155526]],194924:[[32099]],194925:[[17153]],194926:[[32199]],194927:[[32258]],194928:[[32325]],194929:[[17204]],194930:[[156200]],194931:[[156231]],194932:[[17241]],194933:[[156377]],194934:[[32634]],194935:[[156478]],194936:[[32661]],194937:[[32762]],194938:[[32773]],194939:[[156890]],194940:[[156963]],194941:[[32864]],194942:[[157096]],194943:[[32880]],194944:[[144223]],194945:[[17365]],194946:[[32946]],194947:[[33027]],194948:[[17419]],194949:[[33086]],194950:[[23221]],194951:[[157607]],194952:[[157621]],194953:[[144275]],194954:[[144284]],194955:[[33281]],194956:[[33284]],194957:[[36766]],194958:[[17515]],194959:[[33425]],194960:[[33419]],194961:[[33437]],194962:[[21171]],194963:[[33457]],194964:[[33459]],194965:[[33469]],194966:[[33510]],194967:[[158524]],194968:[[33509]],194969:[[33565]],194970:[[33635]],194971:[[33709]],194972:[[33571]],194973:[[33725]],194974:[[33767]],194975:[[33879]],194976:[[33619]],194977:[[33738]],194978:[[33740]],194979:[[33756]],194980:[[158774]],194981:[[159083]],194982:[[158933]],194983:[[17707]],194984:[[34033]],194985:[[34035]],194986:[[34070]],194987:[[160714]],194988:[[34148]],194989:[[159532]],194990:[[17757]],194991:[[17761]],194992:[[159665]],194993:[[159954]],194994:[[17771]],194995:[[34384]],194996:[[34396]],194997:[[34407]],194998:[[34409]],194999:[[34473]],195e3:[[34440]],195001:[[34574]],195002:[[34530]],195003:[[34681]],195004:[[34600]],195005:[[34667]],195006:[[34694]],195007:[[17879]],195008:[[34785]],195009:[[34817]],195010:[[17913]],195011:[[34912]],195012:[[34915]],195013:[[161383]],195014:[[35031]],195015:[[35038]],195016:[[17973]],195017:[[35066]],195018:[[13499]],195019:[[161966]],195020:[[162150]],195021:[[18110]],195022:[[18119]],195023:[[35488]],195024:[[35565]],195025:[[35722]],195026:[[35925]],195027:[[162984]],195028:[[36011]],195029:[[36033]],195030:[[36123]],195031:[[36215]],195032:[[163631]],195033:[[133124]],195034:[[36299]],195035:[[36284]],195036:[[36336]],195037:[[133342]],195038:[[36564]],195039:[[36664]],195040:[[165330]],195041:[[165357]],195042:[[37012]],195043:[[37105]],195044:[[37137]],195045:[[165678]],195046:[[37147]],195047:[[37432]],195048:[[37591]],195049:[[37592]],195050:[[37500]],195051:[[37881]],195052:[[37909]],195053:[[166906]],195054:[[38283]],195055:[[18837]],195056:[[38327]],195057:[[167287]],195058:[[18918]],195059:[[38595]],195060:[[23986]],195061:[[38691]],195062:[[168261]],195063:[[168474]],195064:[[19054]],195065:[[19062]],195066:[[38880]],195067:[[168970]],195068:[[19122]],195069:[[169110]],195070:[[38923]],195071:[[38923]]},64e3:{64e3:[[20999]],64001:[[24230]],64002:[[25299]],64003:[[31958]],64004:[[23429]],64005:[[27934]],64006:[[26292]],64007:[[36667]],64008:[[34892]],64009:[[38477]],64010:[[35211]],64011:[[24275]],64012:[[20800]],64013:[[21952]],64016:[[22618]],64018:[[26228]],64021:[[20958]],64022:[[29482]],64023:[[30410]],64024:[[31036]],64025:[[31070]],64026:[[31077]],64027:[[31119]],64028:[[38742]],64029:[[31934]],64030:[[32701]],64032:[[34322]],64034:[[35576]],64037:[[36920]],64038:[[37117]],64042:[[39151]],64043:[[39164]],64044:[[39208]],64045:[[40372]],64046:[[37086]],64047:[[38583]],64048:[[20398]],64049:[[20711]],64050:[[20813]],64051:[[21193]],64052:[[21220]],64053:[[21329]],64054:[[21917]],64055:[[22022]],64056:[[22120]],64057:[[22592]],64058:[[22696]],64059:[[23652]],64060:[[23662]],64061:[[24724]],64062:[[24936]],64063:[[24974]],64064:[[25074]],64065:[[25935]],64066:[[26082]],64067:[[26257]],64068:[[26757]],64069:[[28023]],64070:[[28186]],64071:[[28450]],64072:[[29038]],64073:[[29227]],64074:[[29730]],64075:[[30865]],64076:[[31038]],64077:[[31049]],64078:[[31048]],64079:[[31056]],64080:[[31062]],64081:[[31069]],64082:[[31117]],64083:[[31118]],64084:[[31296]],64085:[[31361]],64086:[[31680]],64087:[[32244]],64088:[[32265]],64089:[[32321]],64090:[[32626]],64091:[[32773]],64092:[[33261]],64093:[[33401]],64094:[[33401]],64095:[[33879]],64096:[[35088]],64097:[[35222]],64098:[[35585]],64099:[[35641]],64100:[[36051]],64101:[[36104]],64102:[[36790]],64103:[[36920]],64104:[[38627]],64105:[[38911]],64106:[[38971]],64107:[[24693]],64108:[[148206]],64109:[[33304]],64112:[[20006]],64113:[[20917]],64114:[[20840]],64115:[[20352]],64116:[[20805]],64117:[[20864]],64118:[[21191]],64119:[[21242]],64120:[[21917]],64121:[[21845]],64122:[[21913]],64123:[[21986]],64124:[[22618]],64125:[[22707]],64126:[[22852]],64127:[[22868]],64128:[[23138]],64129:[[23336]],64130:[[24274]],64131:[[24281]],64132:[[24425]],64133:[[24493]],64134:[[24792]],64135:[[24910]],64136:[[24840]],64137:[[24974]],64138:[[24928]],64139:[[25074]],64140:[[25140]],64141:[[25540]],64142:[[25628]],64143:[[25682]],64144:[[25942]],64145:[[26228]],64146:[[26391]],64147:[[26395]],64148:[[26454]],64149:[[27513]],64150:[[27578]],64151:[[27969]],64152:[[28379]],64153:[[28363]],64154:[[28450]],64155:[[28702]],64156:[[29038]],64157:[[30631]],64158:[[29237]],64159:[[29359]],64160:[[29482]],64161:[[29809]],64162:[[29958]],64163:[[30011]],64164:[[30237]],64165:[[30239]],64166:[[30410]],64167:[[30427]],64168:[[30452]],64169:[[30538]],64170:[[30528]],64171:[[30924]],64172:[[31409]],64173:[[31680]],64174:[[31867]],64175:[[32091]],64176:[[32244]],64177:[[32574]],64178:[[32773]],64179:[[33618]],64180:[[33775]],64181:[[34681]],64182:[[35137]],64183:[[35206]],64184:[[35222]],64185:[[35519]],64186:[[35576]],64187:[[35531]],64188:[[35585]],64189:[[35582]],64190:[[35565]],64191:[[35641]],64192:[[35722]],64193:[[36104]],64194:[[36664]],64195:[[36978]],64196:[[37273]],64197:[[37494]],64198:[[38524]],64199:[[38627]],64200:[[38742]],64201:[[38875]],64202:[[38911]],64203:[[38923]],64204:[[38971]],64205:[[39698]],64206:[[40860]],64207:[[141386]],64208:[[141380]],64209:[[144341]],64210:[[15261]],64211:[[16408]],64212:[[16441]],64213:[[152137]],64214:[[154832]],64215:[[163539]],64216:[[40771]],64217:[[40846]],195072:[[38953]],195073:[[169398]],195074:[[39138]],195075:[[19251]],195076:[[39209]],195077:[[39335]],195078:[[39362]],195079:[[39422]],195080:[[19406]],195081:[[170800]],195082:[[39698]],195083:[[4e4]],195084:[[40189]],195085:[[19662]],195086:[[19693]],195087:[[40295]],195088:[[172238]],195089:[[19704]],195090:[[172293]],195091:[[172558]],195092:[[172689]],195093:[[40635]],195094:[[19798]],195095:[[40697]],195096:[[40702]],195097:[[40709]],195098:[[40719]],195099:[[40726]],195100:[[40763]],195101:[[173568]]},64256:{64256:[[102,102],256],64257:[[102,105],256],64258:[[102,108],256],64259:[[102,102,105],256],64260:[[102,102,108],256],64261:[[383,116],256],64262:[[115,116],256],64275:[[1396,1398],256],64276:[[1396,1381],256],64277:[[1396,1387],256],64278:[[1406,1398],256],64279:[[1396,1389],256],64285:[[1497,1460],512],64286:[,26],64287:[[1522,1463],512],64288:[[1506],256],64289:[[1488],256],64290:[[1491],256],64291:[[1492],256],64292:[[1499],256],64293:[[1500],256],64294:[[1501],256],64295:[[1512],256],64296:[[1514],256],64297:[[43],256],64298:[[1513,1473],512],64299:[[1513,1474],512],64300:[[64329,1473],512],64301:[[64329,1474],512],64302:[[1488,1463],512],64303:[[1488,1464],512],64304:[[1488,1468],512],64305:[[1489,1468],512],64306:[[1490,1468],512],64307:[[1491,1468],512],64308:[[1492,1468],512],64309:[[1493,1468],512],64310:[[1494,1468],512],64312:[[1496,1468],512],64313:[[1497,1468],512],64314:[[1498,1468],512],64315:[[1499,1468],512],64316:[[1500,1468],512],64318:[[1502,1468],512],64320:[[1504,1468],512],64321:[[1505,1468],512],64323:[[1507,1468],512],64324:[[1508,1468],512],64326:[[1510,1468],512],64327:[[1511,1468],512],64328:[[1512,1468],512],64329:[[1513,1468],512],64330:[[1514,1468],512],64331:[[1493,1465],512],64332:[[1489,1471],512],64333:[[1499,1471],512],64334:[[1508,1471],512],64335:[[1488,1500],256],64336:[[1649],256],64337:[[1649],256],64338:[[1659],256],64339:[[1659],256],64340:[[1659],256],64341:[[1659],256],64342:[[1662],256],64343:[[1662],256],64344:[[1662],256],64345:[[1662],256],64346:[[1664],256],64347:[[1664],256],64348:[[1664],256],64349:[[1664],256],64350:[[1658],256],64351:[[1658],256],64352:[[1658],256],64353:[[1658],256],64354:[[1663],256],64355:[[1663],256],64356:[[1663],256],64357:[[1663],256],64358:[[1657],256],64359:[[1657],256],64360:[[1657],256],64361:[[1657],256],64362:[[1700],256],64363:[[1700],256],64364:[[1700],256],64365:[[1700],256],64366:[[1702],256],64367:[[1702],256],64368:[[1702],256],64369:[[1702],256],64370:[[1668],256],64371:[[1668],256],64372:[[1668],256],64373:[[1668],256],64374:[[1667],256],64375:[[1667],256],64376:[[1667],256],64377:[[1667],256],64378:[[1670],256],64379:[[1670],256],64380:[[1670],256],64381:[[1670],256],64382:[[1671],256],64383:[[1671],256],64384:[[1671],256],64385:[[1671],256],64386:[[1677],256],64387:[[1677],256],64388:[[1676],256],64389:[[1676],256],64390:[[1678],256],64391:[[1678],256],64392:[[1672],256],64393:[[1672],256],64394:[[1688],256],64395:[[1688],256],64396:[[1681],256],64397:[[1681],256],64398:[[1705],256],64399:[[1705],256],64400:[[1705],256],64401:[[1705],256],64402:[[1711],256],64403:[[1711],256],64404:[[1711],256],64405:[[1711],256],64406:[[1715],256],64407:[[1715],256],64408:[[1715],256],64409:[[1715],256],64410:[[1713],256],64411:[[1713],256],64412:[[1713],256],64413:[[1713],256],64414:[[1722],256],64415:[[1722],256],64416:[[1723],256],64417:[[1723],256],64418:[[1723],256],64419:[[1723],256],64420:[[1728],256],64421:[[1728],256],64422:[[1729],256],64423:[[1729],256],64424:[[1729],256],64425:[[1729],256],64426:[[1726],256],64427:[[1726],256],64428:[[1726],256],64429:[[1726],256],64430:[[1746],256],64431:[[1746],256],64432:[[1747],256],64433:[[1747],256],64467:[[1709],256],64468:[[1709],256],64469:[[1709],256],64470:[[1709],256],64471:[[1735],256],64472:[[1735],256],64473:[[1734],256],64474:[[1734],256],64475:[[1736],256],64476:[[1736],256],64477:[[1655],256],64478:[[1739],256],64479:[[1739],256],64480:[[1733],256],64481:[[1733],256],64482:[[1737],256],64483:[[1737],256],64484:[[1744],256],64485:[[1744],256],64486:[[1744],256],64487:[[1744],256],64488:[[1609],256],64489:[[1609],256],64490:[[1574,1575],256],64491:[[1574,1575],256],64492:[[1574,1749],256],64493:[[1574,1749],256],64494:[[1574,1608],256],64495:[[1574,1608],256],64496:[[1574,1735],256],64497:[[1574,1735],256],64498:[[1574,1734],256],64499:[[1574,1734],256],64500:[[1574,1736],256],64501:[[1574,1736],256],64502:[[1574,1744],256],64503:[[1574,1744],256],64504:[[1574,1744],256],64505:[[1574,1609],256],64506:[[1574,1609],256],64507:[[1574,1609],256],64508:[[1740],256],64509:[[1740],256],64510:[[1740],256],64511:[[1740],256]},64512:{64512:[[1574,1580],256],64513:[[1574,1581],256],64514:[[1574,1605],256],64515:[[1574,1609],256],64516:[[1574,1610],256],64517:[[1576,1580],256],64518:[[1576,1581],256],64519:[[1576,1582],256],64520:[[1576,1605],256],64521:[[1576,1609],256],64522:[[1576,1610],256],64523:[[1578,1580],256],64524:[[1578,1581],256],64525:[[1578,1582],256],64526:[[1578,1605],256],64527:[[1578,1609],256],64528:[[1578,1610],256],64529:[[1579,1580],256],64530:[[1579,1605],256],64531:[[1579,1609],256],64532:[[1579,1610],256],64533:[[1580,1581],256],64534:[[1580,1605],256],64535:[[1581,1580],256],64536:[[1581,1605],256],64537:[[1582,1580],256],64538:[[1582,1581],256],64539:[[1582,1605],256],64540:[[1587,1580],256],64541:[[1587,1581],256],64542:[[1587,1582],256],64543:[[1587,1605],256],64544:[[1589,1581],256],64545:[[1589,1605],256],64546:[[1590,1580],256],64547:[[1590,1581],256],64548:[[1590,1582],256],64549:[[1590,1605],256],64550:[[1591,1581],256],64551:[[1591,1605],256],64552:[[1592,1605],256],64553:[[1593,1580],256],64554:[[1593,1605],256],64555:[[1594,1580],256],64556:[[1594,1605],256],64557:[[1601,1580],256],64558:[[1601,1581],256],64559:[[1601,1582],256],64560:[[1601,1605],256],64561:[[1601,1609],256],64562:[[1601,1610],256],64563:[[1602,1581],256],64564:[[1602,1605],256],64565:[[1602,1609],256],64566:[[1602,1610],256],64567:[[1603,1575],256],64568:[[1603,1580],256],64569:[[1603,1581],256],64570:[[1603,1582],256],64571:[[1603,1604],256],64572:[[1603,1605],256],64573:[[1603,1609],256],64574:[[1603,1610],256],64575:[[1604,1580],256],64576:[[1604,1581],256],64577:[[1604,1582],256],64578:[[1604,1605],256],64579:[[1604,1609],256],64580:[[1604,1610],256],64581:[[1605,1580],256],64582:[[1605,1581],256],64583:[[1605,1582],256],64584:[[1605,1605],256],64585:[[1605,1609],256],64586:[[1605,1610],256],64587:[[1606,1580],256],64588:[[1606,1581],256],64589:[[1606,1582],256],64590:[[1606,1605],256],64591:[[1606,1609],256],64592:[[1606,1610],256],64593:[[1607,1580],256],64594:[[1607,1605],256],64595:[[1607,1609],256],64596:[[1607,1610],256],64597:[[1610,1580],256],64598:[[1610,1581],256],64599:[[1610,1582],256],64600:[[1610,1605],256],64601:[[1610,1609],256],64602:[[1610,1610],256],64603:[[1584,1648],256],64604:[[1585,1648],256],64605:[[1609,1648],256],64606:[[32,1612,1617],256],64607:[[32,1613,1617],256],64608:[[32,1614,1617],256],64609:[[32,1615,1617],256],64610:[[32,1616,1617],256],64611:[[32,1617,1648],256],64612:[[1574,1585],256],64613:[[1574,1586],256],64614:[[1574,1605],256],64615:[[1574,1606],256],64616:[[1574,1609],256],64617:[[1574,1610],256],64618:[[1576,1585],256],64619:[[1576,1586],256],64620:[[1576,1605],256],64621:[[1576,1606],256],64622:[[1576,1609],256],64623:[[1576,1610],256],64624:[[1578,1585],256],64625:[[1578,1586],256],64626:[[1578,1605],256],64627:[[1578,1606],256],64628:[[1578,1609],256],64629:[[1578,1610],256],64630:[[1579,1585],256],64631:[[1579,1586],256],64632:[[1579,1605],256],64633:[[1579,1606],256],64634:[[1579,1609],256],64635:[[1579,1610],256],64636:[[1601,1609],256],64637:[[1601,1610],256],64638:[[1602,1609],256],64639:[[1602,1610],256],64640:[[1603,1575],256],64641:[[1603,1604],256],64642:[[1603,1605],256],64643:[[1603,1609],256],64644:[[1603,1610],256],64645:[[1604,1605],256],64646:[[1604,1609],256],64647:[[1604,1610],256],64648:[[1605,1575],256],64649:[[1605,1605],256],64650:[[1606,1585],256],64651:[[1606,1586],256],64652:[[1606,1605],256],64653:[[1606,1606],256],64654:[[1606,1609],256],64655:[[1606,1610],256],64656:[[1609,1648],256],64657:[[1610,1585],256],64658:[[1610,1586],256],64659:[[1610,1605],256],64660:[[1610,1606],256],64661:[[1610,1609],256],64662:[[1610,1610],256],64663:[[1574,1580],256],64664:[[1574,1581],256],64665:[[1574,1582],256],64666:[[1574,1605],256],64667:[[1574,1607],256],64668:[[1576,1580],256],64669:[[1576,1581],256],64670:[[1576,1582],256],64671:[[1576,1605],256],64672:[[1576,1607],256],64673:[[1578,1580],256],64674:[[1578,1581],256],64675:[[1578,1582],256],64676:[[1578,1605],256],64677:[[1578,1607],256],64678:[[1579,1605],256],64679:[[1580,1581],256],64680:[[1580,1605],256],64681:[[1581,1580],256],64682:[[1581,1605],256],64683:[[1582,1580],256],64684:[[1582,1605],256],64685:[[1587,1580],256],64686:[[1587,1581],256],64687:[[1587,1582],256],64688:[[1587,1605],256],64689:[[1589,1581],256],64690:[[1589,1582],256],64691:[[1589,1605],256],64692:[[1590,1580],256],64693:[[1590,1581],256],64694:[[1590,1582],256],64695:[[1590,1605],256],64696:[[1591,1581],256],64697:[[1592,1605],256],64698:[[1593,1580],256],64699:[[1593,1605],256],64700:[[1594,1580],256],64701:[[1594,1605],256],64702:[[1601,1580],256],64703:[[1601,1581],256],64704:[[1601,1582],256],64705:[[1601,1605],256],64706:[[1602,1581],256],64707:[[1602,1605],256],64708:[[1603,1580],256],64709:[[1603,1581],256],64710:[[1603,1582],256],64711:[[1603,1604],256],64712:[[1603,1605],256],64713:[[1604,1580],256],64714:[[1604,1581],256],64715:[[1604,1582],256],64716:[[1604,1605],256],64717:[[1604,1607],256],64718:[[1605,1580],256],64719:[[1605,1581],256],64720:[[1605,1582],256],64721:[[1605,1605],256],64722:[[1606,1580],256],64723:[[1606,1581],256],64724:[[1606,1582],256],64725:[[1606,1605],256],64726:[[1606,1607],256],64727:[[1607,1580],256],64728:[[1607,1605],256],64729:[[1607,1648],256],64730:[[1610,1580],256],64731:[[1610,1581],256],64732:[[1610,1582],256],64733:[[1610,1605],256],64734:[[1610,1607],256],64735:[[1574,1605],256],64736:[[1574,1607],256],64737:[[1576,1605],256],64738:[[1576,1607],256],64739:[[1578,1605],256],64740:[[1578,1607],256],64741:[[1579,1605],256],64742:[[1579,1607],256],64743:[[1587,1605],256],64744:[[1587,1607],256],64745:[[1588,1605],256],64746:[[1588,1607],256],64747:[[1603,1604],256],64748:[[1603,1605],256],64749:[[1604,1605],256],64750:[[1606,1605],256],64751:[[1606,1607],256],64752:[[1610,1605],256],64753:[[1610,1607],256],64754:[[1600,1614,1617],256],64755:[[1600,1615,1617],256],64756:[[1600,1616,1617],256],64757:[[1591,1609],256],64758:[[1591,1610],256],64759:[[1593,1609],256],64760:[[1593,1610],256],64761:[[1594,1609],256],64762:[[1594,1610],256],64763:[[1587,1609],256],64764:[[1587,1610],256],64765:[[1588,1609],256],64766:[[1588,1610],256],64767:[[1581,1609],256]},64768:{64768:[[1581,1610],256],64769:[[1580,1609],256],64770:[[1580,1610],256],64771:[[1582,1609],256],64772:[[1582,1610],256],64773:[[1589,1609],256],64774:[[1589,1610],256],64775:[[1590,1609],256],64776:[[1590,1610],256],64777:[[1588,1580],256],64778:[[1588,1581],256],64779:[[1588,1582],256],64780:[[1588,1605],256],64781:[[1588,1585],256],64782:[[1587,1585],256],64783:[[1589,1585],256],64784:[[1590,1585],256],64785:[[1591,1609],256],64786:[[1591,1610],256],64787:[[1593,1609],256],64788:[[1593,1610],256],64789:[[1594,1609],256],64790:[[1594,1610],256],64791:[[1587,1609],256],64792:[[1587,1610],256],64793:[[1588,1609],256],64794:[[1588,1610],256],64795:[[1581,1609],256],64796:[[1581,1610],256],64797:[[1580,1609],256],64798:[[1580,1610],256],64799:[[1582,1609],256],64800:[[1582,1610],256],64801:[[1589,1609],256],64802:[[1589,1610],256],64803:[[1590,1609],256],64804:[[1590,1610],256],64805:[[1588,1580],256],64806:[[1588,1581],256],64807:[[1588,1582],256],64808:[[1588,1605],256],64809:[[1588,1585],256],64810:[[1587,1585],256],64811:[[1589,1585],256],64812:[[1590,1585],256],64813:[[1588,1580],256],64814:[[1588,1581],256],64815:[[1588,1582],256],64816:[[1588,1605],256],64817:[[1587,1607],256],64818:[[1588,1607],256],64819:[[1591,1605],256],64820:[[1587,1580],256],64821:[[1587,1581],256],64822:[[1587,1582],256],64823:[[1588,1580],256],64824:[[1588,1581],256],64825:[[1588,1582],256],64826:[[1591,1605],256],64827:[[1592,1605],256],64828:[[1575,1611],256],64829:[[1575,1611],256],64848:[[1578,1580,1605],256],64849:[[1578,1581,1580],256],64850:[[1578,1581,1580],256],64851:[[1578,1581,1605],256],64852:[[1578,1582,1605],256],64853:[[1578,1605,1580],256],64854:[[1578,1605,1581],256],64855:[[1578,1605,1582],256],64856:[[1580,1605,1581],256],64857:[[1580,1605,1581],256],64858:[[1581,1605,1610],256],64859:[[1581,1605,1609],256],64860:[[1587,1581,1580],256],64861:[[1587,1580,1581],256],64862:[[1587,1580,1609],256],64863:[[1587,1605,1581],256],64864:[[1587,1605,1581],256],64865:[[1587,1605,1580],256],64866:[[1587,1605,1605],256],64867:[[1587,1605,1605],256],64868:[[1589,1581,1581],256],64869:[[1589,1581,1581],256],64870:[[1589,1605,1605],256],64871:[[1588,1581,1605],256],64872:[[1588,1581,1605],256],64873:[[1588,1580,1610],256],64874:[[1588,1605,1582],256],64875:[[1588,1605,1582],256],64876:[[1588,1605,1605],256],64877:[[1588,1605,1605],256],64878:[[1590,1581,1609],256],64879:[[1590,1582,1605],256],64880:[[1590,1582,1605],256],64881:[[1591,1605,1581],256],64882:[[1591,1605,1581],256],64883:[[1591,1605,1605],256],64884:[[1591,1605,1610],256],64885:[[1593,1580,1605],256],64886:[[1593,1605,1605],256],64887:[[1593,1605,1605],256],64888:[[1593,1605,1609],256],64889:[[1594,1605,1605],256],64890:[[1594,1605,1610],256],64891:[[1594,1605,1609],256],64892:[[1601,1582,1605],256],64893:[[1601,1582,1605],256],64894:[[1602,1605,1581],256],64895:[[1602,1605,1605],256],64896:[[1604,1581,1605],256],64897:[[1604,1581,1610],256],64898:[[1604,1581,1609],256],64899:[[1604,1580,1580],256],64900:[[1604,1580,1580],256],64901:[[1604,1582,1605],256],64902:[[1604,1582,1605],256],64903:[[1604,1605,1581],256],64904:[[1604,1605,1581],256],64905:[[1605,1581,1580],256],64906:[[1605,1581,1605],256],64907:[[1605,1581,1610],256],64908:[[1605,1580,1581],256],64909:[[1605,1580,1605],256],64910:[[1605,1582,1580],256],64911:[[1605,1582,1605],256],64914:[[1605,1580,1582],256],64915:[[1607,1605,1580],256],64916:[[1607,1605,1605],256],64917:[[1606,1581,1605],256],64918:[[1606,1581,1609],256],64919:[[1606,1580,1605],256],64920:[[1606,1580,1605],256],64921:[[1606,1580,1609],256],64922:[[1606,1605,1610],256],64923:[[1606,1605,1609],256],64924:[[1610,1605,1605],256],64925:[[1610,1605,1605],256],64926:[[1576,1582,1610],256],64927:[[1578,1580,1610],256],64928:[[1578,1580,1609],256],64929:[[1578,1582,1610],256],64930:[[1578,1582,1609],256],64931:[[1578,1605,1610],256],64932:[[1578,1605,1609],256],64933:[[1580,1605,1610],256],64934:[[1580,1581,1609],256],64935:[[1580,1605,1609],256],64936:[[1587,1582,1609],256],64937:[[1589,1581,1610],256],64938:[[1588,1581,1610],256],64939:[[1590,1581,1610],256],64940:[[1604,1580,1610],256],64941:[[1604,1605,1610],256],64942:[[1610,1581,1610],256],64943:[[1610,1580,1610],256],64944:[[1610,1605,1610],256],64945:[[1605,1605,1610],256],64946:[[1602,1605,1610],256],64947:[[1606,1581,1610],256],64948:[[1602,1605,1581],256],64949:[[1604,1581,1605],256],64950:[[1593,1605,1610],256],64951:[[1603,1605,1610],256],64952:[[1606,1580,1581],256],64953:[[1605,1582,1610],256],64954:[[1604,1580,1605],256],64955:[[1603,1605,1605],256],64956:[[1604,1580,1605],256],64957:[[1606,1580,1581],256],64958:[[1580,1581,1610],256],64959:[[1581,1580,1610],256],64960:[[1605,1580,1610],256],64961:[[1601,1605,1610],256],64962:[[1576,1581,1610],256],64963:[[1603,1605,1605],256],64964:[[1593,1580,1605],256],64965:[[1589,1605,1605],256],64966:[[1587,1582,1610],256],64967:[[1606,1580,1610],256],65008:[[1589,1604,1746],256],65009:[[1602,1604,1746],256],65010:[[1575,1604,1604,1607],256],65011:[[1575,1603,1576,1585],256],65012:[[1605,1581,1605,1583],256],65013:[[1589,1604,1593,1605],256],65014:[[1585,1587,1608,1604],256],65015:[[1593,1604,1610,1607],256],65016:[[1608,1587,1604,1605],256],65017:[[1589,1604,1609],256],65018:[[1589,1604,1609,32,1575,1604,1604,1607,32,1593,1604,1610,1607,32,1608,1587,1604,1605],256],65019:[[1580,1604,32,1580,1604,1575,1604,1607],256],65020:[[1585,1740,1575,1604],256]},65024:{65040:[[44],256],65041:[[12289],256],65042:[[12290],256],65043:[[58],256],65044:[[59],256],65045:[[33],256],65046:[[63],256],65047:[[12310],256],65048:[[12311],256],65049:[[8230],256],65056:[,230],65057:[,230],65058:[,230],65059:[,230],65060:[,230],65061:[,230],65062:[,230],65063:[,220],65064:[,220],65065:[,220],65066:[,220],65067:[,220],65068:[,220],65069:[,220],65072:[[8229],256],65073:[[8212],256],65074:[[8211],256],65075:[[95],256],65076:[[95],256],65077:[[40],256],65078:[[41],256],65079:[[123],256],65080:[[125],256],65081:[[12308],256],65082:[[12309],256],65083:[[12304],256],65084:[[12305],256],65085:[[12298],256],65086:[[12299],256],65087:[[12296],256],65088:[[12297],256],65089:[[12300],256],65090:[[12301],256],65091:[[12302],256],65092:[[12303],256],65095:[[91],256],65096:[[93],256],65097:[[8254],256],65098:[[8254],256],65099:[[8254],256],65100:[[8254],256],65101:[[95],256],65102:[[95],256],65103:[[95],256],65104:[[44],256],65105:[[12289],256],65106:[[46],256],65108:[[59],256],65109:[[58],256],65110:[[63],256],65111:[[33],256],65112:[[8212],256],65113:[[40],256],65114:[[41],256],65115:[[123],256],65116:[[125],256],65117:[[12308],256],65118:[[12309],256],65119:[[35],256],65120:[[38],256],65121:[[42],256],65122:[[43],256],65123:[[45],256],65124:[[60],256],65125:[[62],256],65126:[[61],256],65128:[[92],256],65129:[[36],256],65130:[[37],256],65131:[[64],256],65136:[[32,1611],256],65137:[[1600,1611],256],65138:[[32,1612],256],65140:[[32,1613],256],65142:[[32,1614],256],65143:[[1600,1614],256],65144:[[32,1615],256],65145:[[1600,1615],256],65146:[[32,1616],256],65147:[[1600,1616],256],65148:[[32,1617],256],65149:[[1600,1617],256],65150:[[32,1618],256],65151:[[1600,1618],256],65152:[[1569],256],65153:[[1570],256],65154:[[1570],256],65155:[[1571],256],65156:[[1571],256],65157:[[1572],256],65158:[[1572],256],65159:[[1573],256],65160:[[1573],256],65161:[[1574],256],65162:[[1574],256],65163:[[1574],256],65164:[[1574],256],65165:[[1575],256],65166:[[1575],256],65167:[[1576],256],65168:[[1576],256],65169:[[1576],256],65170:[[1576],256],65171:[[1577],256],65172:[[1577],256],65173:[[1578],256],65174:[[1578],256],65175:[[1578],256],65176:[[1578],256],65177:[[1579],256],65178:[[1579],256],65179:[[1579],256],65180:[[1579],256],65181:[[1580],256],65182:[[1580],256],65183:[[1580],256],65184:[[1580],256],65185:[[1581],256],65186:[[1581],256],65187:[[1581],256],65188:[[1581],256],65189:[[1582],256],65190:[[1582],256],65191:[[1582],256],65192:[[1582],256],65193:[[1583],256],65194:[[1583],256],65195:[[1584],256],65196:[[1584],256],65197:[[1585],256],65198:[[1585],256],65199:[[1586],256],65200:[[1586],256],65201:[[1587],256],65202:[[1587],256],65203:[[1587],256],65204:[[1587],256],65205:[[1588],256],65206:[[1588],256],65207:[[1588],256],65208:[[1588],256],65209:[[1589],256],65210:[[1589],256],65211:[[1589],256],65212:[[1589],256],65213:[[1590],256],65214:[[1590],256],65215:[[1590],256],65216:[[1590],256],65217:[[1591],256],65218:[[1591],256],65219:[[1591],256],65220:[[1591],256],65221:[[1592],256],65222:[[1592],256],65223:[[1592],256],65224:[[1592],256],65225:[[1593],256],65226:[[1593],256],65227:[[1593],256],65228:[[1593],256],65229:[[1594],256],65230:[[1594],256],65231:[[1594],256],65232:[[1594],256],65233:[[1601],256],65234:[[1601],256],65235:[[1601],256],65236:[[1601],256],65237:[[1602],256],65238:[[1602],256],65239:[[1602],256],65240:[[1602],256],65241:[[1603],256],65242:[[1603],256],65243:[[1603],256],65244:[[1603],256],65245:[[1604],256],65246:[[1604],256],65247:[[1604],256],65248:[[1604],256],65249:[[1605],256],65250:[[1605],256],65251:[[1605],256],65252:[[1605],256],65253:[[1606],256],65254:[[1606],256],65255:[[1606],256],65256:[[1606],256],65257:[[1607],256],65258:[[1607],256],65259:[[1607],256],65260:[[1607],256],65261:[[1608],256],65262:[[1608],256],65263:[[1609],256],65264:[[1609],256],65265:[[1610],256],65266:[[1610],256],65267:[[1610],256],65268:[[1610],256],65269:[[1604,1570],256],65270:[[1604,1570],256],65271:[[1604,1571],256],65272:[[1604,1571],256],65273:[[1604,1573],256],65274:[[1604,1573],256],65275:[[1604,1575],256],65276:[[1604,1575],256]},65280:{65281:[[33],256],65282:[[34],256],65283:[[35],256],65284:[[36],256],65285:[[37],256],65286:[[38],256],65287:[[39],256],65288:[[40],256],65289:[[41],256],65290:[[42],256],65291:[[43],256],65292:[[44],256],65293:[[45],256],65294:[[46],256],65295:[[47],256],65296:[[48],256],65297:[[49],256],65298:[[50],256],65299:[[51],256],65300:[[52],256],65301:[[53],256],65302:[[54],256],65303:[[55],256],65304:[[56],256],65305:[[57],256],65306:[[58],256],65307:[[59],256],65308:[[60],256],65309:[[61],256],65310:[[62],256],65311:[[63],256],65312:[[64],256],65313:[[65],256],65314:[[66],256],65315:[[67],256],65316:[[68],256],65317:[[69],256],65318:[[70],256],65319:[[71],256],65320:[[72],256],65321:[[73],256],65322:[[74],256],65323:[[75],256],65324:[[76],256],65325:[[77],256],65326:[[78],256],65327:[[79],256],65328:[[80],256],65329:[[81],256],65330:[[82],256],65331:[[83],256],65332:[[84],256],65333:[[85],256],65334:[[86],256],65335:[[87],256],65336:[[88],256],65337:[[89],256],65338:[[90],256],65339:[[91],256],65340:[[92],256],65341:[[93],256],65342:[[94],256],65343:[[95],256],65344:[[96],256],65345:[[97],256],65346:[[98],256],65347:[[99],256],65348:[[100],256],65349:[[101],256],65350:[[102],256],65351:[[103],256],65352:[[104],256],65353:[[105],256],65354:[[106],256],65355:[[107],256],65356:[[108],256],65357:[[109],256],65358:[[110],256],65359:[[111],256],65360:[[112],256],65361:[[113],256],65362:[[114],256],65363:[[115],256],65364:[[116],256],65365:[[117],256],65366:[[118],256],65367:[[119],256],65368:[[120],256],65369:[[121],256],65370:[[122],256],65371:[[123],256],65372:[[124],256],65373:[[125],256],65374:[[126],256],65375:[[10629],256],65376:[[10630],256],65377:[[12290],256],65378:[[12300],256],65379:[[12301],256],65380:[[12289],256],65381:[[12539],256],65382:[[12530],256],65383:[[12449],256],65384:[[12451],256],65385:[[12453],256],65386:[[12455],256],65387:[[12457],256],65388:[[12515],256],65389:[[12517],256],65390:[[12519],256],65391:[[12483],256],65392:[[12540],256],65393:[[12450],256],65394:[[12452],256],65395:[[12454],256],65396:[[12456],256],65397:[[12458],256],65398:[[12459],256],65399:[[12461],256],65400:[[12463],256],65401:[[12465],256],65402:[[12467],256],65403:[[12469],256],65404:[[12471],256],65405:[[12473],256],65406:[[12475],256],65407:[[12477],256],65408:[[12479],256],65409:[[12481],256],65410:[[12484],256],65411:[[12486],256],65412:[[12488],256],65413:[[12490],256],65414:[[12491],256],65415:[[12492],256],65416:[[12493],256],65417:[[12494],256],65418:[[12495],256],65419:[[12498],256],65420:[[12501],256],65421:[[12504],256],65422:[[12507],256],65423:[[12510],256],65424:[[12511],256],65425:[[12512],256],65426:[[12513],256],65427:[[12514],256],65428:[[12516],256],65429:[[12518],256],65430:[[12520],256],65431:[[12521],256],65432:[[12522],256],65433:[[12523],256],65434:[[12524],256],65435:[[12525],256],65436:[[12527],256],65437:[[12531],256],65438:[[12441],256],65439:[[12442],256],65440:[[12644],256],65441:[[12593],256],65442:[[12594],256],65443:[[12595],256],65444:[[12596],256],65445:[[12597],256],65446:[[12598],256],65447:[[12599],256],65448:[[12600],256],65449:[[12601],256],65450:[[12602],256],65451:[[12603],256],65452:[[12604],256],65453:[[12605],256],65454:[[12606],256],65455:[[12607],256],65456:[[12608],256],65457:[[12609],256],65458:[[12610],256],65459:[[12611],256],65460:[[12612],256],65461:[[12613],256],65462:[[12614],256],65463:[[12615],256],65464:[[12616],256],65465:[[12617],256],65466:[[12618],256],65467:[[12619],256],65468:[[12620],256],65469:[[12621],256],65470:[[12622],256],65474:[[12623],256],65475:[[12624],256],65476:[[12625],256],65477:[[12626],256],65478:[[12627],256],65479:[[12628],256],65482:[[12629],256],65483:[[12630],256],65484:[[12631],256],65485:[[12632],256],65486:[[12633],256],65487:[[12634],256],65490:[[12635],256],65491:[[12636],256],65492:[[12637],256],65493:[[12638],256],65494:[[12639],256],65495:[[12640],256],65498:[[12641],256],65499:[[12642],256],65500:[[12643],256],65504:[[162],256],65505:[[163],256],65506:[[172],256],65507:[[175],256],65508:[[166],256],65509:[[165],256],65510:[[8361],256],65512:[[9474],256],65513:[[8592],256],65514:[[8593],256],65515:[[8594],256],65516:[[8595],256],65517:[[9632],256],65518:[[9675],256]}};var k={nfc:D,nfd:I,nfkc:L,nfkd:M};e.exports=k,k.shimApplied=!1,String.prototype.normalize||(Object.defineProperty(String.prototype,"normalize",{enumerable:!1,configurable:!0,writable:!0,value:function(){var e=""+this,t=void 0===arguments[0]?"NFC":arguments[0];if(null===this||void 0===this)throw new TypeError("Cannot call method on "+Object.prototype.toString.call(this));if("NFC"===t)return k.nfc(e);if("NFD"===t)return k.nfd(e);if("NFKC"===t)return k.nfkc(e);if("NFKD"===t)return k.nfkd(e);throw new RangeError("Invalid normalization form: "+t)}}),k.shimApplied=!0)}()}}]);
//# sourceMappingURL=about.9ce16d84.js.map